{"meta":{"title":"æ´»ç€å°±æ˜¯ä¸ºäº†æ‘¸é±¼ğŸŸï¼ï¼ï¼","subtitle":"","description":"ä¸€ä¸ªä¸èµ·çœ¼çš„å°åšå®¢","author":"ä¸€ä¸ªå°åƒåœ¾","url":"http://example.com","root":"/"},"pages":[{"title":"archives","date":"2022-06-25T09:46:11.000Z","updated":"2022-06-25T10:00:28.430Z","comments":true,"path":"archives/index.html","permalink":"http://example.com/archives/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2022-06-25T09:44:36.000Z","updated":"2022-06-25T10:10:32.117Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"å…³äºæˆ‘æ˜¯è°","date":"2022-06-25T09:46:19.000Z","updated":"2022-06-26T00:50:58.784Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2022-06-25T09:45:03.000Z","updated":"2022-06-25T10:09:55.599Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"","slug":"è€ƒç ”/é«˜æ•°","date":"2022-09-27T13:40:02.560Z","updated":"2022-09-27T13:40:12.715Z","comments":true,"path":"2022/09/27/è€ƒç ”/é«˜æ•°/","link":"","permalink":"http://example.com/2022/09/27/%E8%80%83%E7%A0%94/%E9%AB%98%E6%95%B0/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"(æ¯æ—¥LeetCode)é¢è¯•é¢˜ 01.02. åˆ¤å®šæ˜¯å¦äº’ä¸ºå­—ç¬¦é‡æ’","slug":"æ¯æ—¥LeetCode/2022-9/é¢è¯•é¢˜ 01.02 åˆ¤å®šæ˜¯å¦äº’ä¸ºå­—ç¬¦é‡æ’","date":"2022-09-27T04:43:00.000Z","updated":"2022-09-27T04:43:35.593Z","comments":true,"path":"2022/09/27/æ¯æ—¥LeetCode/2022-9/é¢è¯•é¢˜ 01.02 åˆ¤å®šæ˜¯å¦äº’ä¸ºå­—ç¬¦é‡æ’/","link":"","permalink":"http://example.com/2022/09/27/%E6%AF%8F%E6%97%A5LeetCode/2022-9/%E9%9D%A2%E8%AF%95%E9%A2%98%2001.02%20%E5%88%A4%E5%AE%9A%E6%98%AF%E5%90%A6%E4%BA%92%E4%B8%BA%E5%AD%97%E7%AC%A6%E9%87%8D%E6%8E%92/","excerpt":"","text":"é¢˜ç›®ï¼š ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² s1 å’Œ s2ï¼Œè¯·ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œç¡®å®šå…¶ä¸­ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­—ç¬¦é‡æ–°æ’åˆ—åï¼Œèƒ½å¦å˜æˆå¦ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: s1 &#x3D; â€œabcâ€, s2 &#x3D; â€œbcaâ€è¾“å‡º: true ä»£ç (cpp)ï¼š æ–¹å¼ä¸€ï¼šæ’åº 12345678910111213141516171819class Solution &#123;public: bool CheckPermutation1(string s1, string s2) &#123; if(s1.size() != s2.size())&#123; return false; &#125; sort(s1.begin(), s1.end()); sort(s2.begin(), s2.end()); for(int i = 0; i &lt; s1.size(); i++)&#123; if(s1[i] != s2[i])&#123; return false; &#125; &#125; return true; &#125;&#125;; æ–¹å¼äºŒï¼šå“ˆå¸Œ 12345678910111213141516171819202122class Solution &#123;public: bool CheckPermutation(string s1, string s2)&#123; if(s1.size() != s2.size())&#123; return false; &#125; vector&lt;int&gt; map(26, 0); for(auto&amp; s : s1)&#123; map[s - &#x27;a&#x27;]++; &#125; for(auto&amp; s : s2)&#123; if(map[s - &#x27;a&#x27;] != 0)&#123; map[s - &#x27;a&#x27;]--; &#125; else return false; &#125; return true; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)é¢è¯•é¢˜ 17.19. æ¶ˆå¤±çš„ä¸¤ä¸ªæ•°å­—","slug":"æ¯æ—¥LeetCode/2022-9/é¢è¯•é¢˜ 17.19 æ¶ˆå¤±çš„ä¸¤ä¸ªæ•°å­—","date":"2022-09-26T14:25:00.000Z","updated":"2022-09-27T04:42:48.846Z","comments":true,"path":"2022/09/26/æ¯æ—¥LeetCode/2022-9/é¢è¯•é¢˜ 17.19 æ¶ˆå¤±çš„ä¸¤ä¸ªæ•°å­—/","link":"","permalink":"http://example.com/2022/09/26/%E6%AF%8F%E6%97%A5LeetCode/2022-9/%E9%9D%A2%E8%AF%95%E9%A2%98%2017.19%20%E6%B6%88%E5%A4%B1%E7%9A%84%E4%B8%A4%E4%B8%AA%E6%95%B0%E5%AD%97/","excerpt":"","text":"é¢˜ç›®ï¼š ç»™å®šä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä» 1 åˆ° N æ‰€æœ‰çš„æ•´æ•°ï¼Œä½†å…¶ä¸­ç¼ºäº†ä¸¤ä¸ªæ•°å­—ã€‚ä½ èƒ½åœ¨ O(N) æ—¶é—´å†…åªç”¨ O(1) çš„ç©ºé—´æ‰¾åˆ°å®ƒä»¬å—ï¼Ÿ ä»¥ä»»æ„é¡ºåºè¿”å›è¿™ä¸¤ä¸ªæ•°å­—å‡å¯ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: [2,3]è¾“å‡º: [1,4] ä»£ç (cpp)ï¼š 1234567891011121314151617181920212223242526class Solution &#123;public: vector&lt;int&gt; missingTwo(vector&lt;int&gt;&amp; nums) &#123; //æ€»é•¿åº¦ int all = nums.size() + 2; //è·å–æ€»é•¿åº¦çš„å…ƒç´ æ€»å’Œ int all_sum = all*(1 + all) / 2; //è®¡ç®—å‰©ä½™çš„æ€»å’Œ int remain_sum = all_sum; for(auto&amp; num : nums)&#123; remain_sum -= num; &#125; //è·å–ç»“æœä¸­é—´çš„å…ƒç´ ï¼Œè¯´æ˜æœ‰ä¸€ä¸ªç­”æ¡ˆå¿…å®šæœ‰ä¸€ä¸ªå°äºmidçš„ int mid = remain_sum / 2; //è®¡ç®—å‡ºæ€»å’Œ int mid_sum = mid*(1 + mid) / 2; //è·å–é‚£ä¸ªå°äºmidçš„ç­”æ¡ˆ for(auto&amp; num : nums)&#123; if(num &lt;= mid)&#123; mid_sum -= num; &#125; &#125; //ç”¨å‰©ä½™çš„å‡å»mid_sumjiu&#x27;de return &#123;mid_sum, remain_sum - mid_sum&#125;; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1652. æ‹†ç‚¸å¼¹","slug":"æ¯æ—¥LeetCode/2022-9/1652 æ‹†ç‚¸å¼¹","date":"2022-09-24T01:25:00.000Z","updated":"2022-09-24T01:25:16.126Z","comments":true,"path":"2022/09/24/æ¯æ—¥LeetCode/2022-9/1652 æ‹†ç‚¸å¼¹/","link":"","permalink":"http://example.com/2022/09/24/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1652%20%E6%8B%86%E7%82%B8%E5%BC%B9/","excerpt":"","text":"é¢˜ç›®ï¼šä½ æœ‰ä¸€ä¸ªç‚¸å¼¹éœ€è¦æ‹†é™¤ï¼Œæ—¶é—´ç´§è¿«ï¼ä½ çš„æƒ…æŠ¥å‘˜ä¼šç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„ å¾ªç¯ æ•°ç»„ code ä»¥åŠä¸€ä¸ªå¯†é’¥ k ã€‚ ä¸ºäº†è·å¾—æ­£ç¡®çš„å¯†ç ï¼Œä½ éœ€è¦æ›¿æ¢æ‰æ¯ä¸€ä¸ªæ•°å­—ã€‚æ‰€æœ‰æ•°å­—ä¼š åŒæ—¶ è¢«æ›¿æ¢ã€‚ å¦‚æœ k &gt; 0 ï¼Œå°†ç¬¬ i ä¸ªæ•°å­—ç”¨ æ¥ä¸‹æ¥ k ä¸ªæ•°å­—ä¹‹å’Œæ›¿æ¢ã€‚ å¦‚æœ k &lt; 0 ï¼Œå°†ç¬¬ i ä¸ªæ•°å­—ç”¨ ä¹‹å‰ k ä¸ªæ•°å­—ä¹‹å’Œæ›¿æ¢ã€‚ å¦‚æœ k &#x3D;&#x3D; 0 ï¼Œå°†ç¬¬ i ä¸ªæ•°å­—ç”¨ 0 æ›¿æ¢ã€‚ ç”±äº code æ˜¯å¾ªç¯çš„ï¼Œ code[n-1] ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯ code[0] ï¼Œä¸” code[0] å‰ä¸€ä¸ªå…ƒç´ æ˜¯ code[n-1] ã€‚ ç»™ä½  å¾ªç¯ æ•°ç»„ code å’Œæ•´æ•°å¯†é’¥ k ï¼Œè¯·ä½ è¿”å›è§£å¯†åçš„ç»“æœæ¥æ‹†é™¤ç‚¸å¼¹ï¼ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šcode &#x3D; [5,7,1,4], k &#x3D; 3è¾“å‡ºï¼š[12,10,16,13]è§£é‡Šï¼šæ¯ä¸ªæ•°å­—éƒ½è¢«æ¥ä¸‹æ¥ 3 ä¸ªæ•°å­—ä¹‹å’Œæ›¿æ¢ã€‚è§£å¯†åçš„å¯†ç ä¸º [7+1+4, 1+4+5, 4+5+7, 5+7+1]ã€‚æ³¨æ„åˆ°æ•°ç»„æ˜¯å¾ªç¯è¿æ¥çš„ã€‚ è¾“å…¥ï¼šcode &#x3D; [2,4,9,3], k &#x3D; -2è¾“å‡ºï¼š[12,5,6,13]è§£é‡Šï¼šè§£å¯†åçš„å¯†ç ä¸º [3+9, 2+3, 4+2, 9+4] ã€‚æ³¨æ„åˆ°æ•°ç»„æ˜¯å¾ªç¯è¿æ¥çš„ã€‚å¦‚æœ k æ˜¯è´Ÿæ•°ï¼Œé‚£ä¹ˆå’Œä¸º ä¹‹å‰ çš„æ•°å­—ã€‚ æ€è·¯ï¼šåˆ†ä¸º3ä¸­æƒ…å†µï¼Œæ¨¡æ‹Ÿå‡º3ç§æƒ…å†µå³å¯ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930class Solution &#123;public: vector&lt;int&gt; decrypt(vector&lt;int&gt;&amp; code, int k) &#123; vector&lt;int&gt; ans; int n = code.size(); if(k == 0)&#123; return vector&lt;int&gt;(n); &#125; else if (k &gt; 0)&#123; for(int i = 0; i &lt; code.size(); i++)&#123; int sum = 0; for(int j = 0; j &lt; k; j++)&#123; sum += code[(i + j + 1) % n]; &#125; ans.emplace_back(sum); &#125; &#125; else &#123; for(int i = 0; i &lt; code.size(); i++)&#123; int sum = 0; for(int j = 0; j &lt; abs(k); j++)&#123; sum += code[(i - j - 1 + n) % n]; &#125; ans.emplace_back(sum); &#125; &#125; return ans; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)707. è®¾è®¡é“¾è¡¨","slug":"æ¯æ—¥LeetCode/2022-9/707 è®¾è®¡é“¾è¡¨","date":"2022-09-23T01:23:00.000Z","updated":"2022-09-23T01:24:10.730Z","comments":true,"path":"2022/09/23/æ¯æ—¥LeetCode/2022-9/707 è®¾è®¡é“¾è¡¨/","link":"","permalink":"http://example.com/2022/09/23/%E6%AF%8F%E6%97%A5LeetCode/2022-9/707%20%E8%AE%BE%E8%AE%A1%E9%93%BE%E8%A1%A8/","excerpt":"","text":"é¢˜ç›®ï¼šè®¾è®¡é“¾è¡¨çš„å®ç°ã€‚æ‚¨å¯ä»¥é€‰æ‹©ä½¿ç”¨å•é“¾è¡¨æˆ–åŒé“¾è¡¨ã€‚å•é“¾è¡¨ä¸­çš„èŠ‚ç‚¹åº”è¯¥å…·æœ‰ä¸¤ä¸ªå±æ€§ï¼šval å’Œ nextã€‚val æ˜¯å½“å‰èŠ‚ç‚¹çš„å€¼ï¼Œnext æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ&#x2F;å¼•ç”¨ã€‚å¦‚æœè¦ä½¿ç”¨åŒå‘é“¾è¡¨ï¼Œåˆ™è¿˜éœ€è¦ä¸€ä¸ªå±æ€§ prev ä»¥æŒ‡ç¤ºé“¾è¡¨ä¸­çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚å‡è®¾é“¾è¡¨ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯ 0-index çš„ã€‚ åœ¨é“¾è¡¨ç±»ä¸­å®ç°è¿™äº›åŠŸèƒ½ï¼š get(index)ï¼šè·å–é“¾è¡¨ä¸­ç¬¬ index ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚å¦‚æœç´¢å¼•æ— æ•ˆï¼Œåˆ™è¿”å›-1ã€‚ addAtHead(val)ï¼šåœ¨é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹å‰æ·»åŠ ä¸€ä¸ªå€¼ä¸º val çš„èŠ‚ç‚¹ã€‚æ’å…¥åï¼Œæ–°èŠ‚ç‚¹å°†æˆä¸ºé“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ addAtTail(val)ï¼šå°†å€¼ä¸º val çš„èŠ‚ç‚¹è¿½åŠ åˆ°é“¾è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚ addAtIndex(index,val)ï¼šåœ¨é“¾è¡¨ä¸­çš„ç¬¬ index ä¸ªèŠ‚ç‚¹ä¹‹å‰æ·»åŠ å€¼ä¸º val çš„èŠ‚ç‚¹ã€‚å¦‚æœ index ç­‰äºé“¾è¡¨çš„é•¿åº¦ï¼Œåˆ™è¯¥èŠ‚ç‚¹å°†é™„åŠ åˆ°é“¾è¡¨çš„æœ«å°¾ã€‚å¦‚æœ index å¤§äºé“¾è¡¨é•¿åº¦ï¼Œåˆ™ä¸ä¼šæ’å…¥èŠ‚ç‚¹ã€‚å¦‚æœindexå°äº0ï¼Œåˆ™åœ¨å¤´éƒ¨æ’å…¥èŠ‚ç‚¹ã€‚ deleteAtIndex(index)ï¼šå¦‚æœç´¢å¼• index æœ‰æ•ˆï¼Œåˆ™åˆ é™¤é“¾è¡¨ä¸­çš„ç¬¬ index ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹ï¼š MyLinkedList linkedList &#x3D; new MyLinkedList();linkedList.addAtHead(1);linkedList.addAtTail(3);linkedList.addAtIndex(1,2); &#x2F;&#x2F;é“¾è¡¨å˜ä¸º1-&gt; 2-&gt; 3linkedList.get(1); &#x2F;&#x2F;è¿”å›2linkedList.deleteAtIndex(1); &#x2F;&#x2F;ç°åœ¨é“¾è¡¨æ˜¯1-&gt; 3linkedList.get(1); &#x2F;&#x2F;è¿”å›3 ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566class MyLinkedList &#123;public: MyLinkedList() &#123; this-&gt;head = new ListNode(-1, nullptr); this-&gt;size = 0; &#125; int get(int index) &#123; if(index &lt; 0 || this-&gt;size &lt;= index) return -1; auto temp = this-&gt;head; while(index &gt;=0) &#123; temp = temp-&gt;next; index--; &#125; return temp-&gt;val; &#125; void addAtHead(int val) &#123; addAtIndex(0, val); &#125; void addAtTail(int val) &#123; this-&gt;addAtIndex(this-&gt;size, val); &#125; void addAtIndex(int index, int val) &#123; if(index &lt; 0 || this-&gt;size &lt; index) return; auto temp = this-&gt;head; while(index &gt; 0) &#123; temp = temp-&gt;next; index--; &#125; ListNode* newNode = new ListNode(val, temp-&gt;next); temp-&gt;next = newNode; this-&gt;size++; &#125; void deleteAtIndex(int index) &#123; if(index &lt; 0 || this-&gt;size &lt;= index) return; auto temp = this-&gt;head; while(index &gt; 0) &#123; temp = temp-&gt;next; index--; &#125; auto e = temp-&gt;next; temp-&gt;next = e-&gt;next; delete e; this-&gt;size--; &#125;private: class ListNode &#123; public: int val; ListNode* next; ListNode(int val, ListNode* next) &#123; this-&gt;val = val; this-&gt;next = next; &#125; &#125;; int size; ListNode* head;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šåˆå§‹åŒ–æ¶ˆè€— O(1)ï¼Œget æ¶ˆè€— O(index)ï¼ŒaddAtHead æ¶ˆè€— O(1)ï¼ŒaddAtTail æ¶ˆè€— O(n)ï¼Œå…¶ä¸­ n ä¸ºé“¾è¡¨å½“å‰é•¿åº¦ï¼Œå³ addAtHeadï¼ŒaddAtTail å’Œ addAtIndex å·²è°ƒç”¨æ¬¡æ•°ä¹‹å’Œï¼ŒaddAtIndex æ¶ˆè€— O(index)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šæ‰€æœ‰å‡½æ•°çš„å•æ¬¡è°ƒç”¨ç©ºé—´å¤æ‚åº¦å‡ä¸º O(1)ï¼Œæ€»ä½“ç©ºé—´å¤æ‚åº¦ä¸º O(n)ï¼Œå…¶ä¸­ n ä¸º addAtHeadï¼ŒaddAtTail å’Œ addAtIndex è°ƒç”¨æ¬¡æ•°ä¹‹å’Œã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"Gitçš„å­¦ä¹ ç¬”è®°","slug":"Java/Git","date":"2022-09-21T14:17:30.898Z","updated":"2022-09-27T14:10:34.902Z","comments":true,"path":"2022/09/21/Java/Git/","link":"","permalink":"http://example.com/2022/09/21/Java/Git/","excerpt":"","text":"1.æ¦‚è¿°1.1 å¼€å‘å¸¸ç”¨åœºæ™¯ å¤‡ä»½ ä»£ç è¿˜åŸ ååŒå¼€å‘ è¿½æº¯é—®é¢˜ä»£ç çš„ç¼–å†™äººå‘˜å’Œç¼–å†™æ—¶é—´ 1.2 SVNSVN(subversion)ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œé€šè¿‡é‡‡ç”¨åˆ†æ”¯ç®¡ç†ç³»ç»Ÿçš„é«˜æ•ˆç®¡ç†ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯ç”¨äºå¤šä¸ªäººå…±åŒå¼€å‘åŒä¸€ä¸ªé¡¹ç›®ï¼Œå®ç°å…±äº«èµ„æºï¼Œå®ç°æœ€ç»ˆé›†ä¸­å¼çš„ç®¡ç†ã€‚ å·¥ä½œæµç¨‹ï¼š SVNæ˜¯é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç‰ˆæœ¬åº“æ˜¯é›†ä¸­æ”¾åœ¨ä¸­å¤®æœåŠ¡å™¨çš„å·¥ä½œæµç¨‹å¦‚ä¸‹: ä»ä¸­å¤®æœåŠ¡å™¨è¿œç¨‹ä»“åº“ä¸‹è½½ä»£ç  ä¿®æ”¹åå°†ä»£ç æäº¤åˆ°ä¸­å¤®æœåŠ¡å™¨è¿œç¨‹ä»“åº“ ä¼˜ç¼ºç‚¹: ä¼˜ç‚¹ï¼šç®€å•,æ˜“æ“ä½œ ç¼ºç‚¹ï¼šæ‰€æœ‰ä»£ç å¿…é¡»æ”¾åœ¨ä¸­å¤®æœåŠ¡å™¨ æœåŠ¡å™¨ä¸€æ—¦å®•æœºæ— æ³•æäº¤ä»£ç ,å³å®¹é”™æ€§è¾ƒå·® ç¦»çº¿æ— æ³•æäº¤ä»£ç ,æ— æ³•åŠæ—¶è®°å½•æˆ‘ä»¬çš„æäº¤è¡Œä¸º 1.3 Gitå·¥ä½œæµç¨‹ï¼š Gitæ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ(Distributed Version Control Systemï¼Œç®€ç§° DVCS)ï¼Œåˆ†ä¸ºä¸¤ç§ç±»å‹çš„ä»“åº“ï¼š æœ¬åœ°ä»“åº“ è¿œç¨‹ä»“åº“ å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š ä»è¿œç¨‹ä»“åº“ä¸­å…‹éš†æˆ–æ‹‰å–ä»£ç åˆ°æœ¬åœ°ä»“åº“(clone&#x2F;pull) ä»æœ¬åœ°è¿›è¡Œä»£ç ä¿®æ”¹ åœ¨æäº¤å‰å…ˆå°†ä»£ç æäº¤åˆ°æš‚å­˜åŒº æäº¤åˆ°æœ¬åœ°ä»“åº“ã€‚æœ¬åœ°ä»“åº“ä¸­ä¿å­˜ä¿®æ”¹çš„å„ä¸ªå†å²ç‰ˆæœ¬ ä¿®æ”¹å®Œæˆåï¼Œéœ€è¦å’Œå›¢é˜Ÿæˆå‘˜å…±äº«ä»£ç æ—¶ï¼Œå°†ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ Gitå’ŒSVNçš„åŒºåˆ«ï¼š SVN æ˜¯é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼ŒGitæ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶å·¥å…· SVNä¸æ”¯æŒç¦»çº¿æäº¤ï¼ŒGitæ”¯æŒç¦»çº¿æäº¤ä»£ç  1.4 Git å·¥ä½œæµç¨‹flowchart LR A[(Remoteè¿œç¨‹ä»“åº“)] B[(Repositoryæœ¬åœ°ä»“åº“)] C[(indexæš‚å­˜åŒº)] D[workspaceå·¥ä½œåŒº] A--1.æŠ“å–/å…‹éš†fetch/clone-->B A--5.æ‹‰å–pullfetch+merge-->D B--2.æ£€å‡ºchecked-->D B--6.æ¨é€push-->A C--4.æäº¤commit-->B D--3.æ·»åŠ add-->C å‘½ä»¤å¦‚ä¸‹ï¼š clone(å…‹éš†)ï¼šä»ç©ç¨‹ä»“åº„ä¸­å…‹éš†ä»£ç åˆ°æœ¬åœ°ä»“åº“ checkout(æ£€å‡º)ï¼šä»æœ¬åœ°ä»“åº“ä¸­æ£€å‡ºä¸€ä¸ªä»“åº“åˆ†æ”¯ç„¶åè¿›è¡Œä¿®è®¢ add(æ·»åŠ )ï¼šåœ¨æäº¤çš„å…ˆæ ¼ä»£ç å ¤äº¤åˆ°æ™ºå­˜åŒº commit(æäº¤)ï¼šæäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œæœ¬åœ°ä»“å—ä¸­ä¿å­˜ä¿®æ”¾çš„å„ä¸ªå†å²ç‰ˆæœ¬ fetch(æŠ“å–)ï¼šä»æ±¡ç¨‹è½¦ï¼ŒæŠ“å–åˆ°æœ¬åœ°ä»“åº“ï¼Œä¸è¿›è¡Œä»»ä½•çš„åˆäº•åŠ¨ä½œï¼Œä¸€èˆ¬æ“ä½œæ¯”è¾ƒå°‘ã€‚ pull(æ‹‰å–)ï¼šä»è¿ç¨‹åº“æ‹‰åˆ°æœ¬åœ°åº“ï¼Œç™½åŠ¨è¿›è¡Œåˆäº•(merge)ï¼Œç„¶åæ”¾åˆ°åˆ°å·¥ä½œåŒºï¼Œç›¸å½“äºfetch+merge push(æ¨é€)ï¼šä¿®æ”¹å®Œæˆåï¼Œéœ€è¦å’Œå›¢é˜Ÿæˆå‘˜å…±äº«ä»£ç ï¼Œå°†ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“ 2.Gitçš„ä½¿ç”¨åŠå¸¸ç”¨å‘½ä»¤å†windowsæ¡Œé¢æˆ–è€…æ–‡ä»¶å¤¹ä¸­å³é”®ï¼Œä¼šå‡ºç°ï¼š Git GUIï¼šGitæä¾›çš„å›¾åƒåŒ–ç•Œé¢å·¥å…· Git Bashï¼šGitæä¾›çš„å‘½ä»¤è¡Œå·¥å…· 2.1 åŸºæœ¬é…ç½®é…ç½®ç”¨æˆ·ä¿¡æ¯ æ‰“å¼€Git Bash è®¾ç½®ç”¨æˆ·ä¿¡æ¯ git config --global user.name&quot;XXX&quot; git config --global user.email&quot;666@qq.com&quot; æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ git config --global user.name git config --global user.email ä¸ºå¸¸ç”¨æŒ‡ä»¤é…ç½®åˆ«åæœ‰äº›å¸¸ç”¨çš„æŒ‡ä»¤å‚æ•°éå¸¸å¤šï¼Œæ¯æ¬¡éƒ½è¦å‡ºå…¥å¥½å¤šå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥èµ·åˆ«åï¼š æ‰“å¼€Usersç›®å½•ï¼Œåˆ›å»º.bashrcæ–‡ä»¶ å†Usersç›®å½•ä¸­å³é”®ï¼Œæ‰“å¼€Git Bashï¼Œè¾“å…¥ä¸‹é¢æ¥åˆ›å»º.bashrcæ–‡ä»¶ 1touch ~/.bashrc å†.bashrcæ–‡ä»¶è¾“å…¥ä»¥ä¸‹å†…å®¹ 1234#ç”¨äºè¾“å‡ºgitæäº¤æ—¥å¿—alias git-log=&#x27;git log --pretty=oneline --all --graph --abbrev-commit&#x27;#ç”¨äºè¾“å‡ºå½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶åŠå…¶æ–‡ä»¶ä¿¡æ¯alias ll=&#x27;ls -al&#x27; æ¥ç€æ‰§è¡Œï¼š 1source ~/.bash è§£å†³Git Bashä¹±ç é—®é¢˜ æ‰“å¼€Git Bashæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š 1git config --global core.quotepath false $&#123;git_home&#125;/etc/bash.bashrcæ–‡ä»¶æœ€ååŠ å…¥ä¸‹é¢å†…å®¹ï¼š 12export LANG=&quot;zh_CN.UTF-8&quot;export LC_ALL=&quot;zh_CN.UTF-8&quot; 2.2 è·å–æœ¬åœ°ä»“åº“è¦ä½¿ç”¨Gitå¯¹ä»£ç è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œé¦–å…ˆéœ€è¦è·å¾—æœ¬åœ°ä»“åº“ åœ¨ç”µè„‘çš„ä»»æ„ä½ç½®åˆ›å»ºä¸€ä¸ªç©ºç›®å½•(ä¾‹å¦‚test)ä½œä¸ºæˆ‘ä»¬çš„æœ¬åœ°Gitä»“åº“ è¿›å…¥è¿™ä¸ªç›®å½•ä¸­ï¼Œç‚¹å‡»å³é”®æ‰“å¼€Git bashçª—å£ æ‰§è¡Œå‘½ä»¤ï¼š 1git init å¦‚æœåˆ›å»ºæˆåŠŸåå¯åœ¨æ–‡ä»¶å¤¹ä¸‹çœ‹åˆ°éšè—çš„.gitç›®å½•ã€‚ 2.3 åŸºç¡€æ“ä½œå‘½ä»¤Gitå·¥ä½œç›®å½•å¯¹äºæ–‡ä»¶çš„ä¿®æ”¹(å¢åŠ ã€åˆ é™¤ã€æ›´æ–°)ä¼šå­˜åœ¨å‡ ä¸ªçŠ¶æ€ï¼Œè¿™äº›ä¿®æ”¹çŠ¶æ€ä¼šéšç€æ‰§è¡ŒGitå‘½ä»¤è€Œå‘ç”Ÿå˜åŒ– ä½¿ç”¨å‘½ä»¤æ¥æ§åˆ¶è¿™äº›çŠ¶æ€ä¹‹é—´çš„è½¬æ¢ï¼š git addï¼šå·¥ä½œåŒºâ€“&gt;æš‚å­˜åŒº git commitï¼šæš‚å­˜åŒºâ€“&gt;æœ¬åœ°ä»“åº“ æŸ¥çœ‹ä¿®æ”¹çš„çŠ¶æ€æŸ¥çœ‹ä¿®æ”¹çš„çŠ¶æ€(æš‚å­˜åŒºã€å·¥ä½œåŒº)ï¼š 1git status æ·»åŠ å·¥ä½œåŒºåˆ°æš‚å­˜åŒº1git add æ–‡ä»¶å æˆ–è€…ä½¿ç”¨é€šé…ç¬¦ï¼Œå¦‚ï¼šå°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº 1git add . æäº¤æš‚å­˜åŒºåˆ°æœ¬åœ°ä»“åº“1git commit -m &#x27;æ³¨é‡Šå†…å®¹&#x27; æŸ¥çœ‹æ—¥å¿—1git log [option] optionå¤šä¸ªå‚æ•°ï¼š --allï¼šæ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯ --pretty=onelineï¼šå°†æäº¤çš„ä¿¡æ¯æ˜¾ç¤ºä¸ºä¸€è¡Œ --abbrev-commitï¼šä½¿å¾—è¾“å‡ºçš„commitIdæ›´ç®€çŸ­ --graphï¼šä»¥å›¾çš„å½¢å¼æ˜¾ç¤º 1git log --pretty=oneline --all --graph --abbrev-commit æˆ–è€…åœ¨ä¹‹å‰çš„å¸¸ç”¨æŒ‡ä»¤è®¾ç½®çš„åˆ«åï¼š 1git-log ç‰ˆæœ¬å›é€€1git reset --hard commitID commitIDå¯ä»¥ä½¿ç”¨git-logæˆ–git logæŸ¥çœ‹ æŸ¥çœ‹å·²ç»åˆ é™¤çš„è®°å½•ï¼š 1git reflog æ·»åŠ æ–‡ä»¶è‡³å¿½ç•¥åˆ—è¡¨åœ¨å·¥ä½œç›®å½•åˆ›å»ºä¸€ä¸ªåä¸º.gitignoreçš„æ–‡ä»¶(æ–‡ä»¶åå›ºå®š) å¯ä»¥åˆ—å‡ºè¦å¿½ç•¥çš„æ–‡ä»¶åï¼Œå¦‚ï¼š å¿½ç•¥åç¼€ä¸ºaçš„æ–‡ä»¶ï¼š 1*.a 2.4 åˆ†æ”¯å‡ ä¹æ‰€æœ‰çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿéƒ½ä»¥æŸç§å½¢å¼æ”¯æŒåˆ†æ”¯ã€‚ä½¿ç”¨åˆ†æ”¯æ„å‘³ç€ä½ å¯ä»¥æŠŠä½ çš„å·¥ä½œä»å¼€å‘ä¸»çº¿ä¸Šåˆ†ç¦»æ¥è¿›è¡Œé‡å¤§çš„BUGä¿®æ”¹ï¼Œå¼€å‘æ–°åŠŸèƒ½ï¼Œä»¥å…å½±å“å¼€å‘ä¸»çº¿ æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯1git branch åˆ›å»ºæœ¬åœ°åˆ†æ”¯1git branch åˆ†æ”¯å åˆ‡æ¢åˆ†æ”¯1git checkout åˆ†æ”¯å è¿˜å¯ä»¥åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä¸å­˜åœ¨çš„åˆ†æ”¯(åˆ›å»ºå¹¶åˆ‡æ¢) 1git checkout -b åˆ†æ”¯å åˆå¹¶åˆ†æ”¯ä¸€ä¸ªåˆ†æ”¯ä¸Šçš„æäº¤å¯ä»¥åˆå¹¶åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ 1git merge åˆ†æ”¯åç§° åˆ é™¤åˆ†æ”¯ä¸èƒ½åˆ é™¤å½“å‰åˆ†æ”¯ï¼Œåªèƒ½åˆ é™¤å…¶ä»–åˆ†æ”¯ åˆ é™¤åˆ†æ”¯æ—¶ï¼Œéœ€è¦åˆ é™¤å…¶ä»–åˆ†æ”¯ï¼š 1git branch -d b1 ä¸åšä»»ä½•æ£€æŸ¥ï¼Œå¼ºåˆ¶åˆ é™¤ï¼š 1git branch -D b1 è§£å†³å†²çªå½“ä¸¤ä¸ªåˆ†æ”¯ä¸Šå¯¹æ–‡ä»¶çš„ä¿®æ”¹å¯èƒ½ä¼šå­˜åœ¨å†²çªï¼Œå¦‚åŒæ—¶ä¿®æ”¹åŒä¸€ä¸ªæ–‡ä»¶çš„åŒä¸€è¡Œï¼Œè¿™æ—¶éœ€è¦æ‰‹åŠ¨è§£å†³å†²çªï¼Œè§£å†³æ­¥éª¤å¦‚ä¸‹ï¼š å¤„ç†æ–‡ä»¶ä¸­å†²çªçš„åœ°æ–¹ å°†è§£å†³å®Œçš„å†²çªçš„æ–‡ä»¶åŠ å…¥æš‚å­˜åŒº(add) æäº¤åˆ°ä»“åº“(commit) å¼€å‘ä¸­åˆ†æ”¯ä½¿ç”¨åŸåˆ™åœ¨å¼€å‘ä¸­ï¼Œä¸€èˆ¬æœ‰å¦‚ä¸‹åˆ†æ”¯ä½¿ç”¨åŸåˆ™ä¸æµç¨‹ï¼š master(ç”Ÿäº§åˆ†æ”¯) çº¿ä¸Šåˆ†æ”¯ã€ä¸»åˆ†æ”¯ã€ä¸­å°è§„æ¨¡é¡¹ç›®ä½œä¸ºçº¿ä¸Šè¿è¡Œçš„åº”ç”¨å¯¹åº”çš„åˆ†æ”¯ develop(å¼€å‘åˆ†æ”¯) æ˜¯ä»masteråˆ›å»ºçš„åˆ†æ”¯ï¼Œä¸€èˆ¬ä½œä¸ºå¼€å‘éƒ¨é—¨çš„ä¸»è¦å¼€å‘åˆ†æ”¯ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å¹¶è¡Œå¼€å‘ä¸åŒæœŸä¸Šçº¿è¦æ±‚ï¼Œéƒ½å¯ä»¥åœ¨æ­¤ç‰ˆæœ¬è¿›è¡Œå¼€å‘ï¼Œé˜¶æ®µå¼€å‘å®Œæˆåï¼Œéœ€è¦åˆå¹¶åˆ°masteråˆ†æ”¯ï¼Œå‡†å¤‡ä¸Šçº¿ feature&#x2F;XXXåˆ†æ”¯ ä»developåˆ›å»ºçš„åˆ†æ”¯ï¼Œä¸€èˆ¬æ˜¯åŒæœŸå¹¶è¡Œå¼€å‘ï¼Œä½†ä¸åŒæœŸä¸Šçº¿æ—¶åˆ›å»ºçš„åˆ†æ”¯ï¼Œåˆ†æ”¯ä¸Šçš„ç ”å‘ä»»åŠ¡å®Œæˆååˆå¹¶åˆ°developåˆ†æ”¯ã€‚ hotfix&#x2F;XXXåˆ†æ”¯ ä»masteræ´¾ç”Ÿçš„åˆ†æ”¯ï¼Œä¸€èˆ¬ä½œä¸ºçº¿ä¸Šbugä¿®å¤ä½¿ç”¨ï¼Œä¿®å¤å®Œæˆåéœ€è¦åˆå¹¶åˆ°masterã€testã€ developåˆ†æ”¯ã€‚ è¿˜æœ‰å…¶ä»–ä¸€äº›åˆ†æ”¯å¦‚ï¼Œteståˆ†æ”¯(ç”¨äºä»£ç æµ‹è¯•)ã€preåˆ†æ”¯(é¢„ä¸Šçº¿åˆ†æ”¯)ç­‰ 3.Gitè¿œç¨‹ä»“åº“3.1 å¸¸ç”¨çš„æ‰˜ç®¡ä»“åº“é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ­å»ºGitè¿œç¨‹ä»“åº“å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥å€ŸåŠ©äº’è”ç½‘ä¸Šæä¾›çš„ä¸€äº›ä»£ç æ‰˜ç®¡æœåŠ¡æ°´å®ç°ï¼Œå…¶ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æœ‰GitHubã€ç äº‘ç­‰ã€‚ gitHubæ˜¯ä¸€ä¸ªé¢å‘å¼€æºåŠç§æœ‰è½¯ä»¶é¡¹ç›®çš„æ‰˜ç®¡å¹³å°ï¼Œå› ä¸ºåªæ”¯æŒGitä½œä¸ºå”¯ä¸€çš„ç‰ˆæœ¬åº“æ ¼å¼è¿›è¡Œæ‰˜ç®¡ï¼Œæ•…ågitHub ç äº‘(gitee)æ˜¯å›½å†…çš„ä¸€ä¸ªä»£ç æ‰˜ç®¡å¹³å°ï¼Œç”±æ‰‹æœåŠ¡å™¨åœ¨å›½å†…ï¼Œæ‰€ä»¥ç›¸æ¯”äºGitHubï¼Œç äº‘é€Ÿåº¦ä¼šæ›´å¿« 3.2 æ“ä½œè¿œç¨‹ä»“åº“è¿œç¨‹ä»“åº“çš„æ·»åŠ å‘½ä»¤ï¼šgit remote add &lt;è¿œç«¯åç§°&gt; &lt;ä»“åº“è·¯å¾„&gt; è¿œç«¯åç§°ï¼šé»˜è®¤ä¸ºorigin(å¯ä»¥è‡ªå·±å–)ï¼Œå–å†³äºè¿œç«¯æœåŠ¡å™¨è®¾ç½® ä»“åº“åç§°ï¼šä»è¿œç¨‹ä»“åº“æœåŠ¡å™¨è·å–çš„URL 1git remote add origin ä»“åº“åœ°å€ æŸ¥çœ‹è¿œç¨‹ä»“åº“1git remote æ¨é€åˆ°è¿œç¨‹ä»“åº“å‘½ä»¤ï¼šgit push [-f] [--set-upstream] [è¿œç«¯åç§°] [æœ¬åœ°åˆ†æ”¯å]:[è¿œç«¯åˆ†æ”¯å] -fï¼šå¼ºåˆ¶è¦†ç›– æ³¨æ„ï¼šå¦‚æœæœ¬åœ°åˆ†æ”¯åå’Œè¿œç«¯åˆ†æ”¯åç›¸åŒï¼Œåˆ™åªéœ€å†™æœ¬åœ°åˆ†æ”¯åå³å¯ 1git push origin master --set-upstreamï¼šæ¨é€åˆ°è¿œç«¯çš„åŒæ—¶å¹¶å»ºç«‹èµ·ä¸è¿œç«¯åˆ†æ”¯çš„å…³è” 1git push --set-upstream origin master å¦‚æœå½“å‰åˆ†æ”¯å·²ç»å’Œè¿œç«¯åˆ†æ”¯å…³è”ï¼Œåˆ™å¯ä»¥çœç•¥åˆ†æ”¯åå’Œè¿œç«¯å 1git push æœ¬åœ°åˆ†æ”¯ä¸è¿œç«¯åˆ†æ”¯æŸ¥çœ‹å…³è”å…³ç³»ï¼š 1git branch -vv ä»è¿œç¨‹ä»“åº“å…‹éš†å°†è¿œç¨‹ä»“åº“å…‹éš†åˆ°æœ¬åœ°ï¼š å‘½ä»¤ï¼šgit clone &lt;ä»“åº“è·¯å¾„&gt; &lt;æœ¬åœ°ç›®å½•&gt; æ³¨æ„ï¼šæœ¬åœ°ç›®å½•å¯ä»¥çœç•¥ï¼Œä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç›®å½• 1git clone ä»“åº“è·¯å¾„ ä»è¿œç¨‹ä»“åº“æŠ“å–å’Œæ‹‰å–æŠ“å–ï¼šå°†ä»“åº“é‡Œçš„æ›´æ–°éƒ½æŠ“å–åˆ°æœ¬åœ°ï¼Œä¸ä¼šè¿›è¡Œåˆå¹¶ æŠ“å–å‘½ä»¤ï¼šgit fetch [remote name] [branch name] å¦‚æœä¸æŒ‡å®šè¿œç«¯åç§°å’Œåˆ†æ”¯åï¼Œåˆ™ä¼šæŠ“å–æ‰€æœ‰åˆ†æ”¯ æ‹‰å–ï¼šå°†è¿œç«¯ä»“åº“çš„ä¿®æ”¹æ‹‰åˆ°æœ¬åœ°å¹¶è‡ªåŠ¨è¿›è¡Œåˆå¹¶ï¼Œç­‰åŒäºfetch+merge æ‹‰å–å‘½ä»¤ï¼šgit pull [remote name] [branch name] å¦‚æœä¸æŒ‡å®šè¿œç«¯åç§°å’Œåˆ†æ”¯åï¼Œåˆ™ä¼šæŠ“å–æ‰€æœ‰åˆ†æ”¯å¹¶æ›´æ–°å½“å‰åˆ†æ”¯ è§£å†³åˆå¹¶å†²çªåœ¨ä¸€æ®µæ—¶é—´ï¼ŒAã€Bç”¨æˆ·ä¿®æ”¹äº†åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä¸”ä¿®æ”¹äº†åŒä¸€è¡Œä½ç½®çš„ä»£ç ï¼Œæ­¤æ—¶ä¼šå‘ç”Ÿåˆå¹¶å†²çªã€‚ Aç”¨æˆ·åœ¨æœ¬åœ°ä¿®æ”¹ä»£ç åä¼˜å…ˆæ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œæ­¤æ—¶Bç”¨æˆ·åœ¨æœ¬åœ°ä¿®è®¢ä»£ç ï¼Œæäº¤åˆ°æœ¬åœ°ä»“åº“åï¼Œä¹Ÿéœ€è¦æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œæ­¤æ—¶Bç”¨æˆ·æ™šäºAç”¨æˆ·ï¼Œæ•…éœ€è¦å…ˆæ‹‰å–è¿œç¨‹ä»“åº“çš„æäº¤ï¼Œç»è¿‡åˆäº•åæ‰èƒ½æ¨é€åˆ°è¿œç«¯åˆ†æ”¯,å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ åœ¨Bç”¨æˆ·æ‹‰å–ä»£ç æ—¶ï¼Œå› ä¸ºAã€Bç”¨æˆ·åŒä¸€æ®µæ—¶åŒä¿®æ”¹äº†åŒä¸€ä¸ªæ–‡ä»¶çš„ç›¸åŒä½ç½®ä»£ç ï¼Œæ•…ä¼šå‘ç”Ÿåˆå¹¶å†²çªã€‚ è¿œç¨‹åˆ†æ”¯ä¹Ÿæ˜¯åˆ†æ”¯ï¼Œæ‰€ä»¥åˆäº•æ—¶å†²çªçš„è§£å†³æ–¹å¼ä¹Ÿå’Œè§£æ±ºæœ¬åœ°åˆ†æ”¯å†²çªç›¸åŒç›¸åŒ","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Git","slug":"Git","permalink":"http://example.com/tags/Git/"}]},{"title":"(æ¯æ—¥LeetCode)698. åˆ’åˆ†ä¸ºkä¸ªç›¸ç­‰çš„å­é›†","slug":"æ¯æ—¥LeetCode/2022-9/698 åˆ’åˆ†ä¸ºkä¸ªç›¸ç­‰çš„å­é›†","date":"2022-09-20T01:18:00.000Z","updated":"2022-09-20T01:18:46.428Z","comments":true,"path":"2022/09/20/æ¯æ—¥LeetCode/2022-9/698 åˆ’åˆ†ä¸ºkä¸ªç›¸ç­‰çš„å­é›†/","link":"","permalink":"http://example.com/2022/09/20/%E6%AF%8F%E6%97%A5LeetCode/2022-9/698%20%E5%88%92%E5%88%86%E4%B8%BAk%E4%B8%AA%E7%9B%B8%E7%AD%89%E7%9A%84%E5%AD%90%E9%9B%86/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ­£æ•´æ•° kï¼Œæ‰¾å‡ºæ˜¯å¦æœ‰å¯èƒ½æŠŠè¿™ä¸ªæ•°ç»„åˆ†æˆ k ä¸ªéç©ºå­é›†ï¼Œå…¶æ€»å’Œéƒ½ç›¸ç­‰ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼š nums &#x3D; [4, 3, 2, 3, 5, 2, 1], k &#x3D; 4è¾“å‡ºï¼š Trueè¯´æ˜ï¼š æœ‰å¯èƒ½å°†å…¶åˆ†æˆ 4 ä¸ªå­é›†ï¼ˆ5ï¼‰ï¼Œï¼ˆ1,4ï¼‰ï¼Œï¼ˆ2,3ï¼‰ï¼Œï¼ˆ2,3ï¼‰ç­‰äºæ€»å’Œã€‚ æ€è·¯ï¼šè®¡ç®—å‡ºnumsçš„å…ƒç´ æ€»å’Œã€‚ é™¤ä»¥kï¼Œä¸èƒ½é™¤å°½ï¼Œåˆ™è¯´æ˜ä¸å­˜åœ¨è§£ æ€»å’Œé™¤ä»¥kï¼Œå¯ä»¥æ±‚å‡ºå¹³å‡å€¼ï¼Œå¾—å‡ºæ¯ä¸ªæ¡¶(arræ•°ç»„)éœ€è¦è£…çš„å…ƒç´ å¤§å° åˆ©ç”¨å›æº¯è¿›è¡Œè£…çƒ(numsä¸­çš„å…ƒç´ )ï¼Œå¾—å‡ºè§£ ä»£ç (cpp)ï¼›123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354class Solution &#123;public: bool dfs(vector&lt;int&gt;&amp; nums, int target, vector&lt;int&gt; arr, int k, int index)&#123; //å¦‚æœindexåˆ°äº†numsçš„æœ«å°¾çš„åä¸€ä½ if(index == nums.size())&#123; for(auto&amp; a : arr)&#123; //å¦‚æœæœ‰ä¸€ä¸ªæ¡¶é‡Œçš„æ•°ä¸ç­‰äºå¹³å‡æ•°ï¼Œåˆ™è¿”å›false if(a != target) return false; &#125; //éå†å®Œæˆï¼Œè¿”å›true return true; &#125; //éå†æ¯ä¸ªæ¡¶ for(int i = 0; i &lt; k; i++)&#123; //å¦‚æœç¬¬iæ¡¶åŠ ä¸Šnumsä¸­çš„indexä½ç½®çš„å…ƒç´ ï¼Œå¤§äºå¹³å‡æ•° if(arr[i] + nums[index] &gt; target) //è¿›å…¥åˆ°ä¸‹ä¸€ä¸ªæ¡¶(i+1) continue; //ç¬¬iæ¡¶åŠ ä¸Šindexä½ç½®å…ƒç´  arr[i] += nums[index]; //è°ƒç”¨é€’å½’ï¼Œæ’å…¥index+1ä½ç½®çš„å…ƒç´  if(dfs(nums, target, arr, k, index + 1)) //å¦‚æœé€’å½’å®Œæˆåæ¯ä¸ªæ¡¶é‡Œçš„æ•°éƒ½ç­‰äºå¹³å‡æ•°ï¼Œåˆ™è¿”å›ä¸ºçœŸ return true; //è¿è¡Œåˆ°è¿™é‡Œè¯´æ˜ï¼Œè¿™ä¸ªindexä½ç½®çš„å…ƒç´ ï¼Œæ”¾åˆ°iæ¡¶é‡Œä¸åˆé€‚ //å°†iæ¡¶ä¸­çš„è¿™ä¸ªä½ç½®çš„å…ƒç´ å‰”é™¤ï¼Œæ”¾åˆ°i+1æ¡¶é‡Œè¯•è¯• arr[i] -= nums[index]; //å‰”é™¤è¿™ä¸ªä½ç½®çš„å…ƒç´ åï¼Œå¦‚æœè¿™ä¸ªæ¡¶ä¸º0ï¼Œåˆ™è¯´æ˜æ”¾åˆ°åˆ«çš„æ¡¶é‡Œä¹Ÿä¸€æ · //æ¯ä¸ªæ¡¶è¦æ”¾çš„å¤§å°éƒ½ä¸€æ · if(arr[i] == 0) break; //å‰ªæ &#125; //éå†å®Œå…¨åï¼Œè¿˜æ²¡æœ‰æ‰¾åˆ°è§£ï¼Œåˆ™è¿”å›false return false; &#125; bool canPartitionKSubsets(vector&lt;int&gt;&amp; nums, int k) &#123; //å¦‚æœnumsçš„å…ƒç´ ä¸ªæ•°å°äºkï¼Œåˆ™è¿”å›flase if(nums.size() &lt; k) return false; //è·å–numsçš„å…ƒç´ æ€»å’Œ int sum = accumulate(nums.begin(),nums.end(),0); //å¦‚æœä¸èƒ½è¢«ké™¤å°½ï¼Œåˆ™è¿”å›false if(sum%k != 0) return false; //é™åºæ’åˆ— sort(nums.begin(), nums.end(), greater&lt;int&gt;()); //è·å–sumçš„å¹³å‡æ•° int target = sum / k; //ç”¨æ¥è®°å½•æ¯ä¸ªæ¡¶çš„å¤§å° vector&lt;int&gt; arr(k); //è°ƒç”¨å›æº¯,å¾—å‡ºè§£ return dfs(nums, target, arr, k, 0); &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1636. æŒ‰ç…§é¢‘ç‡å°†æ•°ç»„å‡åºæ’åº","slug":"æ¯æ—¥LeetCode/2022-9/1636 æŒ‰ç…§é¢‘ç‡å°†æ•°ç»„å‡åºæ’åº","date":"2022-09-19T01:48:00.000Z","updated":"2022-09-19T01:48:44.717Z","comments":true,"path":"2022/09/19/æ¯æ—¥LeetCode/2022-9/1636 æŒ‰ç…§é¢‘ç‡å°†æ•°ç»„å‡åºæ’åº/","link":"","permalink":"http://example.com/2022/09/19/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1636%20%E6%8C%89%E7%85%A7%E9%A2%91%E7%8E%87%E5%B0%86%E6%95%B0%E7%BB%84%E5%8D%87%E5%BA%8F%E6%8E%92%E5%BA%8F/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œè¯·ä½ å°†æ•°ç»„æŒ‰ç…§æ¯ä¸ªå€¼çš„é¢‘ç‡ å‡åº æ’åºã€‚å¦‚æœæœ‰å¤šä¸ªå€¼çš„é¢‘ç‡ç›¸åŒï¼Œè¯·ä½ æŒ‰ç…§æ•°å€¼æœ¬èº«å°†å®ƒä»¬ é™åº æ’åºã€‚ è¯·ä½ è¿”å›æ’åºåçš„æ•°ç»„ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [1,1,2,2,2,3]è¾“å‡ºï¼š[3,1,1,2,2,2]è§£é‡Šï¼šâ€™3â€™ é¢‘ç‡ä¸º 1ï¼Œâ€™1â€™ é¢‘ç‡ä¸º 2ï¼Œâ€™2â€™ é¢‘ç‡ä¸º 3 ã€‚ æ€è·¯ï¼šè·å–numsæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„é¢‘ç‡ï¼Œé€šè¿‡é¢‘ç‡æ¯”è¾ƒï¼š å¦‚æœé¢‘ç‡ç›¸ç­‰çš„æƒ…å†µï¼ŒæŒ‰ç…§å…ƒç´ çš„å¤§å°è¿›è¡Œé™åºæ’åˆ— å¦‚æœé¢‘ç‡ä¸ç›¸ç­‰çš„æƒ…å†µï¼ŒæŒ‰ç…§å…ƒç´ çš„æ’åˆ—å¤§å°è¿›è¡Œå‡åºæ’åˆ— ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: vector&lt;int&gt; frequencySort(vector&lt;int&gt;&amp; nums) &#123; unordered_map&lt;int, int&gt; map; //è·å–numsä¸­å„ä¸ªå…ƒç´ çš„é¢‘ç‡ for(auto&amp; num : nums)&#123; map[num]++; &#125; //ç»™numsè‡ªå®šä¹‰æ’åº sort(nums.begin(), nums.end(), [&amp;](int a, int b)&#123; //é¢‘ç‡ä¸ç›¸ç­‰çš„æƒ…å†µï¼ŒæŒ‰ç…§å‡åºæ’åˆ— if(map[a] != map[b])&#123; return map[a] &lt; map[b]; &#125; //æ’åˆ—ç›¸ç­‰çš„æƒ…å†µï¼ŒæŒ‰ç…§é™åºæ’åº return a &gt; b; &#125;); return nums; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ nums çš„é•¿åº¦ã€‚æ’åºæ¶ˆè€— O(nlogn) æ—¶é—´ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå­˜å‚¨æ•°ç»„å…ƒç´ é¢‘ç‡çš„å“ˆå¸Œè¡¨æ¶ˆè€— O(n) ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1640. èƒ½å¦è¿æ¥å½¢æˆæ•°ç»„","slug":"æ¯æ—¥LeetCode/2022-9/1640 èƒ½å¦è¿æ¥å½¢æˆæ•°ç»„","date":"2022-09-19T01:48:00.000Z","updated":"2022-09-22T01:34:16.162Z","comments":true,"path":"2022/09/19/æ¯æ—¥LeetCode/2022-9/1640 èƒ½å¦è¿æ¥å½¢æˆæ•°ç»„/","link":"","permalink":"http://example.com/2022/09/19/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1640%20%E8%83%BD%E5%90%A6%E8%BF%9E%E6%8E%A5%E5%BD%A2%E6%88%90%E6%95%B0%E7%BB%84/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ arr ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªæ•´æ•° äº’ä¸ç›¸åŒ ã€‚å¦æœ‰ä¸€ä¸ªç”±æ•´æ•°æ•°ç»„æ„æˆçš„æ•°ç»„ piecesï¼Œå…¶ä¸­çš„æ•´æ•°ä¹Ÿ äº’ä¸ç›¸åŒ ã€‚è¯·ä½ ä»¥ ä»»æ„é¡ºåº è¿æ¥ pieces ä¸­çš„æ•°ç»„ä»¥å½¢æˆ arr ã€‚ä½†æ˜¯ï¼Œä¸å…è®¸ å¯¹æ¯ä¸ªæ•°ç»„ pieces[i] ä¸­çš„æ•´æ•°é‡æ–°æ’åºã€‚ å¦‚æœå¯ä»¥è¿æ¥ pieces ä¸­çš„æ•°ç»„å½¢æˆ arr ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šarr &#x3D; [91,4,64,78], pieces &#x3D; [[78],[4,64],[91]]è¾“å‡ºï¼štrueè§£é‡Šï¼šä¾æ¬¡è¿æ¥ [91]ã€[4,64] å’Œ [78] æ€è·¯ï¼šä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨piecesä¸­æ¯ä¸ªæ•°ç»„çš„é¦–å…ƒç´ åŠå…¶è¯¥æ•°ç»„çš„ä½ç½® å†ä¸arræ•°ç»„æ¯”è¾ƒï¼š å¦‚æœæœªæ‰¾åˆ°(arrä¸piecesä¸­çš„å…ƒç´ éƒ½ç›¸åŒ)ï¼Œåˆ™è¯´æ˜è¯¥å…ƒç´ ä¸æ˜¯piecesçš„æ•°ç»„ä¸­çš„é¦–å…ƒç´ ï¼Œè¿”å›false å¦‚æœæ‰¾åˆ°ï¼Œå†ä¾æ¬¡æ¯”è¾ƒåé¢çš„å…ƒç´ ï¼Œå¦‚æœæœ‰ä¸åŒçš„å…ƒç´ ï¼Œè¿”å›false ç›´åˆ°éå†å®Œå…¨ï¼Œæ²¡æœ‰ä¸Šè¿°é—®é¢˜ï¼Œè¿”å›true ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425class Solution &#123;public: bool canFormArray(vector&lt;int&gt;&amp; arr, vector&lt;vector&lt;int&gt;&gt;&amp; pieces) &#123; unordered_map&lt;int, int&gt; map; for(int i = 0; i &lt; pieces.size(); i++)&#123; map.emplace(pieces[i][0], i); &#125; int i = 0; while(i &lt; arr.size())&#123; auto temp = map.find(arr[i]); if(temp != map.end())&#123; for(int j = 0; j &lt; pieces[temp-&gt;second].size(); j++)&#123; if(arr[i++] != pieces[temp-&gt;second][j])&#123; return false; &#125; &#125; &#125; else &#123; return false; &#125; &#125; return true; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚ä¿å­˜å“ˆå¸Œè¡¨éœ€è¦ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"","slug":"Java/æ‰‹å†™Spring","date":"2022-09-17T13:54:33.871Z","updated":"2022-09-20T10:27:33.908Z","comments":true,"path":"2022/09/17/Java/æ‰‹å†™Spring/","link":"","permalink":"http://example.com/2022/09/17/Java/%E6%89%8B%E5%86%99Spring/","excerpt":"","text":"æ‰‹å†™Springå¯åŠ¨å’Œæ‰«æ123456@Target(ElementType.TYPE)@Retention(RetentionPolicy.RUNTIME)public @interface ComponentScan &#123; String value() default &quot;&quot;;&#125; 123456@Target(ElementType.TYPE)@Retention(RetentionPolicy.RUNTIME)public @interface Component &#123; String value() default &quot;&quot;;&#125; 12345@Target(ElementType.TYPE)@Retention(RetentionPolicy.RUNTIME)public @interface Scope &#123; public String value() default &quot;&quot;;&#125; 1234567891011121314151617181920212223242526272829public class BeanDefinition &#123; private Class cls; private String scope; public BeanDefinition()&#123; &#125; public BeanDefinition(Class cls, String scope) &#123; this.cls = cls; this.scope = scope; &#125; public Class getCls() &#123; return cls; &#125; public void setCls(Class cls) &#123; this.cls = cls; &#125; public String getScope() &#123; return scope; &#125; public void setScope(String scope) &#123; this.scope = scope; &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667public class MyApplicationContext &#123; private Class ApplicationConfig; private final ConcurrentHashMap&lt;String, Object&gt; beanDefinitionMap = new ConcurrentHashMap&lt;&gt;(); public MyApplicationContext(Class ApplicationConfig) &#123; this.ApplicationConfig = ApplicationConfig; //è§£æé…ç½®ç±» scan(ApplicationConfig); &#125; //æ‰«æè·¯å¾„ä¸­çš„bean private void scan(Class ApplicationConfig) &#123; //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ComponentScanæ³¨è§£ if (!ApplicationConfig.isAnnotationPresent(ComponentScan.class))&#123; throw new RuntimeException(&quot;not found interface ComponentScan&quot;); &#125; //è·å–ComponentScanæ³¨è§£ ComponentScan componentScan = (ComponentScan) ApplicationConfig.getDeclaredAnnotation(ComponentScan.class); //è·å–æ‰«æçš„è·¯å¾„ String path = componentScan.value(); path = path.replace(&quot;.&quot;,&quot;/&quot;); //æ‰«æè·¯å¾„ ClassLoader classLoader = MyApplicationContext.class.getClassLoader(); //app URL resource = classLoader.getResource(path); File file = new File(resource.getFile()); //è·å–ç›®å½• if (file.isDirectory())&#123; //ç›®å½•æ˜¯å¦ä¸ºç©º File[] files = file.listFiles(); //è·å–ç›®å½•ä¸­çš„ç±»è·¯å¾„ for (File f : files) &#123; String fileName = f.getAbsolutePath(); //è·å–ç±»è·¯å¾„å­—ç¬¦ä¸² if (fileName.endsWith(&quot;.class&quot;))&#123; //åˆ¤æ–­æ˜¯å¦æ˜¯ç±»æ–‡ä»¶ //åˆ†å‰²è·å–æŒ‡å®šçš„è·¯å¾„ String className = fileName.substring(fileName.indexOf(&quot;com&quot;),fileName.indexOf(&quot;.class&quot;)); className = className.replace(&quot;\\\\&quot;, &quot;.&quot;); try &#123; Class&lt;?&gt; cls = classLoader.loadClass(className); //è·å–åˆ°ç±» //åˆ¤æ–­æ˜¯å¦ç±»ä¸­æ˜¯å¦æœ‰Componentæ³¨è§£ if (cls.isAnnotationPresent(Component.class))&#123; //è·å–Componentä¸­çš„beanå Component component = cls.getDeclaredAnnotation(Component.class); String beanName = component.value(); BeanDefinition definition = new BeanDefinition(); definition.setCls(cls); //åˆ¤æ–­æ˜¯å¦ç±»ä¸­æ˜¯å¦æœ‰Scopeæ³¨è§£ if (cls.isAnnotationPresent(Scope.class))&#123; Scope scope = cls.getDeclaredAnnotation(Scope.class); definition.setScope(scope.value()); &#125; else &#123; definition.setScope(&quot;singleton&quot;); &#125; beanDefinitionMap.put(beanName, definition); &#125; &#125; catch (ClassNotFoundException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125; &#125; //TODO public Object getBean(String beanName)&#123; return null;&#125; æ‰‹å†™getBean()123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112public class MyApplicationContext &#123; private Class ApplicationConfig; //å•ä¾‹å¯¹è±¡æ±  private final ConcurrentHashMap&lt;String, Object&gt; singletonObjects = new ConcurrentHashMap&lt;&gt;(); private final ConcurrentHashMap&lt;String, Object&gt; beanDefinitionMap = new ConcurrentHashMap&lt;&gt;(); public MyApplicationContext(Class ApplicationConfig) &#123; this.ApplicationConfig = ApplicationConfig; //è§£æé…ç½®ç±» scan(ApplicationConfig); //åˆ›å»ºå‡ºå•ä¾‹beanï¼Œå¤šä¾‹beanæ— éœ€åˆ›å»ºéšç”¨éšåˆ› for (String beanName : beanDefinitionMap.keySet()) &#123; BeanDefinition beanDefinition = (BeanDefinition) beanDefinitionMap.get(beanName); if (beanDefinition.getScope().equals(&quot;singleton&quot;)) &#123; Object bean = createBean(beanDefinition); singletonObjects.put(beanName, bean); &#125; &#125; &#125; //é€šè¿‡beanDefinitionä¸­çš„clsåˆ›å»ºbean private Object createBean(BeanDefinition beanDefinition)&#123; Class cls = beanDefinition.getCls(); try &#123; Object instance = cls.getDeclaredConstructor().newInstance(); return instance; &#125; catch (InstantiationException e) &#123; e.printStackTrace(); &#125; catch (IllegalAccessException e) &#123; e.printStackTrace(); &#125; catch (InvocationTargetException e) &#123; e.printStackTrace(); &#125; catch (NoSuchMethodException e) &#123; e.printStackTrace(); &#125; return null; &#125; //æ‰«æè·¯å¾„ä¸­çš„bean private void scan(Class ApplicationConfig) &#123; //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ComponentScanæ³¨è§£ if (!ApplicationConfig.isAnnotationPresent(ComponentScan.class))&#123; throw new RuntimeException(&quot;not found interface ComponentScan&quot;); &#125; //è·å–ComponentScanæ³¨è§£ ComponentScan componentScan = (ComponentScan) ApplicationConfig.getDeclaredAnnotation(ComponentScan.class); //è·å–æ‰«æçš„è·¯å¾„ String path = componentScan.value(); path = path.replace(&quot;.&quot;,&quot;/&quot;); //æ‰«æè·¯å¾„ ClassLoader classLoader = MyApplicationContext.class.getClassLoader(); //app URL resource = classLoader.getResource(path); File file = new File(resource.getFile()); //è·å–ç›®å½• if (file.isDirectory())&#123; //ç›®å½•æ˜¯å¦ä¸ºç©º File[] files = file.listFiles(); //è·å–ç›®å½•ä¸­çš„ç±»è·¯å¾„ for (File f : files) &#123; String fileName = f.getAbsolutePath(); //è·å–ç±»è·¯å¾„å­—ç¬¦ä¸² if (fileName.endsWith(&quot;.class&quot;))&#123; //åˆ¤æ–­æ˜¯å¦æ˜¯ç±»æ–‡ä»¶ //åˆ†å‰²è·å–æŒ‡å®šçš„è·¯å¾„ String className = fileName.substring(fileName.indexOf(&quot;com&quot;),fileName.indexOf(&quot;.class&quot;)); className = className.replace(&quot;\\\\&quot;, &quot;.&quot;); try &#123; Class&lt;?&gt; cls = classLoader.loadClass(className); //è·å–åˆ°ç±» //åˆ¤æ–­æ˜¯å¦ç±»ä¸­æ˜¯å¦æœ‰Componentæ³¨è§£ if (cls.isAnnotationPresent(Component.class))&#123; //è·å–Componentä¸­çš„beanå Component component = cls.getDeclaredAnnotation(Component.class); String beanName = component.value(); BeanDefinition definition = new BeanDefinition(); definition.setCls(cls); //åˆ¤æ–­æ˜¯å¦ç±»ä¸­æ˜¯å¦æœ‰Scopeæ³¨è§£ if (cls.isAnnotationPresent(Scope.class))&#123; Scope scope = cls.getDeclaredAnnotation(Scope.class); definition.setScope(scope.value()); &#125; else &#123; definition.setScope(&quot;singleton&quot;); &#125; beanDefinitionMap.put(beanName, definition); &#125; &#125; catch (ClassNotFoundException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125; &#125; //getBeanæ–¹æ³• public Object getBean(String beanName)&#123; if (beanDefinitionMap.containsKey(beanName))&#123; BeanDefinition beanDefinition = (BeanDefinition) beanDefinitionMap.get(beanName); if (beanDefinition.getScope().equals(&quot;singleton&quot;))&#123; //å¦‚æœæ˜¯å•ä¾‹beanï¼Œç›´æ¥åœ¨å•ä¾‹æ± ä¸­å– Object bean = singletonObjects.get(beanName); return bean; &#125;else &#123; //å¤šä¾‹beanå°±åˆ›å»ºæ–°çš„beanå¯¹è±¡ Object bean = createBean(beanDefinition); return bean; &#125; &#125;else &#123; throw new RuntimeException(&quot;not found bean&quot;); &#125; &#125;&#125; æµ‹è¯•ï¼šé…ç½®ç±»ï¼š 1234@ComponentScan(&quot;com.mine.service&quot;)public class AppConfig &#123;&#125; ä¸»å‡½æ•°ï¼š 1234567891011public class Application &#123; public static void main(String[] args) &#123; MyApplicationContext app = new MyApplicationContext(AppConfig.class); UserService userService = (UserService) app.getBean(&quot;userService&quot;); UserService userService1 = (UserService) app.getBean(&quot;userService&quot;); UserService userService2 = (UserService) app.getBean(&quot;userService&quot;); System.out.println(&quot;userService = &quot; + userService); System.out.println(&quot;userService1 = &quot; + userService1); System.out.println(&quot;userService2 = &quot; + userService2); &#125;&#125; å°†UserServiceè®¾ç½®ä¸ºå•ä¾‹(é»˜è®¤å°±ä¸ºå•ä¾‹)ï¼š 123@Component(&quot;userService&quot;)public class UserService &#123;&#125; è¿è¡Œç»“æœï¼š 123userService2 = com.mine.service.UserService@2e817b38userService1 = com.mine.service.UserService@2e817b38userService3 = com.mine.service.UserService@2e817b38 å°†UserServiceè®¾ä¸ºå¤šä¾‹ï¼š 12345@Component(&quot;userService&quot;)@Scope(&quot;prototype&quot;)public class UserService &#123;&#125; è¿è¡Œç»“æœï¼š 123userService2 = com.mine.service.UserService@433c675duserService1 = com.mine.service.UserService@3f91beefuserService3 = com.mine.service.UserService@1a6c5a9e æ‰‹å†™ä¾èµ–æ³¨å…¥123456@Target(&#123;ElementType.METHOD, ElementType.FIELD&#125;)@Retention(RetentionPolicy.RUNTIME)public @interface Autowired &#123; String value() default &quot;&quot;;&#125; 123@Component(&quot;orderService&quot;)public class OrderService &#123;&#125; 12345678910@Component(&quot;userService&quot;)@Scope(&quot;prototype&quot;)public class UserService &#123; @Autowired private OrderService orderService; public void test()&#123; System.out.println(&quot;orderService = &quot; + orderService); &#125;&#125; åœ¨createBeanæ–¹æ³•ä¸­æ·»åŠ ï¼š 1234567891011121314151617181920212223242526272829private Object createBean(BeanDefinition beanDefinition)&#123; Class cls = beanDefinition.getCls(); try &#123; Object instance = cls.getDeclaredConstructor().newInstance(); //è·å–æ¯ä¸ªå­—æ®µ for (Field field : cls.getDeclaredFields()) &#123; //åˆ¤æ–­è¯¥å­—æ®µæ˜¯å¦æœ‰Autowiredæ³¨è§£ if (field.isAnnotationPresent(Autowired.class)) &#123; field.setAccessible(true); //è®¾ç½®å¯ä»¥è®¿é—®privateå˜é‡çš„å˜é‡å€¼ Object bean = getBean(field.getName()); //å°†è¯¥å­—æ®µæ³¨å…¥ field.set(instance, bean); &#125; &#125; return instance; &#125; catch (InstantiationException e) &#123; e.printStackTrace(); &#125; catch (IllegalAccessException e) &#123; e.printStackTrace(); &#125; catch (InvocationTargetException e) &#123; e.printStackTrace(); &#125; catch (NoSuchMethodException e) &#123; e.printStackTrace(); &#125; return null; &#125; æµ‹è¯•ï¼š12345678public class Application &#123; public static void main(String[] args) &#123; MyApplicationContext app = new MyApplicationContext(AppConfig.class); UserService userService = (UserService) app.getBean(&quot;userService&quot;); System.out.println(&quot;userService = &quot; + userService); userService.test(); &#125;&#125; è¿è¡Œç»“æœï¼š 12userService = com.mine.service.UserService@179d3b25orderService = com.mine.service.OrderService@254989ff Awareå›è°ƒ123public interface BeanNameAware &#123; void setBeanName(String name);&#125; å®ç°BeanNameAwareçš„æ¥å£ 123456789101112131415161718@Component(&quot;userService&quot;)@Scope(&quot;prototype&quot;)public class UserService implements BeanNameAware &#123; @Autowired private OrderService orderService; private String beanName; @Override public void setBeanName(String name) &#123; beanName = name; &#125; public void test()&#123; System.out.println(&quot;orderService = &quot; + orderService); System.out.println(&quot;beanName = &quot; + beanName); &#125;&#125; éœ€è¦åœ¨createBeanæ·»åŠ å†…å®¹ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªå‚æ•°(è®°å¾—æŠŠè°ƒç”¨çš„createBeanæ–¹æ³•ä¹Ÿè¿›è¡Œä¿®æ”¹) 123456789101112131415161718192021222324252627282930313233private Object createBean(String beanName, BeanDefinition beanDefinition)&#123; Class cls = beanDefinition.getCls(); try &#123; Object instance = cls.getDeclaredConstructor().newInstance(); //è·å–æ¯ä¸ªå­—æ®µ for (Field field : cls.getDeclaredFields()) &#123; //åˆ¤æ–­è¯¥å­—æ®µæ˜¯å¦æœ‰Autowiredæ³¨è§£ if (field.isAnnotationPresent(Autowired.class)) &#123; field.setAccessible(true); //è®¾ç½®å¯ä»¥è®¿é—®privateå˜é‡çš„å˜é‡å€¼ Object bean = getBean(field.getName()); //å°†è¯¥å­—æ®µæ³¨å…¥ field.set(instance, bean); &#125; &#125; //Awareå›è°ƒ if (instance instanceof BeanNameAware) &#123; //åˆ¤æ–­instanceæ˜¯å¦å®ç°äº†BeanNameAwareçš„æ–¹æ³• ((BeanNameAware) instance).setBeanName(beanName); &#125; return instance; &#125; catch (InstantiationException e) &#123; e.printStackTrace(); &#125; catch (IllegalAccessException e) &#123; e.printStackTrace(); &#125; catch (InvocationTargetException e) &#123; e.printStackTrace(); &#125; catch (NoSuchMethodException e) &#123; e.printStackTrace(); &#125; return null; &#125; æµ‹è¯•ï¼š12345678public class Application &#123; public static void main(String[] args) &#123; MyApplicationContext app = new MyApplicationContext(AppConfig.class); UserService userService = (UserService) app.getBean(&quot;userService&quot;); System.out.println(&quot;userService = &quot; + userService); userService.test(); &#125;&#125; è¿è¡Œç»“æœÂ·ï¼š 123userService = com.mine.service.UserService@254989fforderService = com.mine.service.OrderService@5d099f62beanName = userService åˆå§‹åŒ–æœºåˆ¶123public interface InitializingBean &#123; void afterPropertiesSet() throws Exception;&#125; 123456789101112131415@Component(&quot;userService&quot;)@Scope(&quot;prototype&quot;)public class UserService implements InitializingBean &#123; @Autowired private OrderService orderService; public void test()&#123; System.out.println(&quot;orderService = &quot; + orderService); &#125; @Override public void afterPropertiesSet() throws Exception &#123; System.out.println(&quot;åˆå§‹åŒ–&quot;); &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142private Object createBean(String beanName, BeanDefinition beanDefinition)&#123; Class cls = beanDefinition.getCls(); try &#123; Object instance = cls.getDeclaredConstructor().newInstance(); //è·å–æ¯ä¸ªå­—æ®µ for (Field field : cls.getDeclaredFields()) &#123; //åˆ¤æ–­è¯¥å­—æ®µæ˜¯å¦æœ‰Autowiredæ³¨è§£ if (field.isAnnotationPresent(Autowired.class)) &#123; field.setAccessible(true); //è®¾ç½®å¯ä»¥è®¿é—®privateå˜é‡çš„å˜é‡å€¼ Object bean = getBean(field.getName()); //å°†è¯¥å­—æ®µæ³¨å…¥ field.set(instance, bean); &#125; &#125; //Awareå›è°ƒ if (instance instanceof BeanNameAware) &#123; //instanceæ˜¯å¦å®ç°äº†BeanNameAwareçš„æ–¹æ³• ((BeanNameAware) instance).setBeanName(beanName); &#125; //åˆå§‹åŒ– if (instance instanceof InitializingBean) &#123; try &#123; ((InitializingBean) instance).afterPropertiesSet(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; return instance; &#125; catch (InstantiationException e) &#123; e.printStackTrace(); &#125; catch (IllegalAccessException e) &#123; e.printStackTrace(); &#125; catch (InvocationTargetException e) &#123; e.printStackTrace(); &#125; catch (NoSuchMethodException e) &#123; e.printStackTrace(); &#125; return null;&#125; æµ‹è¯•ï¼š12345678public class Application &#123; public static void main(String[] args) &#123; MyApplicationContext app = new MyApplicationContext(AppConfig.class); UserService userService = (UserService) app.getBean(&quot;userService&quot;); System.out.println(&quot;userService = &quot; + userService); userService.test(); &#125;&#125; è¿è¡Œç»“æœï¼š 123åˆå§‹åŒ–userService = com.mine.service.UserService@254989fforderService = com.mine.service.OrderService@5d099f62 æ‰‹å†™BeanPostProcessoræœºåˆ¶12345public interface BeanPostProcessor &#123; Object postProcessBeforeInitialization(Object bean, String beanName); Object postProcessAfterInitialization(Object bean, String beanName);&#125; 1234567891011121314@Componentpublic class MyBeanPostProcessor implements BeanPostProcessor &#123; @Override public Object postProcessBeforeInitialization(Object bean, String beanName) &#123; System.out.println(&quot;åˆå§‹åŒ–å‰&quot;+beanName); return bean; &#125; @Override public Object postProcessAfterInitialization(Object bean, String beanName) &#123; System.out.println(&quot;åˆå§‹åŒ–å&quot;+beanName); return bean; &#125;&#125; scanæ–¹æ³•ä¸­çš„éƒ¨åˆ†ä»£ç ï¼Œæ·»åŠ åˆ¤æ–­BeanPostProcessoræ¥å£ï¼š 12345678910111213141516171819202122232425try &#123; Class&lt;?&gt; cls = classLoader.loadClass(className); //è·å–åˆ°ç±» if (cls.isAnnotationPresent(Component.class))&#123; //åˆ¤æ–­æ˜¯å¦ç±»ä¸­æ˜¯å¦æœ‰Componentæ³¨è§£ //åˆ¤æ–­æ˜¯å¦å®ç°äº†BeanPostProcessoræ¥å£ if(BeanPostProcessor.class.isAssignableFrom(cls)) &#123; BeanPostProcessor beanPostProcessor = (BeanPostProcessor) cls.getDeclaredConstructor().newInstance(); beanPostProcessorList.add(beanPostProcessor); &#125; Component component = cls.getDeclaredAnnotation(Component.class); String beanName = component.value(); BeanDefinition definition = new BeanDefinition(); definition.setCls(cls); if (cls.isAnnotationPresent(Scope.class))&#123; Scope scope = cls.getDeclaredAnnotation(Scope.class); definition.setScope(scope.value()); &#125; else &#123; definition.setScope(&quot;singleton&quot;); &#125; beanDefinitionMap.put(beanName, definition); &#125; &#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950private Object createBean(String beanName, BeanDefinition beanDefinition)&#123; Class cls = beanDefinition.getCls(); try &#123; Object instance = cls.getDeclaredConstructor().newInstance(); //è·å–æ¯ä¸ªå­—æ®µ for (Field field : cls.getDeclaredFields()) &#123; //åˆ¤æ–­è¯¥å­—æ®µæ˜¯å¦æœ‰Autowiredæ³¨è§£ if (field.isAnnotationPresent(Autowired.class)) &#123; field.setAccessible(true); //è®¾ç½®å¯ä»¥è®¿é—®privateå˜é‡çš„å˜é‡å€¼ Object bean = getBean(field.getName()); //å°†è¯¥å­—æ®µæ³¨å…¥ field.set(instance, bean); &#125; &#125; //Awareå›è°ƒ if (instance instanceof BeanNameAware) &#123; //oæ˜¯å¦å®ç°äº†BeanNameAwareçš„æ–¹æ³• ((BeanNameAware) instance).setBeanName(beanName); &#125; //è°ƒç”¨åˆå§‹åŒ–å‰å®šä¹‰çš„æ–¹æ³• for (BeanPostProcessor beanPostProcessor : beanPostProcessorList) &#123; instance = beanPostProcessor.postProcessBeforeInitialization(instance, beanName); &#125; //åˆå§‹åŒ– if (instance instanceof InitializingBean) &#123; try &#123; ((InitializingBean) instance).afterPropertiesSet(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; //è°ƒç”¨åˆå§‹åŒ–åå®šä¹‰çš„æ–¹æ³• for (BeanPostProcessor beanPostProcessor : beanPostProcessorList) &#123; instance = beanPostProcessor.postProcessAfterInitialization(instance, beanName); &#125; return instance; &#125; catch (InstantiationException e) &#123; e.printStackTrace(); &#125; catch (IllegalAccessException e) &#123; e.printStackTrace(); &#125; catch (InvocationTargetException e) &#123; e.printStackTrace(); &#125; catch (NoSuchMethodException e) &#123; e.printStackTrace(); &#125; return null; &#125; 123456public class Application &#123; public static void main(String[] args) &#123; MyApplicationContext app = new MyApplicationContext(AppConfig.class); UserService userService = (UserService) app.getBean(&quot;userService&quot;); &#125;&#125; è¿è¡Œç»“æœï¼š 123456åˆå§‹åŒ–å‰åˆå§‹åŒ–ååˆå§‹åŒ–å‰orderServiceåˆå§‹åŒ–åorderServiceåˆå§‹åŒ–å‰userServiceåˆå§‹åŒ–åuserService æ‰‹å†™Beanç”Ÿå‘½å‘¨æœŸ æ‰‹å†™Aopæœºåˆ¶","categories":[],"tags":[]},{"title":"","slug":"Java/åŸºç¡€","date":"2022-09-17T12:53:05.148Z","updated":"2022-09-21T13:33:42.088Z","comments":true,"path":"2022/09/17/Java/åŸºç¡€/","link":"","permalink":"http://example.com/2022/09/17/Java/%E5%9F%BA%E7%A1%80/","excerpt":"","text":"æ³¨è§£ javaä¸­æ³¨è§£åˆ†ä¸ºä¸¤ç§ï¼šå…ƒæ³¨è§£ä¸è‡ªå®šä¹‰æ³¨è§£ å…ƒæ³¨è§£ï¼šæè¿°æ³¨è§£çš„æ³¨è§£ è‡ªå®šä¹‰æ³¨è§£ï¼šå¼€å‘è€…è‡ªå·±å®šä¹‰çš„æ³¨è§£ï¼Œå¦‚Springæ¡†æ¶ä¸­@Valueã€@Autowiredç­‰ JDKæä¾›äº†4ä¸ªæ ‡å‡†çš„æ³¨è§£ï¼š å…ƒæ³¨è§£ ä½œç”¨ @Target æŒ‡å®šæ³¨è§£ä½¿ç”¨çš„ä½œç”¨èŒƒå›´(ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰) @Retention æŒ‡å®šæ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ(æºç ã€classæ–‡ä»¶ã€è¿è¡Œç­‰) @Documented è¡¨ç¤ºè¯¥æ³¨è§£ä¼šè¢«javadocæ–‡æ¡£è®°å½• @Inherited è¡¨ç¤ºè¯¥æ³¨è§£çš„å­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£ï¼Œåªèƒ½ä½œç”¨äºç±»ä¸Šçš„æ³¨è§£ é™¤äº†ä»¥ä¸Š4ä¸ªæ³¨è§£å…¶ä½™éƒ½æ˜¯è‡ªå®šä¹‰æ³¨è§£ å…ƒæ³¨è§£å‚æ•°è¯´æ˜ï¼š @Targetå‚æ•° ElementType.METHODï¼šç”¨äºæè¿°æ–¹æ³• ElementType.TYPEï¼šç”¨äºæè¿°ç±»ã€æ¥å£(åŒ…æ‹¬æ³¨è§£ç±»å‹)æˆ–enumå£°æ˜ ElementType.CONSTRUCTORï¼šç”¨äºæè¿°æ„é€ å™¨ ElementType.FIELDï¼šæˆå‘˜å˜é‡ã€å¯¹è±¡ã€å±æ€§(åŒ…æ‹¬enumå®ä¾‹) ElementType.LOCAL_VARIABLEï¼šç”¨äºæè¿°å±€éƒ¨å˜é‡ ElementType.PACKAGEï¼šç”¨äºæè¿°åŒ… ElementType.PARAMETERï¼šç”¨äºæè¿°å‚æ•° ElementType.ANNOTATION_TYPE:ç”¨äºæè¿°å‚æ•° @Retentionå‚æ•° RetentionPolicy.RUNTIMEï¼šå§‹ç»ˆä¸ä¼šä¸¢å¼ƒï¼Œè¿è¡ŒæœŸä¹Ÿä¿ç•™è¯¥æ³¨è§£ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åå°„æœºåˆ¶è¯»å–è¯¥æ³¨è§£çš„ä¿¡æ¯ RetentionPolicy.SOURCEï¼šåœ¨ç¼–è¯‘é˜¶æ®µä¸¢å¼ƒï¼Œè¿™äº›æ³¨è§£åœ¨ç¼–è¯‘ç»“æŸåå°±ä¸å†æœ‰ä»»ä½•æ„ä¹‰ï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä¼šå†™å…¥å­—èŠ‚ç ã€‚å¦‚ï¼š@Overrideå°±å±äºè¿™ç±»æ³¨è§£ RetentionPolicy.CLASSï¼šåœ¨ç±»åŠ è½½çš„æ—¶å€™ä¸¢å¼ƒï¼Œåœ¨å­—èŠ‚ç æ–‡ä»¶çš„å¤„ç†ä¸­æœ‰ç”¨ï¼Œæ³¨è§£é»˜è®¤ä½¿ç”¨è¿™ç§æ–¹å¼ è‡ªå®šä¹‰æ³¨è§£å®ç°ï¼š éœ€æ±‚ï¼šéœ€è¦è®°å½•æ–¹æ³•çš„å…¥å£å‚æ•°ä»¥åŠæ–¹æ³•çš„è¿”å›å‚æ•°ï¼Œä»¥åŠæ–¹æ³•æ‰§è¡Œçš„æ—¶é—´ è‡ªå®šä¹‰ä¸€ä¸ª@MyLogæ³¨è§£ï¼š 123456@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface MyLog &#123; //æè¿°æ–¹æ³• String value() default &quot;&quot;;&#125;","categories":[],"tags":[]},{"title":"(æ¯æ—¥LeetCode)1624. ä¸¤ä¸ªç›¸åŒå­—ç¬¦ä¹‹é—´çš„æœ€é•¿å­å­—ç¬¦ä¸²","slug":"æ¯æ—¥LeetCode/2022-9/1624 ä¸¤ä¸ªç›¸åŒå­—ç¬¦ä¹‹é—´çš„æœ€é•¿å­å­—ç¬¦ä¸²","date":"2022-09-17T01:21:00.000Z","updated":"2022-09-17T01:22:01.274Z","comments":true,"path":"2022/09/17/æ¯æ—¥LeetCode/2022-9/1624 ä¸¤ä¸ªç›¸åŒå­—ç¬¦ä¹‹é—´çš„æœ€é•¿å­å­—ç¬¦ä¸²/","link":"","permalink":"http://example.com/2022/09/17/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1624%20%E4%B8%A4%E4%B8%AA%E7%9B%B8%E5%90%8C%E5%AD%97%E7%AC%A6%E4%B9%8B%E9%97%B4%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œè¯·ä½ è¿”å› ä¸¤ä¸ªç›¸åŒå­—ç¬¦ä¹‹é—´çš„æœ€é•¿å­å­—ç¬¦ä¸²çš„é•¿åº¦ ï¼Œè®¡ç®—é•¿åº¦æ—¶ä¸å«è¿™ä¸¤ä¸ªå­—ç¬¦ã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å­å­—ç¬¦ä¸²ï¼Œè¿”å› -1 ã€‚ å­å­—ç¬¦ä¸² æ˜¯å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªè¿ç»­å­—ç¬¦åºåˆ—ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šs &#x3D; â€œabcaâ€è¾“å‡ºï¼š2è§£é‡Šï¼šæœ€ä¼˜çš„å­å­—ç¬¦ä¸²æ˜¯ â€œbcâ€ ã€‚ æ€è·¯ï¼šä½¿ç”¨å“ˆå¸Œè¡¨å­˜æ”¾æŸä¸ªå­—æ¯ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä¹‹åä¸åé¢å†æ¬¡å‡ºç°çš„å­—æ¯å¾—åˆ°å­—ä¸²é•¿åº¦ï¼Œæœ€åå¾—åˆ°æœ€é•¿çš„å­—ä¸²é•¿åº¦ ä»£ç (cpp)ï¼š1234567891011121314151617181920class Solution &#123;public: unordered_map&lt;char, int&gt; map; int maxLengthBetweenEqualCharacters(string s) &#123; int ans = -1; for(int i = 0; i &lt; s.size(); i++)&#123; auto it = map.find(s[i]); if(it == map.end())&#123; map.emplace(s[i], i); &#125; else &#123; int temp = i - 1 - it-&gt;second; ans = max(temp, ans); &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n è¡¨ç¤ºå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚æˆ‘ä»¬åªéœ€éå†ä¸€éå­—ç¬¦ä¸²å³å¯ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(âˆ£Î£âˆ£)ï¼Œå…¶ä¸­ Î£ æ˜¯å­—ç¬¦é›†ï¼Œåœ¨æœ¬é¢˜ä¸­å­—ç¬¦é›†ä¸ºæ‰€æœ‰å°å†™å­—æ¯ï¼Œâˆ£Î£âˆ£&#x3D;26ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)670. æœ€å¤§äº¤æ¢","slug":"æ¯æ—¥LeetCode/2022-9/670 æœ€å¤§äº¤æ¢","date":"2022-09-13T00:42:00.000Z","updated":"2022-09-13T00:42:46.437Z","comments":true,"path":"2022/09/13/æ¯æ—¥LeetCode/2022-9/670 æœ€å¤§äº¤æ¢/","link":"","permalink":"http://example.com/2022/09/13/%E6%AF%8F%E6%97%A5LeetCode/2022-9/670%20%E6%9C%80%E5%A4%A7%E4%BA%A4%E6%8D%A2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°ï¼Œä½ è‡³å¤šå¯ä»¥äº¤æ¢ä¸€æ¬¡æ•°å­—ä¸­çš„ä»»æ„ä¸¤ä½ã€‚è¿”å›ä½ èƒ½å¾—åˆ°çš„æœ€å¤§å€¼ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: 2736è¾“å‡º: 7236è§£é‡Š: äº¤æ¢æ•°å­—2å’Œæ•°å­—7ã€‚ æ€è·¯ï¼šéå†å…ˆç”¨ç¬¬ä¸€ä¸ªæ•°å­—ä¸åé¢çš„æ•°å­—æ¯”è¾ƒï¼Œæ‰¾å‡ºæœ€å¤§çš„å¹¶ä¸”å¤§äºç¬¬ä¸€ä¸ªæ•°å­—ï¼Œæœªæ‰¾åˆ°ï¼Œåˆ™ç”¨ç¬¬äºŒä¸ªæ•°å­—ä¸åé¢çš„æ•°å­—æ¯”è¾ƒ ä¾æ¬¡éå†ï¼Œç›´åˆ°æ‰¾åˆ°æœ‰æ¯”æ‰€æ¯”è¾ƒçš„æ•°å­—å¤§çš„æ•°å­—åäº¤æ¢ä½ç½®ï¼Œè¿”å›äº¤æ¢åçš„æ•°å­— å¦‚æœéå†å®Œå…¨åï¼Œæœªæ‰¾åˆ°ï¼Œåˆ™è¯´æ˜ï¼Œæ­¤æ•°å­—å·²ç»ä¸ºæœ€å¤§æ•°ï¼Œç›´æ¥è¿”å› ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: int maximumSwap(int num) &#123; string str = to_string(num); for(int i = 0; i &lt; str.size(); i++)&#123; int temp = i; for(int j = str.size() - 1; j &gt;= i + 1; j--)&#123; if(str[temp] &lt; str[j])&#123; temp = j; &#125; &#125; if(temp != i)&#123; swap(str[i], str[temp]); int ans = stoi(str); return ans; &#125; &#125; return num; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2) ç©ºé—´å¤æ‚åº¦ï¼šO(n)","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1608. ç‰¹æ®Šæ•°ç»„çš„ç‰¹å¾å€¼","slug":"æ¯æ—¥LeetCode/2022-9/1608 ç‰¹æ®Šæ•°ç»„çš„ç‰¹å¾å€¼","date":"2022-09-12T01:12:00.000Z","updated":"2022-09-12T01:12:09.046Z","comments":true,"path":"2022/09/12/æ¯æ—¥LeetCode/2022-9/1608 ç‰¹æ®Šæ•°ç»„çš„ç‰¹å¾å€¼/","link":"","permalink":"http://example.com/2022/09/12/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1608%20%E7%89%B9%E6%AE%8A%E6%95%B0%E7%BB%84%E7%9A%84%E7%89%B9%E5%BE%81%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ nums ã€‚å¦‚æœå­˜åœ¨ä¸€ä¸ªæ•° x ï¼Œä½¿å¾— nums ä¸­æ°å¥½æœ‰ x ä¸ªå…ƒç´  å¤§äºæˆ–è€…ç­‰äº x ï¼Œé‚£ä¹ˆå°±ç§° nums æ˜¯ä¸€ä¸ª ç‰¹æ®Šæ•°ç»„ ï¼Œè€Œ x æ˜¯è¯¥æ•°ç»„çš„ ç‰¹å¾å€¼ ã€‚ æ³¨æ„ï¼š x ä¸å¿… æ˜¯ nums çš„ä¸­çš„å…ƒç´ ã€‚ å¦‚æœæ•°ç»„ nums æ˜¯ä¸€ä¸ª ç‰¹æ®Šæ•°ç»„ ï¼Œè¯·è¿”å›å®ƒçš„ç‰¹å¾å€¼ x ã€‚å¦åˆ™ï¼Œè¿”å› -1 ã€‚å¯ä»¥è¯æ˜çš„æ˜¯ï¼Œå¦‚æœ nums æ˜¯ç‰¹æ®Šæ•°ç»„ï¼Œé‚£ä¹ˆå…¶ç‰¹å¾å€¼ x æ˜¯ å”¯ä¸€çš„ ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [3,5]è¾“å‡ºï¼š2è§£é‡Šï¼šæœ‰ 2 ä¸ªå…ƒç´ ï¼ˆ3 å’Œ 5ï¼‰å¤§äºæˆ–ç­‰äº 2 ã€‚ ä»£ç (cpp)ï¼šæš´åŠ›æšä¸¾12345678910111213141516171819class Solution &#123;public: int specialArray(vector&lt;int&gt;&amp; nums) &#123; int size = nums.size(); for(int i = 0; i &lt;= size; i++)&#123; int count = 0; for(int j = 0; j &lt; size; j++)&#123; if(nums[j] &gt;= i)&#123; count++; &#125; &#125; if(count == i)&#123; return i; &#125; &#125; return -1; &#125;&#125;; æ€è·¯ï¼šé™åºæ’åº+ä¸€æ¬¡éå†å…ˆå°†numsæ•°ç»„é™åºæ’åºï¼Œ å…ˆä»¥x = 0ä¸ºä¾‹ï¼šè¿™å°±è¯´æ˜numsæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ä»¥åŠä¹‹åçš„éƒ½è¦å°äºx x = 1æ—¶ï¼šnumsæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ è¦å¤§äºç­‰äºxï¼Œä¹‹åçš„è¦å°äºx x = 2æ—¶ï¼šnumsæ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ è¦å¤§äºç­‰äºx(å› ä¸ºæ˜¯é™åºæ‰€ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ è‚¯å®šå¤§äºx)ï¼Œä¹‹åçš„è¦å°äºx ç»“è®ºï¼šnums[x-1] &gt;= xå¹¶ä¸”num[x] &lt; x ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: int specialArray(vector&lt;int&gt;&amp; nums) &#123; int size = nums.size(); //é™åºæ’åˆ— sort(nums.begin(), nums.end(), greater&lt;int&gt;()); for(int x = 0; x &lt;= size; x++)&#123; //å¦‚æœå­˜åœ¨nums[x-1] &lt; xçš„æƒ…å†µï¼Œè·³å‡ºæ­¤æ¬¡éå†ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ª if(x-1 &gt;=0 &amp;&amp; nums[x-1] &lt; x)&#123; break; &#125; //å¦‚æœnum[x] &lt; xï¼Œè¿”å›x if(x == size || nums[x] &lt; i)&#123; return x; &#125; &#125; return -1; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ nums çš„é•¿åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå³ä¸ºæ’åºéœ€è¦çš„æ ˆç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1619. åˆ é™¤æŸäº›å…ƒç´ åçš„æ•°ç»„å‡å€¼","slug":"æ¯æ—¥LeetCode/2022-9/1619 åˆ é™¤æŸäº›å…ƒç´ åçš„æ•°ç»„å‡å€¼","date":"2022-09-12T01:12:00.000Z","updated":"2022-09-14T02:37:02.282Z","comments":true,"path":"2022/09/12/æ¯æ—¥LeetCode/2022-9/1619 åˆ é™¤æŸäº›å…ƒç´ åçš„æ•°ç»„å‡å€¼/","link":"","permalink":"http://example.com/2022/09/12/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1619%20%E5%88%A0%E9%99%A4%E6%9F%90%E4%BA%9B%E5%85%83%E7%B4%A0%E5%90%8E%E7%9A%84%E6%95%B0%E7%BB%84%E5%9D%87%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ arr ï¼Œè¯·ä½ åˆ é™¤æœ€å° 5% çš„æ•°å­—å’Œæœ€å¤§ 5% çš„æ•°å­—åï¼Œå‰©ä½™æ•°å­—çš„å¹³å‡å€¼ã€‚ ä¸ æ ‡å‡†ç­”æ¡ˆ è¯¯å·®åœ¨ 10^(-5) çš„ç»“æœéƒ½è¢«è§†ä¸ºæ­£ç¡®ç»“æœã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šarr &#x3D; [1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3]è¾“å‡ºï¼š2.00000è§£é‡Šï¼šåˆ é™¤æ•°ç»„ä¸­æœ€å¤§å’Œæœ€å°çš„å…ƒç´ åï¼Œæ‰€æœ‰å…ƒç´ éƒ½ç­‰äº 2ï¼Œæ‰€ä»¥å¹³å‡å€¼ä¸º 2 ã€‚ æ€è·¯ï¼šå°†sizeè®¾ä¸ºæ•°ç»„çš„å…ƒç´ ä¸ªæ•° å°†æ•°ç»„æ’åºåï¼Œå°†å·¦è¾¹size*0.05ä¸ªå…ƒç´ åˆ é™¤ï¼Œå¹¶ä¸”å°†å³è¾¹size*0.05ä¸ªå…ƒç´ åˆ é™¤ å†è®¡ç®—å‡ºæ€»å’Œé™¤ä»¥size*0.9ä¸ªå…ƒç´ (åˆ é™¤å·¦å³ä¸¤è¾¹å„size*0.05ä¸ªå…ƒç´ ï¼Œè¿˜å‰©size*0.9ä¸ªå…ƒç´ ) è¿”å›å¹³å‡æ•° ä»£ç (cpp)ï¼š1234567891011121314class Solution &#123;public: double trimMean(vector&lt;int&gt;&amp; arr) &#123; sort(arr.begin(), arr.end()); int size = arr.size(); int temp = int(size * 0.05); int sum = 0; for(int i = temp; i &lt; size - temp; i++)&#123; sum += arr[i]; &#125; double ans = sum / (size*0.9); return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ã€‚æ’åºéœ€è¦ O(logn) çš„æ ˆç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)669. ä¿®å‰ªäºŒå‰æœç´¢æ ‘","slug":"æ¯æ—¥LeetCode/2022-9/669 ä¿®å‰ªäºŒå‰æœç´¢æ ‘","date":"2022-09-10T01:35:00.000Z","updated":"2022-09-10T01:35:18.888Z","comments":true,"path":"2022/09/10/æ¯æ—¥LeetCode/2022-9/669 ä¿®å‰ªäºŒå‰æœç´¢æ ‘/","link":"","permalink":"http://example.com/2022/09/10/%E6%AF%8F%E6%97%A5LeetCode/2022-9/669%20%E4%BF%AE%E5%89%AA%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ äºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼ŒåŒæ—¶ç»™å®šæœ€å°è¾¹ç•Œlow å’Œæœ€å¤§è¾¹ç•Œ highã€‚é€šè¿‡ä¿®å‰ªäºŒå‰æœç´¢æ ‘ï¼Œä½¿å¾—æ‰€æœ‰èŠ‚ç‚¹çš„å€¼åœ¨[low, high]ä¸­ã€‚ä¿®å‰ªæ ‘ ä¸åº”è¯¥ æ”¹å˜ä¿ç•™åœ¨æ ‘ä¸­çš„å…ƒç´ çš„ç›¸å¯¹ç»“æ„ (å³ï¼Œå¦‚æœæ²¡æœ‰è¢«ç§»é™¤ï¼ŒåŸæœ‰çš„çˆ¶ä»£å­ä»£å…³ç³»éƒ½åº”å½“ä¿ç•™)ã€‚ å¯ä»¥è¯æ˜ï¼Œå­˜åœ¨ å”¯ä¸€çš„ç­”æ¡ˆ ã€‚ æ‰€ä»¥ç»“æœåº”å½“è¿”å›ä¿®å‰ªå¥½çš„äºŒå‰æœç´¢æ ‘çš„æ–°çš„æ ¹èŠ‚ç‚¹ã€‚æ³¨æ„ï¼Œæ ¹èŠ‚ç‚¹å¯èƒ½ä¼šæ ¹æ®ç»™å®šçš„è¾¹ç•Œå‘ç”Ÿæ”¹å˜ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [3,0,4,null,2,null,null,1], low &#x3D; 1, high &#x3D; 3è¾“å‡ºï¼š[3,2,null,1] æ€è·¯ï¼šDFSé€šè¿‡æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œæ‰¾å‡ºä¸ç¬¦åˆ[low, high]åŒºé—´çš„ç»“ç‚¹ï¼Œå¹¶å‰”é™¤ äºŒå‰å¹³è¡¡æ ‘çš„æ€§è´¨ï¼šçˆ¶èŠ‚ç‚¹å¤§äºå·¦å­æ ‘ï¼Œå°äºå³å­æ ‘ å¦‚æœæœ‰èŠ‚ç‚¹å­˜åœ¨ï¼Œvalå€¼å°äºlowå€¼ï¼Œåˆ™è¯´æ˜è¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼Œä¹Ÿå‡å°äºlowå€¼ åŒç†ï¼Œå¦‚æœæœ‰èŠ‚ç‚¹å­˜åœ¨ï¼Œvalå€¼å¤§äºhighå€¼ï¼Œåˆ™è¯´æ˜è¯¥èŠ‚ç‚¹çš„å³å­æ ‘ï¼Œä¹Ÿå‡å¤§äºhighå€¼ ä»£ç (cpp)ï¼š1234567891011121314151617181920class Solution1 &#123;public: TreeNode* trimBST(TreeNode* root, int low, int high) &#123; //æ‰¾åˆ°ç¬¦åˆåŒºé—´çš„ç»“ç‚¹ while(root != nullptr)&#123; if(root-&gt;val &lt; low) root = root-&gt;right; else if(root-&gt;val &gt; high) root = root-&gt;left; else break; &#125; //éå†å·¦å³å­æ ‘ if(root != nullptr)&#123; root-&gt;left = trimBST(root-&gt;left, low, high); root-&gt;right = trimBST(root-&gt;right, low, high); &#125; return root; &#125;&#125;; å®˜æ–¹ä»£ç (cpp)ï¼š12345678910111213141516171819class Solution &#123;public: TreeNode* trimBST(TreeNode* root, int low, int high) &#123; if (root == nullptr) return nullptr; //å°äºlowçš„æƒ…å†µ if (root-&gt;val &lt; low) //è¿”å›è¯¥èŠ‚ç‚¹çš„å³å­æ ‘ return trimBST(root-&gt;right, low, high); //å¤§äºhighçš„æƒ…å†µ else if (root-&gt;val &gt; high) //è¿”å›è¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘ return trimBST(root-&gt;left, low, high); //éå†å·¦å³å­æ ‘ root-&gt;left = trimBST(root-&gt;left, low, high); root-&gt;right = trimBST(root-&gt;right, low, high); return root; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘çš„ç»“ç‚¹æ•°ç›®ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚é€’å½’æ ˆæœ€åæƒ…å†µä¸‹éœ€è¦ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"","slug":"è½¯ä»¶å®‰è£…/Dockerå®‰è£…Nacos","date":"2022-09-09T03:52:41.536Z","updated":"2022-09-12T02:24:30.593Z","comments":true,"path":"2022/09/09/è½¯ä»¶å®‰è£…/Dockerå®‰è£…Nacos/","link":"","permalink":"http://example.com/2022/09/09/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/Docker%E5%AE%89%E8%A3%85Nacos/","excerpt":"","text":"1.å®‰è£…Nacos1.1 æœç´¢Nacosé•œåƒ1docker search nacos 1.2 æ‹‰å–Nacosé•œåƒ1docker pull nacos/nacos-server 1.3 å¯åŠ¨Nacoså®¹å™¨1234567docker run -id \\--name c_nacos \\-p 8848:8848 \\--privileged=true \\-e MODE=standalone \\-e PREFER_HOST_MODE=hostname \\nacos/nacos-server:latest å‚æ•°ï¼š --privileged=trueï¼šä½¿å®¹å™¨å†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™ 1.4 æµ‹è¯•è®¿é—®ï¼šhttp://ä¸»æœºåœ°å€:8848/nacos/index.html 2.æ­å»ºNacosé›†ç¾¤2.1 æ‹‰å–mysqlé•œåƒ 1docker pull mysql 2.2 æ‹‰å–","categories":[],"tags":[]},{"title":"(æ¯æ—¥LeetCode)1598. æ–‡ä»¶å¤¹æ“ä½œæ—¥å¿—æœé›†å™¨","slug":"æ¯æ—¥LeetCode/2022-9/1598 æ–‡ä»¶å¤¹æ“ä½œæ—¥å¿—æœé›†å™¨","date":"2022-09-09T01:07:00.000Z","updated":"2022-09-09T01:07:42.354Z","comments":true,"path":"2022/09/09/æ¯æ—¥LeetCode/2022-9/1598 æ–‡ä»¶å¤¹æ“ä½œæ—¥å¿—æœé›†å™¨/","link":"","permalink":"http://example.com/2022/09/09/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1598%20%E6%96%87%E4%BB%B6%E5%A4%B9%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97%E6%90%9C%E9%9B%86%E5%99%A8/","excerpt":"","text":"é¢˜ç›®ï¼šæ¯å½“ç”¨æˆ·æ‰§è¡Œå˜æ›´æ–‡ä»¶å¤¹æ“ä½œæ—¶ï¼ŒLeetCode æ–‡ä»¶ç³»ç»Ÿéƒ½ä¼šä¿å­˜ä¸€æ¡æ—¥å¿—è®°å½•ã€‚ ä¸‹é¢ç»™å‡ºå¯¹å˜æ›´æ“ä½œçš„è¯´æ˜ï¼š &quot;../&quot; ï¼šç§»åŠ¨åˆ°å½“å‰æ–‡ä»¶å¤¹çš„çˆ¶æ–‡ä»¶å¤¹ã€‚å¦‚æœå·²ç»åœ¨ä¸»æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ™ ç»§ç»­åœç•™åœ¨å½“å‰æ–‡ä»¶å¤¹ ã€‚ &quot;./&quot; ï¼šç»§ç»­åœç•™åœ¨å½“å‰æ–‡ä»¶å¤¹ã€‚ &quot;x/&quot; ï¼šç§»åŠ¨åˆ°åä¸º x çš„å­æ–‡ä»¶å¤¹ä¸­ã€‚é¢˜ç›®æ•°æ® ä¿è¯æ€»æ˜¯å­˜åœ¨æ–‡ä»¶å¤¹ x ã€‚ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ logs ï¼Œå…¶ä¸­ logs[i] æ˜¯ç”¨æˆ·åœ¨ i^th æ­¥æ‰§è¡Œçš„æ“ä½œã€‚ æ–‡ä»¶ç³»ç»Ÿå¯åŠ¨æ—¶ä½äºä¸»æ–‡ä»¶å¤¹ï¼Œç„¶åæ‰§è¡Œ logs ä¸­çš„æ“ä½œã€‚ æ‰§è¡Œå®Œæ‰€æœ‰å˜æ›´æ–‡ä»¶å¤¹æ“ä½œåï¼Œè¯·ä½ æ‰¾å‡º è¿”å›ä¸»æ–‡ä»¶å¤¹æ‰€éœ€çš„æœ€å°æ­¥æ•° ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šlogs &#x3D; [â€œd1&#x2F;â€œ,â€d2&#x2F;â€œ,â€..&#x2F;â€œ,â€d21&#x2F;â€œ,â€.&#x2F;â€œ]è¾“å‡ºï¼š2è§£é‡Šï¼šæ‰§è¡Œ â€œ..&#x2F;â€œ æ“ä½œå˜æ›´æ–‡ä»¶å¤¹ 2 æ¬¡ï¼Œå³å¯å›åˆ°ä¸»æ–‡ä»¶å¤¹ æ€è·¯ï¼šæ ˆæ¨¡æ‹Ÿä»£ç (cpp)ï¼š1234567891011121314151617181920class Solution &#123;public: int minOperations(vector&lt;string&gt;&amp; logs) &#123; stack&lt;string&gt; s; for(auto&amp; log : logs)&#123; if(log == &quot;../&quot;)&#123; if(!s.empty())&#123; s.pop(); &#125; &#125; else if(log == &quot;./&quot;)&#123; continue; &#125; else &#123; s.emplace(log); &#125; &#125; return s.size(); &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n å­—ç¬¦ä¸²æ•°ç»„çš„é•¿åº¦ã€‚åªéœ€éå†ä¸€éå­—ç¬¦ä¸²æ•°ç»„å³å¯ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1592. é‡æ–°æ’åˆ—å•è¯é—´çš„ç©ºæ ¼","slug":"æ¯æ—¥LeetCode/2022-9/1592 é‡æ–°æ’åˆ—å•è¯é—´çš„ç©ºæ ¼","date":"2022-09-07T02:59:00.000Z","updated":"2022-09-07T02:59:51.599Z","comments":true,"path":"2022/09/07/æ¯æ—¥LeetCode/2022-9/1592 é‡æ–°æ’åˆ—å•è¯é—´çš„ç©ºæ ¼/","link":"","permalink":"http://example.com/2022/09/07/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1592%20%E9%87%8D%E6%96%B0%E6%8E%92%E5%88%97%E5%8D%95%E8%AF%8D%E9%97%B4%E7%9A%84%E7%A9%BA%E6%A0%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² text ï¼Œè¯¥å­—ç¬¦ä¸²ç”±è‹¥å¹²è¢«ç©ºæ ¼åŒ…å›´çš„å•è¯ç»„æˆã€‚æ¯ä¸ªå•è¯ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆï¼Œå¹¶ä¸”ä¸¤ä¸ªå•è¯ä¹‹é—´è‡³å°‘å­˜åœ¨ä¸€ä¸ªç©ºæ ¼ã€‚é¢˜ç›®æµ‹è¯•ç”¨ä¾‹ä¿è¯ text è‡³å°‘åŒ…å«ä¸€ä¸ªå•è¯ ã€‚ è¯·ä½ é‡æ–°æ’åˆ—ç©ºæ ¼ï¼Œä½¿æ¯å¯¹ç›¸é‚»å•è¯ä¹‹é—´çš„ç©ºæ ¼æ•°ç›®éƒ½ ç›¸ç­‰ ï¼Œå¹¶å°½å¯èƒ½ æœ€å¤§åŒ– è¯¥æ•°ç›®ã€‚å¦‚æœä¸èƒ½é‡æ–°å¹³å‡åˆ†é…æ‰€æœ‰ç©ºæ ¼ï¼Œè¯· å°†å¤šä½™çš„ç©ºæ ¼æ”¾ç½®åœ¨å­—ç¬¦ä¸²æœ«å°¾ ï¼Œè¿™ä¹Ÿæ„å‘³ç€è¿”å›çš„å­—ç¬¦ä¸²åº”å½“ä¸åŸ text å­—ç¬¦ä¸²çš„é•¿åº¦ç›¸ç­‰ã€‚ è¿”å› é‡æ–°æ’åˆ—ç©ºæ ¼åçš„å­—ç¬¦ä¸² ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼štext &#x3D; â€œ this is a sentence â€œè¾“å‡ºï¼šâ€this is a sentenceâ€è§£é‡Šï¼šæ€»å…±æœ‰ 9 ä¸ªç©ºæ ¼å’Œ 4 ä¸ªå•è¯ã€‚å¯ä»¥å°† 9 ä¸ªç©ºæ ¼å¹³å‡åˆ†é…åˆ°ç›¸é‚»å•è¯ä¹‹é—´ï¼Œç›¸é‚»å•è¯é—´ç©ºæ ¼æ•°ä¸ºï¼š9 &#x2F; (4-1) &#x3D; 3 ä¸ªã€‚ ä»£ç (cpp)ï¼šæ„Ÿè§‰åƒå±å±±ï¼Œä¸ç¡®å®šæˆ‘åœ¨çœ‹çœ‹~ 1234567891011121314151617181920212223242526272829303132333435363738394041424344class Solution &#123;public: string reorderSpaces(string text) &#123; vector&lt;string&gt; str; int count = 0; //ç©ºæ ¼æ•°åˆå§‹åŒ–ä¸º0 string temp = &quot;&quot;; //åˆå§‹åŒ–å•è¯ä¸ºç©º for(int i = 0; i &lt; text.size(); i++) &#123; if(text[i] == &#x27; &#x27;) &#123; //å¦‚æœæ˜¯ç©ºæ ¼ //tempä¸ä¸ºç©ºï¼Œæ’å…¥strï¼Œå¹¶å°†tempç½®ç©ºï¼Œè·å–ä¸‹ä¸€ä¸ªå•è¯ if(temp != &quot;&quot;)&#123; str.emplace_back(temp); temp = &quot;&quot;; &#125; count++; //ç©ºæ ¼æ•°åŠ 1 &#125; else &#123; //å¦‚æœä¸ä¸ºç©ºæ ¼ temp += text[i]; //æ·»åŠ å­—ç¬¦ //å¦‚æœå¤„åœ¨textå­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œç›´æ¥å°†tempæ’å…¥strä¸­ if(i == text.size() - 1)&#123; str.emplace_back(temp); &#125; &#125; &#125; int num = 0; //åˆå§‹åŒ–ä¸¤ä¸ªå•è¯ä¹‹é—´çš„ç©ºæ ¼æ•°ä¸º0 if(str.size() &gt; 1)&#123; //è·å–ä¸¤ä¸ªå•è¯ä¹‹é—´çš„ç©ºæ ¼æ•° num = count / (str.size()-1); &#125; //æ‹¼æ¥å­—ç¬¦ä¸² string ans = str[0]; for(int i = 1; i &lt; str.size(); i++)&#123; //æ‹¼æ¥ ans += string(num, &#x27; &#x27;) + str[i]; count -= num; //å‰©ä½™çš„ç©ºæ ¼æ•° &#125; //å°†å‰©ä½™çš„ç©ºæ ¼åŠ åˆ°ansçš„æœ«å°¾ ans += string(count, &#x27; &#x27;); return ans; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)652. å¯»æ‰¾é‡å¤çš„å­æ ‘","slug":"æ¯æ—¥LeetCode/2022-9/652 å¯»æ‰¾é‡å¤çš„å­æ ‘","date":"2022-09-05T00:28:00.000Z","updated":"2022-09-05T00:51:43.629Z","comments":true,"path":"2022/09/05/æ¯æ—¥LeetCode/2022-9/652 å¯»æ‰¾é‡å¤çš„å­æ ‘/","link":"","permalink":"http://example.com/2022/09/05/%E6%AF%8F%E6%97%A5LeetCode/2022-9/652%20%E5%AF%BB%E6%89%BE%E9%87%8D%E5%A4%8D%E7%9A%84%E5%AD%90%E6%A0%91/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€æ£µäºŒå‰æ ‘ rootï¼Œè¿”å›æ‰€æœ‰é‡å¤çš„å­æ ‘ã€‚ å¯¹äºåŒä¸€ç±»çš„é‡å¤å­æ ‘ï¼Œä½ åªéœ€è¦è¿”å›å…¶ä¸­ä»»æ„ä¸€æ£µçš„æ ¹ç»“ç‚¹å³å¯ã€‚ å¦‚æœä¸¤æ£µæ ‘å…·æœ‰ç›¸åŒçš„ç»“æ„å’Œç›¸åŒçš„ç»“ç‚¹å€¼ï¼Œåˆ™å®ƒä»¬æ˜¯é‡å¤çš„ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [2,2,2,3,null,3,null]è¾“å‡ºï¼š[[2,3],[3]] æ€è·¯ï¼šé€’å½’é€šè¿‡é€’å½’è·å–æ¯ä¸€æ®µçš„å­æ ‘çš„å­—ç¬¦ä¸² å¦‚æœå“ˆå¸Œè¡¨ä¸­ä¸å­˜åœ¨æ­¤å­—ç¬¦ä¸²ï¼Œåˆ™æ’å…¥ï¼Œå­˜åœ¨æ­¤å­—ç¬¦ä¸²ï¼Œè¯´æ˜æ­¤å­—ç¬¦ä¸²å­˜åœ¨é‡å¤çš„å­æ ‘ ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425class Solution &#123;public: unordered_set&lt;TreeNode*&gt; set; unordered_map&lt;string, TreeNode*&gt; map; string dfs(TreeNode* node)&#123; if(node == nullptr) return &quot;&quot;; //è·å–nodeç»“ç‚¹çš„å­æ ‘å­—ç¬¦ä¸² string str = to_string(node-&gt;val) + &quot;(&quot; + dfs(node-&gt;left) + &quot;)(&quot; + dfs(node-&gt;right) + &quot;)&quot;; //åœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥è¯¢ auto temp = map.find(str); if(temp != map.end()) //å­˜åœ¨ï¼Œåˆ™æ’å…¥åˆ°setä¸­ set.emplace(temp-&gt;second); else map[str] = node; //ä¸å­˜åœ¨ï¼Œæ’å…¥åˆ°å“ˆå¸Œè¡¨ä¸­ return str; &#125; vector&lt;TreeNode*&gt; findDuplicateSubtrees(TreeNode* root) &#123; dfs(root); //å°†setä¸­çš„å…ƒç´ æ‹·è´åˆ°vectorä¸­ return &#123;set.begin(), set.end()&#125;; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯æ ‘ä¸­èŠ‚ç‚¹çš„æ•°ç›®ã€‚åœ¨æœ€åæƒ…å†µä¸‹ï¼Œæ ‘å‘ˆç°é“¾çŠ¶çš„ç»“æ„ï¼Œè€Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä¼šåœ¨å…¶å·¦å³å­æ ‘åºåˆ—çš„åŸºç¡€ä¸Šå†å¢åŠ æœ€å¤š 99 ä¸ªå­—ç¬¦ï¼ˆä¸¤ç»„æ‹¬å·ä»¥åŠèŠ‚ç‚¹æœ¬èº«çš„å€¼ï¼‰ï¼Œé‚£ä¹ˆæ‰€æœ‰å­æ ‘çš„åºåˆ—é•¿åº¦ä¹‹å’Œä¸º $\\sum_{i&#x3D;1}^n$ 9n &#x3D; O(n^2)ã€‚æ„é€ å‡ºè¿™äº›åºåˆ—å°±éœ€è¦ O(n^2) çš„æ—¶é—´ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå³ä¸ºå“ˆå¸Œè¡¨éœ€è¦ä½¿ç”¨çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1582. äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„ç‰¹æ®Šä½ç½®","slug":"æ¯æ—¥LeetCode/2022-9/1582 äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„ç‰¹æ®Šä½ç½®","date":"2022-09-04T01:21:00.000Z","updated":"2022-09-04T01:21:39.244Z","comments":true,"path":"2022/09/04/æ¯æ—¥LeetCode/2022-9/1582 äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„ç‰¹æ®Šä½ç½®/","link":"","permalink":"http://example.com/2022/09/04/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1582%20%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%9F%A9%E9%98%B5%E4%B8%AD%E7%9A%84%E7%89%B9%E6%AE%8A%E4%BD%8D%E7%BD%AE/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªå¤§å°ä¸º rows x cols çš„çŸ©é˜µ matï¼Œå…¶ä¸­ mat[i][j] æ˜¯ 0 æˆ– 1ï¼Œè¯·è¿”å› çŸ©é˜µ mat ä¸­ç‰¹æ®Šä½ç½®çš„æ•°ç›® ã€‚ ç‰¹æ®Šä½ç½® å®šä¹‰ï¼šå¦‚æœ mat[i][j] &#x3D;&#x3D; 1 å¹¶ä¸”ç¬¬ i è¡Œå’Œç¬¬ j åˆ—ä¸­çš„æ‰€æœ‰å…¶ä»–å…ƒç´ å‡ä¸º 0ï¼ˆè¡Œå’Œåˆ—çš„ä¸‹æ ‡å‡ ä» 0 å¼€å§‹ ï¼‰ï¼Œåˆ™ä½ç½® (i, j) è¢«ç§°ä¸ºç‰¹æ®Šä½ç½®ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šmat &#x3D; [[1,0,0], [0,0,1], [1,0,0]]è¾“å‡ºï¼š1è§£é‡Šï¼š(1,2) æ˜¯ä¸€ä¸ªç‰¹æ®Šä½ç½®ï¼Œå› ä¸º mat[1][2] &#x3D;&#x3D; 1 ä¸”æ‰€å¤„çš„è¡Œå’Œåˆ—ä¸Šæ‰€æœ‰å…¶ä»–å…ƒç´ éƒ½æ˜¯ 0 æ€è·¯ï¼šæ¨¡æ‹Ÿè·å–matæ•°ç»„ä¸­çš„æ¯è¡ŒiåŠæ¯åˆ—jçš„1å…ƒç´ çš„æ€»ä¸ªæ•°rowã€column å¦‚æœæŸiè¡Œåªæœ‰ä¸€ä¸ª1å…ƒç´ ï¼ŒæŸjåˆ—ä¹Ÿåªæœ‰ä¸€ä¸ª1å…ƒç´ ï¼Œå¹¶ä¸”è¯¥è¡Œåˆ—åœ¨matæ•°ç»„ä¸­å­˜åœ¨ä¸º1 è¯´æ˜mat[i][j]æ‰€å¤„çš„è¡Œå’Œåˆ—ä¸Šæ‰€æœ‰å…¶ä»–å…ƒç´ éƒ½æ˜¯ 0 ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526class Solution &#123;public: int numSpecial(vector&lt;vector&lt;int&gt;&gt;&amp; mat) &#123; int n = mat.size(); //è·å–è¡Œæ•° int m = mat[0].size(); //è·å–åˆ—æ•° vector&lt;int&gt; row(n); vector&lt;int&gt; column(m); for(int i = 0; i &lt; n; i++)&#123; for(int j = 0; j &lt; m; j++)&#123; row[i] += mat[i][j]; //è·å–æ¯è¡Œçš„1å…ƒç´ çš„æ€»ä¸ªæ•° column[j] += mat[i][j]; //è·å–æ¯åˆ—çš„1å…ƒç´ çš„æ€»ä¸ªæ•° &#125; &#125; int ans = 0; for(int i = 0; i &lt; n; i++)&#123; for(int j = 0; j &lt; m; j++)&#123; //å¦‚æœiè¡Œåªæœ‰ä¸€ä¸ª1ï¼Œjåˆ—åªæœ‰ä¸€ä¸ª1ï¼Œå¹¶ä¸”matæ•°ç»„iè¡Œjåˆ—ä¸º1 if(mat[i][j] == 1 &amp;&amp; row[i] == 1 &amp;&amp; column[j] == 1)&#123; ans++; &#125; &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(mÃ—n)ï¼Œå…¶ä¸­ m ä¸ºçŸ©é˜µ mat çš„è¡Œæ•°ï¼Œn ä¸ºçŸ©é˜µ mat çš„åˆ—æ•°ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(m+n)ï¼Œä¸»è¦ä¸ºé¢„å¤„ç†æ¯ä¸€è¡Œå’Œåˆ—çš„ç©ºé—´å¼€é”€ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"C++11çš„å­¦ä¹ ç¬”è®°","slug":"C++/C++11ç‰¹æ€§","date":"2022-09-03T03:49:33.141Z","updated":"2022-09-27T14:06:55.074Z","comments":true,"path":"2022/09/03/C++/C++11ç‰¹æ€§/","link":"","permalink":"http://example.com/2022/09/03/C++/C++11%E7%89%B9%E6%80%A7/","excerpt":"","text":"C++11 ç®€ä»‹C++11æ˜¯å¯¹ç›®å‰C++è¯­è¨€çš„æ‰©å±•ä¸ä¿®æ­£ï¼ŒC++11ä¸ä»…åŒ…å«æ ¸å¿ƒè¯­è¨€çš„æ–°æœºèƒ½ï¼Œè€Œä¸”æ‹“å±•äº†C++çš„æ ‡å‡†åº“(STL)ï¼Œå¹¶å…¥äº†å¤§éƒ¨åˆ†çš„C++Trehnical Report 1(TR1)ç¨‹åºåº“ã€‚ C++11åŒ…æ‹¬çš„æ–°ç‰¹æ€§ï¼ŒåŒ…æ‹¬ï¼šlambdaè¡¨è¾¾å¼ã€ç±»å‹æ¨å¯¼å…³é”®å­—autoã€decltypeä»¥åŠæ¨¡æ¿çš„å¤§é‡æ”¹è¿› 1.ç±»å‹æ¨å¯¼1.1 autoåœ¨Cä¸­ï¼Œautoä¿®é¥°å±€éƒ¨å˜é‡ï¼Œå±€éƒ¨å˜é‡ä¹Ÿå«autoå˜é‡ï¼Œè‡ªåŠ¨å˜é‡ è€Œåœ¨C++11ä¸­ï¼Œautoæ ¹æ®ç”¨æˆ·åˆå§‹åŒ–æ•°æ®ç±»å‹è‡ªåŠ¨æ¨å¯¼ ä¸¾ä¾‹å‰ï¼Œéœ€è¦å¼•å…¥typeinfoï¼š 1#include &lt;typeinfo&gt; å…¶ä¸­ä¸‹é¢çš„å‡½æ•°å¯è¿”å›açš„æ•°æ®ç±»å‹çš„å­—ç¬¦ä¸²å½¢å¼ï¼š 1typeid(a).name(); 1. 1234567891011121314#include&lt;iostream&gt;#include &lt;typeinfo&gt;using namespace std;void main()&#123; int a = 1; auto b = 2; //bçš„æ•°æ®ç±»å‹è‡ªåŠ¨æ¨å¯¼ä¸ºint cout &lt;&lt; typeid(b).name() &lt;&lt; endl; auto c = 2.5; //cçš„æ•°æ®ç±»å‹è‡ªåŠ¨æ¨å¯¼ä¸ºdouble cout &lt;&lt; typeid(c).name() &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 12intdouble 2. 123456789101112131415#include&lt;iostream&gt;#include &lt;typeinfo&gt;using namespace std;double fun()&#123; return 1.5;&#125;void main()&#123; auto a = fun(); //cçš„æ•°æ®ç±»å‹æ ¹æ®è¿”å›å€¼è‡ªåŠ¨æ¨å¯¼ä¸ºdouble cout &lt;&lt; typeid(a).name() &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 1double 3. 12345678910111213141516#include&lt;iostream&gt;#include &lt;typeinfo&gt;using namespace std;struct Test&#123; int a;&#125;;void main()&#123; Test t = &#123; 1 &#125;; //åˆå§‹åŒ–Testç»“æ„ä½“ a = 1 auto a = t; // dçš„æ•°æ®ç±»å‹è‡ªåŠ¨æ¨å¯¼ä¸ºTest cout &lt;&lt; typeid(a).name() &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 1&gt;struct Test ä¸¤ç§éå†æ–¹å¼ï¼š 12345678910111213141516171819#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;void fun1(vector&lt;int&gt;&amp; v)&#123; for (auto it = v.begin(); it != v.end(); it++) &#123; cout &lt;&lt; *it &lt;&lt; endl; &#125;&#125;void fun2(vector&lt;int&gt;&amp; v) &#123; for (auto&amp; i : v) &#123; cout &lt;&lt; i &lt;&lt; endl; &#125;&#125; æ³¨æ„ï¼š ä½¿ç”¨autoæ—¶ï¼Œæ•°æ®å¿…é¡»è¦åˆå§‹åŒ–ï¼š 12345void main()&#123; auto a; //æŠ¥é”™ a = 10;&#125; vsä¸æ”¯æŒå‡½æ•°å½¢å‚æ˜¯autoå˜é‡(éƒ¨åˆ†ç¼–è¯‘å™¨ä¼šæ”¯æŒ)ï¼š 1234void fun3(auto a) //æŠ¥é”™&#123;&#125; ä¸èƒ½ä½œä¸ºè‡ªå®šä¹‰ç±»å‹çš„æˆå‘˜å˜é‡ï¼š 123456struct Test&#123; int a; auto b; //æŠ¥é”™ auto c = 0; //æŠ¥é”™&#125;; autoä¸èƒ½ä½œä¸ºåˆå§‹åŒ–æ•°ç»„ï¼Œä½†æ˜¯å¯ä»¥èµ‹å€¼ï¼š 1234567891011#include&lt;iostream&gt;#include &lt;typeinfo&gt;using namespace std;void main()&#123; //auto a[3] = &#123; 1, 2, 3 &#125;; //æŠ¥é”™ int b[3] = &#123; 1, 2, 3 &#125;; auto c = b; cout &lt;&lt; typeid(c).name() &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 1int * __ptr64 æ¨¡æ¿å®ä¾‹åŒ–ä¸èƒ½æ˜¯autoç±»å‹ï¼š 1234567void main()&#123; //vector&lt;auto&gt; v1; //æŠ¥é”™ //vector&lt;auto&gt; v2 = &#123; 1 &#125;; //æŠ¥é”™ vector&lt;int&gt; v3 = &#123; 1 &#125;; auto v4 = v3; //æ­£å¸¸&#125; 1.2 decltypedecltype()ä¸autoç›¸åï¼Œå¯ä»¥è·å–açš„æ•°æ®ç±»å‹ï¼Œå¹¶ç”¨åšbçš„æ•°æ®ç±»å‹ 1decltype(a) b; 1. 12345678910#include&lt;iostream&gt;using namespace std;void main()&#123; int i; //decltype(i)ç­‰ä»·äºint decltype(i) j = 0; cout &lt;&lt; typeid(j).name() &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 1int 2. 1234567891011#include&lt;iostream&gt;#include&lt;typeinfo&gt;using namespace std;void main()&#123; float a; double b; decltype(a + b) c; cout &lt;&lt; typeid(c).name() &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 1&gt;double 3. 1234567891011121314151617#include&lt;iostream&gt;#include&lt;typeinfo&gt;#include&lt;vector&gt;using namespace std;void main()&#123; vector&lt;int&gt; v; decltype(v.begin()) it; //æ‰“å°è¿­ä»£å™¨æ•°æ®ç±»å‹ cout &lt;&lt; typeid(it).name() &lt;&lt; endl; for (it = v.begin(); it != v.end(); it++) &#123; //æ•°ç»„ä¸ºç©ºï¼Œæ— æ‰“å° cout &lt;&lt; *it &lt;&lt; endl; &#125;&#125; è¿è¡Œç»“æœï¼š 1&gt;class std::_Vector_iterator&lt;class std::_Vector_val&lt;struct std::_Simple_types&lt;int&gt; &gt; &gt; åŒ¿åæ•°æ®ç±»å‹ï¼š 1234567891011#include&lt;iostream&gt;#include&lt;typeinfo&gt;using namespace std;void main()&#123; //åŒ¿åç±»å‹çš„æšä¸¾å˜é‡ enum &#123;OK, Error&#125; flag; decltype(flag) flag2; cout &lt;&lt; typeid(flag2).name() &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 1enum `void __cdecl main(void)&#x27;::`2&#x27;::&lt;unnamed-type-flag&gt; 1.3 è·Ÿè¸ªè¿”å›ç±»å‹ æ­£å¸¸å†™å‡½æ•°ä»¥åŠè¿”å›å€¼ 1234double fun(int a, double b)&#123; return a + b;&#125; å¼•å…¥autoä½œä¸ºè¿”å›å€¼ï¼Œå¹¶æŒ‡å®šè¿”å›å€¼ä¸ºdoubleä¸ä¸Šé¢çš„å‡½æ•°æ•ˆæœç­‰ä»· 1234auto fun1(int a, double b) -&gt; double&#123; return a + b;&#125; è‡ªå®šä¹‰è¿”å›å€¼ 1234auto fun2(int a, double b) -&gt; decltype(a + b)&#123; return a + b;&#125; å¼•å…¥æ¨¡æ¿ 12345template&lt;class T1, class T2&gt;auto fun3(T1 a, T2 b) -&gt; decltype(a + b)&#123; return a + b;&#125; 2.æ˜“ç”¨æ€§æ”¹è¿›2.1 ç±»å†…æˆå‘˜åˆå§‹åŒ– ç±»ä¸­çš„æ•°æ®æˆå‘˜åœ¨ç”³æ˜æ—¶å¯ä»¥ç›´æ¥èµ‹äºˆä¸€ä¸ªé»˜è®¤å€¼ 12345678910111213141516171819202122#include&lt;string&gt;using namespace std;class A&#123;public: A(int a, int b) : a(a),b(b) //å‚æ•°åˆ—è¡¨åˆå§‹åŒ– &#123; &#125; int a = 10; //`=`ç­‰å·åˆå§‹åŒ–é»˜è®¤å€¼ int b&#123; 20 &#125;; //`&#123;&#125;`å¤§æ‹¬å·åˆå§‹åŒ–é»˜è®¤å€¼ string str1 = &quot;str1&quot;; //`=`ç­‰å·åˆå§‹åŒ–é»˜è®¤å€¼ //string str2(&quot;str2&quot;); //æŠ¥é”™ string str3&#123; &quot;str3&quot; &#125;; //`&#123;&#125;`å¤§æ‹¬å·åˆå§‹åŒ–é»˜è®¤å€¼&#125;;void main()&#123; A a&#123;1&#125;; //é€šè¿‡å¤§æ‹¬å·åˆå§‹åŒ–&#125; 2.2 åˆ—è¡¨åˆå§‹åŒ– åˆ—è¡¨åˆå§‹åŒ–(&#123;&#125;åˆå§‹åŒ–æ–¹å¼) 123456789101112131415161718192021#include&lt;iostream&gt;using namespace std;struct Test&#123; int age; double money; char name[20];&#125;;void main()&#123; Test t = &#123; 18, 64.8, &quot;Tom&quot; &#125;; int a = 1; int b = &#123; 1 &#125;; int c&#123; 1 &#125;; int arr1[] = &#123; 1, 2, 3 &#125;; int arr2[]&#123; 1, 2, 3 &#125;;&#125; ä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ–çš„æ–¹å¼å¯ä»¥é˜²æ­¢ç±»å‹æ”¶çª„(éšå¼è½¬æ¢å¯¼è‡´æ•°æ®ä¸¢å¤±) =èµ‹å€¼çš„æƒ…å†µï¼š 12345678910#include&lt;iostream&gt;using namespace std;void main()&#123; int a = 128; char b = a; cout &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; b &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 12&gt;128 //ä¸ºç©ºï¼Œæ•°æ®ä¸¢å¤±ã€‚cè¯­è¨€ä¸­asciiç æœ€å¤šèƒ½è¡¨ç¤º0~127ï¼Œå…±128ä¸ªå­—ç¬¦ &#123;&#125;èµ‹å€¼çš„æƒ…å†µï¼š 1234567void main()&#123; int a = 128; char b&#123; a &#125;; cout &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; b &lt;&lt; endl;&#125; vsè¿è¡ŒæŠ¥é”™ï¼šä»â€œintâ€è½¬æ¢åˆ°â€œcharâ€éœ€è¦æ”¶ç¼©è½¬æ¢ 2.3 forå¾ªç¯ forå¾ªç¯éå†æ•°ç»„ 12345678910111213#include&lt;iostream&gt;using namespace std;void main()&#123; int a[] = &#123; 1, 2, 3, 4, 5 &#125;; int size = sizeof(a) / sizeof(*a); //è·å–å…ƒç´ ä¸ªæ•° for (int i = 0; i &lt; size; i++) &#123; cout &lt;&lt; a[i] &lt;&lt; endl; &#125;&#125; åŸºäºèŒƒå›´çš„forå¾ªç¯ 123456789101112#include&lt;iostream&gt;using namespace std;void main()&#123; int a[] = &#123; 1, 2, 3, 4, 5 &#125;; for (auto&amp; temp : a) &#123; cout &lt;&lt; temp &lt;&lt; endl; &#125;&#125; è¿è¡Œç»“æœï¼š 1234512345 å®¹å™¨èŒƒå›´çš„foréå† 12345678910111213#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;void main()&#123; vector&lt;int&gt; v = &#123; 1, 2, 3, 4, 5 &#125;; for (auto&amp; temp : v) &#123; cout &lt;&lt; temp &lt;&lt; endl; &#125;&#125; æ³¨æ„ï¼š å®¹å™¨çš„èŒƒå›´çš„foréå†ï¼Œéœ€è¦å®¹å™¨å«æœ‰begin()å’Œend()æ‰å¯ä»¥ä½¿ç”¨ ä¾‹å¦‚ï¼šqueueã€stackç­‰å®¹å™¨æ— æ³•ä½¿ç”¨èŒƒå›´çš„foréå† 2.4 é™æ€æ–­è¨€C++æä¾›äº†è°ƒè¯•å·¥å…·assertï¼Œè¿™æ˜¯ä¸ªå®ï¼Œç”¨äºåœ¨è¿è¡Œé˜¶æ®µå¯¹æ–­è¨€è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ¡ä»¶ä¸ºtrueï¼Œæ‰§è¡Œç¨‹åºï¼Œå¦åˆ™è°ƒç”¨abort() ä½¿ç”¨assert()éœ€è¦å¯¼å…¥ï¼š 1#include &lt;cassert&gt; assert()æ–­è¨€ï¼š è¿è¡Œæ—¶æ£€æŸ¥æ¡ä»¶ æ¡ä»¶åº”ä¸ºå¸¸é‡ã€å˜é‡å‡å¯ 123456789101112#include&lt;iostream&gt;#include &lt;cassert&gt;using namespace std;void main()&#123; bool flag = false; //è¿è¡Œæ—¶æ£€æŸ¥æ¡ä»¶ï¼Œå¦‚æœä¸ºçœŸï¼Œç»§ç»­æ‰§è¡Œï¼›å¦åˆ™ä¸­æ–­ç¨‹åºï¼ŒæŠ¥é”™ assert(flag == true); cout &lt;&lt; &quot;hello assert&quot; &lt;&lt; endl;&#125; è¿è¡ŒæŠ¥é”™ï¼š 1Assertion failed: flag == true, file E:\\08_é™æ€æ–­è¨€.cpp, line 9 static_assert()é™æ€æ–­è¨€ï¼š ç¼–è¯‘æ—¶æ£€æŸ¥æ¡ä»¶ æ¡ä»¶åº”ä¸ºå¸¸é‡ï¼Œç¼–è¯‘é˜¶æ®µä¸ä¼šæœ‰å˜é‡ ä¸‹é¢ä¸ºï¼Œæ£€æŸ¥æ˜¯å¦ä¸ä¸º64ä½ç³»ç»Ÿï¼š 12345678910#include&lt;iostream&gt;#include &lt;cassert&gt;using namespace std;void main()&#123; static_assert(sizeof(void*) == 8, &quot;ä¸æ”¯æŒ64ä½ç³»ç»Ÿ&quot;); cout &lt;&lt; &quot;hello static_assert&quot; &lt;&lt; endl;&#125; 2.5 noexceptä¿®é¥°ç¬¦æŠ›å‡ºå¼‚å¸¸ï¼š 1234void fun1()&#123; throw 1; //æŠ›å‡ºå¼‚å¸¸&#125; ä¸è®©å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼š 12345//fun2å‡½æ•°ä¸èƒ½æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œè€å¼å†™æ³•ï¼Œåœ¨C++11ä¸­è¢«åºŸå¼ƒvoid fun2() throw()&#123;&#125; æ³¨æ„ï¼šæ­¤å†™æ³•ï¼Œåœ¨C++11ä¸­è¢«åºŸå¼ƒ æ–°å†™æ³•ä½¿ç”¨noexceptä¿®é¥°ç¬¦ æ¥æ›¿ä»£throw() 12345//fun3å‡½æ•°ä¸èƒ½æŠ›å‡ºä»»ä½•å¼‚å¸¸void fun3() noexcept&#123;&#125; 2.6 nullptrnullptræ˜¯ä¸ºäº†è§£å†³C++ä¸­NULLçš„äºŒä¹‰æ€§é—®é¢˜ä»è€Œå¼•è¿›çš„ä¸€ç§æ–°çš„ç±»å‹ï¼ŒNULLå®é™…ä¸Šä»£è¡¨çš„æ˜¯0 é‡è½½funå‡½æ•°ï¼š â€‹ å½“è°ƒç”¨fun(NULL)æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒæ‰“å°çš„æ˜¯ï¼šfun2 1234567891011121314151617#include&lt;iostream&gt;using namespace std;void fun(int a)&#123; cout &lt;&lt; &quot;fun1&quot; &lt;&lt; endl;&#125;void fun(int* p)&#123; cout &lt;&lt; &quot;fun2&quot; &lt;&lt; endl;&#125;void main()&#123; fun(NULL);&#125; è¿è¡Œç»“æœï¼š 1fun1 ä½†æ˜¯ï¼Œæ‰“å°çš„æ˜¯ï¼šfun1ï¼› å¦‚æœè¦è§£å†³è¿™ä¸ªäºŒä¹‰æ€§ï¼Œæ‰€ä»¥å°±éœ€è¦ä½¿ç”¨nullptrï¼š 1234567891011121314151617#include&lt;iostream&gt;using namespace std;void fun(int a)&#123; cout &lt;&lt; &quot;fun1&quot; &lt;&lt; endl;&#125;void fun(int* p)&#123; cout &lt;&lt; &quot;fun2&quot; &lt;&lt; endl;&#125;void main()&#123; fun(nullptr);&#125; è¿è¡Œç»“æœï¼š 1&gt;fun2 æ¯”è¾ƒNULLå’Œnullptrï¼š 12345678910111213#include&lt;iostream&gt;using namespace std;void main()&#123; int* p1 = NULL; int* p2 = nullptr; if (p1 == p2) &#123; cout &lt;&lt; &quot;p1 = p2&quot; &lt;&lt; endl; &#125;&#125; è¿è¡Œç»“æœï¼š 1&gt;p1 = p2 è¯æ˜ï¼šNULLå’Œnullptrç›¸ç­‰ nullpträ¸èƒ½èµ‹å€¼ç»™æ™®é€šç±»å‹ï¼š 1234567void main()&#123; int a = NULL; //æ­£å¸¸ //int b = nullptr; //æŠ¥é”™ //double c = nullptr; //æŠ¥é”™ int* p = nullptr; //æ­£å¸¸&#125; 2.7 å¼ºç±»å‹æšä¸¾12345void main()&#123; enum Status1 &#123; Ok, Error &#125;; enum Status2 &#123; Ok, Error &#125;;&#125; è¿è¡ŒæŠ¥é”™ï¼š 12â€œmain::Okâ€: é‡å®šä¹‰ï¼›ä»¥å‰çš„å®šä¹‰æ˜¯â€œæšä¸¾æ•°â€â€œmain::Errorâ€: é‡å®šä¹‰ï¼›ä»¥å‰çš„å®šä¹‰æ˜¯â€œæšä¸¾æ•°â€ å¼ºç±»å‹æšä¸¾ï¼šenumåé¢åŠ ä¸Šclassæˆ–structä¿®é¥°ï¼Œå³å¯ï¼š 12345void main()&#123; enum class Status1 &#123; Ok, Error &#125;; enum class Status2 &#123; Ok, Error &#125;;&#125; è¿è¡ŒæˆåŠŸï¼ è°ƒç”¨æ—¶ï¼Œéœ€è¦æŒ‡å®šæšä¸¾ç±»å‹çš„ä½œç”¨åŸŸï¼š 12345678void main()&#123; enum class Status1 &#123; Ok, Error &#125;; enum class Status2 &#123; Ok, Error &#125;; //Status1 flag = OK; //æŠ¥é”™ï¼Œå¿…é¡»è¦æŒ‡å®šæšä¸¾çš„ä½œç”¨åŸŸ Status1 flag = Status1::Ok; //æ­£å¸¸&#125; å¼ºæšä¸¾ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šæˆå‘˜å˜é‡çš„ç±»å‹ï¼š 12345678void main()&#123; enum class Status1 &#123; Ok, Error &#125;; enum class Status2 : char &#123; Ok, Error &#125;; cout &lt;&lt; sizeof(Status1::Ok) &lt;&lt; endl; //4å­—èŠ‚ cout &lt;&lt; sizeof(Status2::Ok) &lt;&lt; endl; //1å­—èŠ‚&#125; è¿è¡Œç»“æœï¼š 12&gt;4&gt;1 2.8 å¸¸é‡è¡¨è¾¾å¼å¸¸é‡è¡¨è¾¾å¼è¦åœ¨ç¨‹åºç¼–è¯‘æ—¶æ‰§è¡Œï¼Œæ™®é€šå˜é‡è¦åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰§è¡Œ constexprï¼šå¯ä»¥å°†å˜é‡æˆ–å‡½æ•°åœ¨ç¼–è¯‘é˜¶æ®µåˆå§‹åŒ– 1234567891011121314151617181920212223242526272829#include&lt;iostream&gt;using namespace std;//è¿è¡Œæ—¶åˆå§‹åŒ–ï¼Œéå¸¸é‡int getNum1()&#123; return 2;&#125;//constä¿®é¥°çš„å¸¸é‡å±äºå³å€¼//constä¿®é¥°çš„å½¢å‚ä¸æ˜¯å¸¸é‡const int getNum2()&#123; return 2;&#125;//å¸¸é‡è¡¨è¾¾å¼ï¼Œå‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µconstexpr int getNum3()&#123; return 2;&#125;void main()&#123; // æšä¸¾ç±»å‹æˆå‘˜åˆå§‹åŒ–ï¼Œå¿…é¡»æ˜¯æ•´å‹å¸¸é‡ //enum &#123;e1 = getNum1(), e2 &#125;; //æŠ¥é”™ //enum &#123; e1 = getNum2(), e2 &#125;; //constï¼ŒæŠ¥é”™ enum &#123; e1 = getNum3(), e2 &#125;; //æ­£å¸¸ constexpr int temp = getNum3(); //æ­£å¸¸ï¼Œå‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µ enum &#123; e3 = temp, e4 &#125;; //æ­£å¸¸&#125; constexprçš„é™åˆ¶ï¼š å‡½æ•°ä¸­å…è®¸åŒ…å«typedefã€usingæŒ‡ä»¤ã€é™æ€æ–­è¨€ å‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ åœ¨ä½¿ç”¨å‰å¿…é¡»å·²æœ‰å®šä¹‰ returnè¿”å›è¯­å¥è¡¨è¾¾å¼ä¸èƒ½ä½¿ç”¨éå¸¸é‡è¡¨è¾¾å¼çš„å‡½æ•°ã€å…¨å±€å‡½æ•°ï¼Œä¸”å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ æ€»ç»“ï¼šè¿è¡Œé˜¶æ®µäº§ç”Ÿçš„å˜é‡æˆ–å‡½æ•°ï¼Œä¸è¦çæºå’Œåˆ°å¸¸é‡è¡¨è¾¾å¼ä¸­ 2.9 è‡ªå®šä¹‰å­—é¢é‡æ ¹æ®C++11æ ‡å‡†ï¼Œåªæœ‰ä»¥ä¸‹å‚æ•°æ‰æ˜¯åˆæ³•çš„ï¼š char const * unsigned long long long double char const *, size_t wchar const *, size_t char16_t const *, size_t char32_t const *, size_t 123456789101112131415161718192021222324252627#include&lt;iostream&gt;using namespace std;//è‡ªå®šä¹‰å­—é¢é‡ï¼Œèµ·åè¦æ±‚ operator&quot;&quot;XXX//åªéœ€è¦ä¼ é€’ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°è‡ªåŠ¨æ¨å¯¼å‡ºç¬¬ä¸€ä¸ªå‚æ•°çš„é•¿åº¦å¹¶èµ‹å€¼size_t operator&quot;&quot;_len(char const* str, size_t size)&#123; return size;&#125;char const* operator&quot;&quot;_str(char const* str, size_t size)&#123; return str;&#125;char const* operator&quot;&quot;_test(char const* str)&#123; return str;&#125;void main()&#123; cout &lt;&lt; &quot;abc&quot;_len &lt;&lt; endl; //æ­£å¸¸ cout &lt;&lt; &quot;abc&quot;_str &lt;&lt; endl; //æ­£å¸¸ //cout &lt;&lt; &quot;abc&quot;_test &lt;&lt; endl; //æŠ¥é”™ cout &lt;&lt; 123_test &lt;&lt; endl; //æ­£å¸¸&#125; è¿è¡Œç»“æœï¼š 123&gt;3&gt;abc&gt;123 2.10 åŸç”Ÿå­—ç¬¦ä¸²å­—é¢å€¼åŸç”Ÿå­—ç¬¦ä¸²å­—é¢å€¼ï¼šä½¿ç”¨æˆ·ä¹¦å†™çš„å­—ç¬¦ä¸²â€æ‰€è§å³æ‰€å¾—â€ C++11ä¸­ä½¿ç”¨åŸç”Ÿå­—ç¬¦ä¸²å­—é¢å€¼åªéœ€è¦åœ¨R&quot;()&quot;æ‹¬å·ä¸­å†™å…¥å­—ç¬¦ä¸²ï¼Œå³å¯ 123456789101112131415#include&lt;iostream&gt;#include&lt;string&gt;using namespace std;void main()&#123; cout &lt;&lt; R&quot;(Hello ,\\n \\rworld !!!)&quot; &lt;&lt; endl; cout &lt;&lt; &quot;-------------------&quot; &lt;&lt; endl; //ä¹Ÿå¯ä»¥èµ‹å€¼ç»™stringæ•°æ®ç±»å‹ string str = R&quot;(Hello ,\\n \\r)&quot;; cout &lt;&lt; str &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 12345&gt;Hello ,\\n \\r&gt;world !!!&gt;-------------------&gt;Hello ,\\n \\r 3.ç±»çš„æ”¹è¿›â€¦.. 4.æ¨¡æ¿çš„æ”¹è¿›4.1 å³å°–æ‹¬å·&gt;åœ¨C++98&#x2F;03ä¸­ï¼Œæ¨¡æ¿å®ä¾‹åŒ–æ—¶ï¼Œè¿ç»­çš„å³å°–æ‹¬å·&gt;&gt;ä¼šè¢«ç¼–è¯‘æˆå³ç§»åŠ¨æ“ä½œç¬¦ éœ€è¦åœ¨ä¸¤ä¸ªå³å°–æ‹¬å·ä¹‹é—´æ·»åŠ ç©ºæ ¼&gt; &gt; 123456789#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;void main()&#123; //vector&lt;vector&lt;int&gt;&gt; v1; //æŠ¥é”™ vector&lt;vector&lt;int&gt; &gt; v2; //æ­£å¸¸&#125; åœ¨C++11ä¸­è§£å†³äº†æ­¤é—®é¢˜ï¼š 12345678#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;void main()&#123; vector&lt;vector&lt;int&gt;&gt; v //æ­£å¸¸&#125; 4.2 ç±»å‹çš„åˆ«åéœ€è¦å¯¼å…¥ä¸€ä¸ªåº“æ¥åˆ¤æ–­æ•°æ®ç±»å‹æ˜¯å¦ç›¸åŒ 1#include&lt;type_traits&gt; is_sameåˆ¤æ–­ä¸¤ä¸ªæ•°æ®ç±»å‹æ˜¯å¦ç›¸åŒï¼Œè¿”å›å€¼ä¸ºboolç±»å‹ï¼š 1is_same&lt;T1, T2&gt;::value 12345678910111213#include&lt;iostream&gt;#include&lt;type_traits&gt;using namespace std;//é€šè¿‡typedefç»™ä¸€ä¸ªç±»å‹èµ·åˆ«åï¼Œä¸èƒ½æ–°å»ºç±»å‹typedef int int32;//C++11èµ·åˆ«åæ–¹å¼using my_int = int;void main()&#123; cout &lt;&lt; is_same&lt;int32, my_int&gt;::value &lt;&lt; endl;&#125; 4.3 å‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°1234567891011121314151617181920212223242526272829#include&lt;iostream&gt;#include&lt;string&gt;using namespace std;//ç±»æ¨¡æ¿æ”¯æŒé»˜è®¤æ¨¡æ¿å‚æ•°//æ³¨æ„ï¼šå¦‚æœæœ‰å¤šä¸ªç±»æ¨¡æ¿å‚æ•°ï¼Œé»˜è®¤æ¨¡æ¿å‚æ•°è¦å†™åœ¨**æœ€å³è¾¹**template&lt;class T = int&gt;class A&#123;public: A(T a) : a(a) &#123;&#125; T a;&#125;;//C++11æ”¯æŒå‡½æ•°æ¨¡æ¿çš„é»˜è®¤æ¨¡æ¿å‚æ•°template&lt;class T = int&gt;void fun(T t)&#123; &#125;void main()&#123; A&lt;&gt; a(10); //é»˜è®¤ä¸ºint cout &lt;&lt; a.a &lt;&lt; endl; A&lt;string&gt; b(&quot;abc&quot;); //æŒ‡å®šä¸ºstring cout &lt;&lt; b.a &lt;&lt; endl; fun(10); //ä¼ å…¥int fun&lt;string&gt;(&quot;abc&quot;); //ä¼ å…¥string&#125; 4.4 å¯å˜å‚æ•°æ¨¡æ¿å‡½æ•°å¯å˜æ¨¡æ¿å‡½æ•°çš„å£°æ˜ï¼š 123456789101112131415161718#include&lt;iostream&gt;using namespace std;//ä¸‹é¢ä¸ºå¯å˜å‚æ•°æ¨¡æ¿å‡½æ•°template&lt;class ... T&gt; //Tä¸ºæ¨¡æ¿å‚æ•°åŒ…void fun(T ... args) //argsä¸ºå‡½æ•°å‚æ•°åŒ…&#123; //è·å–å¯å˜å‚æ•°ä¸ªæ•° cout &lt;&lt; sizeof ... (args) &lt;&lt; endl;&#125;void main()&#123; fun&lt;int&gt;(10); fun&lt;int, string&gt;(10, &quot;abc&quot;); fun&lt;int, string, char&gt;(10, &quot;abc&quot;, &#x27;a&#x27;); fun(1, 1, 1, 1); //ä¸æŒ‡å®šæ•°æ®ç±»å‹ä¹Ÿå¯ä»¥&#125; è¿è¡Œç»“æœï¼š 1234&gt;1&gt;2&gt;3&gt;4 å‚æ•°åŒ…çš„å±•å¼€ é€’å½’çš„æ–¹å¼å±•å¼€ï¼š 12345678910111213141516171819202122#include&lt;iostream&gt;using namespace std;//é€’å½’ç»ˆæ­¢å‡½æ•°ï¼Œå½“å‚æ•°åˆ—è¡¨éå†å®Œåï¼Œè°ƒç”¨æ­¤é‡è½½å‡½æ•°ç»“æŸé€’å½’//æœ¬è´¨å°±æ˜¯é‡è½½å‡½æ•°void fun()&#123; cout &lt;&lt; &quot;å‚æ•°å·²ä¸ºç©º&quot; &lt;&lt; endl;&#125;template&lt;class T1, class ... T2&gt;void fun(T1 first, T2 ... last)&#123; cout &lt;&lt; first &lt;&lt; endl; fun(last ...);&#125;void main()&#123; fun(1, 2.5, 3, &quot;abc&quot;, &#x27;a&#x27;);&#125; è¿è¡Œç»“æœï¼š 123456&gt;1&gt;2.5&gt;3&gt;abc&gt;a&gt;å‚æ•°å·²ä¸ºç©º éé€’å½’çš„æ–¹å¼å±•å¼€ï¼š 123456789101112131415161718192021#include&lt;iostream&gt;using namespace std;template&lt;class T&gt;void print(T t)&#123; cout &lt;&lt; t &lt;&lt; endl;&#125;template&lt;class ... T&gt;void fun(T ... args)&#123; //é€—å·è¿ç®—ç¬¦ //åˆå§‹åŒ–åˆ—è¡¨ int a[] = &#123; (print(args), 0) ... &#125;;&#125;void main()&#123; fun(1, 2.5, &quot;abc&quot;, &#x27;a&#x27;);&#125; è¿è¡Œç»“æœï¼š 1234&gt;1&gt;2.5&gt;abc&gt;a 4.5 å¯å˜å‚æ•°æ¨¡æ¿ç±»ç»§æ‰¿çš„æ–¹å¼å±•å¼€å‚æ•°æ¨¡æ¿ç±» ç±»æ¨¡æ¿ç»§æ‰¿æ–¹å¼å±•å¼€å‚æ•°åŒ…ï¼š 12345678910111213141516171819202122232425262728#include&lt;iostream&gt;#include&lt;typeinfo&gt;using namespace std;//å¯å˜å‚æ•°æ¨¡æ¿çš„å£°æ˜ï¼Œå¿…é¡»è¦å£°æ˜template &lt;class ... T&gt;class Car; //ä¸»æ¨¡æ¿çš„å£°æ˜ä¸­ä¸å…è®¸ä½¿ç”¨æ¨¡æ¿å‚æ•°åˆ—è¡¨&lt; &gt;//é€’å½’ç»§æ‰¿æ¨¡æ¿ç±»template&lt;class Head, class ... Tail&gt;class Car&lt;Head, Tail ...&gt; : public Car&lt;Tail ...&gt;&#123;public: Car() &#123; cout &lt;&lt; typeid(Head).name() &lt;&lt; endl; &#125;&#125;;//é€’å½’ç»ˆæ­¢ç±»template&lt;&gt; class Car&lt;&gt;&#123; &#125;;void main()&#123; //åˆå§‹åŒ–Car Car&lt;int, double, string, char&gt; c;&#125; è¿è¡Œç»“æœï¼š 1234&gt;char&gt;class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;&gt;double&gt;int ç±»æ¨¡æ¿é€’å½’å’Œç‰¹åŒ–æ–¹å¼å±•å¼€å‚æ•°åŒ… ä¸‹é¢çš„æ˜¯è·å¾—ç›¸åŠ çš„æ•°æ®ç±»å‹çš„å­—èŠ‚æ€»æ•°ï¼š 123456789101112131415161718192021222324//å¯å˜å‚æ•°æ¨¡æ¿çš„å£°æ˜template&lt;class ... T&gt;class Add;//å¯å˜å‚æ•°æ¨¡æ¿çš„å®šä¹‰template&lt;class first, class ... last&gt;class Add&lt;first, last ...&gt;&#123;public: static const int val = Add&lt;first&gt;::val + Add&lt;last ...&gt;::val;&#125;;//è¾¹ç•Œæ¡ä»¶ï¼Œé€’å½’ç»ˆæ­¢æ¡ä»¶template&lt;class first&gt;class Add&lt;first&gt;&#123;public: static const int val = sizeof(first);&#125;;void main()&#123; cout &lt;&lt; Add&lt;int&gt;::val &lt;&lt; endl; //intç±»å‹å­—èŠ‚ä¸º4 cout &lt;&lt; Add&lt;double&gt;::val &lt;&lt; endl; //doubleç±»å‹å­—èŠ‚ä¸º8 cout &lt;&lt; Add&lt;int, int, double&gt;::val &lt;&lt; endl; //int+int+doubleå­—èŠ‚æ•°ä¸º16 &#125; è¿è¡Œç»“æœï¼š 123&gt;4&gt;8&gt;16 ä¹Ÿå¯ä»¥æŒ‡å®šæ•°æ®ç±»å‹ï¼š æŒ‡å®šæ•°æ®ç±»å‹ä¸ºintï¼Œå¹¶è·å¾—ä»–ä»¬çš„ä¹‹é—´ç›¸ä¹˜çš„æ€»å’Œï¼š 1234567891011121314151617181920212223242526272829#include&lt;iostream&gt;#include&lt;typeinfo&gt;using namespace std;//å¯å˜å‚æ•°æ¨¡æ¿çš„å£°æ˜//å¹¶æŒ‡å®šä¸ºintç±»å‹template&lt;int ... T&gt;class Mul;//å¯å˜å‚æ•°æ¨¡æ¿çš„å®šä¹‰template&lt;int first, int ... last&gt;class Mul&lt;first, last ...&gt;&#123;public: static const int val = first * Mul&lt;last ...&gt;::val;&#125;;//è¾¹ç•Œæ¡ä»¶ï¼Œé€’å½’ç»ˆæ­¢æ¡ä»¶template&lt;&gt;class Mul&lt;&gt;&#123;public: static const int val = 1;&#125;;void main()&#123; cout &lt;&lt; Mul&lt;2&gt;::val &lt;&lt; endl; //2*1 cout &lt;&lt; Mul&lt;2, 2&gt;::val &lt;&lt; endl; //2*2 cout &lt;&lt; Mul&lt;3, 3, 3&gt;::val &lt;&lt; endl; //3*3*3&#125; è¿è¡Œç»“æœï¼š 123&gt;2&gt;4&gt;27 5.å·¦å€¼ã€å³å€¼5.1 å·¦å€¼ã€å³å€¼å¼•ç”¨å·¦å€¼å¼•ç”¨ï¼š 1234567891011121314151617void main1()&#123; //å¼•ç”¨&amp;ï¼šç»™ä¸€ä¸ªå†…å­˜èµ·åˆ«åï¼Œå®šä¹‰æ—¶å¿…é¡»åˆå§‹åŒ– int a; const int temp = 1; int t1 = 1; int t2 = 2; int&amp; b = a; //æ­£å¸¸ //int&amp; c = 1; //æŠ¥é”™ï¼Œéå¸¸é‡å¼•ç”¨çš„åˆå§‹å€¼å¿…é¡»ä¸ºå·¦å€¼ //int&amp; d = t1 + t2; //æŠ¥é”™ï¼Œéå¸¸é‡å¼•ç”¨çš„åˆå§‹å€¼å¿…é¡»ä¸ºå·¦å€¼ //const int&amp; ä¸‡èƒ½å¼•ç”¨ const int&amp; e = a; //æ­£å¸¸ const int&amp; f = 1; //æ­£å¸¸ const int&amp; t = temp; //æ­£å¸¸&#125; å³å€¼å¼•ç”¨ï¼š 1234567891011void main()&#123; //å³å€¼å¼•ç”¨ int&amp;&amp; a = 10; //æ­£å¸¸ int&amp;&amp; b = fun(); //æ­£å¸¸ int t1 = 1; int t2 = 1; //int&amp;&amp; c = t1; //æŠ¥é”™ï¼Œæ— æ³•å°†å³å€¼å¼•ç”¨ç»‘å®šåˆ°å·¦å€¼ int&amp;&amp; d = t1 + t2; //æ­£å¸¸&#125; å·¦å€¼ã€å³å€¼åˆ¤æ–­ï¼š 123456789101112131415161718192021222324#include&lt;iostream&gt;using namespace std;//é€šè¿‡é‡è½½å‡½æ•°çš„ç‰¹ç‚¹ï¼Œæ¥è¿›è¡Œåˆ¤æ–­void test(int&amp; left)&#123; cout &lt;&lt; &quot;å·¦å€¼&quot; &lt;&lt; endl;&#125;void test(int&amp;&amp; right)&#123; cout &lt;&lt; &quot;å³å€¼&quot; &lt;&lt; endl;&#125;void main()&#123; int a = 1; int b = 1; int&amp;&amp; c = 1; test(a); //å·¦å€¼ test(1); //å³å€¼ test(a + b); //å³å€¼ test(c); //å·¦å€¼&#125; è¿è¡Œç»“æœï¼š 1234&gt;å·¦å€¼&gt;å³å€¼&gt;å³å€¼&gt;å·¦å€¼ 5.2 è¿”å›å€¼ä¼˜åŒ–â€¦â€¦ 6.ç§»åŠ¨è¯­ä¹‰â€¦â€¦ 6.3 std::move123456789#include&lt;iostream&gt;using namespace std;void main()&#123; int a = 10; //int&amp;&amp; b = a; //æŠ¥é”™ï¼Œå·¦å€¼ä¸èƒ½ç»‘å®šåˆ°å³å€¼å¼•ç”¨ int&amp;&amp; c = move(a); //æ­£å¸¸ï¼Œmoveå°†å·¦å€¼è½¬åŒ–ä¸ºå³å€¼&#125; 6.4 std::forwardå½“æˆ‘ä»¬éœ€è¦å°†ä¸€ç»„å‚æ•°åŸå°ä¸åŠ¨çš„ä¼ é€’ç»™é‡Œä¸€ä¸ªå‡½æ•°æ—¶ï¼š 12345678910111213141516171819202122232425262728293031323334#include&lt;iostream&gt;using namespace std;template&lt;class T&gt;void fun(const T&amp; t)&#123; cout &lt;&lt; &quot;fun(const T&amp; t) &quot; &lt;&lt; endl;&#125;template&lt;class T&gt;void fun(T&amp; t)&#123; cout &lt;&lt; &quot;fun(T&amp; t) &quot; &lt;&lt; endl;&#125;template&lt;class T&gt;void forwardVal(const T&amp; t)&#123; fun(t);&#125;template&lt;class T&gt;void forwardVal(T&amp; t)&#123; fun(t);&#125;void main()&#123; int a = 0; const int b = 1; forwardVal(a); forwardVal(b);&#125; è¿è¡Œç»“æœï¼š 12&gt;fun(T&amp; t)&gt;fun(const T&amp; t) ä½¿ç”¨std::forwardå‡½æ•°ï¼Œå®ç°å®Œç¾è½¬å‘ï¼š 12345678910111213141516171819202122232425262728293031323334template&lt;class T&gt;void fun(const T&amp; t)&#123; cout &lt;&lt; &quot;fun(const T&amp; t) &quot; &lt;&lt; endl;&#125;template&lt;class T&gt;void fun(T&amp; t)&#123; cout &lt;&lt; &quot;fun(T&amp; t) &quot; &lt;&lt; endl;&#125;template&lt;class T&gt;void fun(const T&amp;&amp; t)&#123; cout &lt;&lt; &quot;fun(const T&amp;&amp; t) &quot; &lt;&lt; endl;&#125;//åªéœ€å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ— éœ€é‡è½½å‡½æ•°template&lt;class T&gt;void forwardVal(T&amp;&amp; t)&#123; //forwardä¿å­˜å‚æ•°çš„å·¦å€¼ã€å³å€¼å±æ€§ fun(forward&lt;T&gt;(t));&#125;void main()&#123; int a = 1; const int b = 2; forwardVal(a); forwardVal(b); forwardVal(10);&#125; è¿è¡Œç»“æœï¼š 123&gt;fun(T&amp; t)&gt;fun(const T&amp; t)&gt;fun(const T&amp;&amp; t) 7.æ™ºèƒ½æŒ‡é’ˆ7.1 unique_ptr12345678910111213141516#include&lt;iostream&gt;#include&lt;memory&gt; //æ™ºèƒ½æŒ‡é’ˆå¤´æ–‡ä»¶using namespace std;void main()&#123; //æ™ºèƒ½æŒ‡é’ˆæ— éœ€é‡Šæ”¾ï¼Œè‡ªåŠ¨é‡Šæ”¾ unique_ptr&lt;int&gt; ptr(new int(10)); cout &lt;&lt; *ptr &lt;&lt; endl; //é‡è½½äº†operator*() cout &lt;&lt; ptr &lt;&lt; endl; //å¯ä»¥äººä¸ºæŒ‡å®šé‡Šæ”¾å †åŒºç©ºé—´ //ptr = nullptr; //æ­£å¸¸ //ptr = NULL; //æ­£å¸¸ ptr.reset(); //æ­£å¸¸&#125; 1234567891011121314151617#include&lt;iostream&gt;#include&lt;memory&gt; //æ™ºèƒ½æŒ‡é’ˆå¤´æ–‡ä»¶using namespace std;void main()&#123; unique_ptr&lt;int&gt; ptr1(new int(10)); //æŠ¥é”™ï¼Œç¦ç”¨æ‹·è´æ„é€  //unique_ptr&lt;int&gt; ptr2 = ptr; //int* p = ptr //æŠ¥é”™ //å°†ptr1ä½¿ç”¨æƒ(æŒ‡å‘çš„å†…å­˜)äº¤ç»™ptr3ï¼Œptr1ä¸èƒ½å†æ“ä½œå †åŒºå†…å­˜äº† unique_ptr&lt;int&gt; ptr3 = move(ptr1); //cout &lt;&lt; *ptr1 &lt;&lt; endl; //æŠ¥é”™ cout &lt;&lt; *ptr3 &lt;&lt; endl; //æ­£å¸¸&#125; 1234567891011121314#include&lt;iostream&gt;#include&lt;memory&gt; //æ™ºèƒ½æŒ‡é’ˆå¤´æ–‡ä»¶using namespace std;void main()&#123; unique_ptr&lt;int&gt; ptr(new int(10)); //æ— å‚ï¼Œä½œç”¨ä¸ºæ˜¾å¼é‡Šæ”¾å †åŒºå†…å­˜ //ptr.reset(); //æœ‰å‚ï¼Œå…ˆé‡Šæ”¾å †åŒºå†…å­˜ï¼Œå†é‡æ–°ç»‘å®šä¸€ä¸ªæ–°å †åŒºå†…å­˜ ptr.reset(new int(20));&#125; 1234567891011121314151617#include&lt;iostream&gt;#include&lt;memory&gt; //æ™ºèƒ½æŒ‡é’ˆå¤´æ–‡ä»¶using namespace std;void main()&#123; unique_ptr&lt;int&gt; ptr(new int(10)); //é‡Šæ”¾ptrå¯¹å †åŒºå†…å­˜çš„æ§åˆ¶æƒä½†æ˜¯ä¸é‡Šæ”¾å †åŒºçš„å†…å­˜ï¼Œå¹¶å°†æ§åˆ¶æƒäº¤ç»™æŒ‡é’ˆp int* p = ptr.release(); //cout &lt;&lt; *ptr &lt;&lt; endl; //æŠ¥é”™ cout &lt;&lt; *p &lt;&lt; endl; //æ­£å¸¸ //éœ€è¦äººä¸ºå°†pæŒ‡é’ˆçš„å †åŒºé‡Šæ”¾ delete p;&#125; 7.2 shared_ptrshared_ptrå…è®¸å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆå…±äº«å¹¶æ‹¥æœ‰åŒä¸€ä¸ªå †åŒºåˆ†é…å¯¹è±¡çš„å†…å­˜ã€‚é€šè¿‡å¼•ç”¨è®¡æ•°å®ç°ï¼Œä¼šè®°å½•æœ‰å¤šå°‘ä¸ªshared_ptrå…±åŒæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæœ€åä¸€ä¸ªå…±äº«æŒ‡é’ˆè¢«é”€æ¯ï¼Œä¹Ÿå°±æ˜¯å¯¹æŸä¸ªå¼•ç”¨å¯¹è±¡çš„è®¡æ•°å˜ä¸º0æ—¶ï¼Œè‡ªåŠ¨é‡Šæ”¾æ­¤å†…å­˜ã€‚ 123456789101112131415161718192021222324#include&lt;iostream&gt;#include&lt;memory&gt;using namespace std;void main()&#123; //shared_pträ¹Ÿä¼šè‡ªåŠ¨é‡Šæ”¾å †åŒºç©ºé—´ shared_ptr&lt;int&gt; ptr1(new int(10)); //æ‹·è´æ„é€ ï¼Œæ­¤æ—¶æœ‰2ä¸ªå¯¹è±¡å’Œå †åŒºå†…å­˜ç»‘å®š shared_ptr&lt;int&gt; ptr2 = ptr1; //æ­£å¸¸ //æ‰“å°ptr1ä¸ptr2çš„åœ°å€ cout &lt;&lt; ptr1 &lt;&lt; endl; cout &lt;&lt; ptr2 &lt;&lt; endl; //è®¡æ•°å™¨ï¼Œè·å–ä¸å †åŒºç»‘å®šçš„å¯¹è±¡çš„ä¸ªæ•° cout &lt;&lt; ptr1.use_count() &lt;&lt; endl; //2 //é‡Šæ”¾ptr1å¯¹è±¡ï¼Œè®¡æ•°å™¨å‡1ï¼Œä¸ä¼šé‡Šæ”¾å †åŒºå†…å­˜ ptr1.reset(); cout &lt;&lt; ptr2.use_count() &lt;&lt; endl; //1 //å½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œæ‰ä¼šé‡Šæ”¾å †åŒºç©ºé—´ ptr2.reset();&#125; è¿è¡Œç»“æœï¼š 1234&gt;0000026C3E3E6CA0&gt;0000026C3E3E6CA0&gt;2&gt;1 7.3 weak_ptrweak_ptræ˜¯ä¸ºé…åˆ shared_ptr è€Œå¼•å…¥çš„ä¸€ç§æ™ºèƒ½æŒ‡é’ˆæ¥ååŠ© shared_ptr å·¥ä½œï¼Œå®ƒå¯ä»¥ä»ä¸€ä¸ªshared_ptr æˆ–å¦ä¸€ä¸ª weak_ptr å¯¹è±¡æ„é€ ï¼Œå®ƒçš„æ„é€ å’Œææ„ä¸ä¼šå¼•èµ·å¼•ç”¨è®¡æ•°çš„å¢åŠ æˆ–å‡å°‘ã€‚æ²¡æœ‰é‡è½½ * å’Œ-&gt;ä½†å¯ä»¥ä½¿ç”¨ lock è·å¾—ä¸€ä¸ªå¯ç”¨çš„ shared_ptr å¯¹è±¡ã€‚ weak_ptr çš„ä½¿ç”¨æ›´ä¸ºå¤æ‚ä¸€ç‚¹ï¼Œå®ƒå¯ä»¥æŒ‡å‘ shared_ptr æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡å†…å­˜ï¼Œå´å¹¶ä¸æ‹¥æœ‰è¯¥å†…å­˜ï¼Œè€Œä½¿ç”¨ weak_ptr æˆå‘˜lockï¼Œåˆ™å¯è¿”å›å…¶æŒ‡å‘å†…å­˜çš„ä¸€ä¸ª share_ptr å¯¹è±¡ï¼Œä¸”åœ¨æ‰€æŒ‡å¯¹è±¡å†…å­˜å·±ç»æ— æ•ˆæ—¶ï¼Œè¿”å›æŒ‡é’ˆç©ºå€¼ nullptrã€‚ 12345678910111213141516171819202122232425262728293031323334#include&lt;iostream&gt;#include&lt;memory&gt;using namespace std;void main()&#123; shared_ptr&lt;int&gt; ptr1(new int(10)); shared_ptr&lt;int&gt; ptr2 = ptr1; //2ä¸ªå¯¹è±¡ç»‘å®šå †åŒºç©ºé—´ //weak_pträ¸å’Œå †åŒºç©ºé—´ç»‘å®šï¼Œå¯ä»¥é€šè¿‡lockå‡½æ•°è·å–shared_ptrçš„å¯¹è±¡ weak_ptr&lt;int&gt; ptr3 = ptr1; cout &lt;&lt; ptr1.use_count() &lt;&lt; endl; //æ‰“å°è®¡æ•°å™¨ cout &lt;&lt; ptr3.use_count() &lt;&lt; endl; //æ‰“å°è®¡æ•°å™¨ cout &lt;&lt; &quot;----------------&quot; &lt;&lt; endl; //é€šè¿‡lockå‡½æ•°è·å–shared_ptrçš„å¯¹è±¡ shared_ptr&lt;int&gt; ptr4 = ptr3.lock(); //3ä¸ªå¯¹è±¡ç»‘å®šå †åŒºç©ºé—´ cout &lt;&lt; ptr1.use_count() &lt;&lt; endl; //æ‰“å°è®¡æ•°å™¨ cout &lt;&lt; ptr3.use_count() &lt;&lt; endl; //æ‰“å°è®¡æ•°å™¨ cout &lt;&lt; *ptr1 &lt;&lt; &quot;,&quot; &lt;&lt; *ptr2 &lt;&lt; &quot;,&quot; &lt;&lt; *ptr4 &lt;&lt; endl; //æ­£å¸¸ //cout &lt;&lt; *ptr3 &lt;&lt; endll; //æŠ¥é”™ï¼Œæ²¡æœ‰é‡è½½*å’Œ-&gt; //é‡Šæ”¾æ‰€æœ‰shared_ptrå¯¹è±¡ ptr1.reset(); ptr2.reset(); ptr4.reset(); shared_ptr&lt;int&gt; temp = ptr3.lock(); if (temp == nullptr) &#123; cout &lt;&lt; &quot;tempä¸ºç©ºï¼Œå·²ç»é‡Šæ”¾äº†å †åŒºç©ºé—´ï¼&quot; &lt;&lt; endl; &#125;&#125; è¿è¡Œç»“æœï¼š 1234567&gt;2&gt;2&gt;----------------&gt;3&gt;3&gt;10,10,10&gt;tempä¸ºç©ºï¼Œå·²ç»é‡Šæ”¾äº†å †åŒºç©ºé—´ï¼ 8.é—­åŒ…çš„å®ç°8.1 é—­åŒ…æ˜¯ä»€ä¹ˆé—­åŒ…æœ‰å¾ˆå¤šç§å®šä¹‰ï¼Œä¸€ç§è¯´æ³•æ˜¯ï¼Œé—­åŒ…æ˜¯å¸¦æœ‰ä¸Šä¸‹æ–‡çš„å‡½æ•°ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯æœ‰çŠ¶æ€çš„å‡½æ•°ï¼Œæ›´ç›´æ¥ä¸€äº›ï¼Œä¸å°±æ˜¯ä¸ªç±»å—ï¼Ÿæ¢äº†ä¸ªåå­—åŒ– ã€‚ ä¸€ä¸ªå‡½æ•°ï¼Œå¸¦ä¸Šäº†ä¸€ä¸ªçŠ¶æ€ï¼Œå°±å˜æˆäº†é—­åŒ…äº†ã€‚é‚£ä»€ä¹ˆå«â€œå¸¦ä¸ŠçŠ¶æ€ï¼Œå‘¢ï¼Ÿæ„æ€æ˜¯è¿™ä¸ªé—­åŒ…æœ‰å±äºè‡ªå·±çš„å˜é‡ï¼Œè¿™äº›ä¸ªå˜é‡çš„å€¼æ˜¯åˆ›å»ºé—­åŒ…çš„æ—¶å€™è®¾ç½®çš„ï¼Œå¹¶åœ¨è°ƒç”¨é—­åŒ…çš„æ—¶å€™ï¼Œå¯ä»¥è®¿é—®è¿™äº›å˜é‡ã€‚ å‡½æ•°æ˜¯ä»£ç ï¼ŒçŠ¶æ€æ˜¯ä¸€ç»„å˜é‡ï¼Œå°†ä»£ç å’Œä¸€ç»„å˜é‡æ†ç»‘(bind)ï¼Œå°±å½¢æˆäº†é—­åŒ…ã€‚ é—­åŒ…çš„çŠ¶æ€ã§¢ç»‘ï¼Œå¿…é¡»å‘ç”Ÿåœ¨è¿è¡Œæ—¶ã€‚ 8.2 ä»¿å‡½æ•°ï¼šé‡è½½operator()C++11ä¹‹å‰å°±å·²ç»æ”¯æŒ æ¯”è¾ƒå¤§å°ï¼š 123456789101112131415161718#include&lt;iostream&gt;using namespace std;//ä»¿å‡½æ•°ï¼šé‡è½½operator()class Compare&#123;public: //å¦‚æœval1å°äºval2,åˆ™è¿”å›çœŸï¼Œå¦åˆ™è¿”å›å‡ bool operator()(int val1, int val2) &#123; return val1 &lt; val2; &#125;&#125;;void main()&#123; cout &lt;&lt; Compare()(11, 12) &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 1&gt;1 8.3 std::functionåœ¨C++ä¸­ï¼Œå¯è°ƒç”¨å®ä½“ä¸»è¦åŒ…æ‹¬ï¼šå‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¼•ç”¨ã€å¯ä»¥éšå¼è½¬æ¢ä¸ºå‡½æ•°æŒ‡å®šçš„å¯¹ç³»ï¼Œæˆ–è€…å®ç°äº† opetator()çš„å¯¹è±¡ã€‚ C++11ä¸­ï¼Œæ–°å¢åŠ äº†ä¸€ä¸ª std::function ç±»æ¨¡æ¿ï¼Œå®ƒæ˜¯å¯¹ C++ä¸­ç°æœ‰çš„å¯è°ƒç”¨å®ä½“çš„ä¸€ç§ç±»å‹å®‰å…¨çš„åŒ…è£…ã€‚é€šè¿‡æŒ‡å®šå®ƒçš„æ¨¡æ¿å‚æ•°ï¼Œå®ƒå¯ä»¥ç”¨ç»Ÿä¸€çš„æ–¹å¼å¤„ç†å‡½æ•°ã€å‡½æ•°å¯¹è±¡ã€å‡½æ•°æŒ‡é’ˆï¼Œå¹¶å…è®¸ä¿å­˜å’Œå»¶è¿Ÿæ‰§è¡Œå®ƒä»¬ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243#include&lt;iostream&gt;#include&lt;functional&gt; //std::functionusing namespace std;//æ™®é€šå‡½æ•°void fun()&#123; //__func__ï¼šè¿”å›å‡½æ•°å cout &lt;&lt; __func__ &lt;&lt; endl;&#125;//ç±»ä¸­é™æ€å‡½æ•°class Test&#123;public: static int testFun(int a) &#123; cout &lt;&lt; __func__ &lt;&lt; endl; return a; &#125;&#125;;//ç±»ä¸­ä»¿å‡½æ•°class MyFun&#123;public: int operator()(int a) &#123; cout &lt;&lt; __func__ &lt;&lt; endl; return a; &#125;&#125;;void main()&#123; //ç»‘å®šæ™®é€šå‡½æ•° function&lt;void()&gt; f1 = fun; f1(); //ç»‘å®šç±»ä¸­çš„é™æ€å‡½æ•° function&lt;int(int)&gt; f2 = Test::testFun; cout &lt;&lt; f2(100) &lt;&lt; endl; //ç»‘å®šç±»ä¸­çš„ä»¿å‡½æ•°ï¼Œç»‘å®šå¯¹è±¡ function&lt;int(int)&gt; f3 = MyFun(); cout &lt;&lt; f3(30) &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 12345&gt;fun&gt;testFun&gt;100&gt;operator ()&gt;30 std:functionå¯¹è±¡æœ€å¤§çš„ç”¨å¤„å°±æ˜¯åœ¨å®ç°å‡½æ•°å›è°ƒï¼Œä½¿ç”¨è€…éœ€è¦æ³¨å¿˜ï¼Œå®ƒä¸èƒ½è¢«ç”¨æ¥æ£€æŸ¥ç›¸ç­‰æˆ–è€…ä¸ç›¸ç­‰ï¼Œä½†æ˜¯å¯ä»¥ä¸ NULL æˆ–è€…nullptr è¿›è¡Œæ¯”è¾ƒã€‚ 8.4 std::bindstd:bind æ˜¯è¿™æ ·ä¸€ç§æœºåˆ¶ï¼Œå®ƒå¯ä»¥é¢„å…ˆæŠŠæŒ‡å®šå¯è°ƒç”¨å®ä½“çš„æŸäº›å‚æ•°é„‰å®šåˆ°å·±æœ‰çš„å˜é‡ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„å¯è°ƒç”¨å®ä½“ï¼Œè¿™ç§æœºåˆ¶åœ¨ å›è°ƒå‡½æ•° çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ä¹Ÿé¢‘ä¸ºæœ‰ç”¨ã€‚ C++98ä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸¤æ•°bindlst å’Œbind2ndï¼Œå®ƒä»¬åˆ†åˆ«å¯ä»¥ç”¨æ¥ç»‘å®š functor çš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒä»¬éƒ½æ˜¯åªå¯ä»¥ç»‘å®šä¸€ä¸ªå‚æ•°ï¼Œå„ç§é™åˆ¶ï¼Œä½¿å¾— bind1st å’Œ bind2nd çš„å¯ç”¨æ€§å¤§å¤§é™ä½ã€‚ åœ¨C++11ä¸­ï¼Œæä¾›äº†std:bindï¼Œ å®ƒé„‰å®šçš„å‚æ•°çš„ä¸ªæ•°ä¸å—é™åˆ¶ï¼Œç»‘å®šçš„å…·ä½“å“ªäº›å‚æ•°ä¹Ÿä¸å—é™åˆ¶ï¼Œç”±ç”¨æˆ·æŒ‡å®šï¼Œè¿™ä¸ªbind æ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ç»‘å®šã€‚ 123456789101112131415161718192021222324252627282930#include&lt;iostream&gt;#include&lt;functional&gt; //std::bindusing namespace std;void fun(int x, int y)&#123; cout &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; y &lt;&lt; endl;&#125;void main()&#123; bind(fun, 1, 2)(); //è¾“å‡º1 2 //std::placeholders::_1 è¡¨ç¤ºå‡½æ•°è°ƒç”¨ï¼Œç¬¬1ä¸ªå‚æ•°æ›¿æ¢ //std::placeholders::_2 è¡¨ç¤ºå‡½æ•°è°ƒç”¨ï¼Œç¬¬2ä¸ªå‚æ•°æ›¿æ¢ //std::placeholders::_3 è¡¨ç¤ºå‡½æ•°è°ƒç”¨ï¼Œç¬¬3ä¸ªå‚æ•°æ›¿æ¢ bind(fun, placeholders::_1, placeholders::_2)(5, 10); //è¾“å‡º5 10 //ç®€åŒ–å†™æ³• using namespace std::placeholders; //å°†ç¬¬1ä¸ªå‚æ•°ä¸_1æ›¿æ¢ bind(fun, 5, _1)(2, 4, 10); //è¾“å‡º5 2 //å°†ç¬¬2ä¸ªå‚æ•°ä¸_2æ›¿æ¢ bind(fun, 5, _2)(2, 4, 10); //è¾“å‡º5 4 //ç¬¬1ä¸ªå‚æ•°ä¸ç¬¬ä¸€ä¸ªå‚æ•°äº’æ¢ bind(fun, _2, _1)(2, 4, 10); //è¾“å‡º4 2 //bind(fun, _2, 10)(20); //æŠ¥é”™ï¼Œä¸å­˜å’‹ç¬¬2ä¸ªå‚æ•°&#125; è¿è¡Œç»“æœï¼š 12345&gt;1 2&gt;5 10&gt;5 2&gt;5 4&gt;4 2 8.5 functionç»“åˆbind12345678910111213141516171819202122232425262728#include&lt;iostream&gt;#include&lt;functional&gt;using namespace std;using namespace std::placeholders;class Test&#123;public: int a; void fun(int x, int y) &#123; cout &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; y &lt;&lt; endl; &#125;&#125;;void main()&#123; Test test; //åˆ›å»ºå¯¹è±¡ //ç»‘å®šæˆå‘˜å‡½æ•° function&lt;void(int, int)&gt; f1 = bind(&amp;Test::fun, &amp;test, _1, _2); f1(1, 2); //test.fun(1, 2) //ç»‘å®šæˆå‘˜å˜é‡ function&lt;int&amp; ()&gt; f2 = bind(&amp;Test::a, &amp;test); f2() = 12; //test.a = 12; cout &lt;&lt; test.a &lt;&lt; endl;&#125; è¿è¡Œç»“æœï¼š 12&gt;1 2&gt;12 8.6 lambdaè¡¨è¾¾å¼lambdaè¡¨è¾¾å¼çš„åŸºæœ¬æ ¼å¼ï¼š 1234[]()&#123; &#125; åŸºç¡€è¯­æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172#include&lt;iostream&gt;using namespace std;//[]ä¸­åªèƒ½æ•è·å…¨å±€å˜é‡ä¸åŒä¸€ä½œç”¨åŸŸçš„å˜é‡void main()&#123; auto f1 = []() &#123;&#125;; int a = 1; int b = 2; cout &lt;&lt; &quot;f2-------------&quot; &lt;&lt; endl; //aã€bä»¥å€¼ä¼ é€’æ–¹å¼ auto f2 = [a, b]() &#123; cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; endl; &#125;; f2(); cout &lt;&lt; &quot;f3-------------&quot; &lt;&lt; endl; //æ·»åŠ xã€yå‚æ•° auto f3 = [a, b](int x, int y) &#123; cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; endl; cout &lt;&lt; &quot;x=&quot; &lt;&lt; x &lt;&lt; &quot;,y=&quot; &lt;&lt; y &lt;&lt; endl; &#125;; f3(3, 6); cout &lt;&lt; &quot;f4-------------&quot; &lt;&lt; endl; //=ï¼šä»¥å€¼ä¼ é€’çš„æ–¹å¼æ•è·å¤–é¢çš„å˜é‡ auto f4 = [=]() &#123; f3(4, 8); cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; endl; &#125;; f4(); cout &lt;&lt; &quot;f5-------------&quot; &lt;&lt; endl; //&amp;ï¼šä»¥å¼•ç”¨çš„æ–¹å¼æ•è·å¤–é¢çš„å˜é‡ auto f5 = [&amp;]() &#123; f3(5, 10); cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; endl; &#125;; f5(); cout &lt;&lt; &quot;f6-------------&quot; &lt;&lt; endl; //aä¸ºå€¼ä¼ é€’ï¼Œå…¶ä½™ä¸ºå¼•ç”¨ auto f6 = [&amp;, a]() &#123; f3(6, 12); cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; endl; &#125;; f6(); cout &lt;&lt; &quot;f7-------------&quot; &lt;&lt; endl; //aä¸ºå¼•ç”¨ï¼Œå…¶ä½™ä¸ºå€¼ä¼ é€’ auto f7 = [=, &amp;a]() &#123; f3(7, 14); cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; endl; &#125;; f7(); //é»˜è®¤æƒ…å†µä¸‹ï¼Œlambdaè¡¨è¾¾å¼ä»¥constä¿®é¥°å‡½æ•°ä½“ //æ·»åŠ mutableï¼Œå°±å¯ä»¥ä¿®æ”¹äº† auto f8 = [=]() mutable &#123; //ä¸åŠ mutableä¼šæŠ¥é”™ï¼Œæ— æ³•ä¿®æ”¹ a++; //æ­£å¸¸ &#125;;&#125; è¿è¡Œç»“æœï¼š 1234567891011121314151617181920&gt;1 2&gt;f3-------------&gt;1 2&gt;x=3,y=6&gt;f4-------------&gt;1 2&gt;x=4,y=8&gt;1 2&gt;f5-------------&gt;1 2&gt;x=5,y=10&gt;1 2&gt;f6-------------&gt;1 2&gt;x=6,y=12&gt;1 2&gt;f7-------------&gt;1 2&gt;x=7,y=14&gt;1 2 ç±»å’Œå…¨å±€å˜é‡ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243#include&lt;iostream&gt;using namespace std;int globality = 10;class Test&#123;public: int i = 10; void testFun() &#123; int a = 5; cout &lt;&lt; __func__ &lt;&lt; endl; auto f1 = [=]() &#123; cout &lt;&lt; i &lt;&lt; endl; //æ­£å¸¸ cout &lt;&lt; globality &lt;&lt; endl; //æ­£å¸¸ &#125;; auto f2 = [&amp;]() &#123; cout &lt;&lt; i &lt;&lt; endl; //æ­£å¸¸ cout &lt;&lt; globality &lt;&lt; endl; //æ­£å¸¸ &#125;; //åªèƒ½æ•è·ç±»æˆå‘˜å˜é‡å’Œå…¨å±€å˜é‡ï¼Œä¸èƒ½æ•è·å±€éƒ¨å˜é‡ auto f3 = [this]() &#123; cout &lt;&lt; i &lt;&lt; endl; //æ­£å¸¸ cout &lt;&lt; globality &lt;&lt; endl; //æ­£å¸¸ //cout &lt;&lt; a &lt;&lt; endl; //æŠ¥é”™ &#125;; &#125;&#125;;//[]ä¸­åªèƒ½æ•è·å…¨å±€å˜é‡ä¸åŒä¸€ä½œç”¨åŸŸçš„å˜é‡void main()&#123; auto f1 = [=]() &#123; cout &lt;&lt; globality &lt;&lt; endl; &#125;; f1();&#125; 8.7 å€¼ä¼ é€’ä¸å¼•ç”¨æ•è·å‚æ•°çš„åŒºåˆ«12345678910111213141516171819202122232425#include&lt;iostream&gt;using namespace std;void main()&#123; int a = 1; auto f1 = [=]() mutable &#123; a++; cout &lt;&lt; a &lt;&lt; endl; //a = 2; &#125;; f1(); cout &lt;&lt; a &lt;&lt; endl; //a = 1; cout &lt;&lt; &quot;-----------&quot; &lt;&lt; endl; int b = 1; auto f2 = [&amp;]() mutable &#123; b++; cout &lt;&lt; b &lt;&lt; endl; //b = 2; &#125;; f2(); cout &lt;&lt; b &lt;&lt; endl; //b = 2;&#125; è¿è¡Œç»“æœï¼š 12345&gt;2&gt;1&gt;-----------&gt;2&gt;2 8.8 lambdaè¡¨è¾¾å¼ä¸ä»¿å‡½æ•°äº‹å®ä¸Šï¼Œä»¿å‡½æ•°æ˜¯ç¼–è¯‘å™¨å®ç°lambda çš„ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡ç¼–è¯‘å™¨éƒ½æ˜¯æŠŠlambdaè¡¨è¾¾å¼è½¬åŒ–ä¸ºä¸€ä¸ªä»¿å‡½æ•°å¯¹è±¡ã€‚ å› æ­¤ï¼Œåœ¨C++11ä¸­ï¼Œlambda å¯ä»¥è§†ä¸ºä»¿å‡½æ•°çš„ä¸€ç§ç­‰ä»·å½¢å¼ã€‚ 1234567891011121314151617181920212223242526272829303132#include&lt;iostream&gt;using namespace std;class MyFun&#123;private: int a;public: MyFun(int a) &#123; this-&gt;a = a; &#125; int operator()(int val) &#123; return this-&gt;a + val; &#125;&#125;;void main()&#123; int a = 10; //ä»¿å‡½æ•° cout &lt;&lt; MyFun(a)(20) &lt;&lt; endl; //lambdaè¡¨è¾¾å¼ auto f = [=](int val) &#123; return a + val; &#125;; cout &lt;&lt; f(20) &lt;&lt; endl;;&#125; 8.9 lambdaè¡¨è¾¾å¼ç±»å‹1234567891011121314151617181920212223#include&lt;iostream&gt;#include&lt;functional&gt;using namespace std;using namespace std::placeholders;void main()&#123; function&lt;int(int)&gt; f1 = [](int x) &#123;return x + 1; &#125;; cout &lt;&lt; f1(1) &lt;&lt; endl; //2 function&lt;int(int)&gt; f2 = bind([](int x) &#123;return x + 1; &#125;, _1); cout &lt;&lt; f2(2) &lt;&lt; endl; //3 auto f3 = [](int x, int y) -&gt;int &#123;return x + y; &#125;; auto f4 = [=](int x, int y) -&gt;int &#123;return x + y; &#125;; //å®šä¹‰ä¸€ä¸ªFUN_PTRå‡½æ•°æŒ‡é’ˆï¼Œå‚æ•°åˆ—è¡¨ä¸ºä¸¤ä¸ªintï¼Œè¿”å›å€¼ä¸ºint typedef int (*FUN_PTR)(int, int); FUN_PTR p1 = f3; //æ­£å¸¸ï¼Œlambdaè¡¨è¾¾å¼å¯ä»¥è½¬åŒ–ä¸ºå‡½æ•°æŒ‡é’ˆ //FUN_PTR p2 = f4; //æŠ¥é”™ï¼Œlambdaè¡¨è¾¾å¼è½¬åŒ–ä¸ºå‡½æ•°æŒ‡é’ˆä¸å…è®¸æ•è·å˜é‡ cout&lt;&lt; p1(1, 2) &lt;&lt; endl; //3&#125; è¿è¡Œç»“æœï¼š 123233 8.10 lambdaçš„ä¼˜åŠ¿ä¼ ç»Ÿç­›é€‰å‡ºå¤§äº5çš„æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;vector&lt;int&gt; arr;vector&lt;int&gt; largeNums; //ç­›é€‰å‡ºå¤§äº5çš„æ•°void print(const vector&lt;int&gt;&amp; v)&#123; for (auto&amp; i : v) &#123; cout &lt;&lt; i &lt;&lt; &quot; &quot;; &#125; cout &lt;&lt; endl;&#125;void main()&#123; for (int i = 0; i &lt; 10; i++) &#123; arr.emplace_back(i); &#125; int temp = 5; //ä¼ ç»Ÿæ“ä½œ for (auto&amp; a : arr) &#123; if (a &gt; temp) &#123; largeNums.emplace_back(a); &#125; &#125; print(largeNums);&#125; å›è°ƒå‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334#include&lt;iostream&gt;#include&lt;algorithm&gt; //std::for_each#include&lt;vector&gt;using namespace std;vector&lt;int&gt; arr;vector&lt;int&gt; largeNums; //ç­›é€‰å‡ºå¤§äº5çš„æ•°int temp = 5;void fun(int&amp; n)&#123; if (n &gt; temp) &#123; largeNums.emplace_back(n); &#125;&#125;void print(int&amp; n)&#123; cout &lt;&lt; n &lt;&lt; &quot; &quot;;&#125;void main()&#123; for (int i = 0; i &lt; 10; i++) &#123; arr.emplace_back(i); &#125; //ç­›é€‰ for_each(arr.begin(), arr.end(), fun); //éå† for_each(largeNums.begin(), largeNums.end(), print);&#125; lambdaè¡¨è¾¾å¼ï¼š 123456789101112131415161718192021222324252627#include&lt;iostream&gt;#include&lt;algorithm&gt; //std::for_each#include&lt;vector&gt;using namespace std;vector&lt;int&gt; arr;vector&lt;int&gt; largeNums; //ç­›é€‰å‡ºå¤§äº5çš„æ•°void main()&#123; for (int i = 0; i &lt; 10; i++) &#123; arr.emplace_back(i); &#125; int temp = 5; //ç­›é€‰ for_each(arr.begin(), arr.end(), [&amp;temp](int&amp; n) &#123; if (n &gt; temp) largeNums.emplace_back(n); &#125;); //éå† for_each(largeNums.begin(), largeNums.end(), [](int&amp; n) &#123; cout &lt;&lt; n &lt;&lt; &quot; &quot;; &#125;);&#125;","categories":[{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"}],"tags":[{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"}]},{"title":"(æ¯æ—¥LeetCode)646. æœ€é•¿æ•°å¯¹é“¾","slug":"æ¯æ—¥LeetCode/2022-9/646 æœ€é•¿æ•°å¯¹é“¾","date":"2022-09-03T00:34:00.000Z","updated":"2022-09-03T00:35:59.480Z","comments":true,"path":"2022/09/03/æ¯æ—¥LeetCode/2022-9/646 æœ€é•¿æ•°å¯¹é“¾/","link":"","permalink":"http://example.com/2022/09/03/%E6%AF%8F%E6%97%A5LeetCode/2022-9/646%20%E6%9C%80%E9%95%BF%E6%95%B0%E5%AF%B9%E9%93%BE/","excerpt":"","text":"é¢˜ç›®ï¼š ç»™å‡º n ä¸ªæ•°å¯¹ã€‚ åœ¨æ¯ä¸€ä¸ªæ•°å¯¹ä¸­ï¼Œç¬¬ä¸€ä¸ªæ•°å­—æ€»æ˜¯æ¯”ç¬¬äºŒä¸ªæ•°å­—å°ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ç§è·Ÿéšå…³ç³»ï¼Œå½“ä¸”ä»…å½“ b &lt; c æ—¶ï¼Œæ•°å¯¹(c, d) æ‰å¯ä»¥è·Ÿåœ¨ (a, b) åé¢ã€‚æˆ‘ä»¬ç”¨è¿™ç§å½¢å¼æ¥æ„é€ ä¸€ä¸ªæ•°å¯¹é“¾ã€‚ ç»™å®šä¸€ä¸ªæ•°å¯¹é›†åˆï¼Œæ‰¾å‡ºèƒ½å¤Ÿå½¢æˆçš„æœ€é•¿æ•°å¯¹é“¾çš„é•¿åº¦ã€‚ä½ ä¸éœ€è¦ç”¨åˆ°æ‰€æœ‰çš„æ•°å¯¹ï¼Œä½ å¯ä»¥ä»¥ä»»ä½•é¡ºåºé€‰æ‹©å…¶ä¸­çš„ä¸€äº›æ•°å¯¹æ¥æ„é€ ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼š[[1,2], [2,3], [3,4]]è¾“å‡ºï¼š2è§£é‡Šï¼šæœ€é•¿çš„æ•°å¯¹é“¾æ˜¯ [1,2] -&gt; [3,4] æ€è·¯ï¼šåŠ¨æ€è§„åˆ’éå†æ•°ç»„pairs ç”¨ iè¡¨ç¤º å¦‚æœå­˜åœ¨pairs[j][1] &lt; pairs[i][0] é‡æ–°éå†ä¹‹å‰å·²ç»éå†è¿‡çš„å…ƒç´ (iä½ç½®ä¹‹å‰çš„å…ƒç´ )pairsç”¨jè¡¨ç¤ºå¹¶ä¸”j &lt; iï¼Œæ‰¾åˆ°æœ€å¤§çš„dp[j] + 1ï¼Œè®°å½•åˆ°dp[i]ä¸­ è¿”å›dpæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ å°±ä¸ºæœ€é•¿æ•°å¯¹é“¾ ä»£ç (cpp)ï¼š12345678910111213141516class Solution &#123;public: int findLongestChain(vector&lt;vector&lt;int&gt;&gt;&amp; pairs) &#123; vector&lt;int&gt; dp(pairs.size(), 1); sort(pairs.begin(), pairs.end()); for(int i = 0; i &lt; pairs.size(); i++)&#123; for(int j = 0; j &lt; i; j++)&#123; if (pairs[j][1] &lt; pairs[i][0]) &#123; dp[i] = max(dp[i], dp[j] + 1); &#125; &#125; &#125; return dp.back(); &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n ä¸º pairs çš„é•¿åº¦ã€‚æ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º O(nlogn)ï¼Œä¸¤å±‚ for å¾ªç¯çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n^2)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œæ•°ç»„ dp çš„ç©ºé—´å¤æ‚åº¦ä¸º O(n)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)687. æœ€é•¿åŒå€¼è·¯å¾„","slug":"æ¯æ—¥LeetCode/2022-9/687 æœ€é•¿åŒå€¼è·¯å¾„","date":"2022-09-02T01:36:00.000Z","updated":"2022-09-02T01:36:36.365Z","comments":true,"path":"2022/09/02/æ¯æ—¥LeetCode/2022-9/687 æœ€é•¿åŒå€¼è·¯å¾„/","link":"","permalink":"http://example.com/2022/09/02/%E6%AF%8F%E6%97%A5LeetCode/2022-9/687%20%E6%9C%80%E9%95%BF%E5%90%8C%E5%80%BC%E8%B7%AF%E5%BE%84/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„ root ï¼Œè¿”å› æœ€é•¿çš„è·¯å¾„çš„é•¿åº¦ ï¼Œè¿™ä¸ªè·¯å¾„ä¸­çš„ æ¯ä¸ªèŠ‚ç‚¹å…·æœ‰ç›¸åŒå€¼ ã€‚ è¿™æ¡è·¯å¾„å¯ä»¥ç»è¿‡ä¹Ÿå¯ä»¥ä¸ç»è¿‡æ ¹èŠ‚ç‚¹ã€‚ ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·¯å¾„é•¿åº¦ ç”±å®ƒä»¬ä¹‹é—´çš„è¾¹æ•°è¡¨ç¤ºã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [5,4,5,1,1,5]è¾“å‡ºï¼š2 æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)é€’å½’åˆ°æ ‘çš„æœ€åº•éƒ¨åï¼Œå¾—åˆ°å·¦å³å­æ ‘çš„è·¯å¾„é•¿åº¦ å…¶ä¸­ansè®°å½•äº†å·¦å³å­æ ‘ç”±å®ƒä»¬çš„çˆ¶èŠ‚ç‚¹ç›¸è¿ï¼Œæ‰€å¾—åˆ°çš„å·¦å³å­æ ‘ç›¸åŠ çš„è·¯å¾„é•¿åº¦ è¿”å›å€¼ä¸ºå·¦å³å­æ ‘ä¸­æœ€é•¿è·¯å¾„çš„é•¿åº¦ ä¸¾ä¾‹ï¼š â€‹ 1 &#x2F; \\ 1 1 &#x2F; \\ 1 1 æ­¤æ—¶ï¼Œçº¢è‰²æ ‡è®°çš„å°±æ˜¯çˆ¶èŠ‚ç‚¹ 1 &#x2F; \\ 1 1 ansçš„å€¼å°±ä¸ºï¼š2(å·¦å³å­æ ‘çš„è·¯å¾„é•¿åº¦çš„ç›¸åŠ ä¹‹å’Œ)ï¼Œä¹Ÿå°±æ˜¯å±€éƒ¨çš„æœ€ä¼˜è§£ ä½†æ˜¯è¿”å›å€¼åº”ä¸ºå·¦å³å­æ ‘çš„ä¸­çš„æœ€é•¿è·¯å¾„çš„é•¿åº¦ å› ä¸ºå¦‚æœè¿”å›å·¦å³å­æ ‘ç›¸åŠ ä¹‹å’Œçš„è·¯å¾„é•¿åº¦å°±ä¼šå¯¼è‡´ï¼š â€‹ 1 &#x2F; 1 &#x2F; \\ 1 1 å‡ºç°â€ä¸‰å²”å£â€ã€‚ è¿”å›å·¦å³å­æ ‘çš„ä¸­çš„æœ€é•¿è·¯å¾„çš„é•¿åº¦ â€‹ 1 &#x2F; 1 \\ â€‹ 1 ä¸ä¼šå‡ºç°â€ä¸‰å²”å£â€ã€‚ ä¸€ç›´å‘ä¸Šè¿”å›å€¼ï¼Œç›´è‡³åˆ°è¾¾rootæ ¹èŠ‚ç‚¹ï¼Œæœ€åå¾—åˆ°ansçš„æœ€å¤§å€¼(å…¨å±€æœ€ä¼˜è§£) â€‹ 1 &#x2F; \\ 1 1 \\ â€‹ 1 ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728class Solution &#123;public: int ans = 0; //è®°å½•æœ€é•¿çš„è·¯å¾„ int dfs(TreeNode* root)&#123; if(root == nullptr) return 0; //è¿›å…¥æœ€åº•å±‚çš„èŠ‚ç‚¹ï¼Œä»ä¸‹å¾€ä¸Šè®¡ç®— int L = dfs(root-&gt;left); //è·å–å·¦å­æ ‘ä¸­æœ€é•¿çš„ä¸€æ®µè·¯å¾„ int R = dfs(root-&gt;right); //è·å–å³å­æ ‘ä¸­æœ€é•¿çš„ä¸€æ®µè·¯å¾„ int temp_L = 0; int temp_R = 0; //å¦‚æœå·¦å­æ ‘çš„å€¼ä¸çˆ¶èŠ‚ç‚¹çš„å€¼ç›¸åŒï¼Œåˆ™åŠ ä¸€ï¼Œå¦åˆ™ç½®ä¸º0 if(root-&gt;left != nullptr &amp;&amp; root-&gt;left-&gt;val == root-&gt;val) temp_L = L + 1; if(root-&gt;right != nullptr &amp;&amp; root-&gt;right-&gt;val == root-&gt;val) temp_R = R + 1; //å°†å·¦å³å­æ ‘ç›¸åŠ å˜ä¸ºä¸€æ¡è·¯å¾„ï¼Œä¸ä¹‹å‰çš„æœ€é•¿è·¯å¾„æ¯”è¾ƒ ans = max(ans, temp_L + temp_R); //è¿”å›å·¦å­æ ‘æˆ–å³å­æ ‘ä¸­çš„æœ€é•¿çš„ä¸€æ®µè·¯å¾„ return max(temp_L, temp_R); &#125; int longestUnivaluePath(TreeNode* root) &#123; dfs(root); return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºæ ‘çš„ç»“ç‚¹æ•°ç›®ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚é€’å½’æ ˆæœ€åæƒ…å†µä¸‹éœ€è¦ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1475. å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼","slug":"æ¯æ—¥LeetCode/2022-9/1475 å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼","date":"2022-09-01T01:35:00.000Z","updated":"2022-09-01T01:36:05.052Z","comments":true,"path":"2022/09/01/æ¯æ—¥LeetCode/2022-9/1475 å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼/","link":"","permalink":"http://example.com/2022/09/01/%E6%AF%8F%E6%97%A5LeetCode/2022-9/1475%20%E5%95%86%E5%93%81%E6%8A%98%E6%89%A3%E5%90%8E%E7%9A%84%E6%9C%80%E7%BB%88%E4%BB%B7%E6%A0%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•°ç»„ prices ï¼Œå…¶ä¸­ prices[i] æ˜¯å•†åº—é‡Œç¬¬ i ä»¶å•†å“çš„ä»·æ ¼ã€‚ å•†åº—é‡Œæ­£åœ¨è¿›è¡Œä¿ƒé”€æ´»åŠ¨ï¼Œå¦‚æœä½ è¦ä¹°ç¬¬ i ä»¶å•†å“ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¾—åˆ°ä¸ prices[j] ç›¸ç­‰çš„æŠ˜æ‰£ï¼Œå…¶ä¸­ j æ˜¯æ»¡è¶³ j &gt; i ä¸” prices[j] &lt;= prices[i] çš„ æœ€å°ä¸‹æ ‡ ï¼Œå¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„ j ï¼Œä½ å°†æ²¡æœ‰ä»»ä½•æŠ˜æ‰£ã€‚ è¯·ä½ è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­ç¬¬ i ä¸ªå…ƒç´ æ˜¯æŠ˜æ‰£åä½ è´­ä¹°å•†å“ i æœ€ç»ˆéœ€è¦æ”¯ä»˜çš„ä»·æ ¼ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šprices &#x3D; [8,4,6,2,3]è¾“å‡ºï¼š[4,2,4,2,3]è§£é‡Šï¼šå•†å“ 0 çš„ä»·æ ¼ä¸º price[0]&#x3D;8 ï¼Œä½ å°†å¾—åˆ° prices[1]&#x3D;4 çš„æŠ˜æ‰£ï¼Œæ‰€ä»¥æœ€ç»ˆä»·æ ¼ä¸º 8 - 4 &#x3D; 4 ã€‚å•†å“ 1 çš„ä»·æ ¼ä¸º price[1]&#x3D;4 ï¼Œä½ å°†å¾—åˆ° prices[3]&#x3D;2 çš„æŠ˜æ‰£ï¼Œæ‰€ä»¥æœ€ç»ˆä»·æ ¼ä¸º 4 - 2 &#x3D; 2 ã€‚å•†å“ 2 çš„ä»·æ ¼ä¸º price[2]&#x3D;6 ï¼Œä½ å°†å¾—åˆ° prices[3]&#x3D;2 çš„æŠ˜æ‰£ï¼Œæ‰€ä»¥æœ€ç»ˆä»·æ ¼ä¸º 6 - 2 &#x3D; 4 ã€‚å•†å“ 3 å’Œ 4 éƒ½æ²¡æœ‰æŠ˜æ‰£ã€‚ æ€è·¯ï¼šéå†éå†æ‰¾åˆ°æ»¡è¶³ j &gt; i ä¸” prices[j] &lt;= prices[i] çš„ æœ€å°ä¸‹æ ‡ ä»£ç (cpp)ï¼š123456789101112131415161718class Solution &#123;public: vector&lt;int&gt; finalPrices(vector&lt;int&gt;&amp; prices) &#123; int n = prices.size(); vector&lt;int&gt; ans(n); for(int i = 0; i &lt; n; i++)&#123; ans[i] = prices[i]; for(int j = i + 1; j &lt; n; j++)&#123; if(prices[j] &lt;= prices[i])&#123; ans[i] -= prices[j]; break; &#125; &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n ä¸ºæ•°ç»„çš„é•¿åº¦ã€‚å¯¹äºæ¯ä¸ªå•†å“ï¼Œæˆ‘ä»¬éœ€è¦éå†ä¸€éæ•°ç»„æŸ¥æ‰¾ç¬¦åˆé¢˜ç›®è¦æ±‚çš„æŠ˜æ‰£ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)946. éªŒè¯æ ˆåºåˆ—","slug":"æ¯æ—¥LeetCode/2022-8/946 éªŒè¯æ ˆåºåˆ—","date":"2022-08-31T00:20:00.000Z","updated":"2022-08-31T00:20:45.457Z","comments":true,"path":"2022/08/31/æ¯æ—¥LeetCode/2022-8/946 éªŒè¯æ ˆåºåˆ—/","link":"","permalink":"http://example.com/2022/08/31/%E6%AF%8F%E6%97%A5LeetCode/2022-8/946%20%E9%AA%8C%E8%AF%81%E6%A0%88%E5%BA%8F%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®š pushed å’Œ popped ä¸¤ä¸ªåºåˆ—ï¼Œæ¯ä¸ªåºåˆ—ä¸­çš„ å€¼éƒ½ä¸é‡å¤ï¼Œåªæœ‰å½“å®ƒä»¬å¯èƒ½æ˜¯åœ¨æœ€åˆç©ºæ ˆä¸Šè¿›è¡Œçš„æ¨å…¥ push å’Œå¼¹å‡º pop æ“ä½œåºåˆ—çš„ç»“æœæ—¶ï¼Œè¿”å› trueï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼špushed &#x3D; [1,2,3,4,5], popped &#x3D; [4,5,3,2,1]è¾“å‡ºï¼štrueè§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼špush(1), push(2), push(3), push(4), pop() -&gt; 4,push(5), pop() -&gt; 5, pop() -&gt; 3, pop() -&gt; 2, pop() -&gt; 1 æ€è·¯ï¼šæ¨¡æ‹Ÿä¾æ¬¡å°†pushedæ•°ç»„ä¸­çš„å…ƒç´ å…¥æ ˆï¼Œå¦‚æœæ ˆsçš„æ ˆé¡¶ç­‰äºpoppedçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°†æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œå¹¶åˆ¤æ–­poppedæ•°ç»„çš„ä¸‹ä¸€ä¸ªå…ƒç´  æœ€ååªéœ€è¦åˆ¤æ–­æ ˆsæ˜¯å¦ä¸ºç©ºå³å¯ ä»£ç (cpp)ï¼š123456789101112131415class Solution &#123;public: bool validateStackSequences(vector&lt;int&gt;&amp; pushed, vector&lt;int&gt;&amp; popped) &#123; stack&lt;int&gt; s; int pos = 0 for (int i = 0; i &lt; pushed.size(); i++) &#123; s.emplace(pushed[i]); while (!s.empty() &amp;&amp; s.top() == popped[pos]) &#123; s.pop(); pos++; &#125; &#125; return s.empty(); &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ nn æ˜¯æ•°ç»„ pushed å’Œ popped çš„é•¿åº¦ã€‚éœ€è¦éå†æ•°ç»„ pushed å’Œ popped å„ä¸€æ¬¡ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ä¸ºæœ‰æ•ˆçš„æ ˆæ“ä½œåºåˆ—ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ pushed å’Œ popped çš„é•¿åº¦ã€‚ç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºæ ˆç©ºé—´ï¼Œæ ˆå†…å…ƒç´ ä¸ªæ•°ä¸è¶…è¿‡ nã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)998. æœ€å¤§äºŒå‰æ ‘ II","slug":"æ¯æ—¥LeetCode/2022-8/998 æœ€å¤§äºŒå‰æ ‘ II","date":"2022-08-30T00:45:00.000Z","updated":"2022-08-30T00:49:28.038Z","comments":true,"path":"2022/08/30/æ¯æ—¥LeetCode/2022-8/998 æœ€å¤§äºŒå‰æ ‘ II/","link":"","permalink":"http://example.com/2022/08/30/%E6%AF%8F%E6%97%A5LeetCode/2022-8/998%20%E6%9C%80%E5%A4%A7%E4%BA%8C%E5%8F%89%E6%A0%91%20II/","excerpt":"","text":"é¢˜ç›®ï¼š æœ€å¤§æ ‘ å®šä¹‰ï¼šä¸€æ£µæ ‘ï¼Œå¹¶æ»¡è¶³ï¼šå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºå…¶å­æ ‘ä¸­çš„ä»»ä½•å…¶ä»–å€¼ã€‚ ç»™ä½ æœ€å¤§æ ‘çš„æ ¹èŠ‚ç‚¹ root å’Œä¸€ä¸ªæ•´æ•° val ã€‚ å°±åƒ ä¹‹å‰çš„é—®é¢˜ é‚£æ ·ï¼Œç»™å®šçš„æ ‘æ˜¯åˆ©ç”¨ Construct(a) ä¾‹ç¨‹ä»åˆ—è¡¨ aï¼ˆroot &#x3D; Construct(a)ï¼‰é€’å½’åœ°æ„å»ºçš„ï¼š å¦‚æœ a ä¸ºç©ºï¼Œè¿”å› null ã€‚å¦åˆ™ï¼Œä»¤ a[i] ä½œä¸º a çš„æœ€å¤§å…ƒç´ ã€‚åˆ›å»ºä¸€ä¸ªå€¼ä¸º a[i] çš„æ ¹èŠ‚ç‚¹ root ã€‚root çš„å·¦å­æ ‘å°†è¢«æ„å»ºä¸º Construct([a[0], a[1], â€¦, a[i - 1]]) ã€‚root çš„å³å­æ ‘å°†è¢«æ„å»ºä¸º Construct([a[i + 1], a[i + 2], â€¦, a[a.length - 1]]) ã€‚è¿”å› root ã€‚è¯·æ³¨æ„ï¼Œé¢˜ç›®æ²¡æœ‰ç›´æ¥ç»™å‡º a ï¼Œåªæ˜¯ç»™å‡ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ root &#x3D; Construct(a) ã€‚ å‡è®¾ b æ˜¯ a çš„å‰¯æœ¬ï¼Œå¹¶åœ¨æœ«å°¾é™„åŠ å€¼ valã€‚é¢˜ç›®æ•°æ®ä¿è¯ b ä¸­çš„å€¼äº’ä¸ç›¸åŒã€‚ è¿”å› Construct(b) ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [4,1,3,null,null,2], val &#x3D; 5è¾“å‡ºï¼š[5,4,null,1,3,null,null,2]è§£é‡Šï¼ša &#x3D; [1,4,2,3], b &#x3D; [1,4,2,3,5] æ²¡çœ‹æ‡‚é¢˜ç›®â€¦ çœ‹é¢˜è§£å¤§æ¦‚æ˜¯ï¼švalè¶³å¤Ÿå¤§ï¼Œæ•´ä¸ªæ ‘éƒ½æ˜¯å·¦å­æ ‘ã€‚valè¶³å¤Ÿå°ï¼Œå˜æˆä¸€ä¸ªå³å¶å­ã€‚ ä»£ç (cpp)ï¼š 12345678910111213class Solution &#123;public: TreeNode* insertIntoMaxTree(TreeNode* root, int val) &#123; if(root == nullptr)&#123; return new TreeNode(val); &#125; if(root-&gt;val &lt; val)&#123; return new TreeNode(val, root, nullptr); &#125; root-&gt;right = insertIntoMaxTree(root-&gt;right, val); return root; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1470. é‡æ–°æ’åˆ—æ•°ç»„","slug":"æ¯æ—¥LeetCode/2022-8/1470 é‡æ–°æ’åˆ—æ•°ç»„","date":"2022-08-28T23:54:00.000Z","updated":"2022-08-28T23:54:54.268Z","comments":true,"path":"2022/08/29/æ¯æ—¥LeetCode/2022-8/1470 é‡æ–°æ’åˆ—æ•°ç»„/","link":"","permalink":"http://example.com/2022/08/29/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1470%20%E9%87%8D%E6%96%B0%E6%8E%92%E5%88%97%E6%95%B0%E7%BB%84/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•°ç»„ nums ï¼Œæ•°ç»„ä¸­æœ‰ 2n ä¸ªå…ƒç´ ï¼ŒæŒ‰ [x1,x2,...,xn,y1,y2,...,yn] çš„æ ¼å¼æ’åˆ—ã€‚ è¯·ä½ å°†æ•°ç»„æŒ‰ [x1,y1,x2,y2,...,xn,yn] æ ¼å¼é‡æ–°æ’åˆ—ï¼Œè¿”å›é‡æ’åçš„æ•°ç»„ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [2,5,1,3,4,7], n &#x3D; 3è¾“å‡ºï¼š[2,3,5,4,1,7]è§£é‡Šï¼šç”±äº x1&#x3D;2, x2&#x3D;5, x3&#x3D;1, y1&#x3D;3, y2&#x3D;4, y3&#x3D;7 ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º [2,3,5,4,1,7] æ€è·¯ï¼šåŒæŒ‡é’ˆåœ¨æ•°ç»„numsçš„èµ·å§‹ä½ç½®å’Œä¸­é—´ä½ç½®ä¾æ¬¡éå†æ·»åŠ åˆ°ansæ–°æ•°ç»„ä¸­ ä»£ç (cpp)ï¼š123456789101112131415class Solution &#123;public: vector&lt;int&gt; shuffle(vector&lt;int&gt;&amp; nums, int n) &#123; vector&lt;int&gt; ans(2*n); int left = 0; int right = n; while(left &lt; n)&#123; ans.emplace_back(nums[left]); ans.emplace_back(nums[right]); left++; right++; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯ç»™å®šçš„å‚æ•°ã€‚éœ€è¦éå†é•¿åº¦ä¸º 2n çš„æ•°ç»„ nums ä¸€æ¬¡å°†æ•°ç»„é‡æ–°æ’åˆ—ï¼Œæ¯ä¸ªå…ƒç´ é‡æ–°æ’åˆ—çš„æ—¶é—´æ˜¯ O(1)O(1)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚æ³¨æ„è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)662. äºŒå‰æ ‘æœ€å¤§å®½åº¦","slug":"æ¯æ—¥LeetCode/2022-8/662 äºŒå‰æ ‘æœ€å¤§å®½åº¦","date":"2022-08-27T02:23:00.000Z","updated":"2022-08-27T02:24:07.404Z","comments":true,"path":"2022/08/27/æ¯æ—¥LeetCode/2022-8/662 äºŒå‰æ ‘æœ€å¤§å®½åº¦/","link":"","permalink":"http://example.com/2022/08/27/%E6%AF%8F%E6%97%A5LeetCode/2022-8/662%20%E4%BA%8C%E5%8F%89%E6%A0%91%E6%9C%80%E5%A4%A7%E5%AE%BD%E5%BA%A6/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¿”å›æ ‘çš„ æœ€å¤§å®½åº¦ ã€‚ æ ‘çš„ æœ€å¤§å®½åº¦ æ˜¯æ‰€æœ‰å±‚ä¸­æœ€å¤§çš„ å®½åº¦ ã€‚ æ¯ä¸€å±‚çš„ å®½åº¦ è¢«å®šä¹‰ä¸ºè¯¥å±‚æœ€å·¦å’Œæœ€å³çš„éç©ºèŠ‚ç‚¹ï¼ˆå³ï¼Œä¸¤ä¸ªç«¯ç‚¹ï¼‰ä¹‹é—´çš„é•¿åº¦ã€‚å°†è¿™ä¸ªäºŒå‰æ ‘è§†ä½œä¸æ»¡äºŒå‰æ ‘ç»“æ„ç›¸åŒï¼Œä¸¤ç«¯ç‚¹é—´ä¼šå‡ºç°ä¸€äº›å»¶ä¼¸åˆ°è¿™ä¸€å±‚çš„ null èŠ‚ç‚¹ï¼Œè¿™äº› null èŠ‚ç‚¹ä¹Ÿè®¡å…¥é•¿åº¦ã€‚ é¢˜ç›®æ•°æ®ä¿è¯ç­”æ¡ˆå°†ä¼šåœ¨ 32 ä½ å¸¦ç¬¦å·æ•´æ•°èŒƒå›´å†…ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [1,3,2,5,3,null,9]è¾“å‡ºï¼š4è§£é‡Šï¼šæœ€å¤§å®½åº¦å‡ºç°åœ¨æ ‘çš„ç¬¬ 3 å±‚ï¼Œå®½åº¦ä¸º 4 (5,3,null,9) ã€‚ æ€è·¯ï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢(BFS)å°±æ˜¯ä¸€ä¸ªäºŒå‰æ ‘çš„å±‚åºéå† åªæ˜¯éå†çš„æ—¶å€™å¢åŠ äº†ä¸€ä¸ª æ ‡è®°æ¯ä¸ªç»“ç‚¹çš„åºå· çš„è¿‡ç¨‹ å¦‚æœæŸèŠ‚ç‚¹nodeçš„åºå·ä¸ºnï¼Œé‚£ä¹ˆå®ƒçš„å·¦èŠ‚ç‚¹ä¸º2nï¼Œå³èŠ‚ç‚¹ä¸º2n+1 æ¯å±‚çš„å°¾åºå·ä¸é¦–åºå·ä¹‹é—´çš„å·®å°±æ˜¯è¯¥å±‚çš„å®½åº¦ è¿”å›æœ€å¤§å®½åº¦ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223class Solution &#123;public: int widthOfBinaryTree(TreeNode* root) &#123; // åˆå§‹åŒ–æ•°ç»„å‚¨å­˜ç»“ç‚¹ä»¥åŠå¯¹åº”çš„åºå· vector&lt;pair&lt;TreeNode*, unsigned long long&gt;&gt; array; array.emplace_back(root, 1L); unsigned long long ans = 0; while(!array.empty())&#123; //å±‚åºéå† vector&lt;pair&lt;TreeNode*, unsigned long long&gt;&gt; temp; // è·å–æ¯ä¸ªç»“ç‚¹ä»¥åŠå¯¹åº”çš„åºå· for(auto&amp; [node, index] : array)&#123; //éå†è¯¥å±‚çš„æ¯ä¸ªç»“ç‚¹ if(node-&gt;left) temp.emplace_back(node-&gt;left, index*2); if(node-&gt;right) temp.emplace_back(node-&gt;right, index*2 + 1); &#125; ans = max(ans, array.back().second - array[0].second + 1); array = move(temp); //å°†temp(å°±æ˜¯ä¸‹ä¸€å±‚çš„ç»“ç‚¹)å¼•ç”¨ç»™array &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚éœ€è¦éå†æ‰€æœ‰èŠ‚ç‚¹ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚å¹¿åº¦ä¼˜å…ˆæœç´¢çš„ç©ºé—´å¤æ‚åº¦æœ€å¤šä¸º O(n)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1464. æ•°ç»„ä¸­ä¸¤å…ƒç´ çš„æœ€å¤§ä¹˜ç§¯","slug":"æ¯æ—¥LeetCode/2022-8/1464 æ•°ç»„ä¸­ä¸¤å…ƒç´ çš„æœ€å¤§ä¹˜ç§¯","date":"2022-08-26T01:01:00.000Z","updated":"2022-08-26T01:01:39.525Z","comments":true,"path":"2022/08/26/æ¯æ—¥LeetCode/2022-8/1464 æ•°ç»„ä¸­ä¸¤å…ƒç´ çš„æœ€å¤§ä¹˜ç§¯/","link":"","permalink":"http://example.com/2022/08/26/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1464%20%E6%95%B0%E7%BB%84%E4%B8%AD%E4%B8%A4%E5%85%83%E7%B4%A0%E7%9A%84%E6%9C%80%E5%A4%A7%E4%B9%98%E7%A7%AF/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œè¯·ä½ é€‰æ‹©æ•°ç»„çš„ä¸¤ä¸ªä¸åŒä¸‹æ ‡ i å’Œ jï¼Œä½¿ (nums[i]-1)*(nums[j]-1) å–å¾—æœ€å¤§å€¼ã€‚ è¯·ä½ è®¡ç®—å¹¶è¿”å›è¯¥å¼çš„æœ€å¤§å€¼ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [3,4,5,2]è¾“å‡ºï¼š12è§£é‡Šï¼šå¦‚æœé€‰æ‹©ä¸‹æ ‡ i&#x3D;1 å’Œ j&#x3D;2ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ï¼Œåˆ™å¯ä»¥è·å¾—æœ€å¤§å€¼ï¼Œ(nums[1]-1)(nums[2]-1) &#x3D; (4-1)(5-1) &#x3D; 3*4 &#x3D; 12 ã€‚ ä»£ç (cpp)ï¼š1234567class Solution &#123;public: int maxProduct(vector&lt;int&gt;&amp; nums) &#123; sort(nums.begin(), nums.end()); return (nums[nums.size()-2] - 1)*(nums[nums.size()-1] - 1); &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n ä¸ºæ•°ç»„ nums çš„é•¿åº¦ï¼Œä¸»è¦ä¸ºæ•°ç»„æ’åºçš„æ—¶é—´å¤æ‚åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œä»…ä½¿ç”¨å¸¸é‡ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)658. æ‰¾åˆ° K ä¸ªæœ€æ¥è¿‘çš„å…ƒç´ ","slug":"æ¯æ—¥LeetCode/2022-8/658 æ‰¾åˆ° K ä¸ªæœ€æ¥è¿‘çš„å…ƒç´ ","date":"2022-08-25T02:34:00.000Z","updated":"2022-08-25T02:34:05.353Z","comments":true,"path":"2022/08/25/æ¯æ—¥LeetCode/2022-8/658 æ‰¾åˆ° K ä¸ªæœ€æ¥è¿‘çš„å…ƒç´ /","link":"","permalink":"http://example.com/2022/08/25/%E6%AF%8F%E6%97%A5LeetCode/2022-8/658%20%E6%89%BE%E5%88%B0%20K%20%E4%B8%AA%E6%9C%80%E6%8E%A5%E8%BF%91%E7%9A%84%E5%85%83%E7%B4%A0/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ª æ’åºå¥½ çš„æ•°ç»„ arr ï¼Œä¸¤ä¸ªæ•´æ•° k å’Œ x ï¼Œä»æ•°ç»„ä¸­æ‰¾åˆ°æœ€é è¿‘ xï¼ˆä¸¤æ•°ä¹‹å·®æœ€å°ï¼‰çš„ k ä¸ªæ•°ã€‚è¿”å›çš„ç»“æœå¿…é¡»è¦æ˜¯æŒ‰å‡åºæ’å¥½çš„ã€‚ æ•´æ•° a æ¯”æ•´æ•° b æ›´æ¥è¿‘ x éœ€è¦æ»¡è¶³ï¼š |a - x| &lt; |b - x| æˆ–è€…|a - x| == |b - x| ä¸” a &lt; b ç¤ºä¾‹ï¼š è¾“å…¥ï¼šarr &#x3D; [1,2,3,4,5], k &#x3D; 4, x &#x3D; 3è¾“å‡ºï¼š[1,2,3,4] æ€è·¯ï¼šäºŒåˆ†æŸ¥æ‰¾+åŒæŒ‡é’ˆåˆ©ç”¨ äºŒåˆ†æŸ¥æ‰¾ æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸å°äºxçš„å…ƒç´  åˆ©ç”¨ åŒæŒ‡é’ˆ å¾ªç¯æ‰¾åˆ°æœ€æ¥è¿‘xå€¼çš„å…ƒç´ åŒºé—´ è¿”å›æ­¤åŒºé—´çš„å…ƒç´ å³å¯ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223class Solution &#123;public: vector&lt;int&gt; findClosestElements(vector&lt;int&gt;&amp; arr, int k, int x) &#123; auto right = lower_bound(arr.begin(), arr.end(), x); auto left = right - 1; while (k &gt; 0) &#123; if (left &lt; arr.begin()) &#123; right++; &#125; else if (right &gt;= arr.end()) &#123; left--; &#125; else if (x - *left &lt;= *right - x) &#123; left--; &#125; else &#123; right++; &#125; k--; &#125; return vector&lt;int&gt;(left + 1, right); &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(logn+k)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚äºŒåˆ†æŸ¥æ‰¾éœ€è¦ O(logn)ï¼ŒåŒæŒ‡é’ˆæŸ¥æ‰¾éœ€è¦ O(k)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1460. é€šè¿‡ç¿»è½¬å­æ•°ç»„ä½¿ä¸¤ä¸ªæ•°ç»„ç›¸ç­‰","slug":"æ¯æ—¥LeetCode/2022-8/1460 é€šè¿‡ç¿»è½¬å­æ•°ç»„ä½¿ä¸¤ä¸ªæ•°ç»„ç›¸ç­‰","date":"2022-08-24T01:54:00.000Z","updated":"2022-08-24T01:55:04.953Z","comments":true,"path":"2022/08/24/æ¯æ—¥LeetCode/2022-8/1460 é€šè¿‡ç¿»è½¬å­æ•°ç»„ä½¿ä¸¤ä¸ªæ•°ç»„ç›¸ç­‰/","link":"","permalink":"http://example.com/2022/08/24/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1460%20%E9%80%9A%E8%BF%87%E7%BF%BB%E8%BD%AC%E5%AD%90%E6%95%B0%E7%BB%84%E4%BD%BF%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E7%9B%B8%E7%AD%89/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸¤ä¸ªé•¿åº¦ç›¸åŒçš„æ•´æ•°æ•°ç»„ target å’Œ arr ã€‚æ¯ä¸€æ­¥ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹© arr çš„ä»»æ„ éç©ºå­æ•°ç»„ å¹¶å°†å®ƒç¿»è½¬ã€‚ä½ å¯ä»¥æ‰§è¡Œæ­¤è¿‡ç¨‹ä»»æ„æ¬¡ã€‚ å¦‚æœä½ èƒ½è®© arr å˜å¾—ä¸ target ç›¸åŒï¼Œè¿”å› Trueï¼›å¦åˆ™ï¼Œè¿”å› False ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼štarget &#x3D; [1,2,3,4], arr &#x3D; [2,4,1,3]è¾“å‡ºï¼štrueè§£é‡Šï¼šä½ å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤ä½¿ arr å˜æˆ targetï¼š1- ç¿»è½¬å­æ•°ç»„ [2,4,1] ï¼Œarr å˜æˆ [1,4,2,3]2- ç¿»è½¬å­æ•°ç»„ [4,2] ï¼Œarr å˜æˆ [1,2,4,3]3- ç¿»è½¬å­æ•°ç»„ [4,3] ï¼Œarr å˜æˆ [1,2,3,4]ä¸Šè¿°æ–¹æ³•å¹¶ä¸æ˜¯å”¯ä¸€çš„ï¼Œè¿˜å­˜åœ¨å¤šç§å°† arr å˜æˆ target çš„æ–¹æ³•ã€‚ æ€è·¯ï¼šè¿™é“é¢˜å¾ˆç®€å•ï¼ ä¸éœ€è¦å…³æ³¨è¿‡ç¨‹ï¼Œåªéœ€è¦çœ‹åˆ°ç»“æœå³å¯ å°†targetä¸arræ’åºåæ¯”è¾ƒæ˜¯å¦ç›¸åŒå³å¯ ä»£ç (cpp)ï¼š123456789class Solution &#123;public: bool canBeEqual(vector&lt;int&gt;&amp; target, vector&lt;int&gt;&amp; arr) &#123; sort(target.begin(), target.end()); sort(arr.begin(), arr.end()); return target == arr; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nÃ—logn)ï¼Œå…¶ä¸­ n æ˜¯è¾“å…¥æ•°ç»„çš„é•¿åº¦ã€‚æ’åºæ¶ˆè€— O(nÃ—logn) å¤æ‚åº¦ï¼Œåˆ¤æ–­æ˜¯å¦ç›¸åŒæ¶ˆè€— O(n) å¤æ‚åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå¿«é€Ÿæ’åºé€’å½’æ·±åº¦å¹³å‡ä¸º O(logn)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)655. è¾“å‡ºäºŒå‰æ ‘","slug":"æ¯æ—¥LeetCode/2022-8/655 è¾“å‡ºäºŒå‰æ ‘","date":"2022-08-22T02:20:00.000Z","updated":"2022-08-22T02:21:03.902Z","comments":true,"path":"2022/08/22/æ¯æ—¥LeetCode/2022-8/655 è¾“å‡ºäºŒå‰æ ‘/","link":"","permalink":"http://example.com/2022/08/22/%E6%AF%8F%E6%97%A5LeetCode/2022-8/655%20%E8%BE%93%E5%87%BA%E4%BA%8C%E5%8F%89%E6%A0%91/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¯·ä½ æ„é€ ä¸€ä¸ªä¸‹æ ‡ä» 0 å¼€å§‹ã€å¤§å°ä¸º m x n çš„å­—ç¬¦ä¸²çŸ©é˜µ res ï¼Œç”¨ä»¥è¡¨ç¤ºæ ‘çš„ æ ¼å¼åŒ–å¸ƒå±€ ã€‚æ„é€ æ­¤æ ¼å¼åŒ–å¸ƒå±€çŸ©é˜µéœ€è¦éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š æ ‘çš„ é«˜åº¦ ä¸º height ï¼ŒçŸ©é˜µçš„è¡Œæ•° m åº”è¯¥ç­‰äº height + 1 ã€‚çŸ©é˜µçš„åˆ—æ•° n åº”è¯¥ç­‰äº 2^(height+1 - 1) ã€‚æ ¹èŠ‚ç‚¹ éœ€è¦æ”¾ç½®åœ¨ é¡¶è¡Œ çš„ æ­£ä¸­é—´ ï¼Œå¯¹åº”ä½ç½®ä¸º res[0][(n-1)/2] ã€‚å¯¹äºæ”¾ç½®åœ¨çŸ©é˜µä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œè®¾å¯¹åº”ä½ç½®ä¸º res[r][c] ï¼Œå°†å…¶å·¦å­èŠ‚ç‚¹æ”¾ç½®åœ¨ res[r+1][c-2height-r-1] ï¼Œå³å­èŠ‚ç‚¹æ”¾ç½®åœ¨ res[r+1][c+2height-r-1]ã€‚ç»§ç»­è¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°æ ‘ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å¦¥å–„æ”¾ç½®ã€‚ä»»æ„ç©ºå•å…ƒæ ¼éƒ½åº”è¯¥åŒ…å«ç©ºå­—ç¬¦ä¸² &quot;&quot; ã€‚è¿”å›æ„é€ å¾—åˆ°çš„çŸ©é˜µ res ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [1,2,3,null,4]è¾“å‡ºï¼š[[â€œâ€,â€â€,â€â€,â€1â€,â€â€,â€â€,â€â€],[â€œâ€,â€2â€,â€â€,â€â€,â€â€,â€3â€,â€â€],[â€œâ€,â€â€,â€4â€,â€â€,â€â€,â€â€,â€â€]] æ€è·¯ï¼šDFS(æ·±åº¦ä¼˜å…ˆæœç´¢) åˆ©ç”¨DFSè·å–æ·±åº¦ åˆ©ç”¨DFSéå†äºŒå‰æ ‘è·å–å¯¹åº”çš„valå€¼ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829303132333435class Solution &#123;public: int getHeight(TreeNode* root)&#123; int height = 0; if(root-&gt;left)&#123; height = max(height, getHeight(root-&gt;left) + 1); &#125; if(root-&gt;right)&#123; height = max(height, getHeight(root-&gt;right) + 1); &#125; return height; &#125; void dfs(int r, int c, TreeNode* root, vector&lt;vector&lt;string&gt;&gt;&amp; res, int&amp; height)&#123; if(root == nullptr) return; res[r][c] = to_string(root-&gt;val); dfs(r+1, c-pow(2, height-r-1), root-&gt;left, res, height); dfs(r+1, c+pow(2, height-r-1), root-&gt;right, res, height); &#125; vector&lt;vector&lt;string&gt;&gt; printTree(TreeNode* root) &#123; int height = getHeight(root); //è·å–æ·±åº¦ int m = height + 1; int n = pow(2, m) - 1; //åˆå§‹åŒ–res vector&lt;vector&lt;string&gt;&gt; res(m, vector&lt;string&gt;(n)); //dfséå†äºŒå‰æ ‘ dfs(0, (n-1)/2, root, res, height); return res; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(heightÃ—2^height)ï¼Œå…¶ä¸­height æ˜¯äºŒå‰æ ‘çš„é«˜åº¦ã€‚éœ€è¦å¡«å…… (height + 1)Ã—(2^(height+1) âˆ’ 1) çš„æ•°ç»„ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(height)ï¼Œå…¶ä¸­ height æ˜¯äºŒå‰æ ‘çš„é«˜åº¦ã€‚ç©ºé—´å¤æ‚åº¦ä¸»è¦æ˜¯é€’å½’è°ƒç”¨çš„æ ˆç©ºé—´ï¼Œå–å†³äºäºŒå‰æ ‘çš„é«˜åº¦ã€‚æ³¨æ„è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"","slug":"å°æŠ€å·§/C++ä¸­1ã€Šã€Š nçš„æ„æ€","date":"2022-08-22T01:35:19.667Z","updated":"2022-08-22T01:42:23.591Z","comments":true,"path":"2022/08/22/å°æŠ€å·§/C++ä¸­1ã€Šã€Š nçš„æ„æ€/","link":"","permalink":"http://example.com/2022/08/22/%E5%B0%8F%E6%8A%80%E5%B7%A7/C++%E4%B8%AD1%E3%80%8A%E3%80%8A%20n%E7%9A%84%E6%84%8F%E6%80%9D/","excerpt":"","text":"1 &lt;&lt; næ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ1çš„äºŒè¿›åˆ¶æ˜¯0000 0001&lt;&lt;ï¼šå°†äºŒè¿›åˆ¶ç¼–ç å‘å·¦ç§»åŠ¨nä½å¹¶å°†ç©ºä½è¡¥0 ä¾‹å¦‚ï¼š 1 &lt;&lt; 2 å°±æ˜¯å°†0000 0001å·¦ç§»2ä½ä¸ºå˜æˆ0000 0100 è½¬æ¢æˆåè¿›åˆ¶æœ€ç»ˆå˜æˆ4 åŒç†ï¼š 1 &gt;&gt; nï¼šå°†äºŒè¿›åˆ¶ç¼–ç å‘å³ç§»åŠ¨nä½","categories":[],"tags":[]},{"title":"(æ¯æ—¥LeetCode)1455. æ£€æŸ¥å•è¯æ˜¯å¦ä¸ºå¥ä¸­å…¶ä»–å•è¯çš„å‰ç¼€","slug":"æ¯æ—¥LeetCode/2022-8/1455 æ£€æŸ¥å•è¯æ˜¯å¦ä¸ºå¥ä¸­å…¶ä»–å•è¯çš„å‰ç¼€","date":"2022-08-21T00:33:00.000Z","updated":"2022-08-21T00:40:32.493Z","comments":true,"path":"2022/08/21/æ¯æ—¥LeetCode/2022-8/1455 æ£€æŸ¥å•è¯æ˜¯å¦ä¸ºå¥ä¸­å…¶ä»–å•è¯çš„å‰ç¼€/","link":"","permalink":"http://example.com/2022/08/21/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1455%20%E6%A3%80%E6%9F%A5%E5%8D%95%E8%AF%8D%E6%98%AF%E5%90%A6%E4%B8%BA%E5%8F%A5%E4%B8%AD%E5%85%B6%E4%BB%96%E5%8D%95%E8%AF%8D%E7%9A%84%E5%89%8D%E7%BC%80/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² sentence ä½œä¸ºå¥å­å¹¶æŒ‡å®šæ£€ç´¢è¯ä¸º searchWord ï¼Œå…¶ä¸­å¥å­ç”±è‹¥å¹²ç”¨ å•ä¸ªç©ºæ ¼ åˆ†éš”çš„å•è¯ç»„æˆã€‚è¯·ä½ æ£€æŸ¥æ£€ç´¢è¯ searchWord æ˜¯å¦ä¸ºå¥å­ sentence ä¸­ä»»æ„å•è¯çš„å‰ç¼€ã€‚ å¦‚æœ searchWord æ˜¯æŸä¸€ä¸ªå•è¯çš„å‰ç¼€ï¼Œåˆ™è¿”å›å¥å­ sentence ä¸­è¯¥å•è¯æ‰€å¯¹åº”çš„ä¸‹æ ‡ï¼ˆä¸‹æ ‡ä» 1 å¼€å§‹ï¼‰ã€‚å¦‚æœ searchWord æ˜¯å¤šä¸ªå•è¯çš„å‰ç¼€ï¼Œåˆ™è¿”å›åŒ¹é…çš„ç¬¬ä¸€ä¸ªå•è¯çš„ä¸‹æ ‡ï¼ˆæœ€å°ä¸‹æ ‡ï¼‰ã€‚å¦‚æœ searchWord ä¸æ˜¯ä»»ä½•å•è¯çš„å‰ç¼€ï¼Œåˆ™è¿”å› -1 ã€‚ å­—ç¬¦ä¸² s çš„ å‰ç¼€ æ˜¯ s çš„ä»»ä½•å‰å¯¼è¿ç»­å­å­—ç¬¦ä¸²ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šsentence &#x3D; â€œi love eating burgerâ€, searchWord &#x3D; â€œburgâ€è¾“å‡ºï¼š4è§£é‡Šï¼šâ€burgâ€ æ˜¯ â€œburgerâ€ çš„å‰ç¼€ï¼Œè€Œ â€œburgerâ€ æ˜¯å¥å­ä¸­ç¬¬ 4 ä¸ªå•è¯ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: int isPrefixOfWord(string sentence, string searchWord) &#123; int ans = 1; //åˆå§‹åŒ–ç¬¬ä¸€ä¸ªå•è¯çš„wei for (int i = 0; i &lt; sentence.size(); i++) &#123; int temp = 0; while (sentence[i] == searchWord[temp]) &#123; // ä¸searchWordè¿›è¡Œæ¯”è¾ƒ if (temp == searchWord.size() - 1) &#123; //æ¯”è¾ƒå®Œï¼Œè¿”å›å•è¯ä½ç½® return ans; &#125; temp++; i++; &#125; while (i &lt; sentence.size() &amp;&amp; sentence[i] != &#x27; &#x27;)&#123;//éå†åˆ°ä¸‹ä¸€ä¸ªå•è¯ i++; &#125; ans++; // è¿›å…¥ä¸‹ä¸€ä¸ªå•è¯çš„ä½ç½® &#125; return -1; //ä¸å­˜åœ¨ï¼Œè¿”å›-1 &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)654. æœ€å¤§äºŒå‰æ ‘","slug":"æ¯æ—¥LeetCode/2022-8/654 æœ€å¤§äºŒå‰æ ‘","date":"2022-08-20T02:04:00.000Z","updated":"2022-08-20T02:05:04.652Z","comments":true,"path":"2022/08/20/æ¯æ—¥LeetCode/2022-8/654 æœ€å¤§äºŒå‰æ ‘/","link":"","permalink":"http://example.com/2022/08/20/%E6%AF%8F%E6%97%A5LeetCode/2022-8/654%20%E6%9C%80%E5%A4%A7%E4%BA%8C%E5%8F%89%E6%A0%91/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªä¸é‡å¤çš„æ•´æ•°æ•°ç»„ nums ã€‚ æœ€å¤§äºŒå‰æ ‘ å¯ä»¥ç”¨ä¸‹é¢çš„ç®—æ³•ä» nums é€’å½’åœ°æ„å»º: åˆ›å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå…¶å€¼ä¸º nums ä¸­çš„æœ€å¤§å€¼ã€‚é€’å½’åœ°åœ¨æœ€å¤§å€¼ å·¦è¾¹ çš„ å­æ•°ç»„å‰ç¼€ä¸Š æ„å»ºå·¦å­æ ‘ã€‚é€’å½’åœ°åœ¨æœ€å¤§å€¼ å³è¾¹ çš„ å­æ•°ç»„åç¼€ä¸Š æ„å»ºå³å­æ ‘ã€‚è¿”å› nums æ„å»ºçš„ æœ€å¤§äºŒå‰æ ‘ ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [3,2,1,6,0,5]è¾“å‡ºï¼š[6,3,5,null,2,0,null,null,1]è§£é‡Šï¼šé€’å½’è°ƒç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š [3,2,1,6,0,5] ä¸­çš„æœ€å¤§å€¼æ˜¯ 6 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [3,2,1] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [0,5] ã€‚ [3,2,1] ä¸­çš„æœ€å¤§å€¼æ˜¯ 3 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [2,1] ã€‚ ç©ºæ•°ç»„ï¼Œæ— å­èŠ‚ç‚¹ã€‚ [2,1] ä¸­çš„æœ€å¤§å€¼æ˜¯ 2 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [1] ã€‚ ç©ºæ•°ç»„ï¼Œæ— å­èŠ‚ç‚¹ã€‚ åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå€¼ä¸º 1 çš„èŠ‚ç‚¹ã€‚ [0,5] ä¸­çš„æœ€å¤§å€¼æ˜¯ 5 ï¼Œå·¦è¾¹éƒ¨åˆ†æ˜¯ [0] ï¼Œå³è¾¹éƒ¨åˆ†æ˜¯ [] ã€‚ åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå€¼ä¸º 0 çš„èŠ‚ç‚¹ã€‚ ç©ºæ•°ç»„ï¼Œæ— å­èŠ‚ç‚¹ã€‚ æ€è·¯ï¼šé€’å½’æ¯æ¬¡é€’å½’éå†ä¸­æ‰¾åˆ°leftå’ŒrightåŒºé—´çš„æœ€å¤§å€¼ä½œä¸ºè¯¥èŠ‚ç‚¹çš„valå€¼ï¼Œä»¥åŠè¯¥æœ€å¤§å€¼çš„ä½ç½®max_pos åˆ’åˆ†è¯¥èŠ‚ç‚¹çš„å·¦å­æ ‘çš„åŒºé—´ä¸ºleftå’Œmax_pos åˆ’åˆ†è¯¥èŠ‚ç‚¹çš„å³å­æ ‘çš„åŒºé—´ä¸ºmax_pos+1å’Œright å¦‚æœå·¦å³åŒºé—´left &gt;= rightè¯´æ˜å·²ç»éå†å®Œå…¨ï¼Œé€€å‡ºé€’å½’ ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425class Solution &#123;public: TreeNode* def(vector&lt;int&gt;&amp; nums, int left, int right)&#123; if(left &gt;= right) return nullptr; int temp = -1; int max_pos = 0; for(int i = left; i &lt; right; i++)&#123; if(nums[i] &gt; temp)&#123; temp = nums[i]; max_pos = i; &#125; &#125; TreeNode* node = new TreeNode(temp); node-&gt;left = def(nums, left, max_pos); node-&gt;right = def(nums, max_pos + 1, right); return node; &#125; TreeNode* constructMaximumBinaryTree(vector&lt;int&gt;&amp; nums) &#123; return def(nums, 0, nums.size()); &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ nums çš„é•¿åº¦ã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ä¸¥æ ¼é€’å¢æˆ–é€’å‡ï¼Œéœ€è¦é€’å½’ n å±‚ï¼Œç¬¬ (0 â‰¤ i &lt; n) å±‚éœ€è¦éå† n-i ä¸ªå…ƒç´ ä»¥æ‰¾å‡ºæœ€å¤§å€¼ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º O(n^2)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå³ä¸ºæœ€åæƒ…å†µä¸‹éœ€è¦ä½¿ç”¨çš„æ ˆç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"Dockerä¸­å®‰è£…esä»¥åŠkibana","slug":"è½¯ä»¶å®‰è£…/Dockerä¸­å®‰è£…esä»¥åŠkibana","date":"2022-08-19T02:55:08.053Z","updated":"2022-08-20T04:48:54.524Z","comments":true,"path":"2022/08/19/è½¯ä»¶å®‰è£…/Dockerä¸­å®‰è£…esä»¥åŠkibana/","link":"","permalink":"http://example.com/2022/08/19/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/Docker%E4%B8%AD%E5%AE%89%E8%A3%85es%E4%BB%A5%E5%8F%8Akibana/","excerpt":"","text":"1.es1.1 å®‰è£…esé•œåƒæˆ‘çš„å®¹å™¨ä¸­jdkç‰ˆæœ¬ä¸º8 è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯esçš„7.17.5ç‰ˆæœ¬é•œåƒé•œåƒå®‰è£…ï¼Œå› ä¸ºes8ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸æ”¯æŒjdk8 1docker pull elasticsearch:7.17.5 1.2 å¯åŠ¨eså®¹å™¨12345docker run -id \\--name c_es \\-p 9200:9200 \\-e &quot;discovery.type=single-node&quot; \\elasticsearch:7.17.5 1.3 æµ‹è¯•åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttp://ä¸»æœºåœ°å€ip:9200 å¦‚æœå‡ºç°ï¼š 1234567891011121314151617&#123; &quot;name&quot; : &quot;3c9efa3c75db&quot;, &quot;cluster_name&quot; : &quot;docker-cluster&quot;, &quot;cluster_uuid&quot; : &quot;1hr4ILNNQfufDSJYgcuIHQ&quot;, &quot;version&quot; : &#123; &quot;number&quot; : &quot;7.17.5&quot;, &quot;build_flavor&quot; : &quot;default&quot;, &quot;build_type&quot; : &quot;docker&quot;, &quot;build_hash&quot; : &quot;8d61b4f7ddf931f219e3745f295ed2bbc50c8e84&quot;, &quot;build_date&quot; : &quot;2022-06-23T21:57:28.736740635Z&quot;, &quot;build_snapshot&quot; : false, &quot;lucene_version&quot; : &quot;8.11.1&quot;, &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;, &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot; &#125;, &quot;tagline&quot; : &quot;You Know, for Search&quot;&#125; åˆ™è¯´æ˜å®‰è£…æˆåŠŸï¼ 1.4 è·¨åŸŸè®¿é—®é—®é¢˜è¿›å…¥å®¹å™¨ï¼š 1docker exec -it c_es /bin/bash ä¿®æ”¹elasticsearch.ymlï¼š 12cd /usr/share/elasticsearch/config/vi elasticsearch.yml æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 12http.cors.enabled: truehttp.cors.allow-origin: &quot;*&quot; é‡å¯å®¹å™¨ï¼š 1docker restart c_es 2.kibana2.1 å®‰è£…kibanaé•œåƒå‰æï¼šå·²ç»æˆåŠŸéƒ¨ç½²es æ³¨æ„ï¼škibanaç‰ˆæœ¬è¦ä¸esçš„ç‰ˆæœ¬ä¸€è‡´ 1docker pull kibana:7.17.5 2.2 è·å–eså®¹å™¨å†…éƒ¨ipæŸ¥çœ‹c_eså®¹å™¨ä¿¡æ¯ï¼š 1docker inspect c_es æ‰¾åˆ°IPAddress: &quot;ip&quot;ï¼Œæ­¤ipå°±æ˜¯eså®¹å™¨å†…éƒ¨ip 2.3 å¯åŠ¨kibanaå®¹å™¨å°†ELASTICSEARCH_HOSTSä¿®æ”¹ä¸ºè‡ªå·±eså®¹å™¨å†…éƒ¨ip 12345docker run -id \\--name c_kibana \\-e ELASTICSEARCH_HOSTS=http://eså®¹å™¨å†…éƒ¨ip:9200 \\-p 5601:5601 \\kibana:7.17.5 2.4 ä¿®æ”¹ä¸­æ–‡è¿›å…¥å®¹å™¨ï¼š 1docker exec -u 0 -it c_kibana /bin/bash 12cd configvi kibana.yml åœ¨æœ«å°¾åŠ ä¸Šä¸€ä¸‹å†…å®¹ï¼š 1i18n.locale: &quot;zh-CN&quot; 2.5 æµ‹è¯•åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttp://ä¸»æœºåœ°å€ip:5601 å°±å¯ä»¥çœ‹åˆ°kibanaçš„ç•Œé¢äº†ï¼","categories":[{"name":"è½¯ä»¶å®‰è£…","slug":"è½¯ä»¶å®‰è£…","permalink":"http://example.com/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"}],"tags":[{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"es","slug":"es","permalink":"http://example.com/tags/es/"},{"name":"kibana","slug":"kibana","permalink":"http://example.com/tags/kibana/"}]},{"title":"(æ¯æ—¥LeetCode)1450. åœ¨æ—¢å®šæ—¶é—´åšä½œä¸šçš„å­¦ç”Ÿäººæ•°","slug":"æ¯æ—¥LeetCode/2022-8/1450 åœ¨æ—¢å®šæ—¶é—´åšä½œä¸šçš„å­¦ç”Ÿäººæ•°","date":"2022-08-19T00:21:00.000Z","updated":"2022-08-19T00:21:37.245Z","comments":true,"path":"2022/08/19/æ¯æ—¥LeetCode/2022-8/1450 åœ¨æ—¢å®šæ—¶é—´åšä½œä¸šçš„å­¦ç”Ÿäººæ•°/","link":"","permalink":"http://example.com/2022/08/19/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1450%20%E5%9C%A8%E6%97%A2%E5%AE%9A%E6%97%B6%E9%97%B4%E5%81%9A%E4%BD%9C%E4%B8%9A%E7%9A%84%E5%AD%A6%E7%94%9F%E4%BA%BA%E6%95%B0/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸¤ä¸ªæ•´æ•°æ•°ç»„ startTimeï¼ˆå¼€å§‹æ—¶é—´ï¼‰å’Œ endTimeï¼ˆç»“æŸæ—¶é—´ï¼‰ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªæ•´æ•° queryTime ä½œä¸ºæŸ¥è¯¢æ—¶é—´ã€‚ å·²çŸ¥ï¼Œç¬¬ i åå­¦ç”Ÿåœ¨ startTime[i] æ—¶å¼€å§‹å†™ä½œä¸šå¹¶äº endTime[i] æ—¶å®Œæˆä½œä¸šã€‚ è¯·è¿”å›åœ¨æŸ¥è¯¢æ—¶é—´ queryTime æ—¶æ­£åœ¨åšä½œä¸šçš„å­¦ç”Ÿäººæ•°ã€‚å½¢å¼ä¸Šï¼Œè¿”å›èƒ½å¤Ÿä½¿ queryTime å¤„äºåŒºé—´ [startTime[i], endTime[i]]ï¼ˆå«ï¼‰çš„å­¦ç”Ÿäººæ•°ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šstartTime &#x3D; [1,2,3], endTime &#x3D; [3,2,7], queryTime &#x3D; 4è¾“å‡ºï¼š1è§£é‡Šï¼šä¸€å…±æœ‰ 3 åå­¦ç”Ÿã€‚ç¬¬ä¸€åå­¦ç”Ÿåœ¨æ—¶é—´ 1 å¼€å§‹å†™ä½œä¸šï¼Œå¹¶äºæ—¶é—´ 3 å®Œæˆä½œä¸šï¼Œåœ¨æ—¶é—´ 4 æ²¡æœ‰å¤„äºåšä½œä¸šçš„çŠ¶æ€ã€‚ç¬¬äºŒåå­¦ç”Ÿåœ¨æ—¶é—´ 2 å¼€å§‹å†™ä½œä¸šï¼Œå¹¶äºæ—¶é—´ 2 å®Œæˆä½œä¸šï¼Œåœ¨æ—¶é—´ 4 æ²¡æœ‰å¤„äºåšä½œä¸šçš„çŠ¶æ€ã€‚ç¬¬ä¸‰åå­¦ç”Ÿåœ¨æ—¶é—´ 3 å¼€å§‹å†™ä½œä¸šï¼Œé¢„è®¡äºæ—¶é—´ 7 å®Œæˆä½œä¸šï¼Œè¿™æ˜¯æ˜¯å”¯ä¸€ä¸€ååœ¨æ—¶é—´ 4 æ—¶æ­£åœ¨åšä½œä¸šçš„å­¦ç”Ÿã€‚ æ€è·¯ï¼šæšä¸¾ä»£ç (cpp)ï¼š123456789101112class Solution &#123;public: int busyStudent(vector&lt;int&gt;&amp; startTime, vector&lt;int&gt;&amp; endTime, int queryTime) &#123; int sum = 0; for(int i = 0; i &lt; startTime.size(); i++)&#123; if(startTime[i] &lt;= queryTime &amp;&amp; queryTime &lt;= endTime[i]) &#123; sum++; &#125; &#125; return sum; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸º æ•°ç»„çš„é•¿åº¦ã€‚åªéœ€éå†ä¸€éæ•°ç»„å³å¯ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1302. å±‚æ•°æœ€æ·±å¶å­èŠ‚ç‚¹çš„å’Œ","slug":"æ¯æ—¥LeetCode/2022-8/1302 å±‚æ•°æœ€æ·±å¶å­èŠ‚ç‚¹çš„å’Œ","date":"2022-08-17T02:50:00.000Z","updated":"2022-08-17T02:50:49.131Z","comments":true,"path":"2022/08/17/æ¯æ—¥LeetCode/2022-8/1302 å±‚æ•°æœ€æ·±å¶å­èŠ‚ç‚¹çš„å’Œ/","link":"","permalink":"http://example.com/2022/08/17/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1302%20%E5%B1%82%E6%95%B0%E6%9C%80%E6%B7%B1%E5%8F%B6%E5%AD%90%E8%8A%82%E7%82%B9%E7%9A%84%E5%92%8C/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¯·ä½ è¿”å› å±‚æ•°æœ€æ·±çš„å¶å­èŠ‚ç‚¹çš„å’Œ ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [1,2,3,4,5,null,6,7,null,null,null,null,8]è¾“å‡ºï¼š15 æ€è·¯ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425class Solution &#123;public: int max_level = 0; int sum = 0; void dfs(TreeNode* root, int level)&#123; if(!root) return; if(max_level &lt; level)&#123; //max_sumå¦‚æœä¸æ˜¯æœ€å¤§æ·±åº¦ï¼Œé‡æ–°å¼€å§‹ sum = root-&gt;val; max_level = level; &#125; else if(max_level == level) &#123; //ä¸ºæœ€å¤§æ·±åº¦ï¼Œle sum += root-&gt;val; &#125; dfs(root-&gt;left, level + 1); dfs(root-&gt;right, level + 1); &#125; int deepestLeavesSum(TreeNode* root) &#123; dfs(root, 0); return sum; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ã€‚æ·±åº¦ä¼˜å…ˆæœç´¢éœ€è¦éå†æ¯ä¸ªèŠ‚ç‚¹ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ã€‚ç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºé€’å½’è°ƒç”¨æ ˆçš„æ·±åº¦ï¼Œä¸ºäºŒå‰æ ‘çš„æ·±åº¦ï¼Œæœ€åæƒ…å†µä¸‹äºŒå‰æ ‘çš„æ·±åº¦æ˜¯ O(n)ã€‚ æ€è·¯äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢(BFS)ä»£ç (cpp)ï¼š1234567891011121314151617181920class Solution &#123;public: int deepestLeavesSum(TreeNode* root) &#123; queue&lt;TreeNode*&gt; q; q.emplace(root); int sum = 0; while(!q.empty())&#123; //å±‚éå† sum = 0; int size = q.size(); //è·å–è¯¥å±‚çš„å…ƒç´ ä¸ªæ•° for(int i = 0; i &lt; size; i++)&#123; //è¯¥å±‚çš„å…ƒç´ éå† TreeNode* node = q.front(); q.pop(); if(node-&gt;left) q.emplace(node-&gt;left); if(node-&gt;right) q.emplace(node-&gt;right); sum += node-&gt;val; &#125; &#125; return sum; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ã€‚å¹¿åº¦ä¼˜å…ˆæœç´¢éœ€è¦éå†æ¯ä¸ªèŠ‚ç‚¹ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ã€‚ç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºé˜Ÿåˆ—ç©ºé—´ï¼Œé˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ä¸ªæ•°ä¸è¶…è¿‡ n ä¸ªã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1656. è®¾è®¡æœ‰åºæµ","slug":"æ¯æ—¥LeetCode/2022-8/1656 è®¾è®¡æœ‰åºæµ","date":"2022-08-16T03:34:00.000Z","updated":"2022-08-16T03:34:20.019Z","comments":true,"path":"2022/08/16/æ¯æ—¥LeetCode/2022-8/1656 è®¾è®¡æœ‰åºæµ/","link":"","permalink":"http://example.com/2022/08/16/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1656%20%E8%AE%BE%E8%AE%A1%E6%9C%89%E5%BA%8F%E6%B5%81/","excerpt":"","text":"é¢˜ç›®ï¼šæœ‰ n ä¸ª (id, value) å¯¹ï¼Œå…¶ä¸­ id æ˜¯ 1 åˆ° n ä¹‹é—´çš„ä¸€ä¸ªæ•´æ•°ï¼Œvalue æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä¸å­˜åœ¨ id ç›¸åŒçš„ä¸¤ä¸ª (id, value) å¯¹ã€‚ è®¾è®¡ä¸€ä¸ªæµï¼Œä»¥ ä»»æ„ é¡ºåºè·å– n ä¸ª (id, value) å¯¹ï¼Œå¹¶åœ¨å¤šæ¬¡è°ƒç”¨æ—¶ æŒ‰ id é€’å¢çš„é¡ºåº è¿”å›ä¸€äº›å€¼ã€‚ å®ç° OrderedStream ç±»ï¼š OrderedStream(int n) æ„é€ ä¸€ä¸ªèƒ½æ¥æ”¶ n ä¸ªå€¼çš„æµï¼Œå¹¶å°†å½“å‰æŒ‡é’ˆ ptr è®¾ä¸º 1 ã€‚ String[] insert(int id, String value) å‘æµä¸­å­˜å‚¨æ–°çš„ (id, value) å¯¹ã€‚å­˜å‚¨åï¼š å¦‚æœæµå­˜å‚¨æœ‰ id = ptr çš„ (id, value) å¯¹ï¼Œåˆ™æ‰¾å‡ºä» id = ptr å¼€å§‹çš„ æœ€é•¿ id è¿ç»­é€’å¢åºåˆ— ï¼Œå¹¶ æŒ‰é¡ºåº è¿”å›ä¸è¿™äº› id å…³è”çš„å€¼çš„åˆ—è¡¨ã€‚ç„¶åï¼Œå°† ptr æ›´æ–°ä¸ºæœ€åé‚£ä¸ª id + 1 ã€‚ å¦åˆ™ï¼Œè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥[â€œOrderedStreamâ€, â€œinsertâ€, â€œinsertâ€, â€œinsertâ€, â€œinsertâ€, â€œinsertâ€][[5], [3, â€œcccccâ€], [1, â€œaaaaaâ€], [2, â€œbbbbbâ€], [5, â€œeeeeeâ€], [4, â€œdddddâ€]]è¾“å‡º[null, [], [â€œaaaaaâ€], [â€œbbbbbâ€, â€œcccccâ€], [], [â€œdddddâ€, â€œeeeeeâ€]] è§£é‡ŠOrderedStream os&#x3D; new OrderedStream(5);os.insert(3, â€œcccccâ€); &#x2F;&#x2F; æ’å…¥ (3, â€œcccccâ€)ï¼Œè¿”å› []os.insert(1, â€œaaaaaâ€); &#x2F;&#x2F; æ’å…¥ (1, â€œaaaaaâ€)ï¼Œè¿”å› [â€œaaaaaâ€]os.insert(2, â€œbbbbbâ€); &#x2F;&#x2F; æ’å…¥ (2, â€œbbbbbâ€)ï¼Œè¿”å› [â€œbbbbbâ€, â€œcccccâ€]os.insert(5, â€œeeeeeâ€); &#x2F;&#x2F; æ’å…¥ (5, â€œeeeeeâ€)ï¼Œè¿”å› []os.insert(4, â€œdddddâ€); &#x2F;&#x2F; æ’å…¥ (4, â€œdddddâ€)ï¼Œè¿”å› [â€œdddddâ€, â€œeeeeeâ€] ä»£ç (cpp)ï¼š12345678910111213141516171819class OrderedStream &#123;public: int ptr; vector&lt;string&gt; array; OrderedStream(int n) &#123; ptr = 1; array = vector&lt;string&gt;(n + 1); &#125; vector&lt;string&gt; insert(int idKey, string value) &#123; vector&lt;string&gt; ans; array[idKey] = value; while(ptr &lt; array.size() &amp;&amp; array[ptr] != &quot;&quot;)&#123; ans.emplace_back(array[ptr]); ptr++; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šOrderedStream(int n) çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼›String[] insert(int id, String value) çš„æ—¶é—´å¤æ‚åº¦ä¸ºå‡æ‘Š O(1)ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¼šæ°å¥½è°ƒç”¨è¯¥å‡½æ•° n æ¬¡ï¼Œé‚£ä¹ˆæ¯ä¸€ä¸ªå­—ç¬¦ä¸²æœ€å¤šä¼šè¢«åŒ…å«åœ¨è¿”å›æ•°ç»„ä¸­ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå³ä¸ºå­˜å‚¨ n ä¸ªå­—ç¬¦ä¸²éœ€è¦çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)641. è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—","slug":"æ¯æ—¥LeetCode/2022-8/641 è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—","date":"2022-08-15T02:29:00.000Z","updated":"2022-08-15T02:29:10.370Z","comments":true,"path":"2022/08/15/æ¯æ—¥LeetCode/2022-8/641 è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—/","link":"","permalink":"http://example.com/2022/08/15/%E6%AF%8F%E6%97%A5LeetCode/2022-8/641%20%E8%AE%BE%E8%AE%A1%E5%BE%AA%E7%8E%AF%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šè®¾è®¡å®ç°åŒç«¯é˜Ÿåˆ—ã€‚ å®ç° MyCircularDeque ç±»: MyCircularDeque(int k) ï¼šæ„é€ å‡½æ•°,åŒç«¯é˜Ÿåˆ—æœ€å¤§ä¸º k ã€‚ boolean insertFront()ï¼šå°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°åŒç«¯é˜Ÿåˆ—å¤´éƒ¨ã€‚ å¦‚æœæ“ä½œæˆåŠŸè¿”å› true ï¼Œå¦åˆ™è¿”å› falseã€‚ boolean insertLast() ï¼šå°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°åŒç«¯é˜Ÿåˆ—å°¾éƒ¨ã€‚å¦‚æœæ“ä½œæˆåŠŸè¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚ boolean deleteFront() ï¼šä»åŒç«¯é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æœæ“ä½œæˆåŠŸè¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚ boolean deleteLast() ï¼šä»åŒç«¯é˜Ÿåˆ—å°¾éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæ“ä½œæˆåŠŸè¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚ int getFront()ï¼šä»åŒç«¯é˜Ÿåˆ—å¤´éƒ¨è·å¾—ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚ int getRear() ï¼šè·å¾—åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æœåŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚ boolean isEmpty() ï¼šè‹¥åŒç«¯é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚ boolean isFull() ï¼šè‹¥åŒç«¯é˜Ÿåˆ—æ»¡äº†ï¼Œåˆ™è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥[â€œMyCircularDequeâ€, â€œinsertLastâ€, â€œinsertLastâ€, â€œinsertFrontâ€, â€œinsertFrontâ€, â€œgetRearâ€, â€œisFullâ€, â€œdeleteLastâ€, â€œinsertFrontâ€, â€œgetFrontâ€][[3], [1], [2], [3], [4], [], [], [], [4], []]è¾“å‡º[null, true, true, true, false, 2, true, true, true, 4] è§£é‡ŠMyCircularDeque circularDeque &#x3D; new MycircularDeque(3); &#x2F;&#x2F; è®¾ç½®å®¹é‡å¤§å°ä¸º3circularDeque.insertLast(1); &#x2F;&#x2F; è¿”å› truecircularDeque.insertLast(2); &#x2F;&#x2F; è¿”å› truecircularDeque.insertFront(3); &#x2F;&#x2F; è¿”å› truecircularDeque.insertFront(4); &#x2F;&#x2F; å·²ç»æ»¡äº†ï¼Œè¿”å› falsecircularDeque.getRear(); &#x2F;&#x2F; è¿”å› 2circularDeque.isFull(); &#x2F;&#x2F; è¿”å› truecircularDeque.deleteLast(); &#x2F;&#x2F; è¿”å› truecircularDeque.insertFront(4); &#x2F;&#x2F; è¿”å› truecircularDeque.getFront(); &#x2F;&#x2F; è¿”å› 4 æ€è·¯ï¼šæ•°ç»„å¯å‚è€ƒåŠ›æ‰£ 622 è®¾è®¡å¾ªç¯é˜Ÿåˆ— ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657class MyCircularDeque &#123;public: vector&lt;int&gt; deque; int front; int rear; int capacity; MyCircularDeque(int k) &#123; capacity = k; deque = vector&lt;int&gt;(k + 1); front = 0; rear = 0; &#125; bool insertFront(int value) &#123; if(isFull()) return false; front = (front - 1 + capacity + 1) % (capacity + 1); deque[front] = value; return true; &#125; bool insertLast(int value) &#123; if(isFull()) return false; deque[rear] = value; rear = (rear + 1) % (capacity + 1); return true; &#125; bool deleteFront() &#123; if(isEmpty()) return false; front = (front + 1) % (capacity + 1); return true; &#125; bool deleteLast() &#123; if(isEmpty()) return false; rear = (rear - 1 + capacity + 1) % (capacity + 1); return true; &#125; int getFront() &#123; if(isEmpty()) return -1; return deque[front]; &#125; int getRear() &#123; if(isEmpty()) return -1; return deque[(rear - 1 + capacity + 1) % (capacity + 1)]; &#125; bool isEmpty() &#123; return front == rear; &#125; bool isFull() &#123; return (rear + 1) % (capacity + 1) == front; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šåˆå§‹åŒ–å’Œæ¯é¡¹æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‡ä¸º O(1)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(k)ï¼Œå…¶ä¸­ k ä¸ºç»™å®šçš„é˜Ÿåˆ—å…ƒç´ æ•°ç›®ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1422. åˆ†å‰²å­—ç¬¦ä¸²çš„æœ€å¤§å¾—åˆ†","slug":"æ¯æ—¥LeetCode/2022-8/1422 åˆ†å‰²å­—ç¬¦ä¸²çš„æœ€å¤§å¾—åˆ†","date":"2022-08-14T01:44:00.000Z","updated":"2022-08-14T01:45:00.113Z","comments":true,"path":"2022/08/14/æ¯æ—¥LeetCode/2022-8/1422 åˆ†å‰²å­—ç¬¦ä¸²çš„æœ€å¤§å¾—åˆ†/","link":"","permalink":"http://example.com/2022/08/14/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1422%20%E5%88%86%E5%89%B2%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%A4%A7%E5%BE%97%E5%88%86/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªç”±è‹¥å¹² 0 å’Œ 1 ç»„æˆçš„å­—ç¬¦ä¸² s ï¼Œè¯·ä½ è®¡ç®—å¹¶è¿”å›å°†è¯¥å­—ç¬¦ä¸²åˆ†å‰²æˆä¸¤ä¸ª éç©º å­å­—ç¬¦ä¸²ï¼ˆå³ å·¦ å­å­—ç¬¦ä¸²å’Œ å³ å­å­—ç¬¦ä¸²ï¼‰æ‰€èƒ½è·å¾—çš„æœ€å¤§å¾—åˆ†ã€‚ ã€Œåˆ†å‰²å­—ç¬¦ä¸²çš„å¾—åˆ†ã€ä¸º å·¦ å­å­—ç¬¦ä¸²ä¸­ 0 çš„æ•°é‡åŠ ä¸Š å³ å­å­—ç¬¦ä¸²ä¸­ 1 çš„æ•°é‡ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šs &#x3D; â€œ011101â€è¾“å‡ºï¼š5è§£é‡Šï¼šå°†å­—ç¬¦ä¸² s åˆ’åˆ†ä¸ºä¸¤ä¸ªéç©ºå­å­—ç¬¦ä¸²çš„å¯è¡Œæ–¹æ¡ˆæœ‰ï¼šå·¦å­å­—ç¬¦ä¸² &#x3D; â€œ0â€ ä¸” å³å­å­—ç¬¦ä¸² &#x3D; â€œ11101â€ï¼Œå¾—åˆ† &#x3D; 1 + 4 &#x3D; 5å·¦å­å­—ç¬¦ä¸² &#x3D; â€œ01â€ ä¸” å³å­å­—ç¬¦ä¸² &#x3D; â€œ1101â€ï¼Œå¾—åˆ† &#x3D; 1 + 3 &#x3D; 4å·¦å­å­—ç¬¦ä¸² &#x3D; â€œ011â€ ä¸” å³å­å­—ç¬¦ä¸² &#x3D; â€œ101â€ï¼Œå¾—åˆ† &#x3D; 1 + 2 &#x3D; 3å·¦å­å­—ç¬¦ä¸² &#x3D; â€œ0111â€ ä¸” å³å­å­—ç¬¦ä¸² &#x3D; â€œ01â€ï¼Œå¾—åˆ† &#x3D; 1 + 1 &#x3D; 2å·¦å­å­—ç¬¦ä¸² &#x3D; â€œ01110â€ ä¸” å³å­å­—ç¬¦ä¸² &#x3D; â€œ1â€ï¼Œå¾—åˆ† &#x3D; 2 + 1 &#x3D; 3 æ€è·¯ï¼šæšä¸¾è·å¾—æ¯ä¸€ç§å¯èƒ½çš„åˆ†æ•°ï¼Œæ¯”è¾ƒå‡ºæœ€é«˜å¾—åˆ† ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: int maxScore(string s) &#123; int score = 0; for(int i = 0; i &lt; s.size() - 1; i++)&#123; int temp_score = 0; for(int j = 0; j &lt;= i; j++)&#123; if(s[j] == &#x27;0&#x27;)&#123; temp_score++; &#125; &#125; for(int k = i + 1; k &lt; s.size(); k++)&#123; if(s[k] == &#x27;1&#x27;)&#123; temp_score++; &#125; &#125; score = max(score, temp_score); &#125; return score; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸² s çš„é•¿åº¦ã€‚éœ€è¦éå† nâˆ’1 ä¸ªåˆ†å‰²ç‚¹ï¼Œå¯¹äºæ¯ä¸ªåˆ†å‰²ç‚¹éœ€è¦ O(n) çš„æ—¶é—´éå†æ•´ä¸ªå­—ç¬¦ä¸²è®¡ç®—åˆ†å‰²å­—ç¬¦ä¸²çš„å¾—åˆ†ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^2) ç©ºé—´å¤æ‚åº¦ï¼šO(1)","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1282. ç”¨æˆ·åˆ†ç»„","slug":"æ¯æ—¥LeetCode/2022-8/1282 ç”¨æˆ·åˆ†ç»„","date":"2022-08-12T02:14:00.000Z","updated":"2022-08-12T02:14:47.826Z","comments":true,"path":"2022/08/12/æ¯æ—¥LeetCode/2022-8/1282 ç”¨æˆ·åˆ†ç»„/","link":"","permalink":"http://example.com/2022/08/12/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1282%20%E7%94%A8%E6%88%B7%E5%88%86%E7%BB%84/","excerpt":"","text":"é¢˜ç›®ï¼šæœ‰ n ä¸ªäººè¢«åˆ†æˆæ•°é‡æœªçŸ¥çš„ç»„ã€‚æ¯ä¸ªäººéƒ½è¢«æ ‡è®°ä¸ºä¸€ä¸ªä» 0 åˆ° n - 1 çš„å”¯ä¸€ID ã€‚ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ groupSizes ï¼Œå…¶ä¸­ groupSizes[i] æ˜¯ç¬¬ i ä¸ªäººæ‰€åœ¨çš„ç»„çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ groupSizes[1] &#x3D; 3 ï¼Œåˆ™ç¬¬ 1 ä¸ªäººå¿…é¡»ä½äºå¤§å°ä¸º 3 çš„ç»„ä¸­ã€‚ è¿”å›ä¸€ä¸ªç»„åˆ—è¡¨ï¼Œä½¿æ¯ä¸ªäºº i éƒ½åœ¨ä¸€ä¸ªå¤§å°ä¸º groupSizes[i] çš„ç»„ä¸­ã€‚ æ¯ä¸ªäººåº”è¯¥ æ°å¥½åª å‡ºç°åœ¨ ä¸€ä¸ªç»„ ä¸­ï¼Œå¹¶ä¸”æ¯ä¸ªäººå¿…é¡»åœ¨ä¸€ä¸ªç»„ä¸­ã€‚å¦‚æœæœ‰å¤šä¸ªç­”æ¡ˆï¼Œè¿”å›å…¶ä¸­ ä»»ä½• ä¸€ä¸ªã€‚å¯ä»¥ ä¿è¯ ç»™å®šè¾“å…¥ è‡³å°‘æœ‰ä¸€ä¸ª æœ‰æ•ˆçš„è§£ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šgroupSizes &#x3D; [3,3,3,3,3,1,3]è¾“å‡ºï¼š[[5],[0,1,2],[3,4,6]]è§£é‡Šï¼šç¬¬ä¸€ç»„æ˜¯ [5]ï¼Œå¤§å°ä¸º 1ï¼ŒgroupSizes[5] &#x3D; 1ã€‚ç¬¬äºŒç»„æ˜¯ [0,1,2]ï¼Œå¤§å°ä¸º 3ï¼ŒgroupSizes[0] &#x3D; groupSizes[1] &#x3D; groupSizes[2] &#x3D; 3ã€‚ç¬¬ä¸‰ç»„æ˜¯ [3,4,6]ï¼Œå¤§å°ä¸º 3ï¼ŒgroupSizes[3] &#x3D; groupSizes[4] &#x3D; groupSizes[6] &#x3D; 3ã€‚å…¶ä»–å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæœ‰ [[2,1,6],[5],[0,4,3]] å’Œ [[5],[0,6,2],[4,3,1]]ã€‚ æ€è·¯ï¼šå“ˆå¸Œè¡¨ä½¿ç”¨å“ˆå¸Œè¡¨è·å–ç”¨æˆ·äººæ•°ç›¸åŒçš„å…ƒç´ çš„æ‰€åœ¨ä½ç½® éå†å“ˆå¸Œè¡¨ï¼Œä¾æ¬¡æˆªå–ç”¨æˆ·äººæ•°ä¸ºå¤§å°çš„ç‰‡æ®µ ä»£ç (cpp)ï¼š1234567891011121314151617class Solution &#123;public: vector&lt;vector&lt;int&gt;&gt; groupThePeople(vector&lt;int&gt;&amp; groupSizes) &#123; unordered_map&lt;int, vector&lt;int&gt;&gt; groups; for(int i = 0; i &lt; groupSizes.size(); i++)&#123; groups[groupSizes[i]].emplace_back(i); &#125; vector&lt;vector&lt;int&gt;&gt; ans; for(auto&amp; group : groups)&#123; for(auto it = group.second.begin(); it != group.second.end();)&#123; ans.emplace_back(vector&lt;int&gt;(it, it + group.first)); //æˆªå–æ•°ç»„ç‰‡æ®µ it += group.first; &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ groupSize çš„é•¿åº¦ã€‚éœ€è¦éå†æ•°ç»„ä¸€æ¬¡å¾—åˆ°æ¯ä¸ªç»„çš„å¤§å°å¯¹åº”çš„æ‰€æœ‰äººçš„ç¼–å·ï¼Œç„¶åéœ€è¦éå†æ‰€æœ‰å…ƒç´ å®Œæˆåˆ†ç»„ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ groupSize çš„é•¿åº¦ã€‚ç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºå“ˆå¸Œè¡¨ï¼Œå“ˆå¸Œè¡¨éœ€è¦ O(n) çš„ç©ºé—´è®°å½•æ¯ä¸ªç»„çš„å¤§å°å¯¹åº”çš„æ‰€æœ‰äººçš„ç¼–å·ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1417. é‡æ–°æ ¼å¼åŒ–å­—ç¬¦ä¸²","slug":"æ¯æ—¥LeetCode/2022-8/1417 é‡æ–°æ ¼å¼åŒ–å­—ç¬¦ä¸²","date":"2022-08-11T03:17:00.000Z","updated":"2022-08-11T03:17:50.166Z","comments":true,"path":"2022/08/11/æ¯æ—¥LeetCode/2022-8/1417 é‡æ–°æ ¼å¼åŒ–å­—ç¬¦ä¸²/","link":"","permalink":"http://example.com/2022/08/11/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1417%20%E9%87%8D%E6%96%B0%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ··åˆäº†æ•°å­—å’Œå­—æ¯çš„å­—ç¬¦ä¸² sï¼Œå…¶ä¸­çš„å­—æ¯å‡ä¸ºå°å†™è‹±æ–‡å­—æ¯ã€‚ è¯·ä½ å°†è¯¥å­—ç¬¦ä¸²é‡æ–°æ ¼å¼åŒ–ï¼Œä½¿å¾—ä»»æ„ä¸¤ä¸ªç›¸é‚»å­—ç¬¦çš„ç±»å‹éƒ½ä¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­—æ¯åé¢åº”è¯¥è·Ÿç€æ•°å­—ï¼Œè€Œæ•°å­—åé¢åº”è¯¥è·Ÿç€å­—æ¯ã€‚ è¯·ä½ è¿”å› é‡æ–°æ ¼å¼åŒ–å çš„å­—ç¬¦ä¸²ï¼›å¦‚æœæ— æ³•æŒ‰è¦æ±‚é‡æ–°æ ¼å¼åŒ–ï¼Œåˆ™è¿”å›ä¸€ä¸ª ç©ºå­—ç¬¦ä¸² ã€‚ ç¤ºä¾‹ï¼šè¾“å…¥ï¼šs &#x3D; â€œa0b1c2â€è¾“å‡ºï¼šâ€0a1b2câ€è§£é‡Šï¼šâ€0a1b2câ€ ä¸­ä»»æ„ä¸¤ä¸ªç›¸é‚»å­—ç¬¦çš„ç±»å‹éƒ½ä¸åŒã€‚ â€œa0b1c2â€, â€œ0a1b2câ€, â€œ0c2a1bâ€ ä¹Ÿæ˜¯æ»¡è¶³é¢˜ç›®è¦æ±‚çš„ç­”æ¡ˆã€‚ æ€è·¯ï¼šåˆ†åˆ«è·å–æ•°å­—numå’Œå­—æ¯letter æ±‚å¾—æ•°å­—é•¿åº¦ä¸å­—æ¯é•¿åº¦ä¹‹é—´çš„å·®ï¼š å·®çš„ç»å¯¹å€¼å¤§äº1ï¼Œåˆ™æ— è§£ï¼› å·®ç­‰äº0ï¼Œä¾æ¬¡æ·»åŠ æ•°å­—ã€å­—æ¯ï¼› å·®ç­‰äº1ï¼Œå…ˆæ·»åŠ æ•°å­—å†æ·»åŠ å­—æ¯ï¼› å·®ç­‰äº-1ï¼Œå…ˆæ·»åŠ å­—æ¯å†æ·»åŠ æ•°å­—ï¼› ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041class Solution &#123;public: string reformat(string s) &#123; string num = &quot;&quot;; string letter = &quot;&quot;; for(auto i : s)&#123; if(i &gt;= 48 &amp;&amp; i &lt;= 57)&#123; num += i; &#125; else&#123; letter += i; &#125; &#125; int temp = num.size() - letter.size(); if(temp &gt; 1 || temp &lt; -1)&#123; return &quot;&quot;; &#125; string ans; if(temp == 0)&#123; for(int i = 0; i &lt; num.size(); i++)&#123; ans += num[i]; ans += letter[i]; &#125; &#125; else if(temp == 1)&#123; ans += num[0]; for(int i = 0; i &lt; letter.size(); i++)&#123; ans += letter[i]; ans += num[i + 1]; &#125; &#125; else&#123; ans += letter[0]; for(int i = 0; i &lt; num.size(); i++)&#123; ans += num[i]; ans += letter[i + 1]; &#125; &#125; return ans; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"","slug":"C++/åšé¢˜å¸¸ç”¨å‡½æ•°","date":"2022-08-11T02:49:11.978Z","updated":"2022-09-19T23:36:20.290Z","comments":true,"path":"2022/08/11/C++/åšé¢˜å¸¸ç”¨å‡½æ•°/","link":"","permalink":"http://example.com/2022/08/11/C++/%E5%81%9A%E9%A2%98%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/","excerpt":"","text":"å‡½æ•° bool isdigit(char c) åˆ¤æ–­å­—ç¬¦æ˜¯å¦ä¸ºæ•°å­— int abs(int num) è·å–numçš„ç»å¯¹å€¼ string to_string (int val) æ•°å­—è½¬å­—ç¬¦ä¸² iterator lower_bound(iterator first, iterator last, T&amp; val) æŒ‡å®šåŒºåŸŸå†…æŸ¥æ‰¾ä¸å°äºç›®æ ‡å€¼çš„ç¬¬ä¸€ä¸ªå…ƒç´  äºŒåˆ†æŸ¥æ‰¾ T move(T t) å°†å·¦å€¼å¼ºåˆ¶è½¬åŒ–ä¸ºå³å€¼å¼•ç”¨ æ•ˆç‡æ›´é«˜,å¢å¼ºå‹ç­‰å· int atoi(const char *nptr) å°†char*ç±»å‹çš„å­—ç¬¦ä¸²è½¬ä¸ºintæ•´å‹ int stoi(string str) å°†stringç±»å‹çš„å­—ç¬¦ä¸²è½¬ä¸ºintæ•´å‹ accumulate(èµ·å§‹è¿­ä»£å™¨, ç»“æŸè¿­ä»£å™¨, åˆå§‹å€¼, è‡ªå®šä¹‰æ“ä½œå‡½æ•°) ç´¯åŠ ","categories":[],"tags":[]},{"title":"(æ¯æ—¥LeetCode)1413. é€æ­¥æ±‚å’Œå¾—åˆ°æ­£æ•°çš„æœ€å°å€¼","slug":"æ¯æ—¥LeetCode/2022-8/1413 é€æ­¥æ±‚å’Œå¾—åˆ°æ­£æ•°çš„æœ€å°å€¼","date":"2022-08-09T01:31:00.000Z","updated":"2022-08-09T01:31:40.351Z","comments":true,"path":"2022/08/09/æ¯æ—¥LeetCode/2022-8/1413 é€æ­¥æ±‚å’Œå¾—åˆ°æ­£æ•°çš„æœ€å°å€¼/","link":"","permalink":"http://example.com/2022/08/09/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1413%20%E9%80%90%E6%AD%A5%E6%B1%82%E5%92%8C%E5%BE%97%E5%88%B0%E6%AD%A3%E6%95%B0%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ã€‚ä½ å¯ä»¥é€‰å®šä»»æ„çš„ æ­£æ•° startValue ä½œä¸ºåˆå§‹å€¼ã€‚ ä½ éœ€è¦ä»å·¦åˆ°å³éå† nums æ•°ç»„ï¼Œå¹¶å°† startValue ä¾æ¬¡ç´¯åŠ ä¸Š nums æ•°ç»„ä¸­çš„å€¼ã€‚ è¯·ä½ åœ¨ç¡®ä¿ç´¯åŠ å’Œå§‹ç»ˆå¤§äºç­‰äº 1 çš„å‰æä¸‹ï¼Œé€‰å‡ºä¸€ä¸ªæœ€å°çš„ æ­£æ•° ä½œä¸º startValue ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [-3,2,-3,4,2]è¾“å‡ºï¼š5è§£é‡Šï¼šå¦‚æœä½ é€‰æ‹© startValue &#x3D; 4ï¼Œåœ¨ç¬¬ä¸‰æ¬¡ç´¯åŠ æ—¶ï¼Œå’Œå°äº 1 ã€‚ ç´¯åŠ æ±‚å’Œ startValue &#x3D; 4 | startValue &#x3D; 5 | nums (4 -3 ) &#x3D; 1 | (5 -3 ) &#x3D; 2 | -3 (1 +2 ) &#x3D; 3 | (2 +2 ) &#x3D; 4 | 2 (3 -3 ) &#x3D; 0 | (4 -3 ) &#x3D; 1 | -3 (0 +4 ) &#x3D; 4 | (1 +4 ) &#x3D; 5 | 4 (4 +2 ) &#x3D; 6 | (5 +2 ) &#x3D; 7 | 2 æ€è·¯ï¼šéå†æ•°ç»„ï¼Œå¦‚æœç´¯åŠ ä¸­å°äº1æ—¶ï¼Œå¢åŠ startValueçš„å€¼ç›´åˆ°ç´¯åŠ ä¸º1 ä»£ç (cpp)ï¼š123456789101112131415class Solution &#123;public: int minStartValue(vector&lt;int&gt;&amp; nums) &#123; int startValue = 1; //åˆå§‹åŒ–ä¸º1ï¼Œå› ä¸ºstartValueä¸ºæœ€å°çš„æ­£æ•° int sum = 1; //åˆå§‹åŒ–ä¸º1ï¼Œå› ä¸ºä¸€å¼€å§‹åˆå§‹åŒ–ä¸º0è¦åŠ ä¸ŠstartValueå°±å˜æˆäº†1 for(auto&amp; num : nums)&#123; sum += num; //ç´¯åŠ  if(sum &lt; 1)&#123; //å°äº1çš„æƒ…å†µ startValue += 1 - sum; //åŠ ä¸Šç›¸å·®çš„æ•° sum = 1; //æ€»å’Œå°±å˜æˆäº†1 &#125; &#125; return startValue; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)636. å‡½æ•°çš„ç‹¬å æ—¶é—´","slug":"æ¯æ—¥LeetCode/2022-8/636 å‡½æ•°çš„ç‹¬å æ—¶é—´","date":"2022-08-07T03:38:00.000Z","updated":"2022-08-07T03:38:19.485Z","comments":true,"path":"2022/08/07/æ¯æ—¥LeetCode/2022-8/636 å‡½æ•°çš„ç‹¬å æ—¶é—´/","link":"","permalink":"http://example.com/2022/08/07/%E6%AF%8F%E6%97%A5LeetCode/2022-8/636%20%E5%87%BD%E6%95%B0%E7%9A%84%E7%8B%AC%E5%8D%A0%E6%97%B6%E9%97%B4/","excerpt":"","text":"é¢˜ç›®ï¼šæœ‰ä¸€ä¸ª å•çº¿ç¨‹ CPU æ­£åœ¨è¿è¡Œä¸€ä¸ªå«æœ‰ n é“å‡½æ•°çš„ç¨‹åºã€‚æ¯é“å‡½æ•°éƒ½æœ‰ä¸€ä¸ªä½äº 0 å’Œ n-1 ä¹‹é—´çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ å‡½æ•°è°ƒç”¨ å­˜å‚¨åœ¨ä¸€ä¸ª è°ƒç”¨æ ˆ ä¸Š ï¼šå½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨å¼€å§‹æ—¶ï¼Œå®ƒçš„æ ‡è¯†ç¬¦å°†ä¼šæ¨å…¥æ ˆä¸­ã€‚è€Œå½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨ç»“æŸæ—¶ï¼Œå®ƒçš„æ ‡è¯†ç¬¦å°†ä¼šä»æ ˆä¸­å¼¹å‡ºã€‚æ ‡è¯†ç¬¦ä½äºæ ˆé¡¶çš„å‡½æ•°æ˜¯ å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•° ã€‚æ¯å½“ä¸€ä¸ªå‡½æ•°å¼€å§‹æˆ–è€…ç»“æŸæ—¶ï¼Œå°†ä¼šè®°å½•ä¸€æ¡æ—¥å¿—ï¼ŒåŒ…æ‹¬å‡½æ•°æ ‡è¯†ç¬¦ã€æ˜¯å¼€å§‹è¿˜æ˜¯ç»“æŸã€ä»¥åŠç›¸åº”çš„æ—¶é—´æˆ³ã€‚ ç»™ä½ ä¸€ä¸ªç”±æ—¥å¿—ç»„æˆçš„åˆ—è¡¨ logs ï¼Œå…¶ä¸­ logs[i] è¡¨ç¤ºç¬¬ i æ¡æ—¥å¿—æ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯æ˜¯ä¸€ä¸ªæŒ‰&quot;&#123;function_id&#125;:&#123;&quot;start&quot; | &quot;end&quot;&#125;:&#123;timestamp&#125;&quot; è¿›è¡Œæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œ&quot;0:start:3&quot; æ„å‘³ç€æ ‡è¯†ç¬¦ä¸º 0 çš„å‡½æ•°è°ƒç”¨åœ¨æ—¶é—´æˆ³ 3 çš„ èµ·å§‹å¼€å§‹æ‰§è¡Œ ï¼›è€Œ &quot;1:end:2&quot; æ„å‘³ç€æ ‡è¯†ç¬¦ä¸º 1 çš„å‡½æ•°è°ƒç”¨åœ¨æ—¶é—´æˆ³ 2 çš„ æœ«å°¾ç»“æŸæ‰§è¡Œã€‚æ³¨æ„ï¼Œå‡½æ•°å¯ä»¥ è°ƒç”¨å¤šæ¬¡ï¼Œå¯èƒ½å­˜åœ¨é€’å½’è°ƒç”¨ ã€‚ å‡½æ•°çš„ ç‹¬å æ—¶é—´ å®šä¹‰æ˜¯åœ¨è¿™ä¸ªå‡½æ•°åœ¨ç¨‹åºæ‰€æœ‰å‡½æ•°è°ƒç”¨ä¸­æ‰§è¡Œæ—¶é—´çš„æ€»å’Œï¼Œè°ƒç”¨å…¶ä»–å‡½æ•°èŠ±è´¹çš„æ—¶é—´ä¸ç®—è¯¥å‡½æ•°çš„ç‹¬å æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡ï¼Œä¸€æ¬¡è°ƒç”¨æ‰§è¡Œ 2 å•ä½æ—¶é—´ï¼Œå¦ä¸€æ¬¡è°ƒç”¨æ‰§è¡Œ 1 å•ä½æ—¶é—´ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°çš„ ç‹¬å æ—¶é—´ ä¸º 2 + 1 = 3 ã€‚ ä»¥æ•°ç»„å½¢å¼è¿”å›æ¯ä¸ªå‡½æ•°çš„ ç‹¬å æ—¶é—´ ï¼Œå…¶ä¸­ç¬¬ i ä¸ªä¸‹æ ‡å¯¹åº”çš„å€¼è¡¨ç¤ºæ ‡è¯†ç¬¦ i çš„å‡½æ•°çš„ç‹¬å æ—¶é—´ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šn = 2, logs = [&quot;0:start:0&quot;,&quot;1:start:2&quot;,&quot;1:end:5&quot;,&quot;0:end:6&quot;]è¾“å‡ºï¼š[3,4]è§£é‡Šï¼šå‡½æ•° 0 åœ¨æ—¶é—´æˆ³ 0 çš„èµ·å§‹å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œ 2 ä¸ªå•ä½æ—¶é—´ï¼Œäºæ—¶é—´æˆ³ 1 çš„æœ«å°¾ç»“æŸæ‰§è¡Œã€‚å‡½æ•° 1 åœ¨æ—¶é—´æˆ³ 2 çš„èµ·å§‹å¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œ 4 ä¸ªå•ä½æ—¶é—´ï¼Œäºæ—¶é—´æˆ³ 5 çš„æœ«å°¾ç»“æŸæ‰§è¡Œã€‚å‡½æ•° 0 åœ¨æ—¶é—´æˆ³ 6 çš„å¼€å§‹æ¢å¤æ‰§è¡Œï¼Œæ‰§è¡Œ 1 ä¸ªå•ä½æ—¶é—´ã€‚æ‰€ä»¥å‡½æ•° 0 æ€»å…±æ‰§è¡Œ 2 + 1 &#x3D; 3 ä¸ªå•ä½æ—¶é—´ï¼Œå‡½æ•° 1 æ€»å…±æ‰§è¡Œ 4 ä¸ªå•ä½æ—¶é—´ã€‚ æ€è·¯ï¼šæ ˆéå†logsæ•°ç»„ éå†åˆ°statusä¸ºstartæ—¶ï¼š å°†æ ˆé¡¶å‡½æ•°çš„è¿è¡Œéƒ¨åˆ†æ—¶é•¿æ›´æ–°ï¼Œå› ä¸ºè¦è¿è¡Œæ–°çš„å‡½æ•°ï¼Œå…ˆæš‚æ—¶åœæ­¢è¿è¡Œæ ˆé¡¶å‡½æ•° å°†æ ˆé¡¶å‡½æ•°çš„æ—¶åˆ»æ›´æ–°ä¸ºç°åœ¨çš„æ—¶åˆ»ï¼Œå†å…¥æ ˆ statusä¸ºendæ—¶ï¼š è·å–æ ˆé¡¶å‡½æ•°ï¼Œæ›´æ–°è¿è¡Œæ€»æ—¶é•¿ï¼Œå°†æ­¤å‡½æ•°å¼¹å‡ºï¼Œå› ä¸ºå·²ç»è¿è¡Œå®Œæ¯•äº† æ­¤æ—¶æ ˆé¡¶å‡½æ•°å°±æ˜¯ä¹‹å‰çš„é‚£ä¸ªå‡½æ•°äº†ï¼Œè¦ç»§ç»­è¿è¡Œæ­¤å‡½æ•°ï¼Œ å°†æ­¤å‡½æ•°ä»æ—¶åˆ»æ›´æ–°ä¸ºç°åœ¨çš„æ—¶åˆ»ï¼Œå› ä¸ºæ˜¯ç°åœ¨çš„æ—¶åˆ»å¼€å§‹ç»§ç»­è¿è¡Œçš„ ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031class Solution &#123;public: vector&lt;int&gt; exclusiveTime(int n, vector&lt;string&gt;&amp; logs) &#123; stack&lt;pair&lt;int, int&gt;&gt; s; vector&lt;int&gt; ans(n); for(auto&amp; log : logs)&#123; int id; char status[10]; int cur_time; sscanf(log.c_str(), &quot;%d:%[^:]:%d&quot;, &amp;id, status, &amp;cur_time); if(status[0] == &#x27;s&#x27;)&#123; if(!s.empty())&#123; ans[s.top().first] += cur_time - s.top().second; s.top().second = cur_time; &#125; s.emplace(id, cur_time); &#125; else&#123; auto temp = s.top(); s.pop(); ans[temp.first] += cur_time + 1 - temp.second; if(!s.empty())&#123; s.top().second = cur_time + 1; &#125; &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºå…¨éƒ¨æ—¥å¿— logs çš„æ•°é‡ï¼Œn æ¡æ—¥å¿—ä¿¡æ¯å¯¹åº”æ€»å…± n æ¬¡å…¥æ ˆå’Œå‡ºæ ˆæ“ä½œã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºå…¨éƒ¨æ—¥å¿— logs çš„æ•°é‡ï¼Œn æ¡æ—¥å¿—ä¿¡æ¯å¯¹åº” n&#x2F;2 æ¬¡å…¥æ ˆæ“ä½œï¼Œæœ€åçš„æƒ…å†µä¸‹å…¨éƒ¨ n&#x2F;2 æ¡æ—¥å¿—å…¥æ ˆåæ‰ä¼šä¾æ¬¡å¼¹æ ˆã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"Dockerå®¹å™¨çš„å­¦ä¹ ç¬”è®°","slug":"Java/Dockerå®¹å™¨","date":"2022-08-06T13:24:22.587Z","updated":"2022-08-20T04:31:38.169Z","comments":true,"path":"2022/08/06/Java/Dockerå®¹å™¨/","link":"","permalink":"http://example.com/2022/08/06/Java/Docker%E5%AE%B9%E5%99%A8/","excerpt":"","text":"1.åˆè¯†Dockeræˆ‘ä»¬å†™å¥½çš„ä»£ç ä¼šæ¥è§¦åˆ°å¥½å‡ ä¸ªç¯å¢ƒï¼šå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ å¯èƒ½å¯¼è‡´åœ¨ä¸åŒçš„ç¯å¢ƒä¸‹ä»£ç è¿è¡Œäº§ç”Ÿé—®é¢˜(â€œæ°´åœŸâ€ä¸æœ) æ‰€ä»¥å°±éœ€è¦å°†ä»£ç ä»¥åŠè¿è¡Œç¯å¢ƒè£…åˆ°ä¸€ä¸ªå®¹å™¨ æµ‹è¯•åªéœ€è¦åœ¨å®¹å™¨ä¸­è¿›è¡Œæµ‹è¯•å³å¯ï¼Œä½¿ç”¨çš„æ˜¯å®¹å™¨ä¸­çš„è¿è¡Œç¯å¢ƒï¼Œè§£å†³äº†è½¯ä»¶è·¨ç¯å¢ƒè¿ç§»çš„é—®é¢˜ 1.1 Dockeræ¦‚å¿µ Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ è¯ç”Ÿäº2013å¹´åˆï¼ŒåŸºäºGoè¯­è¨€å®ç° Dockerå¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»å€¼çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„Linuxæœºå™¨ä¸Š å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’éš”ç¦»(ä¸€å°Linuxæœºå™¨å¯ä»¥å¯åŠ¨å¤šä¸ªå®¹å™¨ï¼Œå®¹å™¨ä¹‹é—´äº’ä¸å½±å“) å®¹å™¨æ€§èƒ½å¼€é”€æä½ å°ç»“ï¼šdockeræ˜¯ä¸€ç§å®¹å™¨æŠ€æœ¯ï¼Œè§£å†³è½¯ä»¶è·¨ç¯å¢ƒè¿ç§»çš„é—®é¢˜ 1.2 Dockeræ¶æ„ é•œåƒ(Image)ï¼šDockeré•œåƒ(image)ï¼Œå°±ç›¸å½“äºæ˜¯ä¸€ä¸ªrootæ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚å®˜æ–¹é•œåƒubuntu:16.04åŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„ä¸€å¥—Ubuntu 16.04æœ€å°ç³»ç»Ÿçš„rootæ–‡ä»¶ç³»ç»Ÿã€‚ å®¹å™¨(Container)ï¼šé•œåƒ(image)å’Œå®¹å™¨(Container)çš„å…³ç³»å°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»å’Œå¯¹è±¡ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ç±»ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰æ“ä½œã€‚ ä»“åº“(Repository)ï¼šä»“åº“çœ‹æˆä¸€ä¸ªä»£ç æ§åˆ¶ä¸­å¿ƒï¼Œç”¨æ¥ä¿å­˜é•œåƒã€‚ 1.3 Dockerä¸è™šæ‹Ÿæœºå®¹å™¨å°±æ˜¯å°†è½¯ä»¶æ‰“åŒ…æˆæ ‡å‡†åŒ–å•å…ƒï¼Œä»¥ç”¨äºå¼€å‘ã€äº¤ä»˜å’Œéƒ¨ç½²ã€‚ å®¹å™¨é•œåƒæ˜¯è½»é‡çš„ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼ŒåŒ…å«è½¯ä»¶è¿è¡Œæ–°éœ€çš„æ‰€æœ‰å†…å®¹ï¼šä»£ç ã€è¿è¡Œæ—¶ç¯å¢ƒã€ç³»ç»“å·¥å…·ã€ç³»ç»Ÿåº“å’Œè®¾ç½®ã€‚ å®¹å™¨åŒ–è½¯ä»¶åœ¨ä»»ä½•ç¯å¢ƒä¸­éƒ½èƒ½å¤Ÿå§‹ç»ˆå¦‚ä¸€åœ°è¿è¡Œã€‚ å®¹å™¨èµ‹äºäº†è½¯ä»¶ç‹¬ç«‹æ€§ï¼Œä½¿å…¶å…å—å¤–åœ¨ç¯å¢ƒå·®å¼‚çš„å½±å“ï¼Œä»è€Œæœ‰åŠ©äºå‡å°‘å›¢é˜Ÿé—´åœ¨ç›¸åŒåŸºç¡€è®¾æ–½ä¸Šè¿è¡Œä¸åŒè½¯ä»¶æ—¶çš„å†²çªã€‚ dockerå®¹å™¨è™šæ‹ŸåŒ–ä¸ä¼ ç»Ÿè™šæ‹Ÿæœºæ¯”è¾ƒ ç›¸åŒï¼š å®¹å™¨å’Œè™šæ‹Ÿæœºå…·æœ‰ç›¸ä¼¼çš„èµ„æºéš”ç¦»å’Œåˆ†é…ä¼˜åŠ¿ ä¸åŒï¼š å®¹å™¨è™›æ‹ŸåŒ–çš„æ˜¯æ“ä½œç³»çµ±ï¼Œè™›æ‹Ÿæœºè™šæ‹ŸåŒ–çš„æ˜¯ç¡¬ä»¶ã€‚ ä¼ ç»Ÿè™šæ‹Ÿæœºå¯ä»¥è¿è¡Œä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œå®¹å™¨åªèƒ½è¿è¡ŒåŒä¸€ç±»å‹æ“ä½œç³»ç»Ÿ ç‰¹æ€§ å®¹å™¨ è™šæ‹Ÿæœº å¯åŠ¨ ç§’çº§ åˆ†é’Ÿçº§ ç¡¬ç›˜ä½¿ç”¨ ä¸€èˆ¬ä¸ºMB ä¸€èˆ¬ä¸ºGB æ€§èƒ½ æ¥è¿‘åŸç”Ÿ è¾ƒå¼± ç³»ç»Ÿæ”¯æŒé‡ å•æœºæ”¯æŒä¸Šåƒä¸ªå®¹å™¨ ä¸€èˆ¬ä¸ºå‡ åä¸ª 2.Dockerå‘½ä»¤2.1 æœåŠ¡ç›¸å…³å‘½ä»¤ å¯åŠ¨dockeræœåŠ¡ï¼š 1systemctl start docker åœæ­¢dockeræœåŠ¡ï¼š 1systemctl stop docker é‡å¯dockeræœåŠ¡ï¼š 1systemctl restart docker æŸ¥çœ‹dockeræœåŠ¡çŠ¶æ€ï¼š 1systemctl status docker è®¾ç½®å¼€æœºå¯åŠ¨dockeræœåŠ¡ï¼š 1systemctl enable docker 2.2 é•œåƒç›¸å…³å‘½ä»¤ æŸ¥çœ‹é•œåƒï¼š 1docker images æŸ¥çœ‹é•œåƒæ‰€æœ‰çš„image idï¼š 1docker images -q æœç´¢é•œåƒï¼š æœç´¢redisé•œåƒ 1docker search redis æ‹‰å–(ä¸‹è½½)é•œåƒï¼š é»˜è®¤ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„redisé•œåƒ 1docker search redis ä¹Ÿå¯ä»¥æŒ‡å®šç‰ˆæœ¬å·ï¼š ä¸‹è½½7.0ç‰ˆæœ¬çš„redisé•œåƒ 1docker search redis:7.0 æŸ¥çœ‹ç‰ˆæœ¬ï¼šæ‰“å¼€dockerå®˜ç½‘ï¼Œæœç´¢redisï¼Œæ‰¾åˆ°å¹¶æ‰“å¼€å®˜æ–¹é•œåƒæŸ¥çœ‹æè¿°ä¿¡æ¯ åˆ é™¤é•œåƒï¼š é€šè¿‡image idåˆ é™¤é•œåƒ 1docker rmi &lt;IMAGE ID&gt; ä¹Ÿå¯ä»¥é€šè¿‡åç§°æŒ‡å®šç‰ˆæœ¬ï¼šåˆ é™¤7.0ç‰ˆæœ¬çš„redisé•œåƒ 1docker rmi redis:7.0 åˆ é™¤æ‰€æœ‰é•œåƒï¼š 1docker rmi &#x27;docker images -q&#x27; åˆ é™¤æ— ç”¨é•œåƒï¼š 1docker rmi $(docker images -f &quot;dangling=true&quot; -q) 2.3 å®¹å™¨ç›¸å…³å‘½ä»¤ æŸ¥çœ‹å®¹å™¨ï¼š æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š 1docker ps æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼š 1docker ps -a åˆ›å»ºå®¹å™¨ï¼š 1docker run [å‚æ•°] ä¾‹å­ï¼š 1docker run -it --name=c1 centos:latest /bin/bash 1docker run -id --name=c2 centos:latest -iï¼šä¿æŒå®¹å™¨è¿è¡Œ -tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯(å¯ä¸-iåˆå¹¶ä¸º-it) -itåˆ›å»ºçš„å®¹å™¨ç§°ä¸ºäº¤äº’å¼å®¹å™¨ -dï¼šå®ˆæŠ¤(åå°)æ¨¡å¼è¿è¡Œå®¹å™¨ -idï¼šåˆ›å»ºçš„å®¹å™¨ç§°ä¸ºå®ˆæŠ¤å¼å®¹å™¨ï¼Œéœ€è¦ä½¿ç”¨docker execè¿›å…¥å®¹å™¨ --name=c1ï¼šç»™å®¹å™¨èµ·åä¸ºc1 é€€å‡ºå®¹å™¨ï¼š 1exit è¿›å…¥å®¹å™¨ï¼š 1docker exec [å‚æ•°] è¿›å…¥c2å®¹å™¨ï¼š 1docker exec -it c2 /bin/bash ä»¥rootæƒé™è¿›å…¥å®¹å™¨ï¼š å‚æ•° 0 è¡¨ç¤ºroot 1docker exec -u 0 -it å®¹å™¨å /bin/bash å¯åŠ¨å®¹å™¨ï¼š 1docker start å®¹å™¨åç§° åœæ­¢å®¹å™¨ï¼š 1docker stop å®¹å™¨åç§° åˆ é™¤å®¹å™¨ï¼š 1docker rm å®¹å™¨åç§° æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ï¼š 1docker inspect å®¹å™¨åç§° 3.Dockerå®¹å™¨æ•°æ®å·3.1 æ•°æ®å·æ¦‚å¿µ æ•°æ®å·æ˜¯å®¿ä¸»æœºä¸­çš„ä¸€ä¸ªç›®å½•æˆ–æ–‡ä»¶ å½“å®¹å™¨ç›®å½•å’Œæ•°æ®å·ç›®å½•è¢«ç»‘å®šåï¼ŒåŒæ–¹çš„ä¿®æ”¹ä¼šç«‹å³åŒæ­¥ ä¸€ä¸ªæ•°æ®å·å¯ä»¥è¢«å¤šä¸ªå®¹å™¨åŒæ—¶æŒ‚è½½ ä¸€ä¸ªå®¹å™¨å¯ä»¥è¢«æŒ‚è½½å¤šä¸ªæ•°æ®å· æ•°æ®å·çš„ä½œç”¨ï¼š å®¹å™¨çš„æŒä¹…åŒ– å¤–éƒ¨æœºå™¨å’Œå®¹å™¨é—´æ¥é€šä¿¡ å®¹å™¨ä¹‹é—´æ•°æ®äº¤æ¢ 3.2 é…ç½®æ•°æ®å·åˆ›å»ºå¯åŠ¨å®¹å™¨æ—¶ï¼Œä½¿ç”¨-vè®¾ç½®æ•°æ®å· docker run -v å®¿ä¸»æœºç›®å½•(æˆ–æ–‡ä»¶):å®¹å™¨å†…ç›®å½•(æˆ–æ–‡ä»¶) æ³¨æ„äº‹é¡¹ï¼š ç›®å½•å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»º å¯ä»¥æŒ‚è½½å¤šä¸ªæ•°æ®å· ä¾‹å­ï¼š 1docker run -it --name=c1 -v /root/data:/root/data_container centos:latest /bin/bash æŒ‚è½½å¤šä¸ªæ•°æ®å·ï¼š 1234docker run -it --name=c2 \\-v /root/data1:/root/data_container1 \\-v /root/data2:/root/data_container2 \\centos:latest /bin/bash 3.3 é…ç½®æ•°æ®å·å®¹å™¨å¤šå®¹å™¨è¿›è¡Œæ•°æ®äº¤æ¢ï¼š å¤šä¸ªå®¹å™¨æŒ‚è½½åŒä¸€ä¸ªæ•°æ®å· æ•°æ®å·å®¹å™¨ åˆ›å»ºå¯åŠ¨c3æ•°æ®å·å®¹å™¨ï¼Œä½¿ç”¨-v å‚æ•°è®¾ç½®æ•°æ®å·ï¼š 1docker run -it --name=c3 -v /volume centos:latest /bin/bash åˆ›å»ºå¯åŠ¨c1ã€c2å®¹å™¨ï¼Œä½¿ç”¨--volume-from å‚æ•°è®¾ç½®æ•°æ®å·ï¼š 1docker run -it --name=c1 --volume-from c3 centos:latest /bin/bash 1docker run -it --name=c2 --volume-from c3 centos:latest /bin/bash 3.4 æ•°æ®å·å°ç»“ æ•°æ®å·çš„æ¦‚å¿µ å®¿ä¸»æœºçš„ä¸€ä¸ªç›®å½•æˆ–æ–‡ä»¶ æ•°æ®å·çš„ä½œç”¨ å®¹å™¨æ•°æ®æŒä¹…åŒ– å®¢æˆ·ç«¯å’Œå®¹å™¨æ•°æ®äº¤æ¢ å®¹å™¨ä¹‹é—´æ•°æ®äº¤æ¢ æ•°æ®å·å®¹å™¨ åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼ŒæŒ‚è½½ä¸€ä¸ªç›®å½•ï¼Œè®©å…¶ä»–å®¹å™¨ç»§æ‰¿è¯¥å®¹å™¨ é€šè¿‡ç®€å•æ–¹å¼å®ç°æ•°æ®å·é…ç½® 4.Dockeråº”ç”¨éƒ¨ç½²åŸºæœ¬æ­¥éª¤ï¼š æœç´¢é•œåƒ æ‹‰å–é•œåƒ åˆ›å»ºå®¹å™¨ æ“ä½œå®¹å™¨ å®¹å™¨å†…çš„ç½‘ç»œæœåŠ¡å’Œå¤–éƒ¨æœºå™¨ä¸èƒ½ç›´æ¥é€šä¿¡ å¤–éƒ¨æœºå™¨å’Œå®¿ä¸»æœºå¯ä»¥ç›´æ¥é€šä¿¡ å®¿ä¸»æœºå’Œå®¹å™¨å¯ä»¥ç›´æ¥é€šä¿¡ å½“å®¹å™¨ä¸­çš„ç½‘ç»œæœåŠ¡éœ€è¦è¢«å¤–éƒ¨æœºå™¨è®¿é—®æ—¶ï¼Œå¯ä»¥å°†å®¹å™¨ä¸­æä¾›æœåŠ¡çš„ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£ä¸Šã€‚å¤–éƒ¨æœºå™¨è®¿é—®å®¿ä¸»æœºçš„è¯¥ç«¯å£ï¼Œä»è€Œé—®æ¥è®¿é—®å®¹å™¨çš„æœåŠ¡ã€‚ è¿™ç§æ“ä½œç§°ä¸ºï¼šç«¯å£æ˜ å°„ 4.1 MySQLéƒ¨ç½²éœ€æ±‚ï¼š åœ¨Dockerå®¹å™¨ä¸­éƒ¨ç½²MySQLï¼Œå¹¶é€šè¿‡å¤–éƒ¨mysqlå®¢æˆ·ç«¯æ“ä½œMySQL server æœç´¢é•œåƒ 1docker search mysql æ‹‰å–é•œåƒ 1docker pull mysql åˆ›å»ºå®¹å™¨ï¼Œè®¾ç½®ç«¯å£æ˜ å°„ã€ç›®å½•æ˜ å°„ 123#åœ¨/rootç›®å½•ä¸‹åˆ›å»ºmysqlç›®å½•ç”¨äºå­˜å‚¨mysqlæ•°æ®ä¿¡æ¯mkdir ~/mysqlcd ~/mysql 1234567docker run -id \\-p 3307:3306 \\--name=c_mysql \\-v $PWD/conf:/etc/mysql/conf.d \\-v $PWD/data:/var/lib/mysql \\-e MYSQL_ROOT_PASSWORD=123456 \\mysql:latest å‚æ•°è¯´æ˜ï¼š $PWDï¼šç›¸å½“äºä¸»æœºç›®å½•çš„ &#x2F;root&#x2F;mysql -p 3307:3306ï¼šå°†å®¹å™¨çš„3306ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„3306ç«¯å£ ç«¯å£æ˜ å°„ -V $PWD/conf:/etc/mysql/conf.dï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ conf&#x2F;my.cnf æŒ‚è½½åˆ°å®¹å™¨çš„&#x2F;etc&#x2F;mysql&#x2F;my.cnf é…ç½®ç›®å½• -V $PWD/logs:/logsï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„logsç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ &#x2F;logs æ—¥å¿—ç›®å½• -V $PWD/data:/var/lib/mysqlï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ &#x2F;var&#x2F;lib&#x2F;mysql æ•°æ®ç›®å½• -e MYSOL_ROOT_PASSWORD=123456ï¼šåˆå§‹åŒ–root ç”¨æˆ·çš„å¯†ç ä¸º123456 æ“ä½œMySQLå®¹å™¨ å®¹å™¨å†…è¿æ¥MySQLï¼š 1docker exec -it c_mysql /bin/bash 1mysql -uroot -p123456 å›¾å½¢åŒ–å®¢æˆ·ç«¯è¿æ¥MySQLï¼š ä¸»æœºï¼šå®¿ä¸»æœºçš„ip ç«¯å£ï¼šä¸ºä¸Šé¢æ˜ å°„ä¸ºçš„3307 ç”¨æˆ·åï¼šroot å¯†ç ï¼šä¸ºä¸Šé¢çš„123456 4.2 Tomcatéƒ¨ç½²éœ€æ±‚ï¼š åœ¨Dockerå®¹å™¨ä¸­éƒ¨ç½²Tomcatï¼Œå¹¶é€šè¿‡å¤–éƒ¨æœºå™¨è®¿é—®Tomcatéƒ¨ç½²çš„é¡¹ç›® æœç´¢Tomcaté•œåƒ 1docker search tomcat æ‹‰å–Tomcaté•œåƒ 1docker pull tomcat åˆ›å»ºå®¹å™¨ï¼Œè®¾ç½®ç«¯å£æ˜ å°„ã€ç›®å½•æ˜ å°„ 123#åœ¨/rootç›®å½•ä¸‹åˆ›å»ºtomcatç›®å½•ç”¨äºå­˜å‚¨tomcatæ•°æ®ä¿¡æ¯mkdir ~/tomcatcd ~/tomcat 12345docker run -id \\--name=c_tomcat \\-p 8080:8080 \\-v $PWD:/usr/local/tomcat/webapps \\tomcat:latest å‚æ•°è¯´æ˜ï¼š -p 8080:8080ï¼šå°†å®¹å™¨çš„8080ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„8080ç«¯å£ -v $PWD:/user/local/tomcat/webappsï¼šå°†ä¸»æœºä¸­å½“å‰ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„ &#x2F;user&#x2F;local&#x2F;tomcat&#x2F;webapps æµ‹è¯•Tomcat åœ¨tomcatç›®å½•ä¸‹ï¼Œåˆ›å»ºteståŒ…ï¼Œåœ¨teståŒ…ä¸­åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼š 123mkdir testcd testvim index.html åœ¨index.htmlæ–‡ä»¶ä¸­å†™å…¥ï¼š 1&lt;h1&gt; Hello Tomcat &lt;/h1&gt; ä¿å­˜é€€å‡ºï¼š Esc+:wq ä½¿ç”¨æµè§ˆå™¨è®¿é—®Tomcatï¼šä¸»æœºåœ°å€:8080/test/index.html 4.3 Rediséƒ¨ç½²éœ€æ±‚ï¼š åœ¨Dockerå®¹å™¨ä¸­éƒ¨ç½²Redisï¼Œå¹¶é€šè¿‡å¤–éƒ¨æœºå™¨è¿æ¥Redis æœç´¢Redisé•œåƒ 1docker search redis æ‹‰å–Tomcaté•œåƒ 1docker pull redis åˆ›å»ºå®¹å™¨ï¼Œè®¾ç½®ç«¯å£æ˜ å°„ 1234docker run -id \\-p 6379:6379 \\--name=c_redis \\redis:latest å›¾å½¢åŒ–å®¢æˆ·ç«¯è¿æ¥redis ä¸»æœºåœ°å€ï¼šå®¿ä¸»æœºçš„ip ç«¯å£ï¼šä¸º6379 4.4 Nginxéƒ¨ç½²éœ€æ±‚ï¼š åœ¨Dockerå®¹å™¨ä¸­éƒ¨ç½²Nginxï¼Œå¹¶é€šè¿‡å¤–éƒ¨æœºå™¨è®¿é—®Nginx æœç´¢Nginxé•œåƒ 1docker search nginx æ‹‰å–Nginxé•œåƒ 1docker pull nginx éƒ¨ç½²Nginx åœ¨&#x2F;rootç›®å½•ä¸‹åˆ›å»ºnginxç›®å½•ç”¨äºå­˜å‚¨nginxæ•°æ®ä¿¡æ¯ï¼š 12mkdir ~/nginxcd ~/nginx åœ¨~&#x2F;nginx&#x2F;conf&#x2F;ä¸‹åˆ›å»ºnginx.confæ–‡ä»¶ï¼š 123mkdir confcd confvim nginx.conf åœ¨nginx.confä¸­å†™å…¥ï¼š 1234567891011121314151617181920212223242526272829user nginx;worker_processes 1;error_log /var/log/nginx/error.log warn;pid /var/run/nginx.pid;events &#123; worker_connections 1024;&#125;http &#123; include /etc/nginx/mime.types; default_type application/octet-stream; log_format main &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27; &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27; &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;; access_log /var/log/nginx/access.log main; sendfile on; #tcp_nopush on; keepalive_timeout 65; #gzip on; include /etc/nginx/conf.d/*.conf;&#125; å›åˆ°nginxç›®å½•ï¼š 1cd .. åˆ›å»ºå®¹å™¨ï¼Œè®¾ç½®ç«¯å£æ˜ å°„ã€ç›®å½•æ˜ å°„ï¼š 1234567docker run -id \\--name=c_nginx \\-p 80:80 \\-v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf \\-v $PWD/logs:/var/log/nginx \\-v $PWD/html:/usr/share/nginx/html \\nginx:latest å‚æ•°è¯´æ˜ï¼š -p 80:80ï¼šå°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 80 ç«¯å£ -v $PWD/conf/nginx.conf:/etc/nginx/nginx.confï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„&#x2F;conf&#x2F;nginx.conf æŒ‚è½½åˆ°å®¹å™¨çš„ï¼š&#x2F;etc&#x2F;nginx&#x2F;nginx.conf é…ç½®ç›®å½• -v $PWD/logs:/var/log/nginxï¼šå°†ä¸»æœºå½“å‰ç›®å½•ä¸‹çš„ logs ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„&#x2F;var&#x2F;log&#x2F;nginx æ—¥å¿—ç›®å½• ä½¿ç”¨æµè§ˆå™¨è®¿é—®nginx åˆ›å»ºnginx&#x2F;html&#x2F;test&#x2F;index.htmlæ–‡ä»¶ï¼š 1234cd htmlmkdir testcd testvim index.html å†™å…¥ä¸‹é¢å†…å®¹ï¼š 1&lt;h1&gt; Hello Nginx &lt;/h1&gt; æµè§ˆå™¨è®¿é—®ï¼šä¸»æœºåœ°å€/test/index.html 5.DockerFile5.1 Dockeré•œåƒåŸç† æ“ä½œç³»ç»Ÿç»„æˆéƒ¨åˆ†ï¼š è¿›ç¨‹è°ƒåº¦å­ç³»ç»Ÿ è¿›ç¨‹é€šä¿¡å­ç³»çµ± å†…å­˜ç®¡ç†å­ç³»ç»Ÿ è®¾å¤‡ç®¡ç†å­ç³»ç»Ÿ æ–‡ä»¶ç®¡ç†å­ç³»ç»Ÿ ç½‘ç»œé€šä¿¡å­ç³»ç»Ÿ ä½œä¸šæ§åˆ¶å­ç³»ç»Ÿ Linuxæ–‡ä»¶ç³»ç»Ÿç”±bootfså’Œrootfsä¸¤éƒ¨åˆ†ç»„æˆï¼š bootfsï¼šåŒ…å«bootloader(å¼•å¯¼åŠ è½½ç¨‹åº)å’Œkernel(å†…æ ¸ï¼‰ rootfsï¼šrootæ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…å«çš„å°±æ˜¯å…¸å‹Linux ç³»ç»Ÿä¸­çš„&#x2F;devã€&#x2F;procã€&#x2F;binã€&#x2F;etcç­‰æ ‡å‡†ç›®å½•å’Œæ–‡ä»¶ ä¸åŒçš„linuxå‘è¡Œç‰ˆï¼ŒbootfsåŸºæœ¬ä¸€æ ·ï¼Œè€Œrootisä¸åŒã€‚å¦‚ubuntuã€centosç­‰ Dockeré•œåƒåŸç†ï¼š Dockeré•œåƒæ˜¯ç”±ç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿå åŠ è€Œæˆ æœ€åº•ç«¯æ˜¯bootfsï¼Œ å¹¶ä½¿ç”¨å®¿ä¸»æœºçš„bootfs ç¬¬äºŒå±‚æ˜¯rootæ–‡ä»¶ç³»ç»Ÿrootfsç§°ä¸ºbase image(åŸºç¡€é•œåƒ) ç„¶åå†å¾€ä¸Šå¯ä»¥å åŠ å…¶ä»–çš„é•œåƒæ–‡ä»¶ ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿ (Union File Systemï¼‰æŠ€æœ¯èƒ½å¤Ÿå°†ä¸åŒçš„å±‚æ•´åˆæˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä¸ºè¿™äº›å±‚æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„è§†è§’ï¼Œè¿¹æ ·å°±éšè—äº†å¤šå±‚çš„å­˜åœ¨ï¼Œåœ¨ç”¨æˆ·çš„è§’åº¦çœ‹æ¥ï¼Œåªå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚ ä¸€ä¸ªé•œåƒå¯ä»¥æ”¾åœ¨å¦ä¸€ä¸ªé•œåƒçš„ä¸Šé¢ã€‚ä½äºä¸‹é¢çš„é•œåƒç§°ä¸ºçˆ¶é•œåƒï¼Œæœ€åº•éƒ¨çš„é•œåƒæˆä¸ºåŸºç¡€é•œåƒã€‚ å½“ä¸€ä¸ªé•œåƒå¯åŠ¨å®¹å™¨æ—¶ï¼ŒDockerä¼šåœ¨æœ€åº•å±‚åŠ è½½ä¸€ä¸ªè¯»å†™æ–‡ä»¶ç³»ç»Ÿä½œä¸ºå®¹å™¨ è¿™æ ·åˆ†å±‚çš„å¥½å¤„å°±æ˜¯å¤ç”¨ æ€»ç»“ï¼š Dockeré•œåƒçš„æœ¬è´¨æ˜¯ä»€ä¹ˆ? ä¸€ä¸ªåˆ†å±‚æ–‡ä»¶ç³»ç»Ÿ centosé•œåƒåªæœ‰200MBï¼Œè€Œä¸€ä¸ªcentosçš„æ“ä½œç³»ç»Ÿçš„isoæ–‡ä»¶è¦å‡ ä¸ªGï¼Ÿ centosçš„é•œåƒæ–‡ä»¶åŒ…å«bootfså’Œrootfsï¼Œè€Œdockerçš„centosé•œåƒå¤ç”¨äº†æ“ä½œç³»ç»Ÿ(å°±æ˜¯å®¿ä¸»æœº)çš„bootfsï¼Œåªæœ‰rootfså’Œå…¶ä»–é•œåƒå±‚ Dockerä¸­ä¸€ä¸ªtomcaté•œåƒä¸ºä»€ä¹ˆæœ‰500MBï¼Œè€Œâ€”ä¸ªtomcatå®‰è£…åŒ…åªæœ‰70å¤šMB? ç”±äºdockerä¸­é•œåƒæ˜¯åˆ†å±‚çš„ï¼Œtomcatè™½ç„¶åªæœ‰70å¤šMBï¼Œä½†ä»–éœ€è¦ä¾èµ–äºçˆ¶é•œåƒå’ŒåŸºç¡€é•œåƒï¼Œæ‰€æœ‰æ•´ä¸ªå¯¹å¤–æš´éœ²çš„tomcaté•œåƒåŠ èµ·æ¥å¤§å°500å¤šMB 5.2 å®¹å™¨è½¬é•œåƒå®¹å™¨è½¬é•œåƒ 1docker commit [å®¹å™¨id] [æ–°çš„é•œåƒåç§°]:[è‡ªå®šä¹‰ç‰ˆæœ¬å·] é•œåƒè½¬å‹ç¼©æ–‡ä»¶ 1docker save -o [è‡ªå®šä¹‰å‹ç¼©æ–‡ä»¶åç§°.tar] [é•œåƒåç§°]:[è‡ªå®šä¹‰ç‰ˆæœ¬å·] å‹ç¼©æ–‡ä»¶è½¬é•œåƒ 1docker load -i [å‹ç¼©æ–‡ä»¶] 5.3 DockerFileæ¦‚å¿µ DockerFileæ˜¯ä¸€ä¸ªæ–‡æœ¬ç³»ç»Ÿ åŒ…å«äº†ä¸€æ¡æ¡çš„æŒ‡ä»¤ æ¯æ¡æŒ‡ä»¤æ„å»ºä¸€å±‚ï¼ŒåŸºäºåŸºç¡€é•œåƒï¼Œæœ€ç»ˆæ„å»ºå‡ºä¸€ä¸ªæ–°çš„é•œåƒ å¯ä»¥ä¸ºå¼€å‘å›¢é˜Ÿæé«˜ä¸€ä¸ªå®Œå…¨ä¸€è‡´çš„å¼€å‘ç¯å¢ƒ åœ¨éƒ¨ç½²æ—¶ï¼Œå¯ä»¥å®ç°åº”ç”¨çš„æ— ç¼ç§»æ¤ ä¾‹å¦‚ï¼š centos7çš„dockerfile nginxçš„dockerfile 5.4 DockerFileçš„å…³é”®å­— å…³é”®å­— ä½œç”¨ FROM æŒ‡å®šçˆ¶é•œåƒ MAINTAINER ä½œè€…ä¿¡æ¯ LABEL æ ‡ç­¾ RUN æ‰§è¡Œå‘½ä»¤ CMD å®¹å™¨å¯åŠ¨å‘½ä»¤ ENTRYPOINT å…¥å£ COPY å¤åˆ¶æ–‡ä»¶ ADD æ·»åŠ æ–‡ä»¶ ENV ç¯å¢ƒå˜é‡ ARG æ„å»ºå‚æ•° VOLUME å®šä¹‰å¤–éƒ¨å¯ä»¥æŒ‚è½½çš„æ•°æ®å· EXPOSE æš´éœ²ç«¯å£ WORKDIR å·¥ä½œç›®å½• USER æŒ‡å®šæ‰§è¡Œç”¨æˆ· HEALTHCHECK å¥åº·æ£€æŸ¥ ONBUILD è§¦å‘å™¨ STOPSIGNAL å‘é€ä¿¡æ¯é‡åˆ°å®¿ä¸»æœº SHELL æ‰§è¡Œæ‰§è¡Œè„šæœ¬shell 5.5 éƒ¨ç½²SpringBooté¡¹ç›®éœ€æ±‚ï¼š å®šä¹‰dockerfileï¼Œå‘å¸ƒspringbooté¡¹ç›® å®ç°æ­¥éª¤ï¼š å®šä¹‰çˆ¶é•œåƒ å®šä¹‰ä½œè€…ä¿¡æ¯ å°†jaråŒ…æ·»åŠ åˆ°å®¹å™¨ å®šä¹‰å®¹å™¨å¯åŠ¨æ‰§è¡Œçš„å‘½ä»¤ é€šè¿‡dockerfileæ„å»ºé•œåƒ åˆ›å»ºç›®å½•ï¼š 12mkdir ~/docker-filescd ~/docker-files å°†æ‰“åŒ…å¥½çš„SpringBooté¡¹ç›®ä¸Šä¼ åˆ°~&#x2F;docker-filesç›®å½•ä¸‹ æ³¨æ„ï¼šSpringBooté¡¹ç›®ä¹Ÿè¦ä¸ºjava8ç‰ˆæœ¬ åœ¨docker-filesç›®å½•ç¼–å†™springboot_dockerfileï¼š 1vim springboot_dockerfile å†™å…¥ä¸‹é¢çš„å†…å®¹ï¼š 1234FROM java:8MAINTAINER AiADD springboot-demo-0.0.1-SNAPSHOT.jar app.jarCMD java -jar app.jar ä¿å­˜é€€å‡ºï¼Œå°†jaråŒ…è½¬æ¢ä¸ºé•œåƒï¼š 1docker build -f ./springboot_dockerfile -t app . æµ‹è¯• åˆ›å»ºå®¹å™¨ï¼š 1docker run -id --name=c_app -p 8080:8080 app:latest æµè§ˆå™¨è®¿é—®ï¼šä¸»æœºåœ°å€:8080/hello 5.6 è‡ªå®šä¹‰Centoséœ€æ±‚ï¼š è‡ªå®šä¹‰centos:7é•œåƒï¼Œè¦æ±‚ï¼š é»˜è®¤ç™»å½•è·¯å¾„ä¸º&#x2F;usr å¯ä»¥ä½¿ç”¨vim å®ç°æ­¥éª¤ï¼š å®šä¹‰çˆ¶é•œåƒ å®šä¹‰ä½œè€…ä¿¡æ¯ æ‰§è¡Œå®‰è£…vimå‘½ä»¤ å®šä¹‰é»˜è®¤çš„å·¥ä½œç›®å½• å®šä¹‰å®¹å™¨å¯åŠ¨æ‰§è¡Œçš„å‘½ä»¤ è½¬åˆ°~&#x2F;docker-filesç›®å½• 1cd ~/docker-files ç¼–å†™centos7_dockerfile 1vim centos7_dockerfile å†™å…¥ä¸‹é¢å†…å®¹ï¼š 12345FROM centos:7MAINTAINER AiRUN yum install -y vimWORKDIR /usrCMD /bin/bash ä¿å­˜é€€å‡º åˆ›å»ºè‡ªå®šä¹‰centos7é•œåƒ 1docker build -f ./centos7_dockerfile -t my_centos:1 . 6.DockeræœåŠ¡ç¼–æ’6.1 Docker Composeæ¦‚è¿°å¾®æœåŠ¡æ¶æ„çš„åº”ç”¨ç³»ç»Ÿä¸­ä¸€èˆ¬åŒ…å«è‹¥å¹²ä¸ªå¾®æœåŠ¡ï¼Œæ¯ä¸ªå¾®æœåŠ¡ä¸€èˆ¬éƒ½ä¼šéƒ¨ç½²å¤šä¸ªå®ä¾‹ï¼Œå¦‚æœæ¯ä¸ªå¾®æœåŠ¡éƒ½è¦æ‰‹åŠ¨å¯åœï¼Œç»´æŠ¤çš„å·¥ä½œé‡ä¼šå¾ˆå¤§ã€‚ è¦ä»Dockerfile build image æˆ–è€…å»dockerhubæ‹‰å–image è¦åˆ›å»ºå¤šä¸ªcontainer è¦ç®¡ç†è¿™äº›container(å¯åŠ¨åœæ­¢åˆ é™¤) æœåŠ¡ç¼–æ’ï¼šæŒ‰ç…§ä¸€å®šçš„ä¸šåŠ¡è§„åˆ™æ‰¹é‡ç®¡ç†å®¹å™¨ Docker Composeæ˜¯ä¸€ä¸ªç¼–æ’å¤šå®¹å™¨åˆ†å¸ƒå¼éƒ¨ç½²çš„å·¥å…·ï¼Œæä¾›å‘½ä»¤é›†ç®¡ç†å®¹å™¨åŒ–åº”ç”¨çš„å®Œæ•´å¼€å‘å‘¨æœŸï¼ŒåŒ…æ‹¬æœåŠ¡æ„å»ºã€å¯åŠ¨å’Œåœæ­¢ã€‚ä½¿ç”¨æ­¥éª¤ï¼š åˆ©ç”¨ Dockerfile å®šä¹‰è¿è¡Œç¯å¢ƒé•œåƒ ä½¿ç”¨ docker-compose.ymlå®šä¹‰ç»„æˆåº”ç”¨çš„å„æœåŠ¡ è¿è¡Œ docker-compose up å¯åŠ¨åº”ç”¨ 6.2 Docker Composeå®‰è£…åœ¨å®‰è£…docker-composeä¹‹å‰è¦å®‰è£…dockerï¼Œä»¥äºŒè¿›åˆ¶åŒ…çš„æ–¹å¼å®‰è£…åœ¨Linuxä¸­ï¼š 1curl -L https://get.daocloud.io/docker/compose/releases/download/v2.9.0/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose è®¾ç½®å¯æ‰§è¡Œæƒé™ï¼š 1chmod +x /usr/local/bin/docker-compose æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼š 1docker-compose -v docker-composeçš„å¸è½½ï¼Œåˆ é™¤äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ï¼š 1rm /usr/local/bin/docker-compose 6.3 ç¼–æ’Nginx+SpringBooté¡¹ç›® åˆ›å»ºç›®å½• 123mkdir ~/docker-composecd ~/docker-composevim docker-compose.yml ç¼–å†™docker-compose.ymlæ–‡ä»¶ 1234567891011121314version: &#x27;3&#x27;services: nginx: image: nginx ports: - 80:80 links: - app volumes: - ./nginx/conf.d:/etc/nginx/conf.d app: image: app expose: - &quot;8080&quot; åˆ›å»º.&#x2F;nginx&#x2F;conf.dç›®å½•ä¸‹ 123mkdir -p ./nginx/conf.dcd ./nginx/conf.dvim my.conf ç¼–å†™my.confæ–‡ä»¶ï¼š 1234567server &#123; listen 80; access_log off; location / &#123; proxy_pass http://app:8080; &#125;&#125; åœ¨~&#x2F;docker-composeç›®å½•ä¸‹ä½¿ç”¨docker-composeå¯åŠ¨å®¹å™¨ 1docker-compose up æµ‹è¯• ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼šä¸»æœºåœ°å€:80/hello 7.Dockerç§æœ‰ä»“åº“Dockerç§æœ‰ä»“åº“ï¼š Dockerå®˜æ–¹çš„Docker hubæ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å…¬å…±é•œåƒçš„ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢æ‹‰å–é•œåƒåˆ°æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥æŠŠæˆ‘ä»¬è‡ªå·±çš„é•œåƒæ¨é€ä¸Šå»ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬çš„æœåŠ¡å™¨æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œæˆ–è€…ä½ ä¸å¸Œæœ›å°†è‡ªå·±çš„é•œåƒæ”¾åˆ°å…¬ç½‘å½“ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ­å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“æ¥å­˜å‚¨å’Œç®¡ç†è‡ªå·±çš„é•œåƒã€‚ 7.1 æ­å»ºç§æœ‰ä»“åº“ æ‹‰å–ç§æœ‰ä»“åº“é•œåƒ 1docker pull registry å¯åŠ¨ç§æœ‰ä»“åº“å®¹å™¨ 1docker run -id --name=registry -p 5000:5000 registry æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥åœ°å€https://ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000/v2/_catalog å¦‚æœçœ‹åˆ°&#123;&quot;repositories&quot;:[]&#125;è¡¨ç¤ºç§æœ‰ä»“åº“æ­å»ºæˆåŠŸ ä¿®æ”¹deamon.json 1vim /etc/docker/daemon.json åœ¨deamon.jsonä¸­æ·»åŠ ä¸€ä¸ªkeyï¼Œè®©dockerä¿¡ä»»ç§æœ‰ä»“åº“åœ°å€ï¼Œæ·»åŠ ä¸‹é¢å†…å®¹ï¼š 1&#123;&quot;insecure-registries&quot;: [&quot;ç§æœ‰ä»“åº“æœåŠ¡å™¨ip:5000&quot;]&#125; é‡å¯dockeræœåŠ¡ 1systemctl restart docker å¯åŠ¨registryå®¹å™¨ 1docker start registry 7.2 ä¸Šä¼ é•œåƒåˆ°ç§æœ‰ä»“åº“ä¸Šä¼ centos:7ä¸ºä¾‹ï¼š æ ‡è®°é•œåƒä¸ºç§æœ‰ä»“åº“çš„é•œåƒ 1docker tag centos:7 ç§æœ‰ä»“åº“åœ°å€ip:5000/centos:7 ä¸Šä¼ æ ‡è®°çš„é•œåƒ 1docker push ç§æœ‰ä»“åº“åœ°å€ip:5000/centos:7 æ³¨æ„ï¼šè¦å¯åŠ¨registryå®¹å™¨ï¼Œæ‰å¯ä»¥ä¸Šä¼ åˆ°ç§æœ‰ä»“åº“ 1docker start registry 7.3 ä»ç§æœ‰ä»“åº“æ‹‰å–é•œåƒæ‹‰å–centos:7ä¸ºä¾‹ï¼š 1dokcer pull ç§æœ‰ä»“åº“åœ°å€ip:5000/centos:7","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"}]},{"title":"æ•°æ®ç»“æ„çš„å­¦ä¹ ç¬”è®°","slug":"è®¡ç®—æœº4ä»¶å¥—/æ•°æ®ç»“æ„","date":"2022-08-06T11:11:16.400Z","updated":"2022-09-27T14:16:26.838Z","comments":true,"path":"2022/08/06/è®¡ç®—æœº4ä»¶å¥—/æ•°æ®ç»“æ„/","link":"","permalink":"http://example.com/2022/08/06/%E8%AE%A1%E7%AE%97%E6%9C%BA4%E4%BB%B6%E5%A5%97/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","excerpt":"","text":"0.æ’åº0.1 å†’æ³¡æ’åº12345678910111213141516171819202122#include&lt;vector&gt;#include&lt;functional&gt;using namespace std;class Bubble&#123;public: template &lt;class T, class compare = less&lt;&gt;&gt; static void sort(T&amp; v) &#123; for (int i = v.size() - 1; i &gt; 0; i--) &#123; for (int j = 0; j &lt; i; j++) &#123; if (!compare()(v[j], v[j + 1])) &#123; swap(v[j], v[j + 1]); &#125; &#125; &#125; &#125;&#125;; ç”±äºä½¿ç”¨äº†ç±»æ¨¡æ¿ï¼Œå¯¼è‡´æµ‹è¯•æ—¶ï¼Œå¯¼å…¥å¤´æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š#include&quot;ArrayList.h&quot;ï¼Œä¼šæŠ¥é”™ã€‚ æ‰€ä»¥æ”¹ç”¨å¯¼å…¥æºæ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š#include&quot;ArrayList.cpp&quot;ï¼Œè¿™æ ·å°±èƒ½æˆåŠŸè¿è¡Œäº†ï¼ 1.çº¿æ€§è¡¨1.1 é¡ºåºè¡¨(åŠ¨æ€æ•°ç»„)Cppå®ç°ï¼Œé¡ºåºè¡¨çš„åŸºæœ¬å®ç° å¤´æ–‡ä»¶ArrayList.hï¼š 12345678910111213141516171819202122#pragma oncetemplate &lt;class T&gt;class ArrayList &#123; private: T* arrayList; // å­˜å‚¨å…ƒç´ çš„æ•°ç»„ int size; // æ•°ç»„çš„å¤§å° int capacity; // æ•°ç»„çš„å®¹é‡ void resize(int newCapacity); // é‡æ–°è®¾ç½®å®¹é‡ public: ArrayList(int capacity); // æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–å®¹é‡ ~ArrayList(); // ææ„å‡½æ•° void clear(); // æ¸…ç©ºæ•°ç»„ bool isEmpty(); // æ•°ç»„æ˜¯å¦ä¸ºç©º int length(); // è·å–æ•°ç»„çš„é•¿åº¦ T get(int pos); // è·å–è¯¥ä½ç½®çš„å…ƒç´  void insert(T val); // åœ¨æ•°ç»„æœ«å°¾æ’å…¥å…ƒç´  void insert(int pos, T val); // æŒ‡å®šæ•°ç»„ä¸­çš„ä½ç½®æ’å…¥å…ƒç´  T remove(int pos); // åˆ é™¤è¯¥ä½ç½®çš„å…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´  int indexOf(T val); // æ ¹æ®å…ƒç´ å€¼æŸ¥æ‰¾æœ€å°ç´¢å¼•çš„ä½ç½®ï¼Œæ²¡æœ‰è¿”å›-1&#125;; æºæ–‡ä»¶ArrayList.cppï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125#include&quot;ArrayList.h&quot;template&lt;class T&gt;ArrayList&lt;T&gt;::ArrayList()&#123; this-&gt;capacity = 5; this-&gt;arrayList = new T[this-&gt;capacity]; this-&gt;size = 0;&#125;template&lt;class T&gt;ArrayList&lt;T&gt;::ArrayList(int capacity)&#123; this-&gt;capacity = capacity; this-&gt;arrayList = new T[this-&gt;capacity]; this-&gt;size = 0;&#125;template &lt;class T&gt;ArrayList&lt;T&gt;::~ArrayList() &#123; if (this-&gt;arrayList != nullptr)&#123; delete[] this-&gt;arrayList; this-&gt;arrayList = nullptr; &#125;&#125;template&lt;class T&gt;void ArrayList&lt;T&gt;::clear()&#123; this-&gt;size = 0;&#125;template&lt;class T&gt;bool ArrayList&lt;T&gt;::isEmpty()&#123; return this-&gt;arrayList == nullptr;&#125;template&lt;class T&gt;int ArrayList&lt;T&gt;::length()&#123; return this-&gt;size;&#125;template&lt;class T&gt;T ArrayList&lt;T&gt;::get(int pos)&#123; if (pos &lt;0 || pos &gt;= this-&gt;size) return T(); return this-&gt;arrayList[pos];&#125;template&lt;class T&gt;void ArrayList&lt;T&gt;::insert(T val)&#123; if (this-&gt;size == this-&gt;capacity) &#123; this-&gt;resize(this-&gt;capacity * 2); &#125; this-&gt;arrayList[this-&gt;size] = val; this-&gt;size++;&#125;template&lt;class T&gt;void ArrayList&lt;T&gt;::insert(int pos, T val)&#123; if (this-&gt;size == this-&gt;capacity) &#123; this-&gt;resize(this-&gt;capacity * 2); &#125; for (int i = this-&gt;size - 1; i &gt;= pos ; i--) &#123; this-&gt;arrayList[i + 1] = this-&gt;arrayList[i]; &#125; this-&gt;arrayList[pos] = val; this-&gt;size++;&#125;template&lt;class T&gt;T ArrayList&lt;T&gt;::remove(int pos)&#123; if (pos &lt;0 || pos &gt;= this-&gt;size) return T(); T val = this-&gt;arrayList[pos]; for (int i = pos; i &lt; this-&gt;size; i++) &#123; this-&gt;arrayList[i] = this-&gt;arrayList[i + 1]; &#125; this-&gt;size--; if (this-&gt;size &lt; this-&gt;capacity / 4) &#123; this-&gt;resize(this-&gt;capacity / 2); &#125; return val;&#125;template&lt;class T&gt;int ArrayList&lt;T&gt;::indexOf(T val)&#123; for (int i = 0; i &lt; this-&gt;size; i++) &#123; if (this-&gt;arrayList[i] == val) &#123; return val; &#125; &#125; return -1;&#125;template&lt;class T&gt;void ArrayList&lt;T&gt;::resize(int newCapacity)&#123; this-&gt;capacity = newCapacity; T* temp = new T[this-&gt;capacity]; for (int i = 0; i &lt; this-&gt;size; i++) &#123; temp[i] = this-&gt;arrayList[i]; &#125; delete[] this-&gt;arrayList; this-&gt;arrayList = temp;&#125; éƒ¨åˆ†æµ‹è¯•main.cppï¼š 12345678910111213141516171819202122#include&quot;ArrayList.cpp&quot;#include&lt;iostream&gt;using namespace std;void main() &#123; ArrayList a(3); for (int i = 0; i &lt; 6; i++) &#123; a.insert(i); &#125; cout &lt;&lt; a.isEmpty() &lt;&lt; endl; cout &lt;&lt; a.remove(1) &lt;&lt; endl; cout &lt;&lt; a.indexOf(1) &lt;&lt; endl; for (int i = 0; i &lt; a.length(); i++) &#123; cout &lt;&lt; a.get(i) &lt;&lt; &quot; &quot;; &#125; cout &lt;&lt; endl;&#125; 1.2 å•å‘é“¾è¡¨å¤´æ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839#pragma oncetemplate&lt;class T&gt;class LinkedList&#123;private: class Node &#123; public: T data; Node* next; Node() &#123;&#125; Node(Node* next) &#123; this-&gt;next = next; &#125; Node(T data, Node* next) &#123; this-&gt;data = data; this-&gt;next = next; &#125; &#125;; Node* head; int size; Node* reverse(Node* curr); // å½“å‰èŠ‚ç‚¹å®ç°åè½¬public: LinkedList(); ~LinkedList(); void clear(); bool isEmpty(); int length(); T get(int pos); void insert(T data); void insert(int pos, T data); T remove(int pos); int indexOf(T data); void reverse(); T getMid();&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175#include&quot;LinkedList.h&quot;#include&lt;iostream&gt;using namespace std;template&lt;class T&gt;typename LinkedList&lt;T&gt;::Node* LinkedList&lt;T&gt;::reverse(Node* curr)&#123; if (curr-&gt;next == nullptr) &#123; this-&gt;head-&gt;next = curr; return curr; &#125; Node* p = reverse(curr-&gt;next); p-&gt;next = curr; curr-&gt;next = nullptr; return curr;&#125;template&lt;class T&gt;LinkedList&lt;T&gt;::LinkedList()&#123; this-&gt;head = new Node(nullptr); this-&gt;size = 0;&#125;template&lt;class T&gt;LinkedList&lt;T&gt;::~LinkedList()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; this-&gt;clear(); delete this-&gt;head; this-&gt;head = nullptr;&#125;template&lt;class T&gt;void LinkedList&lt;T&gt;::clear()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; Node* newNode = p-&gt;next; delete p; p = newNode; &#125; this-&gt;head-&gt;next = nullptr; this-&gt;size = 0;&#125;template&lt;class T&gt;bool LinkedList&lt;T&gt;::isEmpty()&#123; return this-&gt;size == 0;&#125;template&lt;class T&gt;int LinkedList&lt;T&gt;::length()&#123; return this-&gt;size;&#125;template&lt;class T&gt;T LinkedList&lt;T&gt;::get(int pos)&#123; if (pos &lt; 0 || pos &gt;= this-&gt;size) return T(); Node* p = this-&gt;head-&gt;next; for (int i = 0; i &lt; pos; i++) &#123; p = p-&gt;next; &#125; return p-&gt;data;&#125;template&lt;class T&gt;void LinkedList&lt;T&gt;::insert(T data)&#123; Node* p = this-&gt;head; while (p-&gt;next != nullptr) &#123; p = p-&gt;next; &#125; Node* newNode = new Node(data, nullptr); p-&gt;next = newNode; this-&gt;size++;&#125;template&lt;class T&gt;void LinkedList&lt;T&gt;::insert(int pos, T data)&#123; Node* p = this-&gt;head; for (int i = 0; i &lt; pos; i++) &#123; p = p-&gt;next; &#125; Node* newNode = new Node(data, p-&gt;next); p-&gt;next = newNode; this-&gt;size++;&#125;template&lt;class T&gt;T LinkedList&lt;T&gt;::remove(int pos)&#123; if (pos &lt; 0 || pos &gt;= this-&gt;size) return T(); Node* p = this-&gt;head; for (int i = 0; i &lt; pos; i++) &#123; p = p-&gt;next; &#125; Node* e = p-&gt;next; p-&gt;next = e-&gt;next; T res = e-&gt;data; delete e; e = nullptr; this-&gt;size--; return res;&#125;template&lt;class T&gt;int LinkedList&lt;T&gt;::indexOf(T data)&#123; Node* p = this-&gt;head-&gt;next; int pos = 0; while (p != nullptr) &#123; if (p-&gt;data == data) &#123; return pos; &#125; p = p-&gt;next; pos++; &#125; return -1;&#125;template&lt;class T&gt;void LinkedList&lt;T&gt;::reverse()&#123; if (this-&gt;size &lt; 2) &#123; return; &#125; reverse(this-&gt;head-&gt;next);&#125;template&lt;class T&gt;T LinkedList&lt;T&gt;::getMid()&#123; if (this-&gt;head-&gt;next == nullptr) return T(); Node* fast = this-&gt;head-&gt;next; Node* slow = this-&gt;head-&gt;next; while (fast != nullptr &amp;&amp; fast-&gt;next != nullptr) &#123; fast = fast-&gt;next-&gt;next; slow = slow-&gt;next; &#125; return slow-&gt;data;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324#include&quot;LinkedList.cpp&quot;#include&lt;iostream&gt;using namespace std;void main()&#123; LinkedList&lt;int&gt; list; for (int i = 0; i &lt; 6; i++) &#123; list.insert(i); &#125; list.insert(2, 100); cout &lt;&lt; list.isEmpty() &lt;&lt; endl; cout &lt;&lt; list.remove(5) &lt;&lt; endl; cout &lt;&lt; list.indexOf(5) &lt;&lt; endl; //list.clear(); for (int i = 0; i &lt; list.length(); i++) &#123; cout &lt;&lt; list.get(i) &lt;&lt; &quot; &quot;; &#125; cout &lt;&lt; endl;&#125; 1.3 åŒå‘é“¾è¡¨å¤´æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243#pragma oncetemplate&lt;class T&gt;class DoubleLinkedList&#123;private: class Node &#123; public: T data; Node* pre; Node* next; Node() &#123;&#125; Node(Node* pre, Node* next) &#123; this-&gt;pre = pre; this-&gt;next = next; &#125; Node(Node* pre, T data, Node* next) &#123; this-&gt;pre = pre; this-&gt;data = data; this-&gt;next = next; &#125; &#125;; Node* head; Node* last; int size; Node* getNode(int pos);public: DoubleLinkedList(); ~DoubleLinkedList(); void clear(); bool isEmpty(); int length(); T get(int pos); void insert(T data); void insert(int pos, T data); T remove(int pos); int indexOf(T data); T getFirst(); T getLast();&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161#include&quot;DoubleLinkedList.h&quot;template&lt;class T&gt;typename DoubleLinkedList&lt;T&gt;::Node* DoubleLinkedList&lt;T&gt;::getNode(int pos)&#123; Node* p; //ä»å‰å¾€åéå† if (pos &lt; int(this-&gt;size / 2)) &#123; p = this-&gt;head-&gt;next; for (int i = 0; i &lt; pos; i++) &#123; p = p-&gt;next; &#125; &#125; //ä»åå¾€å‰éå† else &#123; p = this-&gt;last; for (int i = 0; i &lt; pos; i++) &#123; p = p-&gt;pre; &#125; &#125; return p;&#125;template&lt;class T&gt;DoubleLinkedList&lt;T&gt;::DoubleLinkedList()&#123; this-&gt;head = new Node(nullptr, nullptr); this-&gt;last = this-&gt;head; this-&gt;size = 0;&#125;template&lt;class T&gt;DoubleLinkedList&lt;T&gt;::~DoubleLinkedList()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; this-&gt;clear(); delete this-&gt;head; this-&gt;head = nullptr; this-&gt;last = nullptr;&#125;template&lt;class T&gt;void DoubleLinkedList&lt;T&gt;::clear()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; Node* newNode = p-&gt;next; delete p; p = newNode; &#125; this-&gt;head-&gt;next = nullptr; this-&gt;last = this-&gt;head; this-&gt;size = 0;&#125;template&lt;class T&gt;bool DoubleLinkedList&lt;T&gt;::isEmpty()&#123; return this-&gt;size == 0;&#125;template&lt;class T&gt;int DoubleLinkedList&lt;T&gt;::length()&#123; return this-&gt;size;&#125;template&lt;class T&gt;T DoubleLinkedList&lt;T&gt;::get(int pos)&#123; if (pos &lt; 0 || pos &gt;= this-&gt;size) return T(); Node* p = this-&gt;getNode(pos); return p-&gt;data;&#125;template&lt;class T&gt;void DoubleLinkedList&lt;T&gt;::insert(T data)&#123; Node* newNode = new Node(this-&gt;last, data, nullptr); this-&gt;last-&gt;next = newNode; this-&gt;last = newNode; this-&gt;size++;&#125;template&lt;class T&gt;void DoubleLinkedList&lt;T&gt;::insert(int pos, T data)&#123; Node* p = this-&gt;getNode(pos); Node* newNode = new Node(p, data, p-&gt;next); p-&gt;next-&gt;pre = newNode; p-&gt;next = newNode; this-&gt;size++;&#125;template&lt;class T&gt;T DoubleLinkedList&lt;T&gt;::remove(int pos)&#123; if (pos &lt; 0 || pos &gt;= this-&gt;size) return T(); Node* p = this-&gt;getNode(pos); T res = p-&gt;data; p-&gt;pre-&gt;next = p-&gt;next; p-&gt;next-&gt;pre = p-&gt;pre; delete p; p = nullptr; this-&gt;size--; return res;&#125;template&lt;class T&gt;int DoubleLinkedList&lt;T&gt;::indexOf(T data)&#123; Node* p = this-&gt;head-&gt;next; int pos = 0; while (p != nullptr) &#123; if (p-&gt;data == data) &#123; return pos; &#125; p = p-&gt;next; &#125; return -1;&#125;template&lt;class T&gt;T DoubleLinkedList&lt;T&gt;::getFirst()&#123; if (this-&gt;isEmpty()) return T(); return this-&gt;head-&gt;next-&gt;data;&#125;template&lt;class T&gt;T DoubleLinkedList&lt;T&gt;::getLast()&#123; if (this-&gt;isEmpty()) return T(); return this-&gt;last-&gt;data;&#125; 1.4 æ ˆ(é“¾æ ˆ)å¤´æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132#pragma oncetemplate&lt;class T&gt;class Stack&#123;private: class Node &#123; public: T data; Node* next; Node() &#123;&#125; Node(Node* next) &#123; this-&gt;next = next; &#125; Node(T data, Node* next) &#123; this-&gt;data = data; this-&gt;next = next; &#125; &#125;; Node* head; int size;public: Stack(); ~Stack(); bool isEmpty(); int getSize(); T pop(); void push(T data);&#125;; æºæ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#include &quot;Stack.h&quot;template&lt;class T&gt;Stack&lt;T&gt;::Stack()&#123; this-&gt;head = new Node(nullptr); this-&gt;size = 0;&#125;template&lt;class T&gt;Stack&lt;T&gt;::~Stack()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; Node* newNode = p-&gt;next; delete p; p = newNode; &#125; delete this-&gt;head; this-&gt;head = nullptr;&#125;template&lt;class T&gt;bool Stack&lt;T&gt;::isEmpty()&#123; return this-&gt;size == 0;&#125;template&lt;class T&gt;int Stack&lt;T&gt;::getSize()&#123; return this-&gt;size;&#125;template&lt;class T&gt;T Stack&lt;T&gt;::pop()&#123; if (this-&gt;size == 0) return T(); Node* p = this-&gt;head-&gt;next; T data = p-&gt;data; this-&gt;head-&gt;next = p-&gt;next; this-&gt;size--; return data;&#125;template&lt;class T&gt;void Stack&lt;T&gt;::push(T data)&#123; Node* p = new Node(data, this-&gt;head-&gt;next); this-&gt;head-&gt;next = p; this-&gt;size++;&#125; 1.5 é˜Ÿåˆ—(é“¾é˜Ÿ)å¤´æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132#pragma oncetemplate&lt;class T&gt;class Queue&#123;private: class Node &#123; public: T data; Node* next; Node() &#123;&#125; Node(Node* next) &#123; this-&gt;next = next; &#125; Node(T data, Node* next) &#123; this-&gt;data = data; this-&gt;next = next; &#125; &#125;; Node* head; Node* last; int size;public: Queue(); ~Queue(); bool isEmpty(); T dequeue(); //å‡ºé˜Ÿ void enqueue(T data); //å…¥é˜Ÿ&#125;; æºæ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364#include &quot;Queue.h&quot;template&lt;class T&gt;Queue&lt;T&gt;::Queue()&#123; this-&gt;head = new Node(nullptr); this-&gt;last = this-&gt;head; this-&gt;size = 0;&#125;template&lt;class T&gt;Queue&lt;T&gt;::~Queue()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; Node* newNode = p-&gt;next; delete p; p = newNode; &#125; delete this-&gt;head; this-&gt;head = nullptr; this-&gt;last = nullptr;&#125;template&lt;class T&gt;bool Queue&lt;T&gt;::isEmpty()&#123; return this-&gt;size == 0;&#125;template&lt;class T&gt;T Queue&lt;T&gt;::dequeue()&#123; if (this-&gt;size == 0) return T(); Node* p = this-&gt;head-&gt;next; T data = p-&gt;data; this-&gt;head-&gt;next = p-&gt;next; delete p; this-&gt;size--; if (this-&gt;isEmpty()) &#123; this-&gt;last = this-&gt;head; &#125; return data;&#125;template&lt;class T&gt;void Queue&lt;T&gt;::enqueue(T data)&#123; Node* newNode = new Node(data, nullptr); this-&gt;last-&gt;next = newNode; this-&gt;last = newNode; this-&gt;size++;&#125; 2.ç¬¦å·è¡¨2.1 ç¬¦å·è¡¨(map)å¤´æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334#pragma oncetemplate&lt;class K, class V&gt;class Map&#123;private: class Node &#123; public: K key; V value; Node* next; Node() &#123;&#125; Node(Node* next) &#123; this-&gt;next = next; &#125; Node(K key, V value, Node* next) &#123; this-&gt;key = key; this-&gt;value = value; this-&gt;next = next; &#125; &#125;; Node* head; int size;public: Map(); ~Map(); V get(K key); void put(K key, V value); bool remove(K key); int getSize();&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384#include&quot;Map.h&quot;template&lt;class K, class V&gt;Map&lt;K, V&gt;::Map()&#123; this-&gt;head = new Node(nullptr); this-&gt;size = 0;&#125;template&lt;class K, class V&gt;Map&lt;K, V&gt;::~Map()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; Node* newNode = p-&gt;next; delete p; p = newNode; &#125; delete this-&gt;head; this-&gt;head = nullptr;&#125;template&lt;class K, class V&gt;V Map&lt;K, V&gt;::get(K key)&#123; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; if (p-&gt;key == key) &#123; return p-&gt;value; &#125; p = p-&gt;next; &#125; return V();&#125;template&lt;class K, class V&gt;void Map&lt;K, V&gt;::put(K key, V value)&#123; Node* p = this-&gt;head; while (p-&gt;next != nullptr) &#123; p = p-&gt;next; if (p-&gt;key == key) &#123; p-&gt;value = value; return; &#125; &#125; Node* newNode = new Node(key, value, nullptr); p-&gt;next = newNode; this-&gt;size++;&#125;template&lt;class K, class V&gt;bool Map&lt;K, V&gt;::remove(K key)&#123; Node* p = this-&gt;head; while (p-&gt;next != nullptr) &#123; if (p-&gt;next-&gt;key == key) &#123; Node* e = p-&gt;next; p-&gt;next = e-&gt;next; delete e; this-&gt;size--; return true; &#125; p = p-&gt;next; &#125; return false;&#125;template&lt;class K, class V&gt;int Map&lt;K, V&gt;::getSize()&#123; return this-&gt;size;&#125; 2.2 æœ‰åºç¬¦å·è¡¨å¤´æ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536#pragma once#include&lt;functional&gt;using namespace std;template&lt;class K, class V, class compare = less&lt;K&gt;&gt;class OrderMap&#123;private: class Node &#123; public: K key; V value; Node* next; Node() &#123;&#125; Node(Node* next) &#123; this-&gt;next = next; &#125; Node(K key, V value, Node* next) &#123; this-&gt;key = key; this-&gt;value = value; this-&gt;next = next; &#125; &#125;; Node* head; int size;public: OrderMap(); ~OrderMap(); V get(K key); void put(K key, V value); bool remove(K key); int getSize();&#125;; æºæ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394#include &quot;OrderMap.h&quot;template&lt;class K, class V, class compare&gt;OrderMap&lt;K, V, compare&gt;::OrderMap()&#123; this-&gt;head = new Node(nullptr); this-&gt;size = 0;&#125;template&lt;class K, class V, class compare&gt;OrderMap&lt;K, V, compare&gt;::~OrderMap()&#123; if (this-&gt;head == nullptr) &#123; return; &#125; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; Node* newNode = p-&gt;next; delete p; p = newNode; &#125; delete this-&gt;head; this-&gt;head = nullptr;&#125;template&lt;class K, class V, class compare&gt;V OrderMap&lt;K, V, compare&gt;::get(K key)&#123; Node* p = this-&gt;head-&gt;next; while (p != nullptr) &#123; if (p-&gt;key == key) &#123; return p-&gt;value; &#125; p = p-&gt;next; &#125; return V();&#125;template&lt;class K, class V, class compare&gt;void OrderMap&lt;K, V, compare&gt;::put(K key, V value)&#123; Node* p = this-&gt;head-&gt;next; Node* pre = this-&gt;head; while (p != nullptr &amp;&amp; compare()(p-&gt;key, key)) &#123; p = p-&gt;next; pre = pre-&gt;next; &#125; if (p == nullptr) &#123; Node* newNode = new Node(key, value, nullptr); pre-&gt;next = newNode; this-&gt;size++; return; &#125; if (p-&gt;key == key) &#123; p-&gt;value = value; return; &#125; Node* newNode = new Node(key, value, p); pre-&gt;next = newNode; this-&gt;size++;&#125;template&lt;class K, class V, class compare&gt;bool OrderMap&lt;K, V, compare&gt;::remove(K key)&#123; Node* p = this-&gt;head; while (p-&gt;next != nullptr) &#123; if (p-&gt;next-&gt;key == key) &#123; Node* e = p-&gt;next; p-&gt;next = e-&gt;next; delete e; this-&gt;size--; return true; &#125; p = p-&gt;next; &#125; return false;&#125;template&lt;class K, class V, class compare&gt;int OrderMap&lt;K, V, compare&gt;::getSize()&#123; return this-&gt;size;&#125; 3.æ ‘3.1 äºŒå‰æŸ¥æ‰¾æ ‘å¤´æ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#pragma once#include&lt;vector&gt;#include&lt;queue&gt;using namespace std;template&lt;class K, class V&gt;class BinaryTree&#123;private: class Node &#123; public: K key; V value; Node* left; Node* right; Node() &#123;&#125; Node(K key, V value, Node* left, Node* right) &#123; this-&gt;key = key; this-&gt;value = value; this-&gt;left = left; this-&gt;right = right; &#125; &#125;; Node* root; int size; Node* put(Node* node, K key, V value); V get(Node* node, K key); Node* remove(Node* node, K key); void destroy(Node* node); Node* min(Node* node); Node* max(Node* node); int depth(Node* node); void ergodic(Node* node, vector&lt;K&gt;&amp; keys, int select); void layerErgodic(Node* node, vector&lt;K&gt;&amp; keys);public: BinaryTree(); ~BinaryTree(); void put(K key, V value); V get(K key); void remove(K key); int getSize(); K getMin(); K getMax(); int getDepth(); vector&lt;K&gt; ergodic(int select); //0 å±‚åº å…ˆåº1 ä¸­åº2 ååº3&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234#include &quot;BinaryTree.h&quot;template&lt;class K, class V&gt;typename BinaryTree&lt;K, V&gt;::Node* BinaryTree&lt;K, V&gt;::put(Node* node, K key, V value)&#123; if (node == nullptr) &#123; this-&gt;size++; return new Node(key, value, nullptr, nullptr); &#125; if (node-&gt;key &gt; key) node-&gt;left = this-&gt;put(node-&gt;left, key, value); else if (node-&gt;key &lt; key) node-&gt;right = this-&gt;put(node-&gt;right, key, value); else node-&gt;value = value; return node;&#125;template&lt;class K, class V&gt;V BinaryTree&lt;K, V&gt;::get(Node* node, K key)&#123; if (node == nullptr) return V(); if (node-&gt;key &gt; key) return this-&gt;get(node-&gt;left, key); else if (node-&gt;key &lt; key) return this-&gt;get(node-&gt;right, key); else return node-&gt;value; return V();&#125;template&lt;class K, class V&gt;typename BinaryTree&lt;K, V&gt;::Node* BinaryTree&lt;K, V&gt;::remove(Node* node, K key)&#123; //æœªæ‰¾åˆ°keyå€¼ if (node == nullptr) return nullptr; if (node-&gt;key &gt; key) node-&gt;left = this-&gt;remove(node-&gt;left, key); else if (node-&gt;key &lt; key) node-&gt;right = this-&gt;remove(node-&gt;right, key); // node-&gt;key == keyæƒ…å†µ else &#123; //å·¦å­æ ‘ä¸ºç©ºçš„æƒ…å†µ if (node-&gt;left == nullptr) &#123; Node* temp = node-&gt;right; delete node; node = temp; this-&gt;size--; return node; &#125; //å³å­æ ‘ä¸ºç©ºçš„æƒ…å†µ if (node-&gt;right == nullptr) &#123; Node* temp = node-&gt;left; delete node; node = temp; this-&gt;size--; return node; &#125; //å·¦å³å­—æ ‘éƒ½ä¸ä¸ºç©ºçš„æƒ…å†µ Node* nodeLeft = node-&gt;left; //è¦åˆ é™¤çš„èŠ‚ç‚¹çš„å·¦å­æ ‘ Node* nodeRight = node-&gt;right; //è¦åˆ é™¤çš„èŠ‚ç‚¹çš„å·¦å­æ ‘ //å¾ªç¯ï¼Œæ‰¾åˆ°å³å­æ ‘çš„å·¦èŠ‚ç‚¹çš„åº•èŠ‚ç‚¹eä»¥åŠeçš„çˆ¶èŠ‚ç‚¹p Node* p = node; //åˆå§‹åŒ–çˆ¶èŠ‚ç‚¹ä¸ºnode Node* e = node-&gt;right; //åˆå§‹åŒ–åº•èŠ‚ç‚¹eä¸ºnodeçš„å³èŠ‚ç‚¹ while (e-&gt;left != nullptr) &#123; p = e; e = e-&gt;left; &#125; // å¦‚æœnodeçš„å³èŠ‚ç‚¹å°±æ˜¯åº•èŠ‚ç‚¹eäº† if (p == node) &#123; delete node; //å°†nodeèŠ‚ç‚¹é”€æ¯ node = e; //æ¢æˆeèŠ‚ç‚¹ node-&gt;left = nodeLeft; //eèŠ‚ç‚¹(å°±æ˜¯ç°åœ¨çš„node)çš„å·¦å­æ ‘ä¸ºnodeLeft this-&gt;size--; //size-1 &#125; // è·å–åº•å±‚èŠ‚ç‚¹eï¼Œå°†eçš„çˆ¶èŠ‚ç‚¹på·¦å­æ ‘ç½®ç©º else &#123; p-&gt;left = nullptr; //å°†çˆ¶èŠ‚ç‚¹ç½®ç©º delete node; //å°†nodeèŠ‚ç‚¹é”€æ¯ node = e; //æ¢æˆeèŠ‚ç‚¹ node-&gt;left = nodeLeft; //eèŠ‚ç‚¹(å°±æ˜¯ç°åœ¨çš„node)çš„å·¦å­æ ‘ä¸ºnodeLeft //eèŠ‚ç‚¹éå†å³å­æ ‘åˆ°åº•å±‚èŠ‚ç‚¹temp Node* temp = node; while (temp-&gt;right != nullptr) &#123; temp = temp-&gt;right; &#125; temp-&gt;right = nodeRight; //tempçš„å³å­æ ‘ä¸ºnodeRight this-&gt;size--; //size-1 &#125; &#125; return node;&#125;template&lt;class K, class V&gt;void BinaryTree&lt;K, V&gt;::destroy(Node* node)&#123; if (node == nullptr) return; this-&gt;destroy(node-&gt;left); this-&gt;destroy(node-&gt;right); delete node;&#125;template&lt;class K, class V&gt;typename BinaryTree&lt;K, V&gt;::Node* BinaryTree&lt;K, V&gt;::min(Node* node)&#123; if (node-&gt;left == nullptr) return node; return this-&gt;min(node-&gt;left);&#125;template&lt;class K, class V&gt;typename BinaryTree&lt;K, V&gt;::Node* BinaryTree&lt;K, V&gt;::max(Node* node)&#123; if (node-&gt;right == nullptr) return node; return this-&gt;max(node-&gt;right);&#125;template&lt;class K, class V&gt;int BinaryTree&lt;K, V&gt;::depth(Node* node)&#123; if (node == nullptr) return 0; int left = this-&gt;depth(node-&gt;left) + 1; int right = this-&gt;depth(node-&gt;right) + 1; if (left &gt; right) return left; return right;&#125;template&lt;class K, class V&gt;void BinaryTree&lt;K, V&gt;::ergodic(Node* node, vector&lt;K&gt;&amp; keys, int select)&#123; if (node == nullptr) return; if (select == 1) keys.emplace_back(node-&gt;key); //å…ˆåºçš„é€‰æ‹© this-&gt;ergodic(node-&gt;left, keys, select); if (select == 2) keys.emplace_back(node-&gt;key); //ä¸­åºçš„é€‰æ‹© this-&gt;ergodic(node-&gt;right, keys, select); if (select == 3) keys.emplace_back(node-&gt;key); //ååºçš„é€‰æ‹©&#125;template&lt;class K, class V&gt;void BinaryTree&lt;K, V&gt;::layerErgodic(Node* node, vector&lt;K&gt;&amp; keys)&#123; queue&lt;Node*&gt; q; q.emplace(node); while (!q.empty()) &#123; Node* temp = q.front(); keys.emplace_back(temp-&gt;key); q.pop(); if (temp-&gt;left != nullptr) q.emplace(temp-&gt;left); if (temp-&gt;right != nullptr) q.emplace(temp-&gt;right); &#125;&#125;template&lt;class K, class V&gt;BinaryTree&lt;K, V&gt;::BinaryTree()&#123; this-&gt;root = nullptr; this-&gt;size = 0;&#125;template&lt;class K, class V&gt;BinaryTree&lt;K, V&gt;::~BinaryTree()&#123; this-&gt;destroy(this-&gt;root);&#125;template&lt;class K, class V&gt;void BinaryTree&lt;K, V&gt;::put(K key, V value)&#123; this-&gt;root = this-&gt;put(this-&gt;root, key, value);&#125;template&lt;class K, class V&gt;V BinaryTree&lt;K, V&gt;::get(K key)&#123; return this-&gt;get(this-&gt;root, key);&#125;template&lt;class K, class V&gt;void BinaryTree&lt;K, V&gt;::remove(K key)&#123; this-&gt;root = this-&gt;remove(this-&gt;root, key);&#125;template&lt;class K, class V&gt;int BinaryTree&lt;K, V&gt;::getSize()&#123; return this-&gt;size;&#125;template&lt;class K, class V&gt;K BinaryTree&lt;K, V&gt;::getMin()&#123; return this-&gt;min(this-&gt;root)-&gt;key;&#125;template&lt;class K, class V&gt;K BinaryTree&lt;K, V&gt;::getMax()&#123; return this-&gt;max(this-&gt;root)-&gt;key;&#125;template&lt;class K, class V&gt;int BinaryTree&lt;K, V&gt;::getDepth()&#123; return this-&gt;depth(this-&gt;root);&#125;template&lt;class K, class V&gt;vector&lt;K&gt; BinaryTree&lt;K, V&gt;::ergodic(int select)&#123; vector&lt;K&gt; keys; if (select == 0) this-&gt;layerErgodic(this-&gt;root, keys); //0 å±‚åº this-&gt;ergodic(this-&gt;root, keys, select); return keys;&#125; 3.2 çº¢é»‘æ ‘çº¢é»‘æ ‘å«æœ‰é»‘çº¢é“¾æ¥æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼š çº¢é“¾æ¥å‡ä¸ºå·¦é“¾æ¥ æ²¡æœ‰ä»»ä½•ä¸€ä¸ªç»“ç‚¹åŒæ—¶å’Œä¸¤æ¡çº¢é“¾æ¥ç›¸è¿ è¯¥æ ‘æ˜¯å®Œç¾é»‘è‰²å¹³è¡¡ï¼Œå³ä»»æ„ç©ºé“¾æ¥åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„é»‘é“¾æ¥æ•°é‡ç›¸åŒ å¤´æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546#pragma once#include&lt;functional&gt;using namespace std;//é»˜è®¤ä¸ºless&lt;&gt;ä¸ºå·¦å°å³å¤§ï¼Œå¯ä¿®æ”¹ä¸ºgreater&lt;&gt;å·¦å¤§å³å°template&lt;class K, class V, class compare = less&lt;K&gt;&gt;class RedBlackTree&#123;private: class Node &#123; public: K key; V value; Node* left; Node* right; bool color; Node() &#123;&#125; Node(K key, V value, Node* left, Node* right, bool color) &#123; this-&gt;key = key; this-&gt;value = value; this-&gt;left = left; this-&gt;right = right; this-&gt;color = color; &#125; &#125;; Node* root; int size; static const bool RED = true; static const bool BLACK = false; bool isRed(Node* node); Node* rotateLeft(Node* node); Node* rotateRight(Node* node); void flipColors(Node* node); //é¢œè‰²åè½¬ Node* put(Node* node, K key, V value); V get(Node* node, K key); void destroy(Node* node);public: RedBlackTree(); ~RedBlackTree(); void put(K key, V value); V get(K key); int getSize();&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116#include &quot;RedBlackTree.h&quot;template&lt;class K, class V, class compare&gt;bool RedBlackTree&lt;K, V, compare&gt;::isRed(Node* node)&#123; if (node == nullptr) return false; return node-&gt;color == this-&gt;RED;&#125;template&lt;class K, class V, class compare&gt;typename RedBlackTree&lt;K, V, compare&gt;::Node* RedBlackTree&lt;K, V, compare&gt;::rotateLeft(Node* node)&#123; Node* r = node-&gt;right; //è·å–nodeçš„å³èŠ‚ç‚¹r node-&gt;right = r-&gt;left; //å°†nodeçš„å³èŠ‚ç‚¹æŒ‡å‘ä¹‹å‰çš„å³èŠ‚ç‚¹rçš„å·¦èŠ‚ç‚¹ r-&gt;left = node; //å°†å³èŠ‚ç‚¹rçš„å·¦èŠ‚ç‚¹æŒ‡å‘node r-&gt;color = node-&gt;color; node-&gt;color = this-&gt;RED; return r;&#125;template&lt;class K, class V, class compare&gt;typename RedBlackTree&lt;K, V, compare&gt;::Node* RedBlackTree&lt;K, V, compare&gt;::rotateRight(Node* node)&#123; Node* l = node-&gt;left; node-&gt;left = l-&gt;right; l-&gt;right = node; l-&gt;color = node-&gt;color; node-&gt;color = this-&gt;RED; return l;&#125;template&lt;class K, class V, class compare&gt;void RedBlackTree&lt;K, V, compare&gt;::flipColors(Node* node)&#123; node-&gt;color = this-&gt;RED; node-&gt;left-&gt;color = this-&gt;BLACK; node-&gt;right-&gt;color = this-&gt;BLACK;&#125;template&lt;class K, class V, class compare&gt;typename RedBlackTree&lt;K, V, compare&gt;::Node* RedBlackTree&lt;K, V, compare&gt;::put(Node* node, K key, V value)&#123; if (node == nullptr) &#123; this-&gt;size++; Node* newNode = new Node(key, value, nullptr, nullptr, RED); return newNode; &#125; if (compare()(key, node-&gt;key)) node-&gt;left = this-&gt;put(node-&gt;left, key, value); else if (compare()(node-&gt;key, key)) node-&gt;right = this-&gt;put(node-&gt;right, key, value); else node-&gt;value = value; //å·¦æ—‹ if (isRed(node-&gt;right) &amp;&amp; !isRed(node-&gt;left)) node = this-&gt;rotateLeft(node); //å³æ—‹ if (isRed(node-&gt;left) &amp;&amp; isRed(node-&gt;left-&gt;left)) node = this-&gt;rotateRight(node); //é¢œè‰²åè½¬ if (isRed(node-&gt;left) &amp;&amp; isRed(node-&gt;right)) this-&gt;flipColors(node); return node;&#125;template&lt;class K, class V, class compare&gt;V RedBlackTree&lt;K, V, compare&gt;::get(Node* node, K key)&#123; if (node == nullptr) return V(); if (compare()(key, node-&gt;key)) return this-&gt;get(node-&gt;left, key); else if (compare()(node-&gt;key, key)) return this-&gt;get(node-&gt;right, key); else return node-&gt;value; return V();&#125;template&lt;class K, class V, class compare&gt;void RedBlackTree&lt;K, V, compare&gt;::destroy(Node* node)&#123; if (node == nullptr) return; this-&gt;destroy(node-&gt;left); this-&gt;destroy(node-&gt;right); delete node;&#125;template&lt;class K, class V, class compare&gt;RedBlackTree&lt;K, V, compare&gt;::RedBlackTree()&#123; this-&gt;size = 0; this-&gt;root = nullptr;&#125;template&lt;class K, class V, class compare&gt;RedBlackTree&lt;K, V, compare&gt;::~RedBlackTree()&#123; this-&gt;destroy(this-&gt;root);&#125;template&lt;class K, class V, class compare&gt;void RedBlackTree&lt;K, V, compare&gt;::put(K key, V value)&#123; this-&gt;root = this-&gt;put(this-&gt;root, key, value); this-&gt;root-&gt;color = this-&gt;BLACK;&#125;template&lt;class K, class V, class compare&gt;V RedBlackTree&lt;K, V, compare&gt;::get(K key)&#123; return this-&gt;get(this-&gt;root, key);&#125;template&lt;class K, class V, class compare&gt; int RedBlackTree&lt;K, V, compare&gt;::getSize()&#123; return this-&gt;size;&#125; 3.3 å¹¶æŸ¥é›†å¤´æ–‡ä»¶ï¼š 12345678910111213141516#pragma onceclass UF_Tree_Weighted&#123;private: int* array; int* size; int count;public: UF_Tree_Weighted(int capacity); ~UF_Tree_Weighted(); int getCount(); bool connected(int p, int q); int find(int p); void merge(int p, int q);&#125;; æºæ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#include &quot;UF_Tree_Weighted.h&quot;UF_Tree_Weighted::UF_Tree_Weighted(int capacity)&#123; this-&gt;array = new int[capacity]; this-&gt;size = new int[capacity]; this-&gt;count = capacity; for (int i = 0; i &lt; this-&gt;count; i++) &#123; this-&gt;array[i] = i; this-&gt;size[i] = 1; &#125;&#125;UF_Tree_Weighted::~UF_Tree_Weighted()&#123; if (this-&gt;array != nullptr) &#123; delete[] array; &#125;&#125;int UF_Tree_Weighted::getCount()&#123; return this-&gt;count;&#125;bool UF_Tree_Weighted::connected(int p, int q)&#123; return find(p) == find(q);&#125;int UF_Tree_Weighted::find(int p)&#123; while (true) &#123; if (this-&gt;array[p] == p) return p; p = this-&gt;array[p]; &#125;&#125;void UF_Tree_Weighted::merge(int p, int q)&#123; int pRoot = this-&gt;find(p); int qRoot = this-&gt;find(q); if (pRoot == qRoot) return; //åˆ¤æ–­å“ªä¸ªç»“ç‚¹é•¿ï¼Œå“ªä¸ªå°±å½“æ ¹èŠ‚ç‚¹ if (this-&gt;size[pRoot] &lt; this-&gt;size[qRoot]) &#123; //è®©pçš„æ ¹èŠ‚ç‚¹æŒ‡å‘qçš„æ ¹èŠ‚ç‚¹ this-&gt;array[pRoot] = qRoot; this-&gt;size[qRoot] += this-&gt;size[pRoot]; &#125; else &#123; this-&gt;array[qRoot] = pRoot; this-&gt;size[pRoot] += this-&gt;size[qRoot]; &#125; this-&gt;count--;&#125; 4.å †4.1 å †(å®Œå…¨äºŒå‰æ ‘)å †æ˜¯ç”¨æ•°ç»„å®Œæˆæ•°æ®å…ƒç´ çš„å­˜å‚¨(0ä½ç½®è¢«åºŸæ­¢äº†) å¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„ä½ç½®ä¸ºkï¼Œé‚£ä¹ˆå®ƒçš„çˆ¶èŠ‚ç‚¹çš„ä½ç½®ä¸ºk/2ï¼Œè€Œå®ƒçš„å­èŠ‚ç‚¹çš„ä½ç½®ä¸º2kå’Œ2k+1 å¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹éƒ½è¦å¤§äºå®ƒçš„å­èŠ‚ç‚¹ä¹‹å’Œï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªå­èŠ‚ç‚¹çš„é¡ºåºä½ç½®æ²¡æœ‰è¦æ±‚ å¤´æ–‡ä»¶ï¼š 123456789101112131415161718192021222324#pragma once#include&lt;functional&gt;using namespace std;//é»˜è®¤less&lt;&gt;ä¸ºå°å †é¡¶ï¼Œä½¿ç”¨å¯ä¿®æ”¹ä¸ºgreater&lt;&gt;ä¸ºå¤§å †é¡¶template&lt;class T, class compare = less&lt;T&gt;&gt;class Heap&#123;private: T* arrayList; int size; int capacity; bool less(int i, int j); //åˆ¤æ–­iä½ç½®çš„å…ƒç´ æ˜¯å¦å°äºjä½ç½®çš„å…ƒç´  void exch(int i, int j); //äº¤æ¢iä½ç½®ä¸jä½ç½®çš„å…ƒç´  void swim(int pos); //ä½¿ç”¨ä¸Šæµ®ç®—æ³•ï¼Œä½¿posä½ç½®çš„å…ƒç´ èƒ½å¤„äºæ­£ç¡®ä½ç½® void sink(int pos); //ä½¿ç”¨ä¸‹æµ®ç®—æ³•ï¼Œä½¿posä½ç½®çš„å…ƒç´ èƒ½å¤„äºæ­£ç¡®ä½ç½® void resize(int newCapacity);public: Heap(); Heap(int capacity); ~Heap(); T delMax(); //åˆ é™¤å †ä¸­æœ€å¤§çš„å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´  void insert(T val); //æ’å…¥ä¸€ä¸ªå…ƒç´ &#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113#include &quot;Heap.h&quot;template&lt;class T, class compare&gt;bool Heap&lt;T, compare&gt;::less(int i, int j)&#123; return compare()(this-&gt;arrayList[i], this-&gt;arrayList[j]);&#125;template&lt;class T, class compare&gt;void Heap&lt;T, compare&gt;::exch(int i, int j)&#123; T temp = this-&gt;arrayList[i]; this-&gt;arrayList[i] = this-&gt;arrayList[j]; this-&gt;arrayList[j] = temp;&#125;template&lt;class T, class compare&gt;void Heap&lt;T, compare&gt;::swim(int pos)&#123; while (pos &gt; 1 &amp;&amp; this-&gt;less(pos, int(pos / 2))) &#123; this-&gt;exch(int(pos / 2), pos); pos = int(pos / 2); &#125;&#125;template&lt;class T, class compare&gt;void Heap&lt;T, compare&gt;::sink(int pos)&#123; while (2 * pos &lt;= this-&gt;size) &#123; int min; // å¦‚æœå­˜åœ¨å³èŠ‚ç‚¹ï¼Œåˆ¤æ–­ä¸¤ä¸ªå­èŠ‚ç‚¹å“ªä¸ªæœ€å° if (2 * pos + 1 &lt;= this-&gt;size) &#123; if (this-&gt;less(2 * pos + 1, 2 * pos)) min = 2 * pos + 1; else min = 2 * pos; &#125; // åªæœ‰å·¦èŠ‚ç‚¹ else min = 2 * pos; // çˆ¶èŠ‚ç‚¹poså°äºæœ€å°çš„å­èŠ‚ç‚¹ï¼Œä¸éœ€è¦ç»§ç»­ä¸‹æµ®äº† if (this-&gt;less(pos, min)) break; this-&gt;exch(pos, min); //äº¤æ¢ pos = min; &#125;&#125;template&lt;class T, class compare&gt;void Heap&lt;T, compare&gt;::resize(int newCapacity)&#123; this-&gt;capacity = newCapacity; T* temp = new T[this-&gt;capacity + 1]; for (int i = 1; i &lt;= this-&gt;size; i++) &#123; temp[i] = this-&gt;arrayList[i]; &#125; delete[] this-&gt;arrayList; this-&gt;arrayList = temp;&#125;template&lt;class T, class compare&gt;Heap&lt;T, compare&gt;::Heap()&#123; this-&gt;capacity = 5; this-&gt;arrayList = new T[this-&gt;capacity + 1]; this-&gt;size = 0;&#125;template&lt;class T, class compare&gt;Heap&lt;T, compare&gt;::Heap(int capacity)&#123; this-&gt;capacity = capacity; this-&gt;arrayList = new T[this-&gt;capacity + 1]; this-&gt;size = 0;&#125;template&lt;class T, class compare&gt;Heap&lt;T, compare&gt;::~Heap()&#123; if (this-&gt;arrayList != nullptr) &#123; delete[] this-&gt;arrayList; this-&gt;arrayList = nullptr; &#125;&#125;template&lt;class T, class compare&gt;T Heap&lt;T, compare&gt;::delMax()&#123; if (this-&gt;size == 0) return T(); T val = this-&gt;arrayList[1]; this-&gt;exch(1, this-&gt;size); this-&gt;size--; this-&gt;sink(1); //ä¸‹æ²‰ç®—æ³• return val;&#125;template&lt;class T, class compare&gt;void Heap&lt;T, compare&gt;::insert(T val)&#123; if (this-&gt;size == this-&gt;capacity) &#123; this-&gt;resize(this-&gt;capacity * 2); &#125; //ä¸ç”¨0ä½ç½® this-&gt;arrayList[this-&gt;size + 1] = val; this-&gt;size++; this-&gt;swim(this-&gt;size); //ä¸Šæµ®ç®—æ³•&#125; 5.ä¼˜å…ˆé˜Ÿåˆ—5.1 ä¼˜å…ˆé˜Ÿåˆ—(å †å®ç°)å¤´æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526#pragma once#include&lt;functional&gt;using namespace std;//é»˜è®¤ä¸ºgreater&lt;&gt;æœ€å¤§ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¯ä¿®æ”¹ä¸ºless&lt;&gt;ä¸ºæœ€å°ä¼˜å…ˆé˜Ÿåˆ—template&lt;class T, class compare = greater&lt;T&gt;&gt;class PriorityQueue&#123;private: T* arrayList; int size; int capacity; bool less(int i, int j); //åˆ¤æ–­iä½ç½®çš„å…ƒç´ æ˜¯å¦å°äºjä½ç½®çš„å…ƒç´  void exch(int i, int j); //äº¤æ¢iä½ç½®ä¸jä½ç½®çš„å…ƒç´  void swim(int pos); //ä½¿ç”¨ä¸Šæµ®ç®—æ³•ï¼Œä½¿posä½ç½®çš„å…ƒç´ èƒ½å¤„äºæ­£ç¡®ä½ç½® void sink(int pos); //ä½¿ç”¨ä¸‹æµ®ç®—æ³•ï¼Œä½¿posä½ç½®çš„å…ƒç´ èƒ½å¤„äºæ­£ç¡®ä½ç½® void resize(int newCapacity);public: PriorityQueue(); PriorityQueue(int capacity); ~PriorityQueue(); T delMax(); //åˆ é™¤å †ä¸­æœ€å¤§çš„å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´  void insert(T val); //æ’å…¥ä¸€ä¸ªå…ƒç´  int getSize(); bool isEmpty();&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125#include &quot;PriorityQueue.h&quot;template&lt;class T, class compare&gt;bool PriorityQueue&lt;T, compare&gt;::less(int i, int j)&#123; return compare()(this-&gt;arrayList[i], this-&gt;arrayList[j]);&#125;template&lt;class T, class compare&gt;void PriorityQueue&lt;T, compare&gt;::exch(int i, int j)&#123; T temp = this-&gt;arrayList[i]; this-&gt;arrayList[i] = this-&gt;arrayList[j]; this-&gt;arrayList[j] = temp;&#125;template&lt;class T, class compare&gt;void PriorityQueue&lt;T, compare&gt;::swim(int pos)&#123; while (pos &gt; 1 &amp;&amp; this-&gt;less(pos, int(pos / 2))) &#123; this-&gt;exch(int(pos / 2), pos); pos = int(pos / 2); &#125;&#125;template&lt;class T, class compare&gt;void PriorityQueue&lt;T, compare&gt;::sink(int pos)&#123; while (2 * pos &lt;= this-&gt;size) &#123; int max; // å¦‚æœå­˜åœ¨å³èŠ‚ç‚¹ï¼Œåˆ¤æ–­ä¸¤ä¸ªå­èŠ‚ç‚¹å“ªä¸ªæœ€å¤§ if (2 * pos + 1 &lt;= this-&gt;size) &#123; if (this-&gt;less(2 * pos + 1, 2 * pos)) max = 2 * pos + 1; else max = 2 * pos; &#125; // åªæœ‰å·¦èŠ‚ç‚¹ else max = 2 * pos; // çˆ¶èŠ‚ç‚¹poså¤§äºæœ€å¤§çš„å­èŠ‚ç‚¹ï¼Œä¸éœ€è¦ç»§ç»­ä¸‹æµ®äº† if (this-&gt;less(pos, max)) break; this-&gt;exch(pos, max); //äº¤æ¢ pos = max; &#125;&#125;template&lt;class T, class compare&gt;void PriorityQueue&lt;T, compare&gt;::resize(int newCapacity)&#123; this-&gt;capacity = newCapacity; T* temp = new T[this-&gt;capacity + 1]; for (int i = 1; i &lt;= this-&gt;size; i++) &#123; temp[i] = this-&gt;arrayList[i]; &#125; delete[] this-&gt;arrayList; this-&gt;arrayList = temp;&#125;template&lt;class T, class compare&gt;PriorityQueue&lt;T, compare&gt;::PriorityQueue()&#123; this-&gt;capacity = 5; this-&gt;arrayList = new T[this-&gt;capacity + 1]; this-&gt;size = 0;&#125;template&lt;class T, class compare&gt;PriorityQueue&lt;T, compare&gt;::PriorityQueue(int capacity)&#123; this-&gt;capacity = capacity; this-&gt;arrayList = new T[this-&gt;capacity + 1]; this-&gt;size = 0;&#125;template&lt;class T, class compare&gt;PriorityQueue&lt;T, compare&gt;::~PriorityQueue()&#123; if (this-&gt;arrayList != nullptr) &#123; delete[] this-&gt;arrayList; this-&gt;arrayList = nullptr; &#125;&#125;template&lt;class T, class compare&gt;T PriorityQueue&lt;T, compare&gt;::delMax()&#123; if (this-&gt;size == 0) return T(); T val = this-&gt;arrayList[1]; this-&gt;exch(1, this-&gt;size); this-&gt;size--; this-&gt;sink(1); //ä¸‹æ²‰ç®—æ³• return val;&#125;template&lt;class T, class compare&gt;void PriorityQueue&lt;T, compare&gt;::insert(T val)&#123; if (this-&gt;size == this-&gt;capacity) &#123; this-&gt;resize(this-&gt;capacity * 2); &#125; //ä¸ç”¨0ä½ç½® this-&gt;arrayList[this-&gt;size + 1] = val; this-&gt;size++; this-&gt;swim(this-&gt;size); //ä¸Šæµ®ç®—æ³•&#125;template&lt;class T, class compare&gt;int PriorityQueue&lt;T, compare&gt;::getSize()&#123; return this-&gt;size;&#125;template&lt;class T, class compare&gt;bool PriorityQueue&lt;T, compare&gt;::isEmpty()&#123; return this-&gt;size == 0;&#125; 5.2 ç´¢å¼•ä¼˜å…ˆé˜Ÿåˆ—å¤´æ–‡ä»¶ï¼š 1 æºæ–‡ä»¶ï¼š 1 6.å›¾6.1 æ— å‘å›¾(é‚»æ¥è¡¨)å¤´æ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930#pragma once#include&lt;vector&gt;#include&lt;queue&gt;#include&lt;stack&gt;using namespace std;class Graph&#123;private: int V; int E; vector&lt;int&gt;* adj; int start; int* edgeTo; bool* visited; void dfs(int v, bool* marked, vector&lt;int&gt;&amp; visit); void bfs(int v, bool* marked, vector&lt;int&gt;&amp; visit); void dfsSeek(int s, bool* visited);public: Graph(int v); ~Graph(); int getV(); int getE(); void addEdge(int v, int w); vector&lt;int&gt; get(int v); vector&lt;int&gt; dfs(int v); vector&lt;int&gt; bfs(int v); bool isPath(int start, int end); stack&lt;int&gt; getPath(int start, int end);&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135#include &quot;Graph.h&quot;void Graph::dfs(int v, bool* marked, vector&lt;int&gt;&amp; visit)&#123; marked[v] = false; for (auto&amp; w : this-&gt;adj[v]) &#123; if (marked[w]) &#123; visit.emplace_back(w); this-&gt;dfs(w, marked, visit); &#125; &#125;&#125;void Graph::bfs(int v, bool* marked, vector&lt;int&gt;&amp; visit)&#123; queue&lt;int&gt; q; marked[v] = false; q.emplace(v); while (!q.empty()) &#123; int temp = q.front(); q.pop(); visit.emplace_back(temp); for (auto&amp; w : this-&gt;adj[v]) &#123; if (marked[w]) &#123; marked[w] = false; q.emplace(w); &#125; &#125; &#125;&#125;void Graph::dfsSeek(int s, bool* visited)&#123; visited[s] = false; for (auto&amp; w : this-&gt;adj[s]) &#123; if (visited[w]) &#123; edgeTo[w] = s; this-&gt;dfsSeek(w, visited); &#125; &#125;&#125;Graph::Graph(int v)&#123; this-&gt;V = v; this-&gt;E = 0; this-&gt;start = -1; this-&gt;edgeTo = new int[v]; this-&gt;visited = new bool[v]; this-&gt;adj = new vector&lt;int&gt;[v];&#125;Graph::~Graph()&#123; if (this-&gt;adj != nullptr) delete[] this-&gt;adj; if (this-&gt;edgeTo != nullptr) delete[] this-&gt;edgeTo; if (this-&gt;visited != nullptr) delete[] this-&gt;visited;&#125;int Graph::getV()&#123; return this-&gt;V;&#125;int Graph::getE()&#123; return this-&gt;E;&#125;void Graph::addEdge(int v, int w)&#123; this-&gt;adj[v].emplace_back(w); this-&gt;adj[w].emplace_back(v); this-&gt;E++;&#125;vector&lt;int&gt; Graph::get(int v)&#123; return this-&gt;adj[v];&#125;vector&lt;int&gt; Graph::dfs(int v)&#123; vector&lt;int&gt; visit; bool* marked = new bool[this-&gt;getV()]; this-&gt;dfs(v, marked, visit); delete[] marked; return visit;&#125;vector&lt;int&gt; Graph::bfs(int v)&#123; vector&lt;int&gt; visit; bool* marked = new bool[this-&gt;getV()]; this-&gt;bfs(v, marked, visit); delete[] marked; return visit;&#125;bool Graph::isPath(int start, int end)&#123; if (this-&gt;start != start) &#123; delete[] visited; this-&gt;visited = new bool[this-&gt;getV()]; this-&gt;start = start; this-&gt;dfsSeek(this-&gt;start, visited); &#125; return !visited[end];&#125;stack&lt;int&gt; Graph::getPath(int start, int end)&#123; if(isPath(start, end)) return stack&lt;int&gt;(); stack&lt;int&gt; s; s.emplace(end); int temp = end; while (temp != start) &#123; temp = this-&gt;edgeTo[temp]; s.emplace(temp); &#125; return s;&#125; 6.2 æœ‰å‘å›¾å¤´æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425#pragma once#include&lt;vector&gt;#include&lt;stack&gt;using namespace std;class Digraph&#123;private: int V; int E; vector&lt;int&gt;* adj; void dfsIsCycle(int v, bool* marked, bool* toStack, bool&amp; isCycle); void dfsSort(int v, bool* marked, stack&lt;int&gt;&amp; s); void reversePost(stack&lt;int&gt;&amp; s);public: Digraph(int v); ~Digraph(); int getV(); int getE(); void addEdge(int v, int w); vector&lt;int&gt; get(int v); Digraph reverse(); bool isCycle(); //æ˜¯å¦æœ‰ç¯ stack&lt;int&gt; order(); //æ‹“æ‰‘æ’åº&#125;; æºæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118#include &quot;Digraph.h&quot;void Digraph::dfsIsCycle(int v, bool* marked, bool* toStack, bool&amp; isCycle)&#123; marked[v] = false; //å°†æ­¤ç‚¹æ ‡è®°ä¸ºå·²ç»éå†è¿‡äº† toStack[v] = false; //ç¬¬ä¸€æ¬¡æ ‡è®°æ­¤ç‚¹ for (auto&amp; w : this-&gt;adj[v]) &#123; //å¦‚æœæ²¡éå†è¿‡æ­¤ç‚¹ï¼Œåˆ™éå† if (marked[w]) this-&gt;dfsIsCycle(w, marked, toStack, isCycle); //å¦‚æœéå†è¿‡äº†æ­¤ç‚¹ï¼Œåˆå‡ºç°äº†ï¼Œè¯´æ˜æ­¤ç‚¹å­˜åœ¨ç¯ if (!toStack[w]) &#123; isCycle = true; return; //ç›´æ¥é€€å‡ºï¼Œæ— éœ€ç»§ç»­éå†äº† &#125; &#125; //éå†å®Œæˆï¼Œè¯´æ˜æ­¤ç‚¹ä¸å­˜åœ¨ç¯ï¼Œå°†æ­¤ç‚¹å–æ¶ˆæ ‡è®° //åªæœ‰ä¸å­˜åœ¨ç¯ï¼Œæ‰ä¼šè¿è¡Œåˆ°è¿™é‡Œï¼Œå¹¶ä¸”ç»“æŸé€’å½’æ—¶toStackåˆæ¢å¤åˆ°åŸæ¥çŠ¶æ€äº† toStack[v] = true;&#125;void Digraph::dfsSort(int v, bool* marked, stack&lt;int&gt;&amp; s)&#123; marked[v] = false; for (auto&amp; w : this-&gt;adj[v]) &#123; if (marked[w]) this-&gt;dfsSort(w, marked, s); &#125; s.emplace(v);&#125;void Digraph::reversePost(stack&lt;int&gt;&amp; s)&#123; bool* marked = new bool[this-&gt;getV()]; for (int v = 0; v &lt; this-&gt;getV(); v++) &#123; if (marked[v]) this-&gt;dfsSort(v, marked, s); &#125; delete[] marked;&#125;Digraph::Digraph(int v)&#123; this-&gt;V = v; this-&gt;E = 0; this-&gt;adj = new vector&lt;int&gt;[v];&#125;Digraph::~Digraph()&#123; if (this-&gt;adj != nullptr) &#123; delete[] this-&gt;adj; &#125;&#125;int Digraph::getV()&#123; return this-&gt;V;&#125;int Digraph::getE()&#123; return this-&gt;E;&#125;void Digraph::addEdge(int v, int w)&#123; this-&gt;adj[v].emplace_back(w); this-&gt;E++;&#125;vector&lt;int&gt; Digraph::get(int v)&#123; return this-&gt;adj[v];&#125;Digraph Digraph::reverse()&#123; Digraph newDigraph(this-&gt;getV()); for (int v = 0; v &lt; this-&gt;getV(); v++) &#123; for (auto&amp; w : this-&gt;adj[v]) &#123; newDigraph.addEdge(w, v); &#125; &#125; return newDigraph;&#125;bool Digraph::isCycle()&#123; bool isCycle = false; bool* marked = new bool[this-&gt;getV()]; bool* toStack = new bool[this-&gt;getV()]; for (int v = 0; v &lt; this-&gt;getV(); v++) &#123; if (marked[v]) this-&gt;dfsIsCycle(v, marked, toStack, isCycle); &#125; delete[] marked, toStack; return isCycle;&#125;stack&lt;int&gt; Digraph::order()&#123; if (this-&gt;isCycle()) return stack&lt;int&gt;(); stack&lt;int&gt; s; this-&gt;reversePost(s); return s;&#125; 6.3 åŠ æƒæ— å‘å›¾","categories":[{"name":"è®¡ç®—æœº4ä»¶å¥—","slug":"è®¡ç®—æœº4ä»¶å¥—","permalink":"http://example.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA4%E4%BB%B6%E5%A5%97/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"c++","slug":"c","permalink":"http://example.com/tags/c/"}]},{"title":"æ“ä½œç³»ç»Ÿçš„å­¦ä¹ ç¬”è®°","slug":"è®¡ç®—æœº4ä»¶å¥—/æ“ä½œç³»ç»Ÿ","date":"2022-08-06T11:11:16.398Z","updated":"2022-09-27T14:16:30.089Z","comments":true,"path":"2022/08/06/è®¡ç®—æœº4ä»¶å¥—/æ“ä½œç³»ç»Ÿ/","link":"","permalink":"http://example.com/2022/08/06/%E8%AE%A1%E7%AE%97%E6%9C%BA4%E4%BB%B6%E5%A5%97/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","excerpt":"","text":"ä¸€ã€æ“ä½œç³»ç»Ÿæ¦‚è¿°1.1 ç‰¹å¾æ“ä½œç³»ç»Ÿçš„ç‰¹å¾ï¼š å¹¶å‘ï¼šæŒ‡ä¸¤ä¸ªå¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´é—´éš”å†…å‘ç”Ÿ è¿™äº›äº‹ä»¶å®è§‚ä¸Šæ˜¯åŒæ—¶å‘ç”Ÿçš„ï¼Œä½†å¾®è§‚ä¸Šæ˜¯äº¤æ›¿å‘ç”Ÿçš„ å¹¶è¡Œï¼šæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»åŒæ—¶å‘ç”Ÿ æ“ä½œç³»ç»Ÿçš„å¹¶å‘æ€§æŒ‡è®¡ç®—æœºç³»ç»Ÿä¸­åŒæ—¶å­˜åœ¨ç€å¤šä¸ªè¿è¡Œç€çš„ç¨‹åºã€‚ å•æ ¸CPUåŒä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€ä¸ªç¨‹åºï¼Œå› æ­¤æ“ä½œç³»ç»Ÿä¼šè´Ÿè´£åè°ƒå¤šä¸ªç¨‹åºäº¤æ›¿æ‰§è¡Œï¼Œä½†åœ¨å®è§‚ä¸Šçœ‹å¤šä¸ªç¨‹åºåœ¨åŒæ—¶æ‰§è¡Œ æ“ä½œç³»ç»Ÿæ˜¯ä¼´éšç€â€å¤šé“ç¨‹åºæŠ€æœ¯â€è€Œå‡ºç°çš„ï¼Œå› æ­¤ï¼Œæ“ä½œç³»ç»Ÿå’Œç¨‹åºå¹¶å‘æ˜¯ä¸€èµ·è¯ç”Ÿçš„ å¦‚ä»Šä¸€èˆ¬éƒ½æ˜¯å¤šæ ¸CPUï¼Œæ¯”å¦‚ä¸€ä¸ª4æ ¸çš„CPUï¼ŒåŒä¸€æ—¶åˆ»å¯ä»¥æœ‰4ä¸ªç¨‹åºå¹¶è¡Œæ‰§è¡Œï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿçš„å¹¶å‘æ€§ä¾ç„¶å¿…ä¸å¯å°‘ï¼Œå› ä¸ºä¸å¯èƒ½åªè¿è¡Œ4ä¸ªç¨‹åº å…±äº«ï¼šå³èµ„æºå…±äº«ï¼Œæ˜¯æŒ‡ç³»ç»Ÿä¸­çš„èµ„æºå¯ä¾›å†…å­˜ä¸­å¤šä¸ªå¹¶å‘ç¨‹åºæ‰§è¡Œçš„è¿›ç¨‹å…±åŒä½¿ç”¨ èµ„æºå…±äº«çš„æ–¹å¼ï¼š äº’æ–¥å…±äº«æ–¹å¼ï¼šç³»ç»Ÿä¸­çš„æŸäº›èµ„æºï¼Œè™½ç„¶å¯ä»¥æä¾›ç»™å¤šä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œä½†æ˜¯ä¸€æ®µæ—¶é—´å†…åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®è¯¥èµ„æº ç¤ºä¾‹ï¼šä½¿ç”¨QQå’Œå¾®ä¿¡è§†é¢‘ï¼ŒåŒä¸€æ—¶é—´å†…æ‘„åƒå¤´åªèƒ½åˆ†é…ç»™å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹ åŒæ—¶å…±äº«æ–¹å¼ï¼šç³»ç»Ÿä¸­çš„æŸäº›èµ„æºï¼Œå…è®¸ä¸€ä¸ªæ—¶é—´æ®µç”±å¤šä¸ªè¿›ç¨‹â€åŒæ—¶â€å¯¹å®ƒä»¬è¿›è¡Œè®¿é—® å…¶ä¸­æ‰€è°“â€åŒæ—¶â€ï¼Œæ˜¯åœ¨å®è§‚ä¸Šï¼Œè€Œå¾®è§‚ä¸Šï¼Œè¿™äº›è¿›ç¨‹å¯èƒ½æ˜¯äº¤æ›¿åœ°å¯¹è¯¥èµ„æºè¿›è¡Œè®¿é—® ç¤ºä¾‹ï¼šä½¿ç”¨QQå‘é€æ–‡ä»¶Aï¼ŒåŒæ—¶ä½¿ç”¨å¾®ä¿¡å‘é€æ–‡ä»¶Bã€‚ä»å®è§‚ä¸Šï¼Œä¸¤è¾¹éƒ½åœ¨åŒæ—¶è¯»å–å¹¶å‘é€æ–‡ä»¶ï¼Œä»å¾®è§‚ä¸Šï¼Œä¸¤ä¸ªè¿›ç¨‹åœ¨äº¤æ›¿ç€è®¿é—®ç¡¬ç›˜ è™šæ‹Ÿï¼šæ˜¯æŒ‡æŠŠä¸€ä¸ªç‰©ç†ä¸Šçš„å®ä½“å˜ä¸ºè‹¥å¹²é€»è¾‘ä¸Šçš„å¯¹åº”ç‰©ã€‚ç‰©ç†å®ä½“å®é™…å­˜åœ¨çš„ï¼Œè€Œé€»è¾‘ä¸Šå¯¹åº”ç‰©æ˜¯ç”¨æˆ·æ„Ÿå—åˆ°çš„ ä¸€ä¸ªç¨‹åºéœ€è¦æ”¾å…¥å†…å­˜å¹¶åˆ†é…ç»™CPUæ‰èƒ½æ‰§è¡Œ ä¸€ä¸ªç”µè„‘å†…å­˜4GBï¼ŒGTA5è¿è¡Œéœ€è¦4GBï¼ŒQQè¿è¡Œéœ€è¦256MBï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥æ­¤ç”µè„‘ä¸Šè¿è¡Œã€‚ è¿™æ˜¯å› ä¸ºä½¿ç”¨äº†è™šæ‹Ÿå­˜å‚¨å™¨æŠ€æœ¯ï¼Œè™šæ‹ŸæŠ€æœ¯ä¸­çš„â€œç©ºåˆ†å¤ç”¨æŠ€æœ¯â€ åœ¨å•æ ¸CPUçš„è®¡ç®—æœºä¸­ï¼Œæ‰“å¼€å¤šä¸ªçš„è½¯ä»¶ï¼Œä¾æ—§èƒ½è¿è¡Œï¼Œå®é™…ä¸Šåªæœ‰ä¸€ä¸ªå•æ ¸CPUï¼Œä½†æ˜¯ç”¨æˆ·è®¤ä¸ºæœ‰å¤šä¸ªCPUåœ¨ä¸ºè‡ªå·±æœåŠ¡ã€‚ è¿™æ˜¯è¿ç”¨äº†è™šæ‹Ÿå¤„ç†å™¨æŠ€æœ¯ä¸­çš„â€œæ—¶åˆ†å¤ç”¨æŠ€æœ¯â€ï¼Œå¾®è§‚ä¸Šå¤„ç†æœºåœ¨å„ä¸ªå¾®å°çš„æ—¶é—´æ®µå†…äº¤æ›¿ç€ä¸ºå„ä¸ªè¿›ç¨‹æœåŠ¡ è™šæ‹ŸæŠ€æœ¯ï¼š ç©ºåˆ†å¤ç”¨æŠ€æœ¯ æ—¶åˆ†å¤ç”¨æŠ€æœ¯ å¦‚æœå¤±å»å¹¶å‘æ€§ä¸€æ®µæ—¶é—´åªèƒ½è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œåˆ™å¤±å»äº†è™šæ‹Ÿæ€§çš„æ„ä¹‰(æ²¡æœ‰å¹¶å‘å°±è°ˆä¸ä¸Šè™šæ‹Ÿæ€§) å¼‚æ­¥ï¼šåœ¨å¤šé“ç¨‹åºç¯å¢ƒä¸‹ï¼Œå…è®¸å¤šä¸ªç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œä½†ç”±äºèµ„æºæœ‰é™ï¼Œè¿›ç¨‹çš„æ‰§è¡Œä¸æ˜¯ä¸€è´¯åˆ°åº•çš„ã€‚è€Œæ˜¯èµ°èµ°åœåœçš„ï¼Œå·²ä¸å¯é¢„çŸ¥çš„é€Ÿåº¦å‘å‰æ¨è¿›ï¼Œè¿™å°±æ˜¯è¿›ç¨‹çš„å¼‚æ­¥ã€‚ åªæœ‰ç³»ç»Ÿæ‹¥æœ‰å¹¶å‘æ€§ï¼Œæ‰æœ‰å¯èƒ½å¯¼è‡´å¼‚æ­¥æ€§ å¹¶å‘ä¸å…±äº«çš„å…³ç³»ï¼š å¦‚æœå¤±å»å¹¶å‘æ€§ï¼Œåˆ™å…±äº«æ€§å¤±å»å­˜åœ¨æ„ä¹‰(ä¸éœ€è¦ä¸¤ä¸ªè¿›ç¨‹äº¤æ›¿ç€è®¿é—®ç¡¬ç›˜äº†) å¦‚æœå¤±å»å…±äº«æ€§ï¼Œåˆ™æ— æ³•å¹¶å‘(QQä¸å¾®ä¿¡æ— æ³•åŒæ—¶è¯»å–ç¡¬ç›˜èµ„æº) å¹¶å‘æ€§ä¸å…±çº¿æ€§äº’ä¸ºå­˜åœ¨æ¡ä»¶ æ²¡æœ‰å¹¶å‘å’Œå…±äº«ï¼Œå°±æ²¡æœ‰è™šæ‹Ÿå’Œå¼‚æ­¥ï¼Œå› æ­¤å¹¶å‘å’Œå…±äº«æ˜¯æ“ä½œç³»ç»Ÿçš„ä¸¤ä¸ªæœ€åŸºæœ¬çš„ç‰¹å¾ 1.2 å‘å±•ä¸åˆ†ç±»å‘å±•ï¼š æ‰‹å·¥æ“ä½œé˜¶æ®µ ä¸»è¦ç¼ºç‚¹ï¼šç”¨æˆ·ç‹¬å å…¨æœºï¼Œäººæœºé€Ÿåº¦çŸ›ç›¾å¯¼è‡´èµ„æºåˆ©ç”¨ç‡æä½ æ‰¹å¤„ç†é˜¶æ®µ å•é“æ‰¹å¤„ç†ç³»ç»Ÿ å¼•å…¥è„±æœºè¾“å…¥&#x2F;è¾“å‡ºæŠ€æœ¯(ç”¨ç£å¸¦å®Œæˆ)ï¼Œå¹¶ç›‘ç£ç¨‹åº(æ“ä½œç³»ç»Ÿçš„é›å½¢)è´Ÿè´£æ§åˆ¶ä½œä¸šçš„è¾“å…¥ã€è¾“å‡º ä¸»è¦ä¼˜ç‚¹ï¼šç¼“è§£äº†ä¸€å®šç¨‹åº¦çš„äººæœºé€Ÿåº¦çŸ›ç›¾ï¼Œèµ„æºåˆ©ç”¨ç‡æœ‰æ‰€æå‡ã€‚ ä¸»è¦ç¼ºç‚¹ï¼šå†…å­˜ä¸­ä»…èƒ½æœ‰ä¸€é“ç¨‹åºè¿è¡Œï¼Œåªæœ‰è¯¥ç¨‹åºè¿è¡Œç»“æŸåæ‰ä¼šè¿›å…¥ä¸‹ä¸€é“ç¨‹åºã€‚CPUæœ‰å¤§é‡çš„æ—¶é—´æ˜¯åœ¨ç©ºé—²ç­‰å¾…IOå®Œæˆï¼Œèµ„æºåˆ©ç”¨ç‡ä¾ç„¶å¾ˆä½ å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿ ä¸»è¦ä¼˜ç‚¹ï¼šå¤šé“ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œå…±äº«è®¡ç®—åŠ èµ„æºã€‚èµ„æºåˆ©ç”¨ç‡å¤§å¹…æå‡ï¼ŒCPUå’Œå…¶ä»–èµ„æºä¿æŒâ€å¿™ç¢Œâ€çŠ¶æ€ï¼Œç³»ç»Ÿååé‡å¢å¤§ ä¸»è¦ç¼ºç‚¹ï¼šç”¨æˆ·å“åº”æ—¶é—´é•¿ï¼Œæ²¡æœ‰äººæœºäº¤äº’åŠŸèƒ½(ç”¨æˆ·æäº¤ä½œä¸šååªèƒ½ç­‰å¾…è®¡ç®—æœºå¤„ç†å®Œæˆï¼Œä¸­é—´ä¸èƒ½æ§åˆ¶è‡ªå·±çš„ä½œä¸šæ‰§è¡Œ) åˆ†æ—¶æ“ä½œç³»ç»Ÿï¼šè®¡ç®—æœºä»¥æ—¶é—´ç‰‡ä¸ºå•ä½è½®æµä¸ºå„ä¸ªç”¨æˆ·&#x2F;ä½œä¸šæœåŠ¡ï¼Œå„ä¸ªç”¨æˆ·å¯é€šè¿‡ç»ˆç«¯ä¸è®¡ç®—æœºè¿›è¡Œäº¤äº’ ä¸»è¦ä¼˜ç‚¹ï¼šç”¨æˆ·è¯·æ±‚å¯ä»¥è¢«å³æ—¶å“åº”ï¼Œè§£å†³äº†äººæœºäº¤äº’é—®é¢˜ï¼Œå…è®¸å¤šä¸ªç”¨æˆ·åŒæ—¶ä½¿ç”¨ä¸€å°è®¡ç®—æœºï¼Œå¹¶ä¸”ç”¨æˆ·å¯¹è®¡ç®—æœºçš„æ“ä½œç›¸äº’ç‹¬ç«‹ï¼Œæ„Ÿå—ä¸åˆ°åˆ«äººçš„å­˜åœ¨ ä¸»è¦ç¼ºç‚¹ï¼šä¸èƒ½ä¼˜å…ˆå¤„ç†ä¸€äº›ç´§æ€¥ä»»åŠ¡ï¼Œæ“ä½œç³»ç»Ÿå¯¹å„ä¸ªç”¨æˆ·&#x2F;ä½œä¸šå®Œå…¨å…¬å¹³ï¼Œä¸åŒºåˆ†ä»»åŠ¡çš„ç´§æ€¥æ€§ å®æ—¶æ“ä½œç³»ç»Ÿ ä¸»è¦ä¼˜ç‚¹ï¼šèƒ½å¤Ÿä¼˜å…ˆå“åº”ä¸€äº›ç´§æ€¥ä»»åŠ¡ ï¼ŒæŸäº›ç´§æ€¥ä»»åŠ¡ä¸éœ€è¦æ—¶é—´ç‰‡æ’é˜Ÿ åœ¨å®æ—¶æ“ä½œç³»ç»Ÿçš„æ§åˆ¶ä¸‹ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°ä¿¡å·ååŠæ—¶å¤„ç†ï¼Œå¹¶ä¸”åœ¨ä¸¥æ ¼çš„æ—¶é—´å†…é™æ—¶å®Œæˆä»»åŠ¡ï¼Œå®æ—¶æ“ä½œç³»ç»Ÿçš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šåŠæ—¶æ€§å’Œå¯é æ€§ ç¡¬å®æ—¶ç³»ç»Ÿï¼šå¿…é¡»åœ¨ç»å¯¹ä¸¥æ ¼çš„è§„å®šæ—¶é—´å†…å®Œæˆå¤„ç† è½¯å®æ—¶ç³»ç»Ÿï¼šèƒ½æ¥å—å¶å°”è¿åæ—¶é—´è§„å®š å…¶ä»–å‡ ç§æ“ä½œç³»ç»Ÿï¼š ç½‘ç»œæ“ä½œç³»ç»Ÿï¼šèƒ½å¤ŸæŠŠç½‘ç»œä¸­å„ä¸ªè®¡ç®—æœºæœ‰æœºçš„ç»“åˆèµ·æ¥ï¼Œå®ç°æ•°æ®ä¼ é€ç­‰åŠŸèƒ½ï¼Œå®ç°ç½‘ç»œä¸­çš„å„ç§èµ„æºçš„å…±äº«å’Œå„ä¸ªè®¡ç®—æœºä¹‹é—´çš„é€šä¿¡ åˆ†å¸ƒå¼æ“ä½œç³»ç»Ÿï¼šä¸»è¦ç‰¹ç‚¹æ˜¯åˆ†å¸ƒå¼ä¸å¹¶è¡Œæ€§ï¼Œä»»ä½•å·¥ä½œéƒ½å¯ä»¥åˆ†å¸ƒåœ¨è¿™äº›è®¡ç®—æœºä¸Šï¼Œç”±å®ƒä»¬å¹¶è¡Œã€ååŒå®Œæˆè¿™ä¸ªä»»åŠ¡ ä¸ªäººè®¡ç®—æœºæ“ä½œç³»ç»Ÿï¼šå¦‚Windowsã€MacOSç­‰ 1.3 è¿è¡Œæœºåˆ¶ä¸ä½“ç³»ç»“æ„è¿è¡Œæœºåˆ¶ï¼š æŒ‡ä»¤ï¼šå¤„ç†å™¨èƒ½å¤Ÿè¯†åˆ«ã€æ‰§è¡Œçš„æœ€åŸºæœ¬å‘½ä»¤ ç‰¹æƒæŒ‡ä»¤ï¼šå¦‚å†…å­˜æ¸…é›¶æŒ‡ä»¤(ä¸å…è®¸ç”¨æˆ·ç¨‹åºä½¿ç”¨) éç‰¹æƒæŒ‡ä»¤ï¼šå¦‚æ™®é€šçš„è¿ç®—æŒ‡ä»¤ åˆ¤æ–­æ˜¯å¦å¯ä»¥æ‰§è¡Œç‰¹æƒæŒ‡ä»¤å¯ä»¥é€šè¿‡ä¸¤ç§å¤„ç†å™¨çŠ¶æ€ï¼š ç”¨æˆ·æ€(ç›®æ€)ï¼šæ­¤æ—¶CPUåªèƒ½æ‰§è¡Œéç‰¹æƒæŒ‡ä»¤ æ ¸å¿ƒæ€(ç®¡æ€)ï¼šç‰¹æƒå’Œéç‰¹æƒéƒ½å¯ä»¥æ‰§è¡Œ ç”¨ç¨‹åºçŠ¶æ€å¯„å­˜å™¨(PSW)æ¥æ ‡è¯†å½“å‰å¤„ç†å™¨å¤„äºä»€ä¹ˆçŠ¶æ€ã€‚å¦‚0ä¸ºç”¨æˆ·æ€ï¼Œ1ä¸ºæ ¸å¿ƒæ€ ä¸¤ç§ç¨‹åºï¼š å†…æ ¸ç¨‹åºï¼šæ“ä½œç³»ç»Ÿçš„å†…æ ¸ç¨‹åºæ˜¯ç³»ç»Ÿå‘ç®¡ç†è€…ï¼Œè¿è¡Œåœ¨æ ¸å¿ƒæ€ åº”ç”¨ç¨‹åºï¼šä¸ºäº†ä¿è¯ç³»ç»Ÿçš„å®‰å…¨è¿è¡Œï¼Œæ™®é€šåº”ç”¨ç¨‹åºåªèƒ½è¿è¡Œåœ¨ç”¨æˆ·æ€ æ“ä½œç³»ç»Ÿå†…æ ¸åˆç»†åˆ†ä¸ºï¼šéå†…æ ¸åŠŸèƒ½å’Œå†…æ ¸ å†…æ ¸ï¼šè®¡ç®—æœºä¸Šé…ç½®çš„åº•å±‚è½¯ä»¶ï¼Œæ˜¯æ“ä½œç³»ç»Ÿæœ€åŸºæœ¬ã€æœ€æ ¸å¿ƒçš„éƒ¨åˆ† å¯¹ç³»ç»Ÿèµ„æºè¿›è¡Œç®¡ç†åŠŸèƒ½(æœ‰çš„æ“ä½œç³»ç»Ÿä¸ä¼šæŠŠè¿™éƒ¨åˆ†åŠŸèƒ½å½“ä½œå†…æ ¸åŠŸèƒ½)ï¼š è¿›ç¨‹ç®¡ç†ã€å­˜å‚¨å™¨ç®¡ç†ã€è®¾å¤‡ç®¡ç†ç­‰åŠŸèƒ½ æ—¶é’Ÿç®¡ç†ï¼šå®ç°è®¡æ—¶åŠŸèƒ½ ä¸­æ–­å¤„ç†ï¼šè´Ÿè´£å®ç°ä¸­æ–­æœºåˆ¶ åŸè¯­(è®¾å¤‡é©±åŠ¨ã€CPUåˆ‡æ¢ç­‰) ä¸€ç§ç‰¹æ®Šçš„ç¨‹åºã€‚ æ˜¯æœ€æ¥è¿‘ç¡¬ä»¶çš„éƒ¨åˆ†ï¼Œ è¿™ç§ç¨‹åºçš„è¿è¡Œå…·æœ‰åŸå­æ€§(è¦ä¹ˆä¸æ‰§è¡Œï¼Œè¦ä¹ˆä¸€ç›´æ‰§è¡Œåˆ°ç»“æŸ) æ“ä½œç³»ç»Ÿçš„ä½“ç³»ç»“æ„ï¼šå¤§å†…æ ¸å’Œå¾®å†…æ ¸ å¤§å†…æ ¸ï¼šå°†æ“ä½œç³»ç»Ÿçš„ä¸»è¦åŠŸèƒ½æ¨¡å—éƒ½ä½œä¸ºç³»ç»Ÿå†…æ ¸ï¼Œè¿è¡Œåœ¨æ ¸å¿ƒæ€ ä¼˜ç‚¹ï¼šé«˜æ€§èƒ½ ç¼ºç‚¹ï¼šå†…æ ¸ä»£ç åºå¤§ã€ç»“æ„æ··ä¹±ã€éš¾ä»¥ç»´æŠ¤ å¾®å†…æ ¸ï¼šåªæŠŠæœ€åŸºæœ¬çš„åŠŸèƒ½ä¿ç•™åœ¨å†…æ ¸ ä¼˜ç‚¹ï¼šå†…æ ¸åŠŸèƒ½å°‘ã€ç»“æ„æ¸…æ™°ã€æ–¹ä¾¿ç»´æŠ¤ ç¼ºç‚¹ï¼šéœ€è¦é¢‘ç¹åœ°åœ¨æ ¸å¿ƒæ€å’Œç”¨æˆ·æ€ä¹‹é—´åˆ‡æ¢ã€æ€§èƒ½ä½ 1.4 ä¸­æ–­ä¸å¼‚å¸¸ä¸­æ–­ï¼š å½“ä¸­æ–­å‘ç”Ÿæ—¶ï¼ŒCPUç«‹å³è¿›å…¥æ ¸å¿ƒæ€ å½“ä¸­æ–­å‘ç”Ÿåï¼Œå½“å‰è¿è¡Œçš„è¿›ç¨‹æš‚åœè¿è¡Œï¼Œå¹¶ç”±æ“ä½œç³»ç»Ÿå†…æ ¸å¯¹ä¸­æ–­è¿›è¡Œå¤„ç† å¯¹äºä¸åŒçš„ä¸­æ–­ä¿¡å·ï¼Œä¼šè¿›è¡Œä¸åŒçš„å¤„ç† å‘ç”Ÿäº†ä¸­æ–­ï¼Œå°±æ„å‘³ç€éœ€è¦æ“ä½œç³»ç»Ÿä»‹å…¥ï¼Œå¼€å±•ç®¡ç†å·¥ä½œã€‚ç”±äºæ“ä½œç³»ç»Ÿçš„ç®¡ç†å·¥ä½œ(æ¯”å¦‚è¿›ç¨‹åˆ‡æ¢ã€åˆ†é…IOè®¾å¤‡ç­‰)éœ€è¦ä½¿ç”¨ç‰¹æƒæŒ‡ä»¤ï¼Œå› æ­¤CPUè¦ä»ç”¨æˆ·æ€è½¬æ¢ä¸ºæ ¸å¿ƒæ€ã€‚ ä¸­æ–­å¯ä»¥ä½¿CPUä»ç”¨æˆ·æ€åˆ‡æ¢ä¸ºæ ¸å¿ƒæ€ï¼Œä½¿ç”¨æ“ä½œç³»ç»Ÿè·å¾—è®¡ç®—æœºçš„æ§åˆ¶æƒã€‚æœ‰äº†ä¸­æ–­ï¼Œæ‰èƒ½å®ç°å¤šé“ç¨‹åºå¹¶å‘æ‰§è¡Œ ç”¨æˆ·æ€ä¸æ ¸å¿ƒæ€çš„è½¬æ¢ï¼š ç”¨æˆ·æ€-&gt;æ ¸å¿ƒæ€ï¼šé€šè¿‡ä¸­æ–­å®ç°çš„ï¼Œå¹¶ä¸”åªèƒ½æ˜¯ä¸­æ–­ æ ¸å¿ƒæ€-&gt;ç”¨æˆ·æ€ï¼šé€šè¿‡æ‰§è¡Œä¸€ä¸ªç‰¹æƒæŒ‡ä»¤ï¼Œå°†ç¨‹åºçŠ¶æ€æ ‡å¿—è®¾ç½®ä¸ºç”¨æˆ·æ€ ä¸­æ–­çš„åˆ†ç±»ï¼š å†…ä¸­æ–­ï¼š å¤–ä¸­æ–­ï¼š äºŒã€è¿›ç¨‹ä¸çº¿ç¨‹OSä¸­è¿›ç¨‹ä½œä¸ºèµ„æºåˆ†é…ä¸ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½å‡ºç°ã€‚OSçš„å››å¤§ç‰¹å¾(å¹¶å‘ã€å…±äº«ã€è™šæ‹Ÿã€å¼‚æ­¥)éƒ½æ˜¯åŸºäºè¿›ç¨‹è€Œå½¢æˆçš„ã€‚æ‰€ä»¥åœ¨OSä¸­ï¼Œè¿›ç¨‹æ˜¯ä¸€ä¸ªåŠå…¶é‡è¦çš„æ¦‚å¿µ åˆ°äº†80å¹´ä»£ä¸­æœŸï¼Œåˆå‡ºç°äº†æ¯”è¿›ç¨‹æ›´å°çš„åŸºæœ¬å•ä½â€”â€”çº¿ç¨‹ã€‚ç”¨æ¥æé«˜ç¨‹åºå¹¶å‘æ‰§è¡Œç¨‹åº¦ï¼Œä»¥è¿›ä¸€æ­¥æ”¹å–„ç³»ç»Ÿçš„æœåŠ¡è´¨é‡ã€‚ç°ä»£OSæ— ä¸€ä¾‹å¤–çš„å¼•å…¥äº†çº¿ç¨‹ï¼Œçº¿ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µ 2.1 è¿›ç¨‹çš„æè¿°è¿›ç¨‹æ§åˆ¶å—PCB ä¸ºäº†æ–¹ä¾¿æ§åˆ¶å’Œç®¡ç†å‚ä¸å¹¶å‘æ‰§è¡Œçš„æ¯ä¸ªç¨‹åºçš„ç‹¬ç«‹è¿è¡Œï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­ä¸ºä¹‹é…ç½®ä¸€ç§ä¸“é—¨çš„æ•°æ®ç»“æ„ï¼Œç§°ä¸ºè¿›ç¨‹æ§åˆ¶å—ï¼šPCB(Process Control Block)ã€‚ ç³»ç»Ÿåˆ©ç”¨PCBæ¥æè¿°è¿›ç¨‹çš„åŸºæœ¬ä¿¡æ¯ä¸æ´»åŠ¨è¿‡ç¨‹ï¼Œè¿›è€Œæ§åˆ¶å’Œç®¡ç†ç¨‹ã€‚ PCBã€ç¨‹åºæ®µã€æ•°æ®æ®µä¸‰éƒ¨åˆ†æ„æˆäº†è¿›ç¨‹å®ä½“(è¿›ç¨‹æ˜ åƒ)ï¼Œä¹Ÿå«è¿›ç¨‹ PCBåœ¨è¿›ç¨‹åˆ‡æ¢çš„ä½œç”¨æ“ä½œç³»ç»Ÿå°±æ˜¯æ ¹æ®PCBæ¥æ„ŸçŸ¥è¿›ç¨‹çš„å­˜åœ¨çš„ã€‚ PCBåœ¨è¿›ç¨‹åˆ‡æ¢è¿‡ç¨‹ä¸­èµ·ç€éå¸¸é‡è¦çš„ä½œç”¨ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥é€šè¿‡å¯¹PCBçš„ä¿®æ”¹æ¥è¾¾åˆ°å¯¹è¿›ç¨‹çš„æ§åˆ¶ã€‚ ä»¥ä¸‹æ˜¯PCBç»“æ„ä½“çš„éƒ¨åˆ†æè¿°å±æ€§ï¼š 123456789101112131415struct task_struct &#123;long state; // è¿›ç¨‹è¿è¡ŒçŠ¶æ€ï¼š-1ä¸å¯è¿è¡Œï¼Œ0å¯è¿è¡Œï¼Œ&gt;0å·²åœæ­¢long priority; // è¿›ç¨‹è¿è¡Œä¼˜å…ˆçº§long counter; // å·²è¿è¡Œæ—¶é—´è®¡æ•°å™¨long exit_code; // è¿›ç¨‹åœæ­¢æ‰§è¡Œåé€€å‡ºç ï¼Œå…¶çˆ¶è¿›ç¨‹éœ€è¦è¯»å–unsigned long start_code; // ä»£ç æ®µèµ·å§‹åœ°å€unsigned long end_code; // ä»£ç æ®µé•¿åº¦ï¼Œå•ä½å­—èŠ‚unsigned long next_code; // ä¸‹ä¸€æ¡è¦æ‰§è¡Œä»£ç çš„åœ°å€unsigned long start_data; // æ•°æ®æ®µèµ·å§‹åœ°å€unsigned long end_data; // ä»£ç æ®µé•¿åº¦+æ•°æ®æ®µé•¿åº¦ï¼Œå•ä½å­—èŠ‚unsigned long next_data; // ä¸‹ä¸€æ¡è¦è¯»å–æ•°æ®çš„åœ°å€long pid; // è¿›ç¨‹æ ‡è¯†long father; // çˆ¶è¿›ç¨‹æ ‡è¯†...&#125;ï¼› è¿›ç¨‹å®šä¹‰ ä»ä¸åŒçš„è§’åº¦ï¼Œè¿›ç¨‹å¯ä»¥æœ‰ä¸åŒçš„å®šä¹‰ï¼Œæ¯”è¾ƒä¼ ç»Ÿå…¸å‹çš„å®šä¹‰æœ‰ï¼š è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œçš„è¿‡ç¨‹ è¿›ç¨‹æ˜¯ä¸€ä¸ªç¨‹åºä»¥åŠæ•°æ®åœ¨å¤„ç†é¡ºåºæ‰§è¡Œæ—¶æ‰€å‘ç”Ÿçš„æ´»åŠ¨ è¿›ç¨‹æ˜¯å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºåœ¨æ•°æ®é›†åˆä¸Šçš„è¿è¡Œçš„è¿‡ç¨‹ï¼Œå®ƒæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ è¿™3ä¸ªå®šä¹‰éƒ½å¼ºè°ƒäº†**â€åŠ¨æ€æ€§â€** å¼•å…¥è¿›ç¨‹å®ä½“çš„æ¦‚å¿µåï¼Œå¯ä»¥æŠŠè¿›ç¨‹å®šä¹‰ä¸ºï¼š è¿›ç¨‹æ˜¯è¿›ç¨‹å®ä½“çš„è¿è¡Œç¨‹åºï¼Œæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ æ³¨æ„ï¼šä¸¥æ ¼æ¥è¯´ï¼Œè¿›ç¨‹å®ä½“å’Œè¿›ç¨‹å¹¶ä¸ä¸€æ ·ï¼Œè¿›ç¨‹å®ä½“æ˜¯é™æ€çš„ï¼Œè¿›ç¨‹åˆ™æ˜¯åŠ¨æ€çš„ã€‚ä¸è¿‡ï¼Œé™¤éé¢˜ç›®åˆ»æ„è€ƒå¯ŸäºŒè€…åŒºåˆ«ï¼Œå¦åˆ™æ˜¯å¯ä»¥è®¤ä¸ºè¿›ç¨‹å°±æ˜¯è¿›ç¨‹å®ä½“ å¼•å…¥è¿›ç¨‹åä½¿å¾—ä½œä¸šçš„å¹¶å‘æ‰§è¡Œå¾—ä»¥å®ç°ï¼Œ åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼š å¢åŠ äº†ç©ºé—´å¼€é”€ éœ€è¦ä¸ºè¿›ç¨‹åˆ›å»ºPCB å¢åŠ äº†æ—¶é—´å¼€é”€ ç®¡ç†ã€åè°ƒã€è·Ÿè¸ªè¿›ç¨‹çš„æ‰§è¡Œéœ€è¦æ—¶é—´ åˆ›å»ºã€æ›´æ–°ã€å›æ”¶PCBéœ€è¦æ—¶é—´ è¿›ç¨‹åˆ‡æ¢ã€ä¿æŠ¤ã€æ¢å¤CPUç°åœºéœ€è¦æ—¶é—´ å¢åŠ äº†æ§åˆ¶éš¾åº¦ åè°ƒå¤šä¸ªè¿›ç¨‹å¯¹èµ„æºçš„ç«äº‰ä¸å…±äº«å¢åŠ äº†æ§åˆ¶éš¾åº¦ å¯¹å¯èƒ½ç”±è¿›ç¨‹å¼•å‘çš„å¼‚å¸¸è¿›è¡Œå¤„ç†å¢åŠ äº†æ§åˆ¶éš¾åº¦ 2.2 è¿›ç¨‹çŠ¶æ€äº”ç§çŠ¶æ€æ ¹æ®è¿›ç¨‹æ‰€æ‹¥æœ‰èµ„æºçš„ä¸åŒï¼Œå¯ä»¥å°†è¿›ç¨‹æ‰€å¤„çš„çŠ¶æ€åˆ’åˆ†ä¸ºäº”ç§çŠ¶æ€ï¼š å°±ç»ªçŠ¶æ€ï¼šè¿›ç¨‹å·²ç»è·å–åˆ°äº†é™¤å¤„ç†å™¨ä¹‹å¤–æ‰§è¡Œæ‰€éœ€çš„æ‰€æœ‰èµ„æºçš„çŠ¶æ€ã€‚ æ‰§è¡ŒçŠ¶æ€ï¼šè¿›ç¨‹å·²ç»è·å–åˆ°äº†åŒ…æ‹¬å¤„ç†å™¨åœ¨å†…çš„æ‰§è¡Œæ‰€éœ€çš„æ‰€æœ‰èµ„æºçš„çŠ¶æ€ã€‚ é˜»å¡çŠ¶æ€ï¼šè¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å› ç­‰å¾…æŸäº‹ä»¶çš„å‘ç”Ÿè€Œæ— æ³•ç»§ç»­æ‰§è¡Œçš„çŠ¶æ€ã€‚ åˆ›å»ºçŠ¶æ€ï¼šè¿›ç¨‹ç¼ºå°‘å®Œæ•´PCBä¸è¿è¡Œæ‰€éœ€èµ„æºçš„çŠ¶æ€ã€‚ ç»ˆæ­¢çŠ¶æ€ï¼šè¿›ç¨‹é‡Šæ”¾æ‰€æ‹¥æœ‰èµ„æºçš„è¿‡ç¨‹çš„çŠ¶æ€ã€‚ å…¶ä¸­ï¼Œå°±ç»ªçŠ¶æ€ã€æ‰§è¡ŒçŠ¶æ€ã€é˜»å¡çŠ¶æ€ï¼Œç§°ä¸ºè¿›ç¨‹çš„åŸºæœ¬çŠ¶æ€ çŠ¶æ€è½¬æ¢flowchart LR A(åˆ›å»ºçŠ¶æ€) B(å°±ç»ªçŠ¶æ€) C(æ‰§è¡ŒçŠ¶æ€) D(é˜»å¡çŠ¶æ€) E(ç»ˆæ­¢çŠ¶æ€) A--èµ„æºåˆ†é…-->B--è·å¾—CPU-->C--è¯·æ±‚I/O-->D D--I/Oå®Œæˆ-->B C--é‡Šæ”¾CPU-->B C--é‡Šæ”¾PCB-->E çŠ¶æ€è½¬æ¢çš„ç‰¹ç‚¹ï¼š åˆ›å»ºå¥½çš„è¿›ç¨‹ç›´æ¥åˆ°è¾¾çš„æ˜¯å°±ç»ªæ€ å°±ç»ªæ€è¿›ç¨‹æ— æ³•ç›´æ¥è½¬æ¢ä¸ºé˜»å¡æ€ é˜»å¡æ€åªèƒ½æ˜¯è¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ç”±äºç­‰å¾…æŸäº‹ä»¶çš„å‘ç”Ÿè€Œå¼•å‘çš„ è¿›ç¨‹åªèƒ½æ˜¯åœ¨æ‰§è¡Œæ—¶ç»ˆæ­¢ æŒ‚èµ·ä¸æ¿€æ´»PCBçš„ç»„ç»‡æ–¹å¼ä¸åŒåº”ç”¨å¯ä»¥äº§ç”Ÿå¾ˆå¤šå¼‚ç±»è¿›ç¨‹ï¼Œä¸€ä¸ªåº”ç”¨å¯ä»¥äº§ç”Ÿå¾ˆå¤šåŒç±»è¿›ç¨‹ã€‚æ— è®ºæ˜¯ä½•ç±»è¿›ç¨‹ï¼Œå…¶ä¼šæŒ‰ç…§å®ƒä»¬çš„ çŠ¶æ€å°†å®ƒä»¬ç»„ç»‡åˆ°ä¸€èµ·ã€‚ å¸¸è§çš„ç»„ç»‡æ–¹å¼æœ‰ä¸¤ç§ï¼š é“¾è¡¨æ–¹å¼ï¼šåŒä¸€çŠ¶æ€çš„è¿›ç¨‹çš„PCBç»„æˆä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€ä»¥å¤šç§çŠ¶æ€çš„è¿›ç¨‹PCBç»„æˆå¤šä¸ªé“¾è¡¨ã€‚æ­¤æ—¶å°±ä¼šäº§ç”Ÿè¯¸å¦‚å°±ç»ªé“¾è¡¨ã€é˜»å¡é“¾è¡¨ç­‰ä¸åŒé“¾è¡¨ã€‚ ç´¢å¼•è¡¨æ–¹å¼ï¼šæ‰€æœ‰PCBéƒ½æ”¾å…¥åŒä¸€é“¾è¡¨ï¼Œå†ä¸ºæ¯ç§çŠ¶æ€åˆ›å»ºå‡ºä¸åŒçš„PCBç´¢å¼•é“¾è¡¨ï¼Œå…¶ä¸­å­˜æ”¾çš„å°±æ˜¯è¯¥çŠ¶æ€çš„æ‰€æœ‰PCBçš„ç´¢å¼• ç²—ä¿—çš„ç†è§£å°±æ˜¯ï¼Œæ— è®ºå°±ç»ªé˜Ÿåˆ—ï¼Œè¿˜æ˜¯é˜»å¡é˜Ÿåˆ—ä¸­çš„å…ƒç´ å°±æ˜¯PCB 2.3 è¿›ç¨‹æ§åˆ¶è¿›ç¨‹æ§åˆ¶æ˜¯è¿›ç¨‹ç®¡ç†ä¸­æœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚å¦‚ï¼Œè¿›ç¨‹çš„åˆ›å»ºä¸ç»ˆæ­¢ã€è¿›ç¨‹çŠ¶æ€è½¬æ¢ç­‰ã€‚è¿›ç¨‹æ§åˆ¶ä¸€èˆ¬æ˜¯ç”± OSå†…æ ¸ä¸­çš„åŸè¯­å®ç°çš„ã€‚ è¿›ç¨‹æ§åˆ¶å°±æ˜¯å®ç°è¿›ç¨‹çŠ¶æ€çš„è½¬æ¢ã€‚ è¿›ç¨‹çš„åˆ›å»ºæ— è®ºæ˜¯OSå†…æ ¸åˆ›å»ºè¿›ç¨‹ï¼Œè¿˜æ˜¯ç”¨æˆ·è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹ï¼Œéƒ½æ˜¯è°ƒç”¨äº†è¿›ç¨‹åˆ›å»ºåŸè¯­å®Œæˆçš„ã€‚ è¿›ç¨‹åˆ›å»ºè¿‡ç¨‹ è¿›ç¨‹åˆ›å»ºåŸè¯­çš„åˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹ï¼š ç”Ÿæˆè¿›ç¨‹æ ‡è¯†ç¬¦PID è¿™æ˜¯ä¸€ä¸ªæ•°å­—æ ‡è¯†ç¬¦ï¼Œç”¨äºåŒºåˆ†ç³»ç»Ÿä¸­çš„æ‰€æœ‰è¿›ç¨‹ï¼Œåœ¨ç³»ç»Ÿä¸­å…·æœ‰å”¯ä¸€ æ€§ã€‚ ç”³è¯·ç©ºç™½PCBã€‚ ä¸ºè¿›ç¨‹åˆ†é…å…¶è¿è¡Œæ‰€éœ€çš„ä¸€åˆ‡èµ„æºï¼ˆé™¤CPUå¤–ï¼‰ è¿™äº›èµ„æºè¦ä¹ˆä»OSç›´æ¥è·å¾—ï¼Œè¦ä¹ˆä»çˆ¶è¿›ç¨‹è· å¾—ã€‚ åˆå§‹åŒ–PCBã€‚ è¿™äº›åˆå§‹åŒ–ä¿¡æ¯åŒ…æ‹¬è‡ªå·±çš„PIDåŠçˆ¶è¿›ç¨‹çš„PIDï¼Œå½“å‰å¤„ç†å™¨çš„çŠ¶æ€æ•°æ®ï¼Œè¿›ç¨‹çš„çŠ¶æ€æ•°æ®ã€‚ å°†è¿›ç¨‹å†™å…¥å°±ç»ªé˜Ÿåˆ— (åˆ›å»ºæ€-&gt;å°±ç»ªæ€) è¿›ç¨‹åˆ›å»ºäº‹ä»¶ ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç”±ç³»ç»Ÿå†…æ ¸åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ç”±å¦ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºã€‚å‘ç”Ÿè¿›ç¨‹åˆ›å»ºçš„å…¸å‹äº‹ä»¶æœ‰ä¸‰ç±»ï¼š ç”¨æˆ·ç™»å½•ï¼šåœ¨åˆ†æ—¶ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ç™»å½•åï¼Œç³»ç»Ÿå†…æ ¸ä¼šä¸ºè¯¥ç”¨æˆ·åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ã€‚ ä½œä¸šè°ƒåº¦ï¼šåœ¨å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿä¸­ï¼Œå½“ä½œä¸šè°ƒåº¦ç¨‹åºè°ƒåº¦åˆ°æŸä½œä¸šåï¼Œä¼šå°†å…¶è£…å…¥å†…å­˜ï¼Œå¹¶ç”±ç³»ç»Ÿ å†…æ ¸ä¸ºè¯¥ä½œä¸šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ã€‚ æä¾›æœåŠ¡ï¼šå½“æŸè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æå‡ºæŸç§è¯·æ±‚åï¼Œç³»ç»Ÿå†…æ ¸æˆ–ä¸»è¿›ç¨‹å°†ä¼šåˆ›å»ºä¸€ä¸ªç›¸åº”çš„å­è¿›ç¨‹æ¥å¤„ç†è¯¥è¯·æ±‚ï¼Œä»¥ä½¿ä¸»è¿›ç¨‹ä¸å­è¿›ç¨‹å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚ ä¾‹å¦‚ï¼Œç”¨æˆ·è¿›ç¨‹æäº¤äº†ä¸€ä¸ªæ–‡ä»¶æ‰“å°è¯·æ±‚åï¼Œç³»ç»Ÿå†…æ ¸ä¼šåˆ›å»ºä¸€ä¸ªæ‰“å°è¿›ç¨‹æ¥å¤„ç†è¯¥è¯·æ±‚ã€‚ åº”ç”¨è¯·æ±‚ï¼šç”±ç”¨æˆ·ä¸»åŠ¨è¯·æ±‚åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ è¿›ç¨‹çš„ç»ˆæ­¢è¿›ç¨‹ç»ˆæ­¢è¿‡ç¨‹ ç³»ç»Ÿä¸­å‘ç”Ÿè¿›ç¨‹ç»ˆæ­¢äº‹ä»¶ï¼ŒOSå°±ä¼šè°ƒç”¨è¿›ç¨‹ç»ˆæ­¢åŸè¯­å»ç»ˆæ­¢è¿›ç¨‹ã€‚ è¿›ç¨‹ç»ˆæ­¢åŸè¯­çš„ç»ˆæ­¢è¿‡ç¨‹å¦‚ä¸‹ï¼š æ ¹æ®è¢«ç»ˆæ­¢è¿›ç¨‹çš„PIDï¼Œæ‰¾å‡ºå…¶PCBã€‚ ä»PCBä¸­è¯»å–å…¶çŠ¶æ€ï¼Œè‹¥è¯¥è¿›ç¨‹å¤„äºæ‰§è¡Œæ€ï¼Œåˆ™ç«‹å³ç»ˆæ­¢å…¶æ‰§è¡Œï¼Œå¹¶ç½®è°ƒåº¦æ ‡å¿—ä¸ºçœŸï¼Œç”¨äºæ ‡å¿—è¯¥è¿›ç¨‹å¯è¢«é‡æ–°è°ƒåº¦ã€‚ ä»PCBä¸­è¯»å–å…¶å­è¿›ç¨‹PIDï¼Œè‹¥è¯¥è¿›ç¨‹è¿˜æœ‰å­è¿›ç¨‹ï¼Œåˆ™è¦å°†å…¶æ‰€æœ‰å­è¿›ç¨‹å…¨éƒ¨ç»ˆæ­¢ã€‚ ä»PCBä¸­è¯»å–å…¶æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æºï¼Œå¹¶å…¨éƒ¨é‡Šæ”¾ï¼Œå½’è¿˜ç»™å…¶çˆ¶è¿›ç¨‹æˆ–ç³»ç»Ÿã€‚ è¿™ä¸ªèµ„æºé‡Šæ”¾çš„è¿‡ç¨‹ä¸»è¦åŒ…å«ä¸¤æ­¥ï¼š å°†å…¶PCBèµ‹å€¼ä¸ºnull åœ¨å…¶çˆ¶è¿›ç¨‹æˆ–ç³»ç»Ÿçš„èµ„æºæ•°é‡ä¸Šå¢åŠ ç›¸åº”é‡Šæ”¾çš„æ•°é‡ã€‚ å°†è¯¥è¿›ç¨‹çš„PCBä»PCBé˜Ÿåˆ—æˆ–é“¾è¡¨ä¸­ç§»å‡ºã€‚ é‡Šæ”¾è¯¥PCBç©ºé—´ã€‚ è¿›ç¨‹ç»ˆæ­¢äº‹ä»¶ å¼•èµ·è¿›ç¨‹ç»ˆæ­¢çš„äº‹ä»¶å…¸å‹çš„æœ‰ä¸‰ç±»ï¼š æ­£å¸¸ç»“æŸï¼šè¿›ç¨‹çš„ä»»åŠ¡æ­£å¸¸æ‰§è¡Œå®Œæ¯•åçš„è¿›ç¨‹ç»ˆæ­¢ã€‚å½“è¿›ç¨‹çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œè¿›ç¨‹ä¼šå‘å‡ºä¸€æ¡ç»ˆæ­¢æŒ‡ä»¤ï¼Œæ­¤æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªä¸­æ–­ï¼Œä»¥é€šçŸ¥OSè¿›ç¨‹é©¬ä¸Šç»ˆæ­¢ã€‚ å¼‚å¸¸ç»“æŸï¼šè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿäº†æŸç§å¼‚å¸¸äº‹ä»¶ï¼Œå¯¼è‡´è¿›ç¨‹æ— æ³•ç»§ç»­è¿è¡Œã€‚ å¸¸è§çš„å¼‚å¸¸äº‹ä»¶æœ‰ï¼š è®¿é—®è¶Šç•Œ éæ³•æŒ‡ä»¤ æƒé™å¼‚å¸¸ è¿è¡Œè¶…æ—¶ ç­‰å¾…è¶…æ—¶ è¿ç®—å¼‚å¸¸ IOå¼‚å¸¸ å¤–ç•Œå¹²é¢„ï¼šè¿›ç¨‹è¢«å¤–ç•Œå¹²é¢„ç»ˆæ­¢ã€‚ å¤–ç•Œå¹²é¢„ä¸»è¦æŒ‡ä¸‰æ–¹é¢ï¼š ç”¨æˆ·ç›´æ¥ç»ˆæ­¢ OSç»ˆæ­¢ çˆ¶è¿›ç¨‹ç»ˆæ­¢ è¿›ç¨‹çš„å µå¡ä¸å”¤é†’è¿›ç¨‹é˜»å¡ é˜»å¡æ˜¯è¿›ç¨‹è‡ªèº«çš„ä¸€ç§ä¸»åŠ¨è¡Œä¸ºã€‚å½“ç³»ç»Ÿä¸­å‘ç”Ÿè¿›ç¨‹é˜»å¡äº‹ä»¶åï¼Œè¿›ç¨‹è‡ªå·±ä¼šè°ƒç”¨è¿›ç¨‹é˜»å¡åŸè¯­å°†è‡ª å·±é˜»å¡ã€‚ è¿›ç¨‹é˜»å¡åŸè¯­çš„é˜»å¡è¿‡ç¨‹å¦‚ä¸‹ï¼š ç«‹å³æš‚åœCPUçš„æ‰§è¡Œï¼Œä¿ç•™å½“å‰CPUçš„ç°åœºã€‚ å°†PCBä¸­çš„çŠ¶æ€ç”±æ‰§è¡Œæ€ä¿®æ”¹ä¸ºé˜»å¡æ€ã€‚ å°†PCBå†™å…¥åˆ°ç›¸åº”é˜»å¡åŸå› çš„é˜»å¡é˜Ÿåˆ—ã€‚ å¯åŠ¨è°ƒåº¦ç¨‹åºè¿›è¡Œé‡æ–°è°ƒåº¦ï¼Œå³å°†CPUåˆ†é…ç»™å¦ä¸€å°±ç»ªè¿›ç¨‹ã€‚ æŒ‰ç…§æ–°è¿›ç¨‹çš„PCBè®¾ç½®CPUæ–°çš„ç¯å¢ƒã€‚ å¼•å‘è¿›ç¨‹é˜»å¡çš„äº‹ä»¶ è¿›ç¨‹å‘ç”Ÿé˜»å¡æ˜¯ç”±äº**æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹çªç„¶å‘ç”Ÿæ‰§è¡Œæ¡ä»¶ç¼ºå¤±äº‹ä»¶(éœ€è¦ç­‰å¾…ç³»ç»Ÿåˆ†é…èµ„æºå’Œç­‰å¾…ç›¸äº’åˆä½œçš„è¿›ç¨‹çš„å®Œæˆå·¥ä½œ)**ï¼Œè¿›è€Œæš‚åœæ‰§è¡Œç­‰å¾…æ¡ä»¶çš„æ»¡è¶³ è¿›ç¨‹å”¤é†’ è¿›ç¨‹å”¤é†’è¿‡ç¨‹ å½“è¢«é˜»å¡è¿›ç¨‹æ‰€æœŸå¾…çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œç”±â€œç›¸å…³è¿›ç¨‹ï¼ˆä¿ƒä½¿æ‰§è¡Œæ¡ä»¶æ»¡è¶³çš„è¿›ç¨‹ï¼‰â€è°ƒç”¨å”¤é†’åŸè¯­ï¼Œå°†é˜»å¡è¿›ç¨‹å”¤é†’ï¼ˆå”¤é†’æ˜¯è¿›ç¨‹çš„è¢«åŠ¨è¡Œä¸ºï¼‰ã€‚ è¿›ç¨‹å”¤é†’åŸè¯­çš„å”¤é†’è¿‡ç¨‹å¦‚ä¸‹ï¼š å°†è¯¥è¿›ç¨‹çš„PCBä»é˜»å¡é˜Ÿåˆ—ç§»å‡ºã€‚ ä¿®æ”¹PCBä¸­çš„çŠ¶æ€ç”±é˜»å¡å˜ä¸ºå°±ç»ªã€‚ å°†PCBæ’å…¥åˆ°å°±ç»ªé˜Ÿåˆ— é˜»å¡è¿›ç¨‹è¢«å”¤é†’åˆ™æ˜¯ç”±äºå‘ç”Ÿäº†æŸäº›äº‹ä»¶ï¼Œä»è€Œå…·å¤‡äº†æ‰§è¡Œæ¡ä»¶ï¼Œåˆ°è¾¾äº†æ‰§è¡Œæ—¶æœºã€‚ 2.4 è¿›ç¨‹é€šä¿¡å…±äº«å­˜å‚¨ä¸ºäº†ä¿è¯å®‰å…¨ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸èƒ½ç›´æ¥è®¿é—®å¦ä¸€ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ åœ¨é€šä¿¡çš„è¿›ç¨‹ä¹‹é—´å­˜åœ¨ä¸€å—å¯ç›´æ¥è®¿é—®çš„å…±äº«ç©ºé—´ï¼Œé€šè¿‡å¯¹è¿™ç‰‡å…±äº«ç©ºé—´è¿›è¡Œå†™&#x2F;è¯»æ“ä½œå®ç°è¿›ç¨‹ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚ ä¸¤ä¸ªè¿›ç¨‹å¯¹å…±äº«ç©ºé—´çš„è®¿é—®å¿…é¡»æ˜¯äº’æ–¥çš„(äº’æ–¥è®¿é—®é€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„å·¥å…·å®ç°)ã€‚ äº’æ–¥è®¿é—®å°±æ˜¯åœ¨åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹å¯¹åŒä¸€èµ„æºè¿›è¡Œè®¿é—® æ“ä½œç³»ç»Ÿåªè´Ÿè´£æä¾›å…±äº«ç©ºé—´å’ŒåŒæ­¥äº’æ–¥å·¥å…·(å¦‚Pã€Væ“ä½œ)ã€‚ å…±äº«æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼š ä½çº§æ–¹å¼çš„å…±äº«æ˜¯åŸºäºæ•°æ®ç»“æ„çš„å…±äº« åŸºäºæ•°æ®ç»“æ„çš„å…±äº«ï¼šæ¯”å¦‚å…±äº«ç©ºé—´é‡Œåªèƒ½å‘æ”¾ä¸€ä¸ªé•¿åº¦ä¸º10çš„æ•°ç»„ï¼Œè¿™ç§å…±äº«æ–¹å¼é€Ÿåº¦æ…¢ï¼Œé™åˆ¶å¤šï¼Œæ˜¯ä¸€ç§ä½çº§é€šä¿¡æ–¹å¼ã€‚ é«˜çº§æ–¹å¼çš„å…±äº«åˆ™æ˜¯åŸºäºå­˜å‚¨åŒºçš„å…±äº« åŸºäºå­˜å‚¨åŒºçš„å…±äº«ï¼šåœ¨å†…å­˜ä¸­ç”»å‡ºä¸€å—å…±äº«å­˜å‚¨åŒºï¼Œæ•°æ®çš„å½¢å¼ã€å­˜æ”¾çš„ä½ç½®éƒ½ç”±è¿›ç¨‹å†³å®šï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¿™ç§å…±äº«æ–¹å¼é€Ÿåº¦æ›´å¿«ï¼Œæ˜¯ä¸€ç§é«˜çº§é€šä¿¡æ–¹å¼ã€‚ ç®¡é“é€šä¿¡ â€œç®¡é“â€æ˜¯æŒ‡ç”¨äºè¿æ¥è¯»å†™è¿›ç¨‹çš„ä¸€ä¸ªå…±äº«æ–‡ä»¶ï¼Œåˆåpipeæ–‡ä»¶ï¼Œå…¶å®å°±æ˜¯åœ¨å†…å­˜ä¸­å¼€è¾Ÿçš„ä¸€ä¸ªå¤§å°å›ºå®šçš„ç¼“å†²åŒºã€‚ ç®¡é“é€šä¿¡åªèƒ½é‡‡ç”¨åŠåŒå·¥é€šä¿¡ï¼ŒæŸä¸€ä¸ªæ—¶æ®µå†…åªèƒ½å®ç°å•å‘çš„ä¼ è¾“ï¼Œå¦‚æœè¦å®ç°åŒå‘åŒæ—¶é€šä¿¡ï¼Œåˆ™éœ€è¦è®¾ç½®ä¸¤ä¸ªç®¡é“ã€‚ å„ä¸ªè¿›ç¨‹è¦äº’æ–¥çš„è®¿é—®ç®¡é“ã€‚write æ•°æ®ä»¥å­—ç¬¦æµçš„å½¢å¼å†™å…¥ç®¡é“ï¼Œå½“ç®¡é“å†™æ»¡æ—¶ï¼Œå†™è¿›ç¨‹çš„write()ç³»ç»Ÿè°ƒç”¨å°†è¢«é˜»å¡ï¼Œç­‰å¾…è¯»è¿›ç¨‹å°†æ•°æ®å–èµ°ã€‚å½“è¯»è¿›ç¨‹å°†æ•°æ®å…¨éƒ¨å–èµ°åï¼Œç®¡é“å˜ç©ºï¼Œæ­¤æ—¶è¯»è¿›ç¨‹çš„read()ç³»ç»Ÿè°ƒç”¨å°†è¢«é˜»å¡ã€‚ æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰å†™æ»¡ï¼Œæ˜¯ä¸å…è®¸è¯»çš„ï¼Œå¦‚æœæ²¡æœ‰è¯»ç©ºï¼Œæ˜¯ä¸å…è®¸å†™çš„ã€‚ æ•°æ®ä¸€æ—¦è¢«è¯»å‡ºï¼Œå°±ä¼šä»ç®¡é“ä¸­è¢«æŠ›å¼ƒï¼Œè¿™å°±æ„å‘³ç€è¯»è¿›ç¨‹æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰è¯»é”™æ•°æ®çš„æƒ…å†µã€‚ æ¶ˆæ¯ä¼ é€’è¿›ç¨‹é—´çš„æ•°æ®äº¤æ¢ä»¥æ ¼å¼åŒ–çš„æ¶ˆæ¯(Message)ä¸ºå•ä½ã€‚ è¿›ç¨‹é€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„â€å‘é€æ¶ˆæ¯&#x2F;æ¥æ”¶æ¶ˆæ¯â€ä¸¤ä¸ªåŸè¯­è¿›è¡Œæ•°æ®äº¤æ¢ æ ¼å¼åŒ–çš„æ¶ˆæ¯åˆ†ä¸ºï¼šæ¶ˆæ¯å¤´å’Œæ¶ˆæ¯ä½“ æ¶ˆæ¯å¤´ï¼šåŒ…æ‹¬å‘é€çš„è¿›ç¨‹IDã€æ¥å—è¿›ç¨‹IDã€æ¶ˆæ¯ç±»å‹ã€æ¶ˆæ¯é•¿åº¦ç­‰æ ¼å¼åŒ–ä¿¡æ¯ ç›´æ¥é€šä¿¡æ–¹å¼ï¼šAè¿›ç¨‹å‘é€æ¶ˆæ¯(åŸè¯­)ç›´æ¥æŒ‚åˆ°æ¥æ”¶è¿›ç¨‹Bçš„æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—ä¸Š é—´æ¥é€šä¿¡æ–¹å¼ï¼šå‘é€æ¶ˆæ¯(åŸè¯­)è¦å…ˆå‘é€åˆ°**ä¸­é—´å®ä½“(ä¿¡ç®±)**ä¸­ï¼Œå› æ­¤ä¹Ÿç§°â€ä¿¡ç®±é€šä¿¡æ–¹å¼â€ã€‚å¦‚ï¼šè®¡ç½‘ä¸­çš„ç”µå­é‚®ç®±ç³»ç»Ÿ 2.5 çº¿ç¨‹çš„æè¿°ä¸ºä»€ä¹ˆè¦å¼•å…¥çº¿ç¨‹ è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œä¹Ÿæ˜¯è°ƒåº¦çš„åŸºæœ¬å•ä½ å¼•å…¥çº¿ç¨‹ä¹‹åï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ ç”±äºåˆ‡æ¢è¿›ç¨‹æ—¶ï¼Œéœ€è¦ä¿å­˜&#x2F;æ¢å¤è¿›ç¨‹è¿è¡Œç¯å¢ƒï¼Œè¿˜éœ€è¦åˆ‡æ¢å†…å­˜åœ°å€ç©ºé—´(æ›´æ–°å¿«è¡¨ã€æ›´æ–°ç¼“å†²) å¼•å…¥çº¿ç¨‹åï¼ŒåŒä¸€ä¸ªè¿›ç¨‹å†…å„ä¸ªçº¿ç¨‹é—´å¹¶å‘ï¼Œä¸éœ€è¦åˆ‡æ¢è¿›ç¨‹è¿è¡Œç¯å¢ƒå’Œå†…å­˜åœ°å€ç©ºé—´ï¼Œçœæ—¶çœåŠ›ã€‚ æ³¨æ„ï¼šä»å±äºä¸åŒè¿›ç¨‹çš„çº¿ç¨‹é—´çš„åˆ‡æ¢ï¼Œä¹Ÿä¼šå¯¼è‡´è¿›ç¨‹çš„åˆ‡æ¢ï¼Œå¼€é”€ä¹Ÿå¤§ å¼•å…¥è¿›ç¨‹çš„ç›®çš„æ˜¯ï¼š ä¸ºäº†æ›´å¥½çš„è®©å¤šé“ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œæé«˜èµ„æºåˆ©ç”¨ç‡å’Œç³»ç»Ÿååé‡ ä¸ºäº†å‡å°‘ç¨‹åºåœ¨å¹¶å‘æ‰§è¡Œæ—¶æ‰€ä»˜å‡ºçš„æ—¶ç©ºå¼€é”€ï¼Œæé«˜æ“ä½œç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½ã€‚ è¿›ç¨‹å¯èƒ½éœ€è¦â€åŒæ—¶â€åšå¾ˆå¤šäº‹æƒ…ï¼Œè€Œä¼ ç»Ÿçš„è¿›ç¨‹åªèƒ½ çº¿ç¨‹çš„ç‰¹ç‚¹ å„ä¸ªè¿›ç¨‹çš„å†…å­˜åœ°å€ç©ºé—´ç›¸äº’ç‹¬ç«‹ï¼Œåªèƒ½é€šè¿‡è¯·æ±‚æ“ä½œç³»ç»Ÿå†…æ ¸çš„å¸®åŠ©æ¥å®Œæˆè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ ä½†åŒä¸€ä¸ªè¿›ç¨‹ä¸‹çš„å„ä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«å†…å­˜åœ°å€ç©ºé—´ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡è¯»&#x2F;å†™å†…å­˜ç©ºé—´è¿›è¡Œé€šä¿¡ã€‚ ä»å±äºåŒä¸€ä¸ªè¿›ç¨‹å„ä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„æ‰€æœ‰èµ„æºã€‚ è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡å¿…é¡»è¯·æ±‚æ“ä½œç³»ç»ŸæœåŠ¡(CPUè¦æ±‚æ¢åˆ°æ ¸å¿ƒæ€)ï¼Œå¼€é”€å¤§ã€‚ åŒè¿›ç¨‹ä¸‹çš„çº¿ç¨‹é—´é€šä¿¡ä¸éœ€è¦æ“ä½œç³»ç»Ÿå¹²é¢„ï¼Œå¼€é”€æ›´å°ã€‚ å¼•å…¥çº¿ç¨‹å‰ï¼Œè¿›ç¨‹æ—¢æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œä¹Ÿæ˜¯è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚ ä½†æ˜¯å¼•å…¥çº¿ç¨‹åï¼Œè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè€Œçº¿ç¨‹æ˜¯è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚åŒæ ·çº¿ç¨‹ä¹Ÿæœ‰è¿è¡Œæ€ï¼Œå°±ç»ªæ€å’Œé˜»å¡æ€ã€‚ è€Œçº¿ç¨‹å‡ ä¹ä¸æ‹¥æœ‰èµ„æºï¼Œåªæ‹¥æœ‰æå°‘é‡çš„èµ„æº(çº¿ç¨‹æ§åˆ¶å—TCBã€å¯„å­˜å™¨ä¿¡æ¯ã€å †æ ˆç­‰) åœ¨å¤šæ ¸CPUç¯å¢ƒä¸‹ï¼Œå„ä¸ªçº¿ç¨‹ä¹Ÿå¯ä»¥åˆ†é…åˆ°ä¸åŒçš„CPUä¸Šå¹¶è¡Œçš„æ‰§è¡Œã€‚ 2.6 çº¿ç¨‹çš„å®ç°æ–¹å¼çº¿ç¨‹åˆ†ä¸ºï¼šç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹ ç”¨æˆ·çº§çº¿ç¨‹ ç”¨æˆ·çº§çº¿ç¨‹ç”±åº”ç”¨ç¨‹åºé€šè¿‡çº¿ç¨‹åº“å®ç°ï¼Œæ‰€æœ‰çš„çº¿ç¨‹ç®¡ç†å·¥ä½œéƒ½ç”±åº”ç”¨ç¨‹åºè´Ÿè´£ï¼ˆåŒ…æ‹¬çº¿ç¨‹åˆ‡æ¢ï¼‰ ç”¨æˆ·çº§çº¿ç¨‹ä¸­ï¼Œçº¿ç¨‹åˆ‡æ¢å¯ä»¥åœ¨ç”¨æˆ·æ€ä¸‹å³å¯å®Œæˆï¼Œæ— éœ€æ“ä½œç³»ç»Ÿå¹²é¢„ã€‚ åœ¨ç”¨æˆ·çœ‹æ¥ï¼Œæ˜¯æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯åœ¨æ“ä½œç³»ç»Ÿçš„å†…æ ¸æ¥çœ‹ï¼Œå¹¶ä¸æ„è¯†åˆ°çº¿ç¨‹çš„å­˜åœ¨ã€‚ â€œç”¨æˆ·çº§çº¿ç¨‹â€å°±æ˜¯ä»ç”¨æˆ·è§†è§’æ‰€èƒ½çœ‹åˆ°çš„çº¿ç¨‹ã€‚ ä¼˜ç‚¹ï¼šç”¨æˆ·çº§çº¿ç¨‹çš„åˆ‡æ¢åœ¨ç”¨æˆ·ç©ºé—´å³å¯å®Œæˆï¼Œä¸éœ€è¦åˆ‡æ¢åˆ°æ ¸å¿ƒæ€ï¼Œçº¿ç¨‹ç®¡ç†çš„ç³»ç»Ÿå¼€é”€å°ï¼Œæ•ˆç‡é«˜ã€‚ ç¼ºç‚¹ï¼šå½“ä¸€ä¸ªç”¨æˆ·çº§çº¿ç¨‹è¢«é˜»å¡åï¼Œæ•´ä¸ªçº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ï¼Œå¹¶å‘åº¦ä¸é«˜ã€‚å¤šä¸ªçº¿ç¨‹å¿…é¡»åœ¨å¤šæ ¸å¤„ç†æœºä¸Šå¹¶è¡Œè¿è¡Œã€‚ åœ¨ç”¨æˆ·çº§çº¿ç¨‹ä¸­ï¼ŒCPUè°ƒåº¦çš„åŸºæœ¬å•ä½ä¾æ—§æ˜¯è¿›ç¨‹ï¼Œå¹¶éçº¿ç¨‹ â€‹ å†…æ ¸çº§çº¿ç¨‹ å†…æ ¸çº§çº¿ç¨‹ï¼šåˆç§°â€å†…æ ¸æ”¯æ’‘çš„çº¿ç¨‹â€ï¼Œæ˜¯ç”±æ“ä½œç³»ç»Ÿæ”¯æ’‘çš„çº¿ç¨‹ã€‚ å¤§å¤šæ•°çš„ç°ä»£æ“ä½œç³»ç»Ÿéƒ½å®ç°äº†å†…æ ¸çº§çº¿ç¨‹ï¼Œå¦‚Windowsã€Linuxã€‚ å†…æ ¸çº§çº¿ç¨‹çš„ç®¡ç†å·¥ä½œæ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸å®Œæˆã€‚ çº¿ç¨‹è°ƒåº¦å’Œåˆ‡æ¢ç­‰å·¥ä½œéƒ½æ˜¯ç”±å†…æ ¸è´Ÿè´£ï¼Œå› æ­¤å†…æ ¸çº§çº¿ç¨‹çš„åˆ‡æ¢å¿…ç„¶éœ€è¦åœ¨æ ¸å¿ƒæ€ä¸‹æ‰èƒ½å®Œæˆã€‚ æ“ä½œç³»ç»Ÿä¼šä¸º**æ¯ä¸ªå†…æ ¸çº§çº¿ç¨‹å»ºç«‹ç›¸åº”çš„TCB(è¿›ç¨‹æ§åˆ¶å—)**ï¼Œé€šè¿‡TCBå¯¹çº¿ç¨‹è¿›è¡Œç®¡ç†â€ã€‚ â€œå†…æ ¸çº§çº¿ç¨‹â€å°±æ˜¯ä»æ“ä½œç³»ç»Ÿå†…æ ¸è§†è§’çœ‹åˆ°çš„çº¿ç¨‹ã€‚ ä¼˜ç‚¹ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è¢«é˜»å¡åï¼Œåˆ«çš„çº¿ç¨‹è¿˜å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œå¹¶å‘èƒ½åŠ›å¼ºã€‚å¤šçº¿ç¨‹å¯åœ¨å¤šæ ¸å¤„ç†æœºä¸Šå¹¶è¡Œæ‰§è¡Œã€‚ ç¼ºç‚¹ï¼šä¸€ä¸ªç”¨æˆ·è¿›ç¨‹ä¼šå ç”¨å¤šä¸ªå†…æ ¸ç¨‹åºï¼Œçº¿ç¨‹åˆ‡æ¢ç”±æ“ä½œç³»ç»Ÿå†…æ ¸å®Œæˆï¼Œéœ€è¦ä»ç”¨æˆ·æ€å˜ä¸ºæ ¸å¿ƒæ€ï¼Œå› æ­¤çº¿ç¨‹ç®¡ç†çš„æˆæœ¬é«˜ï¼Œå¼€é”€å¤§ã€‚ 2.7 å¤šçº¿ç¨‹æ¨¡å‹ä¸€å¯¹ä¸€æ¨¡å‹ä¸€å¯¹ä¸€æ¨¡å‹ï¼š ä¸€ä¸ªç”¨æˆ·åŠçº¿ç¨‹æ˜ å°„åˆ°ä¸€ä¸ªè‚‰æ ¸çº§çº¿ç¨‹ã€‚æ¯ä¸ªç”¨æˆ·è¿›ç¨‹æœ‰ä¸ç”¨æˆ·çº§çº¿ç¨‹åŒæ•°é‡çš„å†…æ ¸çº§çº¿ç¨‹ã€‚ ä¼˜ç‚¹ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è¢«é˜»å¡åï¼Œåˆ«çš„çº¿ç¨‹è¿˜å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œå¹¶å‘èƒ½åŠ›å¼ºã€‚å¤šçº¿ç¨‹å¯åœ¨å¤šæ ¸å¤„ç†æœºä¸Šå¹¶è¡Œæ‰§è¡Œã€‚ ç¼ºç‚¹ï¼šä¸€ä¸ªç”¨æˆ·è¿›ç¨‹ä¼šå ç”¨å¤šä¸ªå†…æ ¸çº§çº¿ç¨‹ï¼Œçº¿ç¨‹åˆ‡æ¢ç”±æ“ä½œç³»ç»Ÿå†…æ ¸å®Œæˆï¼Œéœ€è¦åˆ‡æ¢åˆ°æ ¸å¿ƒæ€ï¼Œå› æ­¤çº¿ç¨‹ç®¡ç†çš„æˆæœ¬é«˜ï¼Œå¼€é”€å¤§ã€‚ å¤šå¯¹ä¸€æ¨¡å‹å¤šå¯¹ä¸€æ¨¡å‹ï¼š å¤šä¸ªç”¨æˆ·åŠçº¿ç¨‹æ˜ å°„åˆ°ä¸€ä¸ªå†…æ ¸çº§çº¿ç¨‹ã€‚æ¯ä¸ªç”¨æˆ·è¿›ç¨‹åªå¯¹åº”ä¸€ä¸ªå†…æ ¸çº§çº¿ç¨‹ã€‚ ä¼˜ç‚¹ï¼šç”¨æˆ·çº§çº¿ç¨‹çš„åˆ‡æ¢åœ¨ç”¨æˆ·ç©ºé—´å³å¯å®Œæˆï¼Œä¸éœ€è¦åˆ‡æ¢åˆ°æ ¸å¿ƒæ€ï¼Œçº¿ç¨‹ç®¡ç†çš„ç³»ç»Ÿå¼€é”€å°ï¼Œæ•ˆç‡é«˜ ç¼ºç‚¹ï¼šå½“ä¸€ä¸ªç”¨æˆ·çº§çº¿ç¨‹è¢«é˜»å¡åï¼Œæ•´ä¸ªè¿›ç¨‹éƒ½ä¼šè¢«é˜»å¡ï¼Œå¹¶å‘åº¦ä¸é«˜ã€‚å¤šä¸ªçº¿ç¨‹ä¸å¯åœ¨å¤šæ ¸å¤„ç†æœºä¸Šå¹¶è¡Œè¿è¡Œ å¤šå¯¹å¤šæ¨¡å‹å¤šå¯¹å¤šæ¨¡å‹ï¼š nç”¨æˆ·åŠçº¿ç¨‹æ˜ å°„åˆ°mä¸ªå†…æ ¸çº§çº¿ç¨‹(n&gt;&#x3D;m)ã€‚æ¯ä¸ªç”¨æˆ·è¿›ç¨‹å¯¹åº”mä¸ªå†…æ ¸çº§çº¿ç¨‹ã€‚ å…‹æœäº†å¤šå¯¹ä¸€æ¨¡å‹å¹¶å‘åº¦ä¸é«˜çš„ç¼ºç‚¹ï¼Œåˆå…‹æœäº†ä¸€å¯¹ä¸€æ¨¡å‹ä¸­ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹å ç”¨å¤ªå¤šå†…æ ¸çº§çº¿ç¨‹ï¼Œå¼€é”€å¤ªå¤§çš„ç¼ºç‚¹ã€‚ 2.8 å¤„ç†æœºè°ƒåº¦ å½“æœ‰ä¸€å †ä»»åŠ¡è¦å¤„ç†ï¼Œä½†ç”±äºèµ„æºæœ‰é™ï¼Œè¿™äº›äº‹æƒ…æ²¡æ³•åŒæ—¶å¤„ç†ã€‚è¿™å°±éœ€è¦ç¡®å®šæŸç§è§„åˆ™(æ—¶é—´çŸ­ä¼˜å…ˆã€å…ˆæ¥å…ˆæœåŠ¡ç­‰)æ¥å†³å®šè¿™äº›ä»»åŠ¡çš„é¡ºåºï¼Œè¿™å°±æ˜¯â€œè°ƒåº¦â€ç ”ç©¶çš„é—®é¢˜ã€‚ åœ¨å¤šé“ç¨‹åºç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹çš„æ•°é‡å¾€å¾€æ˜¯å¤šäºå¤„ç†æœºçš„ä¸ªæ•°çš„ï¼Œè¿™æ ·ä¸å¯èƒ½åŒæ—¶å¹¶è¡Œçš„å¤„ç†å„ä¸ªè¿›ç¨‹ã€‚ å¤„ç†æœºè°ƒåº¦ï¼šå°±æ˜¯ä»å°±ç»ªé˜Ÿåˆ—ä¸­æŒ‰ç…§ä¸€å®šçš„ç®—æ³•é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹å¹¶å°†å¤„ç†æœºåˆ†é…ç»™å®ƒè¿è¡Œï¼Œä»¥å®ç°è¿›ç¨‹çš„å¹¶å‘æ‰§è¡Œã€‚ é«˜çº§è°ƒåº¦é«˜çº§è°ƒåº¦æ˜¯ï¼Œä¹Ÿç§°ä¸ºä½œä¸šè°ƒåº¦ï¼Œæ ¹æ®ä¸åŒçš„ä½œä¸šè°ƒåº¦ç®—æ³•ï¼Œå°†ç£ç›˜ä¸­åå¤‡é˜Ÿåˆ—ä¸­çš„ä¸åŒçš„è‹¥å¹²ä½œä¸šè°ƒå…¥ å†…å­˜çš„è¿‡ç¨‹ã€‚ä½œä¸šä¸€æ—¦è¢«è°ƒå…¥å†…å­˜ï¼Œå°±ä¼šå°†å…¶åˆ›å»ºä¸ºè¿›ç¨‹ï¼Œå¹¶ä¸ºä¹‹åˆ†é…å¿…è¦çš„èµ„æºï¼Œè¿›å…¥å°±ç»ªé˜Ÿåˆ—ã€‚ é«˜çº§è°ƒåº¦ï¼Œä¸»è¦å­˜åœ¨äºå¤šé“æ‰¹å¤„ç†ç³»ç»Ÿï¼Œå®æ—¶ç³»ç»Ÿä¸åˆ†æ—¶ç³»ç»Ÿä¸­æ²¡æœ‰è¯¥è°ƒåº¦æ–¹å¼ ä¸­çº§è°ƒåº¦ä¸­çº§è°ƒåº¦ï¼Œä¹Ÿç§°ä¸ºå†…å­˜è°ƒåº¦ï¼Œä¹Ÿæ˜¯OSä¸­æœ€åŸºæœ¬çš„ä¸€ç§è°ƒåº¦ï¼Œæ˜¯ä¸ºæé«˜å†…å­˜åˆ©ç”¨ç‡ä¸ç³»ç»Ÿååé‡è€Œå¼•å…¥ çš„ä¸€ç±»è°ƒåº¦ã€‚å…¶åŠŸèƒ½æ˜¯ï¼Œå°†å†…å­˜ä¸­æš‚æ—¶ä¸èƒ½è¿è¡Œçš„è¿›ç¨‹ï¼Œè°ƒåˆ°å¤–å­˜ç­‰å¾…ã€‚å½“å…·å¤‡è¿è¡Œæ¡ä»¶ä¸”å†…å­˜æœ‰ç©ºé—² æ—¶ï¼Œå†æ ¹æ®ä¸åŒçš„è°ƒåº¦ç®—æ³•å°†å…¶é‡æ–°è°ƒå…¥åˆ°å†…å­˜ã€‚ ä¸­çº§è°ƒåº¦ï¼Œæ— è®ºæ˜¯å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿï¼Œè¿˜æ˜¯åˆ†æ—¶ç³»ç»Ÿã€å®æ—¶ç³»ç»Ÿï¼Œéƒ½å­˜åœ¨è¯¥è°ƒåº¦æ–¹å¼ ä½çº§è°ƒåº¦ä½çº§è°ƒåº¦æ˜¯ï¼Œä¹Ÿç§°ä¸ºè¿›ç¨‹è°ƒåº¦ï¼Œæ˜¯OSä¸­æœ€åŸºæœ¬çš„ä¸€ç§è°ƒåº¦ï¼Œæ˜¯ä¸€ä¸ªæ ¹æ®ä¸åŒçš„è¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼Œé€‰æ‹©ä¸ åŒçš„è¿›ç¨‹ä¸ºå…¶åˆ†é…å¤„ç†æœºçš„è¿‡ç¨‹ã€‚ ä½çº§è°ƒåº¦ï¼Œæ— è®ºæ˜¯å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿï¼Œè¿˜æ˜¯åˆ†æ—¶ç³»ç»Ÿã€å®æ—¶ç³»ç»Ÿï¼Œéƒ½å­˜åœ¨è¯¥è°ƒåº¦æ–¹å¼ 2.9 è¿›ç¨‹è°ƒåº¦è¿›ç¨‹è°ƒåº¦çš„æ—¶æœºè¿›ç¨‹è°ƒåº¦(ä½çº§è°ƒåº¦)ï¼Œå°±æ˜¯æŒ‰ç…§æŸç§ç®—æ³•ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹ä¸ºå…¶åˆ†é…å¤„ç†æœºã€‚ éœ€è¦è¿›è¡Œè¿›ç¨‹è°ƒåº¦ä¸åˆ‡æ¢çš„æƒ…å†µï¼š å½“å‰è¿è¡Œçš„è¿›ç¨‹ä¸»åŠ¨æ”¾å¼ƒå¤„ç†æœº è¿›ç¨‹æ­£å¸¸ç»ˆæ­¢ è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸è€Œç»ˆæ­¢ è¿›ç¨‹ä¸»åŠ¨è¯·æ±‚é˜»å¡ï¼Œå¦‚ç­‰å¾…I&#x2F;O å½“å‰è¿è¡Œçš„è¿›ç¨‹è¢«åŠ¨æ”¾å¼ƒå¤„ç†æœº åˆ†ç»™è¿›ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œ æœ‰æ›´ç´§æ€¥çš„äº‹éœ€è¦å¤„ç†ï¼Œå¦‚I&#x2F;Oä¸­æ–­ æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹è¿›å…¥å°±ç»ªé˜Ÿåˆ— ä¸èƒ½è¿›è¡Œè¿›ç¨‹è°ƒåº¦ä¸åˆ‡ä¸€æ¢çš„æƒ…å†µï¼š åœ¨å¤„ç†ä¸­æ–­çš„è¿‡ç¨‹ä¸­ã€‚ä¸­æ–­å¤„ç†è¿‡ç¨‹å¤æ‚ï¼Œä¸ç¡¬ä»¶å¯†åˆ‡ç›¸å…³ï¼Œå¾ˆéš¾åšåˆ°åœ¨ä¸­æ–­å¤„ç†è¿‡ç¨‹ä¸­è¿›è¡Œè¿›ç¨‹åˆ‡æ¢ã€‚ è¿›ç¨‹åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ç¨‹åºä¸´ç•ŒåŒºä¸­ã€‚ åœ¨åŸå­æ“ä½œè¿‡ç¨‹ä¸­(åŸè¯­)ã€‚åŸå­æ“ä½œä¸å¯ä¸­æ–­ï¼Œè¦ä¸€æ°”å‘µæˆã€‚å¦‚ä¹‹å‰è®²è¿‡çš„ä¿®æ”¹PCBä¸­è¿›ç¨‹çŠ¶æ€æ ‡å¿—ï¼Œå¹¶æŠŠPCBæ”¾åˆ°ç›¸åº”é˜Ÿåˆ— è¿›ç¨‹è°ƒåº¦çš„æ–¹å¼ éå‰¥å¤ºè°ƒåº¦æ–¹å¼ï¼Œåˆç§°éæŠ¢å æ–¹å¼ï¼š å³ï¼Œåªå…è®¸è¿›ç¨‹ä¸»åŠ¨æ”¾å¼ƒå¤„ç†æœºã€‚åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å³ä¾¿æœ‰æ›´ç´§è¿«çš„ä»»åŠ¡åˆ°è¾¾ï¼Œå½“å‰è¿›ç¨‹ä¾ç„¶ä¼šç»§ç»­ä½¿ç”¨å¤„ç†æœºï¼Œç›´åˆ°è¯¥è¿›ç¨‹ç»ˆæ­¢æˆ–ä¸»åŠ¨è¦æ±‚è¿›å…¥é˜»å¡æ€ã€‚ç‰¹ç‚¹ï¼šå®ç°ç®€å•ï¼Œç³»ç»Ÿå¼€çš„å°ä½†æ˜¯æ— æ³•åŠæ—¶å¤„ç†ç´§æ€¥ä»»åŠ¡ï¼Œé€‚åˆäºæ—©æœŸçš„æ‰¹å¤„ç†ç³»ç»Ÿ å‰¥å¤ºè°ƒåº¦æ–¹å¼ï¼Œåˆç§°æŠ¢å æ–¹å¼ï¼š å½“ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨å¤„ç†æœºä¸Šæ‰§è¡Œæ—¶ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ›´é‡è¦æˆ–æ›´ç´§è¿«çš„è¿›ç¨‹éœ€è¦ä½¿ç”¨å¤„ç†æœºï¼Œåˆ™ç«‹å³æš‚åœæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ï¼Œå°†å¤„ç†æœºåˆ†é…ç»™æ›´é‡è¦ç´§è¿«çš„é‚£ä¸ªè¿›ç¨‹ã€‚ç‰¹ç‚¹ï¼šå¯ä»¥ä¼˜å…ˆå¤„ç†æ›´ç´§æ€¥çš„è¿›ç¨‹ï¼Œä¹Ÿå¯å®ç°è®©å„è¿›ç¨‹æŒ‰æ—¶é—´ç‰‡è½®æµæ‰§è¡Œçš„åŠŸèƒ½ï¼ˆé€šè¿‡æ—¶é’Ÿä¸­æ–­ï¼‰ã€‚é€‚åˆäºåˆ†æ—¶æ“ä½œç³»ç»Ÿã€å®æ—¶æ“ä½œç³»ç»Ÿ è¿›ç¨‹çš„åˆ‡æ¢ä¸è¿‡ç¨‹â€œç‹­ä¹‰çš„è¿›ç¨‹è°ƒåº¦â€ä¸â€œè¿›ç¨‹åˆ‡æ¢â€çš„åŒºåˆ«ï¼š ç‹­ä¹‰çš„è¿›ç¨‹è°ƒåº¦ï¼šæŒ‡çš„æ˜¯ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰ä¸­ä¸€ä¸ªè¦è¿è¡Œçš„è¿›ç¨‹(è¿™ä¸ªè¿›ç¨‹å¯ä»¥æ˜¯åˆšåˆšè¢«æš‚åœæ‰§è¡Œçš„è¿›ç¨‹ï¼Œä¹Ÿå¯èƒ½æ˜¯å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œåä¸€ç§æƒ…å†µå°±éœ€è¦è¿›ç¨‹åˆ‡æ¢) è¿›ç¨‹åˆ‡æ¢ï¼šæ˜¯æŒ‡ä¸€ä¸ªè¿›ç¨‹è®©å‡ºå¤„ç†æœºï¼Œç”±å¦ä¸€ä¸ªè¿›ç¨‹å ç”¨å¤„ç†æœºçš„è¿‡ç¨‹ã€‚ å¹¿ä¹‰çš„è¿›ç¨‹è°ƒåº¦ï¼šåŒ…å«äº†é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹å’Œè¿›ç¨‹åˆ‡æ¢ä¸¤ä¸ªæ­¥éª¤ã€‚ è¿›ç¨‹åˆ‡æ¢è¿‡ç¨‹å®Œæˆåï¼š å¯¹åŸæ¥è¿è¡Œè¿›ç¨‹å„ç§æ•°æ®çš„ä¿å­˜ å¯¹æ–°çš„è¿›ç¨‹å„ç§æ•°æ®çš„æ¢å¤ å¦‚ï¼šç¨‹åºè®¡æ•°å™¨ã€ç¨‹åºçŠ¶æ€å­—ã€å„ç§æ•°æ®å¯„å­˜å™¨ç­‰å¤„ç†æœºç°åœºä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¸€ç­ä¿å­˜åœ¨è¿›ç¨‹æ§åˆ¶å—PCBä¸­ æ³¨æ„ï¼šè¿›ç¨‹åˆ‡æ¢æ˜¯æœ‰ä»£ä»·çš„ï¼Œä¸èƒ½è¯´è¿›ç¨‹åˆ‡æ¢è¶Šé¢‘ç¹ç³»ç»Ÿå¹¶å‘æ€§å°±è¶Šå¥½ï¼Œå› ä¸ºå¦‚æœè¿‡äºé¢‘ç¹çš„è¿›è¡Œè¿›ç¨‹è°ƒåº¦ã€åˆ‡æ¢ï¼Œå¿…ç„¶ä¼šä½¿å¾—æ•´ä¸ªç³»ç»Ÿçš„æ•ˆç‡é™ä½ï¼Œä½¿å¾—ç³»ç»Ÿå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨äº†è¿›ç¨‹çš„åˆ‡æ¢ä¸Šï¼Œè€ŒçœŸæ­£ç”¨äºæ‰§è¡Œè¿›ç¨‹çš„æ—¶é—´å‡å°‘ã€‚ 2.10 è°ƒåº¦ç®—æ³•è°ƒåº¦ç®—æ³•çš„è¯„ä»·æŒ‡æ ‡è°ƒåº¦ç®—æ³•çš„è¯„ä»·æŒ‡æ ‡ä¸»è¦æœ‰ï¼šCPUåˆ©ç”¨ç‡ï¼Œç³»ç»Ÿååé‡ã€å‘¨è½¬æ—¶é—´ã€ç­‰å¾…æ—¶é—´å’Œå“åº”æ—¶é—´ CPUåˆ©ç”¨ç‡ï¼šæŒ‡çš„æ˜¯CPUâ€å¿™ç¢Œâ€çš„æ—¶é—´å æ€»æ—¶é—´çš„æ¯”ä¾‹ åˆ©ç”¨ç‡ = CPUå¿™ç¢Œçš„æ—¶é—´ / æ€»æ—¶é—´ ç³»ç»Ÿååé‡ï¼šå•ä½æ—¶é—´å†…å®Œæˆä½œä¸šçš„æ•°é‡ ç³»ç»Ÿååé‡ = æ€»å…±å®Œæˆäº†å¤šå°‘é“ä½œä¸š / æ€»å…±èŠ±äº†å¤šå°‘æ—¶é—´ å‘¨è½¬æ—¶é—´ï¼šæ˜¯æŒ‡ä»ä½œä¸šè¢«æäº¤ç»™ç³»ç»Ÿå¼€å§‹ï¼Œåˆ°ä½œä¸šå®Œæˆä¸ºæ­¢çš„è¿™æ®µæ—¶é—´é—´éš” å‘¨è½¬æ—¶é—´ = ä½œä¸šå®Œæˆæ—¶é—´ - ä½œä¸šæäº¤æ—¶é—´ å¯¹äºç”¨æˆ·ï¼Œæ›´å…³å¿ƒè‡ªå·±çš„å•ä¸ªä½œä¸šçš„å‘¨è½¬æ—¶é—´ å¹³å‡å‘¨è½¬æ—¶é—´ = å„ä¸ªä½œä¸šå‘¨è½¬æ—¶é—´ä¹‹å’Œ / ä½œä¸šæ•° å¯¹äºæ“ä½œç³»ç»Ÿï¼Œæ›´å…³å¿ƒç³»ç»Ÿçš„æ•´ä½“è¡¨ç°ï¼Œå› æ­¤æ›´å…³å¿ƒæ‰€æœ‰ä½œä¸šçš„å‘¨è½¬æ—¶é—´çš„å¹³å‡å€¼ å¸¦æƒå‘¨è½¬æ—¶é—´ = ä½œä¸šå‘¨è½¬æ—¶é—´ / ä½œä¸šå®é™…è¿è¡Œæ—¶é—´ â€‹ = (ä½œä¸šå®Œæˆæ—¶é—´ - ä½œä¸šæäº¤æ—¶é—´) / ä½œä¸šå®é™…è¿è¡Œæ—¶é—´ å¸¦æƒå‘¨è½¬æ—¶é—´ä¸å‘¨è½¬æ—¶é—´éƒ½æ˜¯è¶Šå°è¶Šå¥½(å¸¦æƒå‘¨è½¬æ—¶é—´å¿…ç„¶ &gt;&#x3D; 1) å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´ = å„ä¸ªå¸¦æƒå‘¨è½¬æ—¶é—´ä¹‹å’Œ / ä½œä¸šæ•° ç­‰å¾…æ—¶é—´ï¼šæŒ‡è¿›ç¨‹&#x2F;ä½œä¸šå¤„äºç­‰å¾…å¤„ç†æœºçŠ¶æ€æ—¶é—´ä¹‹å’Œï¼Œç­‰å¾…æ—¶é—´è¶ŠçŸ­ï¼Œç”¨æˆ·è¶Šæ»¡æ„ å¯¹äºè¿›ç¨‹æ¥è¯´ï¼Œç­‰å¾…æ—¶é—´å°±æ˜¯æŒ‡è¿›ç¨‹å»ºç«‹åç­‰å¾…è¢«æœåŠ¡çš„æ—¶é—´ä¹‹å’Œï¼Œåœ¨ç­‰å¾…I&#x2F;Oå®Œæˆçš„æœŸé—´å…¶å®è¿›ç¨‹ä¹Ÿæ˜¯è¢«æœåŠ¡çš„ï¼Œæ‰€ä»¥ä¸è®¡å…¥ç­‰å¾…æ—¶é—´ã€‚ è€Œå¯¹äºä½œä¸šæ¥è¯´ï¼Œä¸ä»…è¦è€ƒè™‘å»ºç«‹è¿›ç¨‹åçš„ç­‰å¾…æ—¶é—´ï¼Œè¿˜è¦åŠ ä¸Šä½œä¸šåœ¨å¤–å­˜åå¤‡é˜Ÿåˆ—ä¸­çš„ç­‰å¾…æ—¶é—´ã€‚ ä¸€ä¸ªä½œä¸šæ€»å…±éœ€è¦è¢«CPUæœåŠ¡å¤šä¹…ï¼Œè¢«I&#x2F;Oè®¾å¤‡æœåŠ¡å¤šä¹…ä¸€èˆ¬æ˜¯ç¡®å®šä¸å˜çš„ï¼Œå› æ­¤è°ƒåº¦ç®—æ³•å…¶å®åªèƒ½å½±å“ä½œä¸šæˆ–è€…è¿›ç¨‹çš„ç­‰å¾…æ—¶é—´ã€‚å½“ç„¶ï¼Œä¸å‰é¢æŒ‡æ ‡ç±»ä¼¼ï¼Œä¹Ÿæœ‰â€å¹³å‡ç­‰å¾…æ—¶é—´â€æ¥è¯„ä»·æ•´ä½“æ€§èƒ½ã€‚ å“åº”æ—¶é—´ï¼šæŒ‡ä»ç”¨æˆ·è¯·æ±‚åˆ°é¦–æ¬¡äº§ç”Ÿå“åº”æ‰€ç”¨çš„æ—¶é—´ è°ƒåº¦ç®—æ³•å…ˆæ¥å…ˆæœåŠ¡(FCFS)ï¼š çŸ­ä½œä¸šä¼˜å…ˆ(SJF)ï¼š é«˜å“åº”æ¯”ä¼˜å…ˆ(HRRN)ï¼š ä¸‰ã€å†…å­˜å››ã€æ–‡ä»¶äº”ã€I-Oè®¾å¤‡","categories":[{"name":"è®¡ç®—æœº4ä»¶å¥—","slug":"è®¡ç®—æœº4ä»¶å¥—","permalink":"http://example.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA4%E4%BB%B6%E5%A5%97/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"","slug":"å°æŠ€å·§/@Autowiredä¸@Resource","date":"2022-08-06T11:11:16.336Z","updated":"2022-09-08T00:30:02.078Z","comments":true,"path":"2022/08/06/å°æŠ€å·§/@Autowiredä¸@Resource/","link":"","permalink":"http://example.com/2022/08/06/%E5%B0%8F%E6%8A%80%E5%B7%A7/@Autowired%E4%B8%8E@Resource/","excerpt":"","text":"@Autowiredå’Œ@ResourceåŒºåˆ«1.æä¾›æ–¹ä¸åŒï¼š @Autowiredæ˜¯ç”±Springæä¾›ï¼Œå±äºç¬¬ä¸‰æ–¹ @Resourceæ˜¯ç”±J2EEæä¾›ï¼Œå±äºJavaçš„ 2.è£…é…æ—¶é»˜è®¤ç±»å‹ä¸åŒï¼š @Autowiredé»˜è®¤æŒ‰typeè£…é… é»˜è®¤æƒ…å†µä¸‹å¿…é¡»è¦æ±‚ä¾èµ–å¯¹è±¡å­˜åœ¨ï¼Œå¦‚æœè¦å…è®¸nullå€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalseã€‚ å¦‚æœæƒ³ä½¿ç”¨åç§°è£…é…å¯ä»¥ç»“åˆ@Qualifieræ³¨è§£è¿›è¡Œä½¿ç”¨ã€‚ @Resourceé»˜è®¤æŒ‰nameè£…é… åç§°å¯ä»¥é€šè¿‡nameå±æ€§è¿›è¡ŒæŒ‡å®šï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šnameå±æ€§ï¼Œå½“æ³¨è§£å†™åœ¨å­—æ®µä¸Šæ—¶ï¼Œé»˜è®¤å–å­—æ®µåè¿›è¡Œåç§°æŸ¥æ‰¾ã€‚ å¦‚æœæ³¨è§£å†™åœ¨setteræ–¹æ³•ä¸Šé»˜è®¤å–å±æ€§åè¿›è¡Œè£…é…ã€‚ å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„beanæ—¶æ‰æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…ã€‚ ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœnameå±æ€§ä¸€æ—¦æŒ‡å®šï¼Œå°±åªä¼šæŒ‰ç…§åç§°è¿›è¡Œè£…é…ã€‚ 3.ä½¿ç”¨æ³¨æ„ï¼š @Autowired @Qualifier(â€œuserServiceâ€) æ˜¯ç›´æ¥æŒ‰ç…§åå­—è¿›è¡Œæœç´¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºUserServiceImpl ä¸Šé¢@Serviceæ³¨è§£å¿…é¡»å†™åå­—ï¼Œä¸å†™å°±ä¼šæŠ¥é”™ï¼Œè€Œä¸”åå­—å¿…é¡»æ˜¯@Autowired @Qualifier(â€œuserServiceâ€) ä¿æŒä¸€è‡´ã€‚å¦‚æœ@Serviceä¸Šé¢å†™äº†åå­—ï¼Œè€Œ@Autowired @Qualifier() ï¼Œä¸€æ ·ä¼šæŠ¥é”™ã€‚ @Resource æ ¹æ®è¿™ä¸ªæ³¨è§£çš„åŒ¹é…æ•ˆæœå¯ä»¥çœ‹å‡ºï¼Œå®ƒè¿›è¡Œäº†ä¸¤æ¬¡åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ åœ¨UserServiceè¿™ä¸ªç±»ä¸Šé¢è¿™æ ·å†™æ³¨è§£@Serviceã€‚é¦–å…ˆæ˜¯æ‰¾ç›¸åŒåå­—çš„ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå†æ‰¾ç›¸åŒç±»å‹çš„ï¼Œè€Œè¿™é‡Œçš„@Serviceæ²¡æœ‰å†™åå­—ï¼Œè¿™ä¸ªæ—¶å€™å°±è¿›è¡Œäº†ä¸¤æ¬¡æœç´¢ï¼Œæ˜¾ç„¶ï¼Œé€Ÿåº¦å°±ä¸‹é™äº†è®¸å¤šã€‚ @Resourceæ ¹æ®åå­—æœç´¢æ˜¯è¿™æ ·å†™@Resource(â€œuserServiceâ€)ï¼Œå¦‚æœä½ å†™äº†è¿™ä¸ªåå­—å«userServiceï¼Œé‚£ä¹ˆUserServiceImplçš„@Serviceæ³¨è§£ä¹Ÿå¿…é¡»ä¹Ÿæ˜¯è¿™ä¸ªåå­—ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šæŠ¥é”™ã€‚","categories":[],"tags":[]},{"title":"","slug":"Python/å›¾å½¢å¤„ç†","date":"2022-08-06T11:11:16.328Z","updated":"2022-07-29T04:19:15.388Z","comments":true,"path":"2022/08/06/Python/å›¾å½¢å¤„ç†/","link":"","permalink":"http://example.com/2022/08/06/Python/%E5%9B%BE%E5%BD%A2%E5%A4%84%E7%90%86/","excerpt":"","text":"1.è®¡ç®—æœºçœ¼ä¸­çš„å›¾åƒå½©è‰²å›¾åƒä¸­æ¯ä¸€ä¸ªå°æ ¼å«åšåƒç´ ç‚¹ï¼Œç”±R(çº¢)G(ç»¿)B(è“)ç»„æˆ å¯¼åŒ…ï¼š 123import cv2import matplotlib.pyplot as pltimport numpy as np 12img = cv2.imread(&#x27;scenery.jpg&#x27;)print(img) è¿è¡Œç»“æœï¼š 1234567891011121314151617[[[23 14 11] [23 14 11] [24 15 12] ... [15 10 9] [14 9 8] [14 9 8]] ... [[ 0 0 0] [ 0 0 0] [ 0 0 0] ... [ 0 0 0] [ 0 0 0] [ 0 0 0]]] å±•ç¤ºå›¾åƒå‡½æ•°ï¼š 123456def show_img(name, img): cv2.imshow(name, img) # ç­‰å¾…æ—¶é—´ï¼Œæ¯«ç§’çº§ï¼Œ0è¡¨ç¤ºä»»æ„é”®ç»ˆæ­¢ cv2.waitKey(0) # å…³é—­æ‰€æœ‰çª—å£ cv2.destroyAllWindows() 1show_img(&quot;111&quot;, img) # å±•ç¤ºå›¾åƒ 1print(img.shape) # è·å–å›¾åƒçš„ä¸‰ç»´æ•°å€¼ è¿è¡Œç»“æœï¼š 1(799, 1200, 3) å±•ç¤ºç°åº¦å›¾åƒï¼š 1234img = cv2.imread(&#x27;scenery.jpg&#x27;, cv2.IMREAD_GRAYSCALE)print(img)show_img(&quot;111&quot;, img)print(img.shape) è¿è¡Œç»“æœï¼š 12345678[[14 14 15 ... 10 9 9] [14 14 15 ... 10 9 9] [14 14 15 ... 10 9 9] ... [ 0 0 0 ... 0 0 0] [ 0 0 0 ... 0 0 0] [ 0 0 0 ... 0 0 0]](799, 1200) ä¿å­˜å›¾ç‰‡ï¼š 1cv2.imwrite(&quot;sc.jpg&quot;, img)","categories":[],"tags":[]},{"title":"Springæ¡†æ¶çš„å­¦ä¹ ç¬”è®°","slug":"Java/Springæ¡†æ¶","date":"2022-08-06T11:11:16.323Z","updated":"2022-08-06T14:16:47.670Z","comments":true,"path":"2022/08/06/Java/Springæ¡†æ¶/","link":"","permalink":"http://example.com/2022/08/06/Java/Spring%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè¯†Spring å®˜ç½‘ï¼šspringå®˜ç½‘ Springå·²ç»å‘å±•æˆäº†ä¸€ç§å¼€å‘çš„ç”Ÿæ€åœˆï¼ŒSpringæä¾›äº†è‹¥å¹²ä¸ªé¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®ç”¨äºå®Œæˆç‰¹å®šçš„åŠŸèƒ½ Spring Framework Spring Boot Spring Cloud â€¦. ç›®å‰å·²ç»å‘å±•åˆ°Spring 5.0ï¼Œéœ€è¦JDK8ä»¥ä¸Šæ”¯æŒ 2.Spring Frameworkæ¶æ„ Spring Frameworkæ˜¯Springç”Ÿæ€åœˆä¸­æœ€åŸºç¡€çš„é¡¹ç›®ï¼Œæ˜¯å…¶ä»–é¡¹ç›®çš„æ ¹åŸº Data Accessï¼šæ•°æ®è®¿é—® Data Integerationï¼šæ•°æ®é›†æˆ Webï¼šwebå¼€å‘ AOPï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ Aspectsï¼šAOPæ€æƒ³å®ç° Core Containerï¼šæ ¸å¿ƒå®¹å™¨ Testï¼šå•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯• 3.æ ¸å¿ƒæ¦‚å¿µ3.1 é¡¹ç›®ç»“æ„ javaåŒ… comåŒ… springåŒ… daoåŒ… BookDao.java implåŒ… BookDaoImpl.java serviceåŒ… BookSerive.java implåŒ… BookServiceImpl.java App.javaä¸»å‡½æ•° resourcesåŒ… applicationContext.xml jdbc.properties 3.2 åˆè¯†IOCå’ŒDI12345public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;book dao save...&quot;); &#125;&#125; 123456public class BookServiceImpl implements BookService &#123; private BookDao bookDao = new BookDaoImpl; public void save() &#123; bookDao.save(); &#125;&#125; è¿™æ˜¯ä¸€ç§å¾ˆå¸¸è§çš„å†™æ³•ã€‚ä½†æ˜¯è¿™æ ·çš„å†™æ³•è€¦åˆåº¦å¤ªé«˜ï¼Œè€¦åˆåº¦å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šä¸¤ä¸ªç±»ä¹‹é—´çš„å…³è”ç¨‹åº¦ï¼Œè€¦åˆåº¦é«˜å°±ä»£è¡¨ä¸¤ä¸ªç±»ä¹‹é—´å…³è”ç¨‹åº¦å¾ˆé«˜ï¼ŒåŠ¨å…¶ä¸­ä¸€ä¸ªç±»ï¼Œå°±ä¸å¾—ä¸åŠ¨å¦å¤–ä¸€ä¸ªç±»ã€‚ æ‰€ä»¥å°±éœ€è¦è§£è€¦ 123456public class BookServiceImpl implements BookService &#123; private BookDao bookDao;//service:æˆ‘å…è´¹å•¦ï¼ public void save() &#123; bookDao.save(); &#125;&#125; IOC(Inversion of Control) æ§åˆ¶åè½¬ ä½¿ç”¨å¯¹è±¡æ—¶ï¼Œç”±ä»¥å‰ä¸»åŠ¨newä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºç”±å¤–éƒ¨æä¾›å¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒäº¤ç»™äº†å¤–éƒ¨ï¼Œæ­¤æ€æƒ³ä¸ºæ§åˆ¶åè½¬ã€‚ SpringæŠ€æœ¯å¯¹IOCè¿›è¡Œå®ç° Springæä¾›ä¸€ä¸ªå®¹å™¨ï¼Œç§°ä¸ºIOCå®¹å™¨ï¼Œç”¨æ¥å½“ä½œIOCæ€æƒ³ä¸­çš„**â€å¤–éƒ¨â€** IOCå®¹å™¨è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ç­‰å·¥ä½œ åœ¨IOCå®¹å™¨ä¸­è¢«åˆ›å»ºæˆ–è¢«ç®¡ç†çš„å¯¹è±¡ç§°ä¹‹ä¸ºBean DI(Dependency Injection) ä¾èµ–æ³¨å…¥ åœ¨å®¹å™¨ä¸­å»ºç«‹çš„beanä¸beanä¹‹é—´çš„ä¾èµ–å…³ç³»çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç§°ä¹‹ä¸ºä¾èµ–æ³¨å…¥ã€‚ ä¾‹ï¼šserviceå±‚éœ€è¦ä¾èµ–daoå±‚è¿è¡Œï¼Œä½†æ— éœ€è‡ªå·±newä¸€ä¸ªdaoå±‚ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆdaoå±‚ã€‚ ç›®æ ‡ï¼šå……åˆ†è§£è€¦ ä½¿ç”¨IOCå®¹å™¨ç®¡ç†bean(IOCæ€æƒ³) åœ¨ICOå®¹å™¨å†…å°†ä¾èµ–å…³ç³»çš„beanè¿›è¡Œå…³ç³»ç»‘å®š(DIæ€æƒ³) åœ¨ä½¿ç”¨å¯¹è±¡æ—¶ä¸ä»…å¯ä»¥ä»IOCå®¹å™¨ä¸­è·å–ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥è·å–åˆ°beanå·²ç»ç»‘å®šçš„æ‰€æœ‰ä¾èµ–å…³ç³» 4.IOCå…¥é—¨ pom.xmlå¯¼å…¥springçš„åæ ‡ 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.3.18&lt;/version&gt;&lt;/dependency&gt; resourcesç›®å½•åˆ›å»ºSpringé…ç½®æ–‡ä»¶applicationContext.xml é…ç½®bean beanæ ‡ç­¾ï¼šé…ç½®bean idå±æ€§ï¼šç»™beanèµ·åå­— classå±æ€§ï¼šç»™beanå®šä¹‰ç±»å‹ 123&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;/&gt; åˆ›å»ºåä¸ºå¯åŠ¨ç±»App 1234567891011121314151617import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import com.spring.dao.BookDao;public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); BookService bookService = (BookService) ac.getBean(&quot;bookService&quot;); bookService.save(); &#125;&#125; 5.DIå…¥é—¨ åŸºäºIOCç®¡ç†bean ä¸èƒ½ä¿ç•™Serviceå±‚ä¸­ç”¨newåˆ›å»ºçš„å¯¹è±¡ é€šè¿‡springé…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®Serviceä¸Daoçš„å…³ç³» 12345678910111213public class BookServiceImpl implements BookService &#123; //åˆ é™¤ä¸šåŠ¡å±‚ä¸­ç”¨newåˆ›å»ºå¯¹è±¡çš„æ–¹å¼ //private BookDao bookDao = new BookDaoImpl(); private BookDao bookDao; //æä¾›ç›¸åº”çš„setçš„æ–¹æ³• public void setBookDao(BookDao bookDao) &#123; this.bookDao = bookDao; &#125; public void save() &#123; bookDao.save(); &#125;&#125; åœ¨springé…ç½®æ–‡ä»¶applicationContext.xmlä¸­ï¼Œé…ç½®property propertyæ ‡ç­¾ï¼šé…ç½®å½“å‰beançš„å±æ€§ nameå±æ€§ï¼šé…ç½®å“ªä¸ªå…·ä½“çš„å±æ€§ refå±æ€§ï¼šå‚ç…§springé…ç½®æ–‡ä»¶ä¸­çš„å“ªä¸ªbeançš„id 123456&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;!-- é…ç½®serviceä¸daoçš„å…³ç³» --&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; é…ç½®å®Œæˆåï¼ŒBookDaoæ— éœ€ä½¿ç”¨newæ¥æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡springæ¥è‡ªåŠ¨åˆ›å»º 6.beanåŸºç¡€é…ç½®6.1 beanåˆ«åé…ç½® nameå±æ€§ï¼šå¯ä»¥èµ·å¤šä¸ªåˆ«åç”¨;åˆ†å· ç©ºæ ¼,é€—å·åˆ†éš” 123&lt;bean id=&quot;bookDao&quot; name=&quot;dao Dao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; name=&quot;Service service&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;/&gt; åˆ«åå¯ä»¥ç”¨äºgetBean()æ–¹æ³• 1234567891011public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean //BookService bookService=(BookService)ac.getBean(&quot;bookService&quot;); //é€šè¿‡åˆ«åè·å–BookService BookService bookService=(BookService)ac.getBean(&quot;Service&quot;); bookService.save(); &#125;&#125; åˆ«åä¹Ÿå¯ä»¥ç”¨äºrefå±æ€§ï¼Œä¸å»ºè®®ç”¨åˆ«åï¼Œå»ºè®®ä½¿ç”¨id 123&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;Dao&quot;/&gt;&lt;/bean&gt; 6.2 beançš„ä½œç”¨èŒƒå›´åˆ›å»ºçš„beanæ˜¯å¦ä¸ºå¤šä¸ªå¯¹è±¡ 123456789101112public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao1 = (BookDao) ac.getBean(&quot;bookDao&quot;); BookDao bookDao2 = (BookDao) ac.getBean(&quot;bookDao&quot;); System.out.println(bookDao1); System.out.println(bookDao2); &#125;&#125; 123è¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@7219ec67com.spring.dao.impl.BookDaoImpl@7219ec67 ç»“è®ºï¼šä¸¤ä¸ªå¯¹è±¡åœ°å€ç›¸åŒï¼Œspringé»˜è®¤åˆ›å»ºçš„beanæ˜¯å•ä¾‹çš„ éœ€è¦åœ¨é…ç½®æ–‡ä»¶çš„beanæ ‡ç­¾é‡Œæ·»åŠ ä¸€ä¸ªscopeå±æ€§ scopeå±æ€§æœ‰singletonå•ä¾‹æ¨¡å¼å’Œprototypeéå•ä¾‹æ¨¡å¼ scopeå±æ€§é»˜è®¤ä¸ºsingletonå•ä¾‹æ¨¡å¼ 1&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; scope=&quot;prtotype&quot;/&gt; 123å†æ¬¡è¿è¡Œåï¼Œè¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@7219ec67com.spring.dao.impl.BookDaoImpl@45018215 ç»“è®ºï¼šä¸¤ä¸ªå¯¹è±¡åœ°å€ä¸åŒï¼Œä¸ºéå•ä¾‹æ¨¡å¼ beanä½œç”¨èŒƒå›´è¯´æ˜ å•ä¾‹beançš„ä¼˜åŠ¿ å‡å°‘äº†æ–°ç”Ÿæˆå®ä¾‹çš„æ¶ˆè€—ï¼Œå¯ä»¥å¿«é€Ÿè·å–åˆ°beanï¼Œæ›´å¤§ç¨‹åº¦çš„å¤ç”¨ é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†çš„bean è¡¨ç°å±‚å¯¹è±¡ï¼Œä¸šåŠ¡å±‚å¯¹è±¡ï¼Œæ•°æ®å±‚å¯¹è±¡ï¼Œå·¥å…·å¯¹è±¡ ä¸é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†çš„bean å°è£…å®ä½“çš„åŸŸå¯¹è±¡(å­˜åœ¨å˜é‡çš„) 7.beanå®ä¾‹åŒ– beançš„æœ¬è´¨å°±æ˜¯å¯¹è±¡ï¼Œåˆ›å»ºbeanéƒ½éœ€è¦ä½¿ç”¨æ„é€ æ–¹æ³•å®Œæˆ 7.1 æ„é€ æ–¹æ³•å®ä¾‹åŒ–bean(å¸¸ç”¨) åœ¨BookDaoImplç±»ä¸­åˆ›å»ºæ„é€ æ–¹æ³•ï¼š 123456789101112public class BookDaoImpl implements BookDao &#123; public BookDaoImpl()&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;); &#125; /*private BookDaoImpl()&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;); &#125;*/ public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125;&#125; AppForInstanceBookç±»è¿›è¡Œæµ‹è¯•ï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ å¹¶ä¸”BookDaoImplä¸­çš„æ„é€ æ–¹æ³•æ— è®ºæ˜¯å¦ç§æœ‰éƒ½å¯ä»¥è¢«è°ƒç”¨ï¼Œè¿™å°±æ˜¯åå°„ã€‚ æ— å‚æ„é€ æ–¹æ³•ä¸å­˜åœ¨ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ åœ¨BookDaoImplç±»ä¸­æ„é€ æ–¹æ³•æ”¹ä¸ºæœ‰å‚æ„é€ ï¼š 123public BookDaoImpl(int i)&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;);&#125; è¿è¡Œåä¼šæŠ¥é”™ï¼ŒåŒæ—¶è¯´æ˜Springåˆ›å»ºbeançš„æ—¶å€™ï¼Œè°ƒç”¨çš„æ˜¯æ— å‚æ„é€ ã€‚ 7.2 é™æ€å·¥å‚å®ä¾‹åŒ–bean(æ—©æœŸå®ä¾‹åŒ–bean äº†è§£) åˆ›å»ºä¸€ä¸ªfactoryè½¯ä»¶åŒ…ï¼Œå¹¶åœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ªBookDaoFactoryç±»ï¼š 123456public class BookDaoFactory &#123; public static BookDao getBookDao()&#123; System.out.println(&quot;factory is running&quot;); return new BookDaoImpl(); &#125;&#125; AppForInstanceBookç±»è¿è¡Œï¼š 1234567public class AppForInstanceBook &#123; public static void main(String[] args) &#123; BookDao bookDao = BookDaoFactory.getBookDao(); bookDao.save(); &#125;&#125;//è¿è¡ŒæˆåŠŸ é€šè¿‡é…ç½®æ–‡ä»¶ä½¿ç”¨é™æ€å·¥å‚å®ä¾‹åŒ–beanï¼š Springé…ç½®æ–‡ä»¶ä¸­ï¼š factory-methodå±æ€§ï¼šé€‰æ‹©å·¥å‚é‡Œçš„beanå®ä¾‹æ–¹æ³• 12&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.factory.BookDaoFactory&quot; factory-method=&quot;getBookDao&quot;/&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is runningBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ 7.3 å®ä¾‹å·¥å‚å®ä¾‹åŒ–bean(éé™æ€å·¥å‚ äº†è§£) BookDaoFactoryç±»ä¸­ï¼Œå°†æ–¹æ³•æ”¹ä¸ºéé™æ€æ–¹æ³• 123456public class BookDaoFactory &#123; public BookDao getBookDao()&#123; System.out.println(&quot;factory is running~~~~~&quot;); return new BookDaoImpl(); &#125;&#125; AppForInstanceBookç±»è¿è¡Œï¼š 1234567public class AppForInstanceBook &#123; public static void main(String[] args) &#123; BookDaoFactory bookDaoFactory = new BookDaoFactory(); BookDao bookDao = bookDaoFactory.getBookDao(); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is running~~~~~BookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ é€šè¿‡é…ç½®æ–‡ä»¶ä½¿ç”¨é™æ€å·¥å‚å®ä¾‹åŒ–beanï¼š Springé…ç½®æ–‡ä»¶ä¸­ï¼š 12345&lt;!-- å…ˆè¦é€ å‡ºå·¥å‚çš„bean --&gt;&lt;bean id=&quot;bookDaoFactory&quot; class=&quot;com.spring.factory.BookDaoFactory&quot;/&gt;&lt;bean id=&quot;bookDao&quot; factory-bean=&quot;bookDaoFactory&quot; factory-method=&quot;getBookDao&quot; /&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is running~~~~~BookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ é…ç½®æ–‡ä»¶ä¸­beanbookDaoFactoryåªæ˜¯ä¸ºäº†é…åˆä½¿ç”¨ï¼Œå®é™…æ²¡æœ‰æ„ä¹‰ã€‚ Springå¯¹è¿™ç§å®ä¾‹åŒ–beanæ–¹æ³•è¿›è¡Œäº†æ”¹è‰¯ï¼š 4.é€šè¿‡FactoryBeanå®ä¾‹åŒ–bean(å®ç”¨) åˆ›å»ºBookDaoFactoryBeanç±»å®ç°æ¥å£FactoryBean&lt;T&gt; 123456789101112public class BookDaoFactoryBean implements FactoryBean&lt;BookDao&gt; &#123; //ä»£æ›¿åŸå§‹å®ä¾‹å·¥å‚ä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹æ³• @Override public BookDao getObject() throws Exception &#123; return new BookDaoImpl(); &#125; @Override public Class&lt;?&gt; getObjectType() &#123; return BookDao.class; &#125;&#125; Springé…ç½®æ–‡ä»¶ä¸­ï¼š 1&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.factory.BookDaoFactoryBean&quot;/&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ å¹¶ä¸”BookDaoFactoryBeanç±»ä¸­å¯ä»¥é‡å†™isSinglentonæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829&lt;table&gt; &lt;th align=&quot;center&quot;&gt; &lt;td rowspan=&quot;2&quot;&gt;Key&lt;/td&gt; &lt;td colspan=&quot;2&quot;&gt;Value&lt;/td&gt; &lt;/th&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td&gt;field&lt;/td&gt; &lt;td&gt;value&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td rowspan=&quot;2&quot;&gt;REQUIRES_NEW&lt;/td&gt; &lt;td&gt;å¼€å¯T&lt;/td&gt; &lt;td&gt;æ–°å»ºT2&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td&gt;æ— &lt;/td&gt; &lt;td&gt;æ–°å»ºT2&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td rowspan=&quot;2&quot;&gt;SUPPORTS&lt;/td&gt; &lt;td&gt;å¼€å¯T&lt;/td&gt; &lt;td&gt;åŠ å…¥T&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td&gt;æ— &lt;/td&gt; &lt;td&gt;æ— &lt;/td&gt; &lt;/tr&gt;&lt;/table&gt; 8.beançš„ç”Ÿå‘½å‘¨æœŸ beanç”Ÿå‘½å‘¨æœŸï¼šbeanä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä½“è¿‡ç¨‹ beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ï¼šåœ¨beanåˆ›å»ºååˆ°é”€æ¯å‰åšä¸€äº›äº‹ åœ¨BookDaoImplç±»ä¸­ï¼Œåˆ›å»ºinitå’Œdestroyæ–¹æ³• 1234567891011121314public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125; public void init()&#123; System.out.println(&quot;init~~~&quot;); &#125; public void destroy()&#123; System.out.println(&quot;destroy~~~&quot;); &#125;&#125; åœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼š init-methodå’Œdestroy-methodå±æ€§ 12&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;/&gt; è°ƒç”¨ä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~ æ§åˆ¶å°å¹¶æ²¡æœ‰è¾“å‡ºdestroy~~~ï¼› å› ä¸ºé”€æ¯å‡½æ•°è¿˜æ²¡æœ‰æ¥å¾—åŠè°ƒç”¨ï¼Œç¨‹åºå°±è¢«æ€æ­»äº†ï¼› æ‰€ä»¥éœ€è¦è¿›è¡Œæ‰‹åŠ¨å…³é—­ï¼› æˆ‘ä»¬è°ƒç”¨ä¸»å‡½æ•°ä¸­çš„acä¸­çš„close()æ–¹æ³•ï¼Œä½†æ˜¯ApplicationContextæ¥å£ä¸­å¹¶æ²¡æœ‰æä¾›close()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ”¹ç”¨ClassPathXmlApplicationContextç±»ã€‚ 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.close(); &#125;&#125; 12345è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~destroy~~~ æˆåŠŸï¼ï¼ï¼ï¼ å®¹å™¨è¿˜æä¾›å¦å¤–ä¸€ç§æ–¹å¼å…³é—­å®¹å™¨ï¼šè®¾ç½®å…³é—­é’©å­ è°ƒç”¨acçš„registerShutdownHook()æ–¹æ³• 1234567891011public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~destroy~~~ close()å’ŒregisterShutdownHook()çš„åŒºåˆ« å°†registerShutdownHook()æ”¾åˆ°ä¸Šé¢ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); ac.registerShutdownHook(); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡ŒæˆåŠŸï¼šinit~~~BookDao~~~~~destroy~~~ å°†close()æ”¾åˆ°ä¸Šé¢ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); ac.close(); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123456è¿è¡Œç»“æœï¼šinit~~~destroy~~~æŠ¥é”™ï¼šBeanFactory not initialized or already closed - call &#x27;refresh&#x27; before accessing beans via the ApplicationContext BeanFactoryæ²¡æœ‰è¢«åˆå§‹åŒ–æˆ–è€…å·²ç»è¢«å…³é—­äº† è¿è¡Œå¤±è´¥ï¼ï¼ æˆ–è€…é€šè¿‡æ¥å£çš„æ–¹å¼å®ç°ï¼š BookServiceImplç±»å®ç°æ¥å£InitializingBeanå’ŒDisposableBeançš„æ–¹æ³• 1234567891011121314151617181920212223public class BookServiceImpl implements BookService, InitializingBean, DisposableBean &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125; public void save() &#123; bookDao.save(); &#125; @Override public void destroy() throws Exception &#123; System.out.println(&quot;service destroy~~~~&quot;); &#125; @Override public void afterPropertiesSet() throws Exception &#123; System.out.println(&quot;service init~~~~&quot;); &#125;&#125; é…ç½®æ–‡ä»¶ï¼š 123456&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt;&lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; ä¸»å‡½æ•°è¿è¡Œï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 1234567è¿è¡Œç»“æœï¼šinit~~~BookDao set~~~service init~~~~BookDao~~~~~service destroy~~~~destroy~~~ BookServiceImplç±»ä¸­destroy()æ–¹æ³•å’ŒafterPropertiesSet()æ–¹æ³•è¢«è°ƒç”¨ å¹¶ä¸”setBookDao()æ–¹æ³•ä¹‹åæ‰è°ƒç”¨çš„afterPropertiesSet()æ–¹æ³• 9.ä¾èµ–æ³¨å…¥æ–¹å¼å‘ä¸€ä¸ªç±»ä¼ é€’æ•°æ®çš„æ–¹å¼æœ‰ï¼šsetæ–¹æ³•ã€æ„é€ æ–¹æ³• 9.1 setteræ³¨å…¥ å¼•ç”¨ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„setæ–¹æ³• BookServiceImplç±»ä¸­ï¼š 1234567public class BookServiceImpl implements BookService &#123; private BookDao bookDao; //æä¾›ç›¸åº”çš„setçš„æ–¹æ³• public void setBookDao(BookDao bookDao) &#123; this.bookDao = bookDao; &#125;&#125; åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨propertyæ ‡ç­¾refå±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ 12345&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; ç®€å•ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„setæ–¹æ³• BookDaoImplç±»ä¸­ï¼š 1234567891011121314public class BookDaoImpl implements BookDao &#123; private String name; private int age; public void setName(String name) &#123; this.name = name; &#125; public void setAge(int age) &#123; this.age = age; &#125; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name+&quot;å¹´é¾„ï¼š&quot;+age); &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨propertyæ ‡ç­¾valueå±æ€§æ³¨å…¥ç®€å•ç±»å‹æ•°æ® 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;DaHuang&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;18&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šDaHuangå¹´é¾„ï¼š18 9.2 æ„é€ å™¨æ³¨å…¥ å¼•ç”¨ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„æ„é€ æ–¹æ³• 12345678public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public BookServiceImpl(BookDao bookDao) &#123; System.out.println(&quot;BookServiceImplæ„é€ å™¨è¿è¡Œ~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨constructor-argæ ‡ç­¾ä¸­çš„refå±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ 12345678&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;DaHuang&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;18&quot;/&gt; &lt;/bean&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;constructor-arg name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookServiceImplæ„é€ å™¨è¿è¡Œ~~~ ç®€å•ç±»å‹ BookDaoImplç±»ä¸­ï¼š 123456789public class BookDaoImpl implements BookDao &#123; private String name; private int age; public BookDaoImpl(String name, int age) &#123; this.name = name; this.age = age; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼š 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;constructor-arg name=&quot;name&quot; value=&quot;DaHei&quot;/&gt; &lt;constructor-arg name=&quot;age&quot; value=&quot;20&quot;/&gt;&lt;/bean&gt; å¦‚æœè¦æ›´æ”¹BookDaoImplç±»ä¸­çš„å½¢å‚åå­—ï¼Œè¿˜è¦æ›´æ”¹é…ç½®æ–‡ä»¶ä¸­çš„nameå±æ€§çš„åå­—ï¼› å­˜åœ¨å½¢å‚ä¸nameå±æ€§åä¸è€¦åˆçš„é—®é¢˜ã€‚ constructor-argæ ‡ç­¾è¿˜æœ‰typeå’Œindexå±æ€§ typeï¼šå½¢å‚çš„æ•°æ®ç±»å‹(å­˜åœ¨å¤šä¸ªåŒæ•°æ®ç±»å‹çš„å½¢å‚ï¼Œæ— æ³•ä½¿ç”¨) indexï¼šå½¢å‚çš„ä½ç½®é¡ºåº åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨indexå±æ€§è®¾ç½®æŒ‰å½¢å‚ä½ç½®é¡ºåºæ³¨å…¥ 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;constructor-arg index=&quot;0&quot; value=&quot;DaHei&quot;/&gt; &lt;constructor-arg index=&quot;1&quot; value=&quot;20&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šDaHeiå¹´é¾„ï¼š20 9.3 ä¾èµ–æ³¨å…¥æ–¹å¼çš„é€‰æ‹© å¼ºåˆ¶ä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥æœ‰æ¦‚ç‡ä¸æ³¨å…¥å¯¼è‡´nullå¯¹è±¡å‡ºç°ã€‚ beanå¿…é¡»è¦çš„ä¸œè¥¿ï¼Œè¦ç”¨æ„é€ å™¨æ³¨å…¥ã€‚å› ä¸ºæ„é€ å™¨å¿…é¡»è¢«æ‰§è¡Œï¼Œå¿…é¡»æ³¨å…¥ï¼Œå¦åˆ™æŠ¥é”™ è€Œsetteræ–¹æ³•å¯ä»¥æ‰§è¡Œä¹Ÿå¯ä»¥ä¸æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œsetteræ³¨å…¥ï¼Œä¼šå¯¼è‡´nullå¯¹è±¡ å¯é€‰ä¾èµ–ä½¿ç”¨setteræ³¨å…¥è¿›è¡Œï¼Œçµæ´»æ€§å¼ºã€‚ setteræ³¨å…¥å¯ä»¥æ‰§è¡Œä¹Ÿå¯ä»¥ä¸æ‰§è¡Œ Springæ¡†æ¶å€¡å¯¼ä½¿ç”¨æ„é€ å™¨ã€‚ ç¬¬ä¸‰æ–¹æ¡†æ¶å¤§å¤šé‡‡ç”¨æ„é€ å™¨æ³¨å…¥çš„å½¢å¼åˆå§‹åŒ–æ•°æ®ï¼Œæ›´åŠ ä¸¥è°¨ setteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥å¯ä»¥åŒæ—¶ä½¿ç”¨ã€‚ ä½¿ç”¨æ„é€ å™¨å®Œæˆå¼ºåˆ¶ä¾èµ–æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥å®Œæˆå¯é€‰ä¾èµ–æ³¨å…¥ è‡ªå·±å¼€å‘çš„æ¨¡å—æ¨èä½¿ç”¨setteræ³¨å…¥ 10.ä¾èµ–è‡ªåŠ¨è£…é…IOCå®¹å™¨æ ¹æ®beanéƒ½ä¾èµ–çš„èµ„æºåœ¨å®¹å™¨ä¸­è‡ªåŠ¨æŸ¥æ‰¾å¹¶æ³¨å…¥åˆ°beanä¸­çš„è¿‡ç¨‹ç§°ä¸ºè‡ªåŠ¨è£…é… è‡ªåŠ¨è£…é…çš„æ–¹å¼ï¼š æŒ‰ç±»å‹(å¸¸ç”¨) æŒ‰åç§° æŒ‰æ„é€ æ–¹æ³•(ä¸æ¨è) ä¸å¯ç”¨è‡ªåŠ¨è£…é… 10.1 æŒ‰ç±»å‹éœ€è¦æä¾›ç›¸åº”çš„setteræ–¹æ³• 123456789public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œè¦æå‰å†™å¥½bookDaoçš„beanå¦åˆ™æ— æ³•è£…é…ï¼Œ autowireå±æ€§è®¾ç½®ä¸ºbyTpye é€šè¿‡ç±»å‹è‡ªåŠ¨è£…é… 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;byType&quot; /&gt; ä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookService bookService = (BookService) ac.getBean(&quot;bookService&quot;); bookService.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao set~~~ å¦‚æœå‡ºç°ä¸€ä¸‹è¿™ç§æƒ…å†µï¼š 12345&lt;bean id=&quot;bookDao1&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookDao2&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;byType&quot; /&gt; å‡ºç°äº†ä¸¤ä¸ªBookDaoçš„beanï¼Œå¯¼è‡´Springæ— æ³•åŒºåˆ†äº†ï¼Œè¿™æ—¶å°±éœ€è¦æŒ‰åç§°è£…é… 10.2 æŒ‰åç§°123456789public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œautowireå±æ€§è®¾ç½®ä¸ºbyName é€šè¿‡åç§°è‡ªåŠ¨è£…é… æ˜¯é€šè¿‡BookServiceImplç±»çš„å˜é‡åbookDaoä¸é…ç½®æ–‡ä»¶çš„beanä¸­idç›¸åŒåç§°çš„è¿›è¡Œç»‘å®š 12345&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookDao2&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;ByName&quot; /&gt; 10.3 æ€»ç»“ è‡ªåŠ¨è£…é…ç”¨äºå¼•ç”¨ç±»å‹ä¾èµ–æ³¨å…¥ï¼Œä¸èƒ½å¯¹ç®€å•ç±»å‹è¿›è¡Œæ“ä½œ ä½¿ç”¨æŒ‰ç±»å‹è£…é…byTypeï¼Œå¿…é¡»ä¿éšœå®¹å™¨ä¸­ç›¸åŒç±»å‹çš„beanå”¯ä¸€ï¼Œæ¨èä½¿ç”¨ ä½¿ç”¨æŒ‰åç§°è£…é…byNameï¼Œå¿…é¡»ä¿éšœå®¹å™¨ä¸­å…·æœ‰æŒ‡å®šåç§°çš„beanï¼Œå˜é‡åè¦ä¸é…ç½®è€¦åˆï¼Œ ä¸æ¨èä½¿ç”¨ è‡ªåŠ¨è£…é…ä¼˜å…ˆçº§ä½äºsetteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥ï¼ŒåŒæ—¶å‡ºç°æ—¶è‡ªåŠ¨è£…é…é…ç½®å¤±æ•ˆ 11.é›†åˆæ³¨å…¥123456789101112131415161718192021222324252627public class BookDaoImpl implements BookDao &#123; private int[] array; private List&lt;String&gt; list; private Set&lt;String&gt; set; private Map&lt;String, String&gt; map; private Properties properties; public void setArray(int[] array) &#123;this.array = array;&#125; public void setList(List&lt;String&gt; list) &#123;this.list = list;&#125; public void setSet(Set&lt;String&gt; set) &#123;this.set = set;&#125; public void setMap(Map&lt;String, String&gt; map) &#123;this.map = map;&#125; public void setProperties(Properties properties) &#123;this.properties = properties;&#125; public void save() &#123; System.out.println(&quot;BookDaoImpl&#123;&quot; + &quot;\\narray=&quot; + Arrays.toString(array) + &quot;, \\nlist=&quot; + list + &quot;, \\nset=&quot; + set + &quot;, \\nmap=&quot; + map + &quot;, \\nproperties=&quot; + properties + &#x27;&#125;&#x27;); &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;array&quot; &gt; &lt;array&gt; &lt;value&gt;100&lt;/value&gt; &lt;value&gt;200&lt;/value&gt; &lt;value&gt;300&lt;/value&gt; &lt;/array&gt; &lt;/property&gt; &lt;property name=&quot;list&quot; &gt; &lt;list&gt; &lt;value&gt;å”±&lt;/value&gt; &lt;value&gt;è·³&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;property name=&quot;set&quot; &gt; &lt;set&gt; &lt;value&gt;å”±&lt;/value&gt; &lt;value&gt;è·³&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;/set&gt; &lt;/property&gt; &lt;property name=&quot;map&quot; &gt; &lt;map&gt; &lt;entry key=&quot;county&quot; value=&quot;china&quot;/&gt; &lt;entry key=&quot;province&quot; value=&quot;tianjin&quot;/&gt; &lt;entry key=&quot;city&quot; value=&quot;baodi&quot;/&gt; &lt;/map&gt; &lt;/property&gt; &lt;property name=&quot;properties&quot;&gt; &lt;props&gt; &lt;prop key=&quot;county&quot;&gt;china&lt;/prop&gt; &lt;prop key=&quot;province&quot;&gt;tianjin&lt;/prop&gt; &lt;prop key=&quot;city&quot;&gt;baodi&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234567è¿è¡Œç»“æœï¼šBookDaoImpl&#123;array=[100, 200, 300], list=[å”±, è·³, Rap], set=[å”±, è·³, Rap], map=&#123;county=china, province=tianjin, city=baodi&#125;, properties=&#123;province=tianjin, city=baodi, county=china&#125;&#125; 12.æ•°æ®æºå¯¹è±¡ç®¡ç†åœ¨pom.xmlå¯¼å…¥druidåæ ‡ 12345678910&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.2.8&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.28&lt;/version&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ä¸­ï¼Œç®¡ç†DruidDataSouurceå¯¹è±¡ 123456&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/demo&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); DataSource dataSource = (DataSource) ac.getBean(&quot;dataSource&quot;); System.out.println(dataSource); &#125;&#125; 123456789101112è¿è¡Œç»“æœï¼š&#123; CreateTime:&quot;2022-06-24 22:27:03&quot;, ActiveCount:0, PoolingCount:0, CreateCount:0, DestroyCount:0, CloseCount:0, ConnectCount:0, Connections:[ ]&#125; 13.åŠ è½½propertiesé…ç½®ä¿¡æ¯åœ¨rescourceèµ„æºåŒ…ä¸­åˆ›å»ºjdbc.propertiesæ–‡ä»¶ï¼š 1234567jdbc.driver=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://localhost:3306/demojdbc.username=rootjdbc.password=123456username=dahuangage=18 é…ç½®æ–‡ä»¶ä¸­: åœ¨beansæ ‡ç­¾ä¸­å¼€å¯contextå‘½åç©ºé—´ ä½¿ç”¨contextç©ºé—´åŠ è½½propertiesæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- 1.å¼€å¯contextå‘½åç©ºé—´ --&gt; &lt;!-- 2.ä½¿ç”¨contextç©ºé—´åŠ è½½propertiesæ–‡ä»¶ --&gt; &lt;context:property-placeholder location=&quot;jdbc.properties&quot; system-properties-mode=&quot;NEVER&quot;/&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;!-- ä½¿ç”¨å ä½ç¬¦$&#123;&#125;è¯»å–propertiesä¸­çš„å±æ€§ --&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;$&#123;username&#125;&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;$&#123;age&#125;&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; åŠ è½½propertiesæ–‡ä»¶æ ¼å¼ï¼š ä¸åŠ è½½ç³»ç»Ÿå±æ€§ï¼š 12&lt;context:property-placeholder location=&quot;jdbc.properties&quot; system-properties-mode=&quot;NEVER&quot;/&gt; åŠ è½½å¤šä¸ªpropertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;jdbc.properties, jdbc2.properties&quot;/&gt; åŠ è½½æ‰€æœ‰propertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;*.properties&quot;/&gt; åŠ è½½propertiesæ–‡ä»¶æ ‡å‡†æ ¼å¼ï¼š 1&lt;context:property-placeholder location=&quot;classpath:*.properties&quot;/&gt; ä»ç±»è·¯å¾„æˆ–jaråŒ…ä¸­æœç´¢åŠ è½½propertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;classpath*:*.properties&quot;/&gt; 14.å®¹å™¨14.1 åˆ›å»ºå®¹å™¨çš„å‡ ç§æ–¹å¼ ç±»è·¯å¾„ä¸‹çš„åŠ è½½é…ç½®æ–‡ä»¶ 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); æ–‡ä»¶ç³»ç»Ÿä¸‹åŠ è½½çš„é…ç½®æ–‡ä»¶ 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;E:\\Java_Web\\Spring\\spring_01_IOC\\src\\main\\resources\\applicationContext.xml&quot;); åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ï¼š 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext1.xml&quot;,&quot;applicationContext2.xml&quot;); 14.2 è·å–beançš„å‡ ç§æ–¹å¼ ä½¿ç”¨beanåç§°è·å– 1BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); ä½¿ç”¨beanåç§°è·å–å¹¶æŒ‡å®šç±»å‹ 1BookDao bookDao = ac.getBean(&quot;bookDao&quot;,BookDao.class); ä½¿ç”¨beanç±»å‹è·å– 1BookDao bookDao = ac.getBean(BookDao.class);//å¯¹åº”çš„å®¹å™¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªè¯¥ç±»å‹ï¼Œå”¯ä¸€ 14.3 å®¹å™¨ç±»å±‚æ¬¡ç»“æ„ä½¿ç”¨ctrl+Hæ‰“å¼€å®¹å™¨ç±»çš„å±‚æ¬¡ç»“æ„å›¾ï¼š BeanFactoryï¼šæ˜¯IOCå®¹å™¨çš„é¡¶å±‚æ¥å£ï¼Œåˆå§‹åŒ–BeanFactoryå¯¹è±¡æ—¶ï¼ŒåŠ è½½çš„beanå»¶è¿ŸåŠ è½½ ApplicationContextï¼šæ˜¯Springå®¹å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œåˆå§‹åŒ–æ—¶beanç«‹å³åŠ è½½ â€‹ æä¾›åŸºç¡€çš„beanæ“ä½œç›¸å…³çš„æ–¹æ³•ï¼Œé€šè¿‡å…¶ä»–æ¥å£æ‰©å±•å…¶åŠŸèƒ½ ConfigurableApplicationContextï¼šæä¾›å…³é—­å®¹å™¨åŠŸèƒ½ ClassPathXmlApplicationContextï¼šå¸¸ç”¨å®ç°ç±» 14.4 BeanFactoryåˆå§‹åŒ–ç±»è·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; Rescoure rescoure = new ClassPathRescoure(&quot;applicationContext.xml&quot;); BeanFactory bf = new XmlBeanFactory(rescoure); BookDao bookDao = bf.getBean(&quot;bookDao&quot;,BookDao.class); bookDao.save(); &#125;&#125; BeanFactoryåˆ›å»ºå®Œæ¯•åï¼Œæ‰€æœ‰beanå‡ä¸ºå»¶è¿ŸåŠ è½½ 15.æ³¨è§£å¼€å‘*15.1 ç”¨æ³¨é‡Šå®šä¹‰bean123456@component(&quot;bookDao&quot;) //ç­‰ä»·äº&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125;&#125; 123456@Component //æ²¡æœ‰å†™beanåï¼Œè¦é€šè¿‡ç±»å‹è·å–beanpublic class BookServiceImpl implements BookService &#123; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); &#125;&#125; ä½†æ˜¯ï¼ŒSpringæ€ä¹ˆæ„ŸçŸ¥åˆ°æ³¨é‡Šå‘¢ï¼Ÿ é…ç½®æ–‡ä»¶ä¸­ï¼Œéœ€è¦æ·»åŠ æ‰«æç»„ä»¶ï¼š 123456789101112&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- æ‰«æ@componentç»„ä»¶ --&gt; &lt;!-- base-packageä¸ºæ‰«æçš„ä½ç½® --&gt; &lt;context:component-scan base-package=&quot;com.spring&quot;/&gt;&lt;/beans&gt; ä¸»å‡½æ•°ï¼š 123456789101112public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); //å› ä¸º@componentï¼Œå¹¶æ²¡æœ‰å†™beanåï¼Œæ‰€ä»¥è¦ç”¨ç±»å‹è·å–bean BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDao~~~~~BookService~~~~ Springæä¾›@componentæ³¨è§£çš„ä¸‰ä¸ªè¡ç”Ÿæ³¨è§£ @Repositoryï¼šç”¨äºæ•°æ®å±‚beanå®šä¹‰(Daoå±‚) â€‹ ä¹Ÿå¯ä»¥åŠ æ‹¬å·æ¥æŒ‡å®šbeanåï¼Œå¦‚ï¼š@Repository(â€œbookDao2â€) @Serviceï¼šç”¨äºä¸šåŠ¡å±‚beanå®šä¹‰(Serviceå±‚) @Controllerï¼šç”¨äºè¡¨ç°å±‚beanå®šä¹‰(Controllerå±‚) @Service,@Repositoryä¸èƒ½å†™åœ¨æ¥å£ä¸Š,éœ€è¦å†™åœ¨æ¥å£çš„å®ç°ç±»ä¸Š 1234@Repositorypublic class BookDaoImpl implements BookDao &#123; &#125; 1234@Servicepublic class BookServiceImpl implements BookService &#123;&#125; 1234@Controllerpublic class BookController &#123;&#125; 15.2 çº¯æ³¨é‡Šå¼€å‘æ–°å»ºä¸€ä¸ªSpringConfigç±»ï¼Œç”¨æ¥æ›¿ä»£é…ç½®æ–‡ä»¶ã€‚ å…¶ä½ç½®ï¼šcom.spring.config.SpringConfig.java comåŒ… springåŒ… configåŒ… SpringConfig.java @Configuration ï¼šç”¨äºè®¾å®šå½“å‰ç±»ä¸ºé…ç½®ç±»@ComponentScan(&quot;com.spring&quot;) ï¼šç”¨ç”¨äºè®¾å®šæ‰«æè·¯å¾„ï¼Œæ­¤æ³¨é‡Šåªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®ç”¨æ•°ç»„æ ¼å¼ 123456//ç”¨æ¥æ›¿ä»£ &lt;context:component-scan base-package=&quot;com.spring&quot;/&gt;@Configuration //ç”¨äºè®¾å®šå½“å‰ç±»ä¸ºé…ç½®ç±»@ComponentScan(&quot;com.spring&quot;) //ç”¨ç”¨äºè®¾å®šæ‰«æè·¯å¾„ï¼Œæ­¤æ³¨é‡Šåªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®ç”¨æ•°ç»„æ ¼å¼public class SpringConfig &#123; &#125; ä¸»å‡½æ•°ï¼š 1234567891011public class AppForAnnotation &#123; public static void main(String[] args) &#123; //æ”¹ç”¨æ³¨é‡Šé…ç½®åˆå§‹åŒ–å®¹å™¨ ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.save(); BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDao~~~~~BookService~~~~ 15.3 beanç®¡ç† ä½œç”¨èŒƒå›´ @Scope(&quot;singleton&quot;)ï¼šå•ä¾‹ï¼Œé»˜è®¤å•ä¾‹ @Scope(&quot;prototype&quot;)ï¼šå¤šä¾‹ beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ @PostConstructæ³¨è§£ï¼šinit @PreDestroyæ³¨è§£ï¼šdestory 123456789101112@Repository@Scope(&quot;prototype&quot;) //å¤šä¾‹public class BookDaoImpl implements BookDao &#123; @PostConstruct public void init()&#123; System.out.println(&quot;init~~~&quot;); &#125; @PreDestroy public void destroy()&#123; System.out.println(&quot;destroy~~~&quot;); &#125;&#125; 15.4 ä¾èµ–æ³¨å…¥1.å¼•ç”¨ç±»å‹ 1234567891011@Servicepublic class BookServiceImpl implements BookService &#123; @Autowired private BookDao bookDao; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); bookDao.save(); &#125;&#125; ä¸»å‡½æ•°ï¼š 12345678public class AppForAnnotation &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookService~~~~ //åœ¨åˆ›å»ºå¥½BookServiceçš„bean,å¹¶æ³¨å…¥BookDaoBookDao~~~~~ //è°ƒç”¨BookDaoçš„æ–¹æ³•save(); 123@Repository(&quot;bookDao&quot;)public class BookDaoImpl implements BookDao &#123;&#125; 123@Repository(&quot;bookDao2&quot;)public class BookDaoImpl2 implements BookDao &#123;&#125; å½“æœ‰å¤šä¸ªåŒç±»å‹çš„beanï¼Œä½¿ç”¨@Qualifier(&quot;bookDao2&quot;)æ¥æŒ‡å®šbeanå å¹¶ä¸”éœ€è¦@Autowiredå’Œ@Qualifier(&quot;bookDao2&quot;)ä¸€èµ·ä½¿ç”¨ 1234567891011@Servicepublic class BookServiceImpl implements BookService &#123; @Autowired @Qualifier(&quot;bookDao2&quot;) private BookDao bookDao; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); bookDao.save(); &#125;&#125; æ³¨æ„ï¼š è‡ªåŠ¨è£…é…åŸºäºåå°„è®¾è®¡åˆ›å»ºå¯¹è±¡å¹¶æš´åŠ›åå°„å¯¹åº”å±æ€§ä¸ºç§æœ‰å±æ€§åˆå§‹åŒ–æ•°æ®ï¼Œæ— éœ€æä¾›setteræ–¹æ³• è‡ªåŠ¨è£…é…å»ºè®®ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œå¦‚æœä¸æä¾›å¯¹åº”çš„æ„é€ æ–¹æ³•ï¼Œè¯·æä¾›å”¯ä¸€çš„æ„é€ æ–¹æ³• @Qualifieræ³¨è§£æ— æ³•å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»é…åˆ@Autowiredæ³¨è§£ä½¿ç”¨ 2.ç®€å•ç±»å‹ 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Value(&quot;dahuang&quot;) private String name; public void save()&#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name); &#125;&#125; ä¸»å‡½æ•°ï¼š 1234567public class AppForAnnotation &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šdahaung ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç›´æ¥èµ‹å€¼ï¼Œä¸ºä»€ä¹ˆè¦ç”¨@Valueæ³¨è§£å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥ç”¨propertiesæ–‡ä»¶ï¼Œå‘å…¶ä¼ å€¼ã€‚ 3.è¯»å–propertiesæ–‡ä»¶ é€šè¿‡åˆ›å»ºä¸€ä¸ªjdbc.propertiesæ–‡ä»¶ï¼š 1name=dahei åœ¨é…ç½®ç±»ä¸­æ–°åŠ æ³¨è§£@PropertySource()ï¼Œæ‹¬å·ä¸­æŒ‡å®šæ–‡ä»¶åï¼š å¦‚ï¼š@PropertySource(&quot;jdbc.properties&quot;)æˆ–è€…@PropertySource(&quot;classpath:jdbc.properties&quot;) ä¹Ÿå¯ä»¥æŒ‡å®šå¤šä¸ªæ–‡ä»¶ï¼š å¦‚ï¼š@PropertySource(&#123;&quot;jdbc.properties&quot;,&quot;jdbc1.properties&quot;,&quot;jdbc2.properties&quot;&#125;) 12345@Configuration@ComponentScan(&quot;com.spring&quot;)@PropertySource(&quot;jdbc.properties&quot;)public class SpringConfig &#123;&#125; åœ¨BookDaoImplä¸­å°†æ³¨è§£æ”¹ä¸ºï¼š@Value(&quot;$&#123;&#125;&quot;)ï¼Œåœ¨&#123;&#125;ä¸­å¡«å…¥propertiesæ–‡ä»¶ä¸­çš„å±æ€§ å¦‚ï¼š@Value(&quot;$&#123;name&#125;&quot;) 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Value(&quot;$&#123;name&#125;&quot;) private String name; public void save()&#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name); &#125;&#125; 15.5 ç¬¬ä¸‰æ–¹beanç®¡ç†1.ä½¿ç”¨ç‹¬ç«‹çš„é…ç½®ç®¡ç†ç¬¬ä¸‰æ–¹bean 1234567891011121314@Configurationpublic class SpringConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DruidDataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.getUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; ä½†æ˜¯ä¸å»ºè®®å°†ç‹¬ç«‹é…ç½®ç›´æ¥å†™åœ¨æ ¸å¿ƒé…ç½®ç±»ä¸­ï¼š æ–¹æ³•ä¸€ï¼šå¯¼å…¥å¼(å»ºè®®ä½¿ç”¨) åœ¨configåŒ…åˆ›å»ºä¸€ä¸ªJdbcConfig.javaé…ç½®ç±»ï¼š 12345678910111213public class JdbcConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DruidDataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.setUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; åœ¨SpringConfig.javaæ ¸å¿ƒé…ç½®ç±»ä¸­å¯¼å…¥ï¼š ä½¿ç”¨æ³¨è§£@Import()åœ¨æ‹¬å·ä¸­æ·»åŠ è¦å¯¼å…¥çš„é…ç½®ç±»çš„ç±»å‹ å¦‚ï¼š@Import(JdbcConfig.class) æ­¤æ³¨è§£åªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¯¼å…¥å¤šä¸ªé…ç½®ç±»ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ ¼å¼å¯¼å…¥ å¦‚ï¼š@Import(&#123;JdbcConfig.class, XXXConfig.class, XXXConfig.calss&#125;) 12345@Configuration@Import(JdbcConfig.class) //å¯¼å…¥JdbcConfigpeipublic class SpringConfig &#123; &#125; æ–¹å¼äºŒï¼šæ‰«æå¼(ä¸å»ºè®®ä½¿ç”¨) æ³¨æ„ï¼šä½¿ç”¨æ‰«æå¼éœ€è¦åœ¨ç‹¬ç«‹çš„é…ç½®ç±»åŠ å…¥æ³¨è§£@Configuration 1234567891011121314@Configurationpublic class JdbcConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.setUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; åœ¨SpringConfig.javaæ ¸å¿ƒé…ç½®ç±»ä¸­æ‰«æï¼š ä½¿ç”¨æ³¨è§£@ComponentScan()åœ¨æ‹¬å·ä¸­æ·»åŠ è¦æ‰«æçš„è·¯å¾„ å¦‚ï¼š@@ComponentScan(&quot;com.spring.config&quot;) æ‰«æå¤šä¸ªè·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ ¼å¼å¯¼å…¥ å¦‚ï¼š@Import(&#123;&quot;com.spring.config&quot;,&quot;com.spring.dao&quot;&#125;) 12345@Configuration@ComponentScan(&quot;com.spring.config&quot;)public class SpringConfig &#123; &#125; 2.ç¬¬ä¸‰æ–¹beanæ³¨å…¥èµ„æº ç®€å•ç±»å‹ä¾èµ–æ³¨å…¥(æˆå‘˜å˜é‡)ï¼š åˆ©ç”¨æ³¨è§£@PropertySource(&quot;jdbc.properties&quot;)å’Œ@Import(JdbcConfig.class)å¯¼å…¥æ ¸å¿ƒä¸»é…ç½®æ–‡ä»¶ä¸­ 123456@Configuration@ComponentScan(&quot;com.spring&quot;)@PropertySource(&quot;jdbc.properties&quot;)@Import(JdbcConfig.class)public class SpringConfig &#123;&#125; åˆ©ç”¨æ³¨è§£@Value(&quot;$&#123;&#125;&quot;)æ³¨å…¥æ•°æ® 12345678910111213141516171819202122public class JdbcConfig &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String userName; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); ds.setDriverClassName(driver); ds.setUrl(url); ds.setUsername(userName); ds.setPassword(password); return ds; &#125;&#125; å¼•å…¥ç±»å‹ä¾èµ–æ³¨å…¥(æ–¹æ³•å½¢å‚)ï¼š å¼•ç”¨ç±»å‹æ³¨å…¥åªéœ€è¦ä¸ºbeanå®šä¹‰çš„æ–¹æ³•è®¾ç½®å½¢å‚ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…å¯¹è±¡ 123456789//å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource(BookDao bookDao)&#123; System.out.println(&quot;å·²å¼•ç”¨ï¼š&quot;+bookDao); DruidDataSource ds = new DruidDataSource(); //å¯¹dsè¿›è¡Œç›¸å…³è®¾ç½® return ds; &#125; 15.6 æ€»ç»“XMLé…ç½®ä¸æ³¨è§£é…ç½®çš„æ¯”è¾ƒï¼š åŠŸèƒ½ XMLé…ç½® æ³¨è§£ å®šä¹‰bean beanæ ‡ç­¾ï¼š&gt;idå±æ€§&gt;classå±æ€§ @Component &gt;@Controller &gt;@Service &gt;@Repository@ComponentScan è®¾ç½®ä¾èµ–æ³¨å…¥ setteræ³¨å…¥(setæ–¹æ³•)&gt;å¼•ç”¨&#x2F;ç®€å•æ„é€ å™¨æ³¨å…¥(æ„é€ æ–¹æ³•)&gt;è‡ªåŠ¨è£…é… @Autowird&gt;@Qualifier@Value é…ç½®ç¬¬ä¸‰æ–¹bean beanæ ‡ç­¾&gt;é™æ€å·¥å‚&gt;å®ä¾‹å·¥å‚&gt;FactoryBean @Bean ä½œç”¨èŒƒå›´ scopeå±æ€§ @Scope ç”Ÿå‘½å‘¨æœŸ æ ‡å‡†æ¥å£&gt;init-method&gt;destory-method @PostConstructor@PreDestroy 16.AOP16.1 AOPç®€ä»‹ AOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼ŒæŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ç»„ç»‡ç¨‹åºç»“æ„ OOP(Object Oriented Programing)é¢å‘å¯¹è±¡ç¼–ç¨‹ ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºå…¶è¿›è¡ŒåŠŸèƒ½å¢å¼º Springç†å¿µï¼šæ— å…¥ä¾µå¼&#x2F;æ— ä¾µå…¥å¼ æ‰§è¡Œsave()æ–¹æ³• è¿è¡Œç»“æœï¼š æ‰“å°å‡ºä¸€ä¸‡æ¬¡çš„book dao save â€¦ å’Œæ¶ˆè€—çš„æ—¶é—´ æ‰§è¡Œupdate()æ–¹æ³•æ²¡æœ‰å›¾ä¸­è“è‰²åŒºåŸŸçš„ä»£ç ï¼Œ ä½†æ˜¯ï¼Œè¿è¡Œç»“æœï¼š ä»ä¼šæ‰“å°æ‰“å°å‡ºä¸€ä¸‡æ¬¡çš„book dao update â€¦ å’Œæ¶ˆè€—çš„æ—¶é—´ è¿æ¥ç‚¹(JoinPoint)ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»æ„ä½ç½®ï¼Œç²’åº¦ä¸ºæ‰§è¡Œæ–¹æ³•ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè®¾ç½®å˜é‡ç­‰(ä»£è¡¨æ‰€æœ‰çš„æ–¹æ³•) åœ¨SpringAOPä¸­ï¼Œç†è§£æ–¹æ³•çš„æ‰§è¡Œ åˆ‡å…¥ç‚¹(Pointcut)ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­(ä»£è¡¨è¦è¿½åŠ åŠŸèƒ½çš„æ–¹æ³•) åœ¨SpringAOPä¸­ï¼Œä¸€ä¸ªåˆ‡å…¥ç‚¹åªæè¿°ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åŒ¹é…å¤šä¸ªæ–¹æ³• ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼šcom.spring.daoåŒ…ä¸‹çš„BookDaoæ¥å£ä¸­çš„äº”æ˜Ÿå‚æ— è¿”å›å€¼çš„save()æ–¹æ³• åŒ¹é…å¤šä¸ªæ–¹æ³•ï¼šæ‰€æœ‰saveæ–¹æ³•ï¼Œæ‰€æœ‰çš„getå¼€å¤´çš„æ–¹æ³•ï¼Œæ‰€æœ‰ä»¥Daoç»“å°¾çš„æ¥å£ä¸­çš„ä»»æ„æ–¹æ³•ï¼Œæ‰€æœ‰å¸¦æœ‰ä¸€ä¸ªå½¢å‚çš„æ–¹æ³• é€šçŸ¥(Advice)ï¼šåœ¨åˆ‡å…¥ç‚¹æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½(ä»£è¡¨è¿½åŠ çš„åŠŸèƒ½) åœ¨SpringAOPä¸­ï¼ŒåŠŸèƒ½æœ€ç»ˆä»¥æ–¹æ³•çš„å½¢å¼å‘ˆç° é€šçŸ¥ç±»ï¼šå®šä¹‰é€šçŸ¥çš„ç±» åˆ‡é¢(Aspect)ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥çš„å¯¹åº”å…³ç³» 16.2 AOPå…¥é—¨ æ¡ˆä¾‹è®¾å®šï¼šæµ‹è¯•æ¥å£æ‰§è¡Œæ•ˆç‡ ç®€åŒ–è®¾å®šï¼šåœ¨æ¥å£æ‰§è¡Œå½“å‰è¾“å‡ºå½“å‰çš„ç³»ç»Ÿæ—¶é—´ å¼€å‘æ¨¡å¼ï¼šXML or æ³¨è§£(æ­¤å…¥é—¨æ¡ˆä¾‹é‡‡ç”¨æ³¨è§£çš„æ–¹å¼) æ€è·¯åˆ†æï¼š å¯¼å…¥åæ ‡(pom.xml) åˆ¶ä½œè¿æ¥ç‚¹æ–¹æ³•(åŸå§‹æ“ä½œï¼ŒDaoæ¥å£ä¸å®ç°ç±») åˆ¶ä½œå…±æ€§åŠŸèƒ½(é€šçŸ¥ç±»ä¸é€šçŸ¥) å®šä¹‰åˆ‡å…¥ç‚¹ ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»(åˆ‡é¢) pom.xmlï¼š 1234567891011&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.3.18&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.9.9.1&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºä¸€ä¸ªMyAdivice.javaç±» å…¶ä½ç½®ï¼šcom.spring.aop.MyAdivice.java @Componentæ³¨è§£ï¼šå®šä¹‰ä¸ºSpringåŠ è½½çš„bean @Aspectæ³¨è§£ï¼šæŠŠå½“å‰ç±»æ ‡è¯†ä¸ºâ¼€ä¸ªåˆ‡â¾¯ä¾›å®¹å™¨è¯»å– @Pointcut(&quot;execution()&quot;)æ³¨è§£ï¼šå®šä¹‰åˆ‡å…¥ç‚¹ï¼Œâ½…æ³•ç­¾åå¿…é¡»æ˜¯publicåŠvoidå‹ã€‚ @Before(&quot;pt()&quot;)æ³¨è§£ï¼šæ ‡è¯†â¼€ä¸ªå‰ç½®å¢å¼ºâ½…æ³• åˆ‡å…¥ç‚¹pt()çš„å®šä¹‰ä¾æ‰˜ä¸€ä¸ªä¸å…·æœ‰å®é™…æ„ä¹‰çš„æ–¹æ³•è¿›è¡Œï¼Œå³æ— å‚æ•°ã€æ— è¿”å›å€¼ã€æ–¹æ³•æ— å®é™…é€»è¾‘ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(System.currentTimeMillis()); &#125;&#125; @EnableAspectJAutoProxyæ³¨è§£ï¼šå¼€å¯AOPä»£ç†è‡ªåŠ¨é…ç½® 123456@Configuration@ComponentScan(&quot;com.spring&quot;)@EnableAspectJAutoProxypublic class SpringConfig &#123;&#125; ä¸»å‡½æ•°ï¼š 1234567public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.update(); &#125;&#125; 123è¿è¡Œç»“æœï¼š1656341601464book dao update~~~ 16.3 AOPå·¥ä½œæµç¨‹ Springå®¹å™¨å¯åŠ¨ è¯»å–æ‰€æœ‰åˆ‡é¢é…ç½®ä¸­çš„åˆ‡å…¥ç‚¹ åˆå§‹åŒ–beanï¼Œåˆ¤å®šbeanå¯¹åº”çš„ç±»ä¸­çš„æ–¹æ³•æ˜¯å¦åŒ¹é…åˆ°ä»»æ„åˆ‡å…¥ç‚¹ åŒ¹é…å¤±è´¥ï¼Œåˆ›å»ºå¯¹è±¡ è·å–beanï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ åŒ¹é…æˆåŠŸï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ è·å–çš„beanæ˜¯ä»£ç†å¯¹è±¡æ—¶ï¼Œæ ¹æ®ä»£ç†å¯¹è±¡çš„è¿è¡Œæ¨¡å¼è¿è¡ŒåŸå§‹æ–¹æ³•ä¸å¢å¼ºå†…å®¹ï¼Œå®Œæˆæ“ä½œ AOPæ ¸å¿ƒæœ¬è´¨ï¼šä»£ç†æ¨¡å¼ ç›®æ ‡å¯¹è±¡(Target)ï¼šåŸå§‹åŠŸèƒ½å»æ‰å…±æ€§åŠŸèƒ½å¯¹åº”çš„ç±»äº§ç”Ÿçš„å¯¹è±¡ï¼Œè¿™ç§å¯¹è±¡æ˜¯æ— æ³•ç›´æ¥å®Œæˆæœ€ç»ˆå·¥ä½œçš„ ä»£ç†(proxy)ï¼šç›®æ ‡å¯¹è±¡æ— æ³•ç›´æ¥å®Œæˆå·¥ä½œï¼Œéœ€è¦è¿›è¡ŒåŠŸèƒ½å›å¡«ï¼Œé€šè¿‡åŸå§‹å¯¹è±¡çš„ä»£ç†å¯¹è±¡å®ç° ä»£ç ä¾æ—§æ˜¯å…¥é—¨æ¡ˆä¾‹çš„ ä½†æ˜¯å°†ä¸»å‡½æ•°ä¿®æ”¹ï¼Œæ‰“å°bookDaoçš„ç±»å‹ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); System.out.println(bookDao); System.out.println(bookDao.getClass()); &#125;&#125; 123è¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@d23e042class jdk.proxy2.$Proxy20 System.out.println(bookDao)æ‰“å°å‡ºcom.spring.dao.impl.BookDaoImpl@d23e042 æ˜¯å› ä¸ºAOPå¯¹BookDaoçš„toString()æ–¹æ³•è¿›è¡Œäº†é‡å†™ class jdk.proxy2.$Proxy20ï¼šæœ€ç»ˆç”¨çš„æ˜¯ä»£ç†çš„å¯¹è±¡ 16.4 AOPåˆ‡å…¥ç‚¹è¡¨è¾¾å¼åˆ‡å…¥ç‚¹ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³• åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³•çš„æè¿°æ–¹æ³• 1.è¯­æ³•æ ¼å¼ åˆ‡å…¥ç‚¹æ ‡å‡†æ ¼å¼ï¼šåŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.æ¥å£/ç±»å.æ–¹æ³•(å‚æ•°) å¼‚å¸¸å) 12execution(public User com.spring.service.UserService.findById(int))execution(public User com.spring.service.impl.UserServiceImpl.findById(int)) åŠ¨ä½œå…³é”®å­—ï¼šæè¿°åˆ‡å…¥ç‚¹è¡Œä¸ºåŠ¨ä½œï¼Œå¦‚executionè¡¨ç¤ºæ‰§è¡Œåˆ°æŒ‡å®šåˆ‡å…¥ç‚¹ è®¿é—®ä¿®é¥°ç¬¦ï¼špublicï¼Œprivateç­‰ï¼Œå¯ä»¥çœç•¥ è¿”å›å€¼ åŒ…å æ¥å£&#x2F;ç±»åï¼šæ¥å£åæˆ–è€…ç±»åéƒ½å¯ä»¥ æ–¹æ³•å å‚æ•° å¼‚å¸¸åï¼šæ–¹æ³•å®šä¹‰ä¸­æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼Œå¯ä»¥çœç•¥ 2.é€šé…ç¬¦ å¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹ï¼Œå¿«é€Ÿæè¿° *ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‰ç¼€æˆ–è€…åç¼€çš„åŒ¹é…ç¬¦å‡ºç° 1execution(public * com.spring.*.UserService.find*(*)) è§£é‡Šï¼šåŒ¹é…com.springåŒ…ä¸‹çš„ä»»æ„åŒ…ä¸­å«æœ‰UserServiceç±»æˆ–æ¥å£ä¸­æ‰€æœ‰å«æœ‰findå¼€å¤´çš„å¸¦æœ‰ä»»æ„ä¸€ä¸ªå‚æ•°çš„æ–¹æ³• ..ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œå¸¸ç”¨äºç®€åŒ–åŒ…åä¸å‚æ•°çš„ä¹¦å†™ 1execution(public User com..UserService.findById(..)) è§£é‡Šï¼šåŒ¹é…comåŒ…ä¸­çš„ä»»æ„åŒ…ä¸­çš„UserServiceç±»æˆ–æ¥å£ä¸­çš„æ‰€æœ‰åç§°ä¸ºfindByIdçš„æ–¹æ³• +ï¼šä¸“ç”¨äºåŒ¹é…å­ç±»ç±»å‹ 1execution(* *..*Service+.*(..)) è§£é‡Šï¼šåŒ¹é…Â·ä»»æ„åŒ…ä¸‹çš„ä»¥Serviceç»“å°¾çš„ç±»æˆ–æ¥å£çš„å­ç±»ä¸­ä¸šåŠ¡å±‚çš„æ‰€æœ‰æ–¹æ³• å¸¸ç”¨å†™æ³• 1execution(* com.spring.*.*Service.save(..)) è§£é‡Šï¼šåŒ¹é…ä¸šåŠ¡å±‚æ‰€æœ‰çš„åä¸ºsaveçš„æ–¹æ³• 3.ä¹¦å†™æŠ€å·§ æ‰€æœ‰ä»£ç æŒ‰ç…§æ ‡å‡†è§„èŒƒå¼€å‘ï¼Œå¦åˆ™ä¸€ä¸‹æŠ€å·§å…¨éƒ¨å¤±æ•ˆ æè¿°åˆ‡å…¥ç‚¹é€šå¸¸æè¿°æ¥å£ï¼Œè€Œä¸æè¿°å®ç°ç±» è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦é’ˆå¯¹æ¥å£å¼€å‘å‡é‡‡ç”¨publicæè¿°(å¯çœç•¥) è¿”å›å€¼ç±»å‹å¯¹åº”å¢åˆ æ”¹ç±»ä½¿ç”¨ç²¾å‡†ç±»å‹åŠ é€ŸåŒ¹é…ï¼Œå¯¹äºæŸ¥è¯¢ç±»è¿”å›å€¼ä½¿ç”¨*é€šé…ç¬¦å¿«é€Ÿæè¿° åŒ…åä¹¦å†™å°½é‡ä¸ä½¿ç”¨..åŒ¹é…ï¼Œæ•ˆç‡è¿‡ä½ï¼Œå¸¸ç”¨*åšå•ä¸ªåŒ…æè¿°åŒ¹é…ï¼Œæˆ–ç²¾å‡†åŒ¹é… æ¥å£å&#x2F;ç±»åä¹¦å†™åç§°ä¸æ¨¡å—çš„é‡‡ç”¨*åŒ¹é… å¦‚ï¼šUserServiceä¹¦å†™æˆ*Serviceï¼Œç»‘å®šä¸šåŠ¡å±‚æ¥å£å æ–¹æ³•åä¹¦å†™ä»¥åŠ¨è¯è¿›è¡Œç²¾å‡†åŒ¹é…ï¼Œåè¯é‡‡ç”¨*åŒ¹é… å¦‚ï¼šgetByIdä¹¦å†™æˆgetBy*ï¼ŒselectAllä¹¦å†™æˆselectAll å‚æ•°è§„åˆ™è¾ƒä¸ºå¤æ‚ï¼Œæ ¹æ®ä¸šåŠ¡æ–¹æ³•çµæ´»è°ƒæ•´ é€šå¸¸ä¸ä½¿ç”¨å¼‚å¸¸ä½œä¸ºåŒ¹é…è§„åˆ™ 16.5 AOPé€šçŸ¥ç±»å‹AOPé€šçŸ¥æè¿°äº†æŠ½å–çš„å…±æ€§åŠŸèƒ½ï¼Œæ ¹æ®å…±æ€§åŠŸèƒ½æŠ½å–çš„ä½ç½®ä¸åŒï¼Œæœ€ç»ˆè¿è¡Œä»£ç æ—¶è¦å°†å…¶åŠ å…¥åˆ°åˆç†çš„ä½ç½® AOPé€šçŸ¥å…±åˆ†ä¸º5é’Ÿç±»å‹ å‰ç½®é€šçŸ¥ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;before~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbefore~~~book dao update~~~ åç½®é€šçŸ¥ â€‹ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;after~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbook dao update~~~after~~~ ç¯ç»•é€šçŸ¥(é‡ç‚¹) 1.æ— è¿”å›å€¼ 1234567891011121314@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Around(&quot;pt()&quot;) public void method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨ pjp.proceed(); System.out.println(&quot;after~~~&quot;); &#125;&#125; 1234è¿è¡Œç»“æœï¼šbefore~~~book dao update~~~after~~~ 2.æœ‰è¿”å›å€¼ åœ¨BookDaoImplä¸­æ–°å†™ä¸€ä¸ªæœ‰è¿”å›å€¼çš„selectæ–¹æ³• 12345678@Repositorypublic class BookDaoImpl implements BookDao &#123; @Override public int select() &#123; System.out.println(&quot;book dao select~~~&quot;); return 100; &#125;&#125; 123456789101112131415@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨ï¼Œå¹¶è·å¾—è¿”å›å€¼ Object ret = pjp.proceed(); System.out.println(&quot;after~~~&quot;); return ret; &#125;&#125; ä¸»å‡½æ•°ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); int num = bookDao.select(); System.out.println(num); &#125;&#125; 12345è¿è¡Œç»“æœï¼šbefore~~~book dao select~~~after~~~100 å¹¶ä¸”æœ‰æ— è¿”å›å€¼éƒ½å»ºè®®è¿™æ ·çš„å†™æ³•ï¼š 1234567@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); Object ret = pjp.proceed(); System.out.println(&quot;after~~~&quot;); return ret; &#125; @Aroundæ³¨æ„äº‹é¡¹ ç¯ç»•é€šçŸ¥å¿…é¡»ä¾èµ–å½¢å‚ProceedingJoinPointæ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ ,è¿›è€Œå®ç°åŸå§‹æ–¹æ³•è°ƒç”¨å‰ååŒæ—¶æ·»åŠ é€šçŸ¥ é€šçŸ¥ä¸­å¦‚æœæœªä½¿ç”¨ProceedingJoinPointå¯¹åŸå§‹æ–¹æ³•è¿›è¡Œè°ƒç”¨å°†è·³è¿‡åŸå§‹æ–¹æ³•çš„æ‰§è¡Œ å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨å¯ä»¥ä¸æ¥æ”¶è¿”å›å€¼ ,é€šçŸ¥æ–¹æ³•è®¾ç½®æˆvoidå³å¯, å¦‚æœæ¥æ”¶è¿”å›å€¼, å¿…é¡»è®¾å®šä¸ºObjectç±»å‹ åŸå§‹æ–¹æ³•çš„è¿”å›å€¼å¦‚æœ æ˜¯voidç±»å‹,é€šçŸ¥æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å¯ä»¥è®¾ç½®æˆvoid ,ä¹Ÿå¯ä»¥è®¾ç½®æˆObject ç”±äºæ— æ³•é¢„çŸ¥åŸå§‹æ–¹æ³•è¿è¡Œåæ˜¯å¦ä¼šæŠ›å‡ºå¼‚å¸¸ ,å› æ­¤ç¯ç»•é€šçŸ¥æ–¹æ³•å¿…é¡»æŠ›å‡ºThrowableå¯¹è±¡ è¿”å›åé€šçŸ¥(äº†è§£) 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @AfterReturning(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;afterReturn~~~&quot;); &#125;&#125; 1234è¿è¡Œç»“æœï¼šbook dao select~~~afterReturn~~~100 @afterå’Œ@AfterReturningçš„åŒºåˆ«ï¼š åŸå§‹æ–¹æ³•æœ‰å¼‚å¸¸æ—¶ï¼š @afterä¹Ÿä¼šæ‰“å°é€šçŸ¥çš„æ–¹æ³• @AfterReturningä¸ä¼šæ‰“å°é€šçŸ¥çš„æ–¹æ³• æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥(äº†è§£) 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @AfterThrowing(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;afterThrowing~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbook dao select~~~100 @AfterThrowingæ³¨è§£ï¼šåªæœ‰åŸå§‹æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œæ‰ä¼šæ‰§è¡Œé€šçŸ¥çš„æ–¹æ³• 16.6 AOPé€šçŸ¥è·å–æ•°æ® è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•° JoinPointï¼šé€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ProceedJointPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿”å›å€¼ è¿”å›åé€šçŸ¥ ç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ç¯ç»•é€šçŸ¥ 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Override public int select(int id, String name) &#123; System.out.println(&quot;book dao select~~~&quot;); System.out.println(&quot;id:&quot;+id+&quot; name:&quot;+name); return 100; &#125;&#125; AOPé€šçŸ¥è·å–å‚æ•°æ•°æ® joinPointå¯¹è±¡æè¿°äº†è¿æ¥ç‚¹æ–¹æ³•çš„è¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥è·å–åˆ°åŸå§‹æ–¹æ³•çš„è°ƒç”¨å‚æ•° 1234567891011121314@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select(..))&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method(JoinPoint jp)&#123; Object[] args = jp.getArgs(); System.out.println(Arrays.toString(args)); &#125;&#125; ä¸»å‡½æ•°è°ƒç”¨selectæ–¹æ³•ï¼š 1234567public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.select(100, &quot;dahuang&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼š[100, dahuang]book dao select~~~ ProceedingJoinPointæ˜¯JoinPointçš„å­ç±» 12345678@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object[] args = pjp.getArgs(); System.out.println(Arrays.toString(args)); args[0] = 666; Object ret = pjp.proceed(args); return ret; &#125; 1234è¿è¡Œç»“æœï¼š[100, dahuang]book dao select~~~id:666 name:dahuang AOPé€šçŸ¥è·å–è¿”å›æ•°æ® æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡ 1234@AfterReturning(value = &quot;pt()&quot;, returning = &quot;ret&quot;)public void method(JoinPoint jp, int ret)&#123; System.out.println(&quot;afterReturn~~~&quot;+ret);&#125; ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥æ‰‹å·¥ä¹¦å†™å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ï¼Œå¾—åˆ°çš„ç»“æœå³ä¸ºåŸå§‹æ–¹æ³•çš„è¿”å›å€¼ 12345@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object ret = pjp.proceed(); return ret; &#125; AOPé€šçŸ¥è·å–å¼‚å¸¸æ•°æ®(äº†è§£) æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡ 1234@AfterThrowing(value = &quot;pt()&quot;, throwing = &quot;t&quot;)public void method(JoinPoint jp, Throwable t)&#123; System.out.println(&quot;afterThrowing~~~&quot;+t);&#125; æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œçš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶è¿è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ 1234567891011@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object ret = null; try&#123; ret = pjp.proceed(); &#125; catch(Throwable t)&#123; t.printStackTrace(); &#125; return ret; &#125; 16.7 AOPæ€»ç»“1.åŸºæœ¬æ¦‚å¿µï¼š æ¦‚å¿µï¼šAOP(Aspect Oriented Programming) é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºæ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼º æ ¸å¿ƒæ¦‚å¿µ ä»£ç†(Proxy)ï¼šSpringAOPçš„æ ¸å¿ƒæœ¬è´¨æ˜¯é‡‡ç”¨ä»£ç†æ¨¡å¼å®ç°çš„ è¿æ¥ç‚¹(JoinPoint )ï¼šåœ¨SpringAOPä¸­ ,ç†è§£ä¸ºä»»æ„æ–¹æ³•çš„æ‰§è¡Œ åˆ‡å…¥ç‚¹( Pointcut )ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­,ä¹Ÿæ˜¯å…·æœ‰å…±æ€§åŠŸèƒ½çš„æ–¹æ³•æè¿° é€šçŸ¥(Advice)ï¼šè‹¥å¹²ä¸ªæ–¹æ³•çš„å…±æ€§åŠŸèƒ½,åœ¨åˆ‡å…¥ç‚¹å¤„æ‰§è¡Œ,æœ€ç»ˆä½“ç°ä¸º-ä¸€ä¸ªæ–¹æ³• åˆ‡é¢( Aspect )ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³» ç›®æ ‡å¯¹è±¡ ( Target )ï¼šè¢«ä»£ç†çš„åŸå§‹å¯¹è±¡æˆä¸ºç›®æ ‡å¯¹è±¡ 2.åˆ‡å…¥ç‚¹ï¼š åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ ‡å‡†æ ¼å¼ï¼š åŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.ç±»&#x2F;æ¥å£å.æ–¹æ³•å(å‚æ•°) å¼‚å¸¸å) execution(* com.spring.service.*Service.*(..)) åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æè¿°é€šé…ç¬¦ï¼š ä½œç”¨: ç”¨äºå¿«é€Ÿæè¿°,èŒƒå›´æè¿° *ï¼šåŒ¹é…ä»»æ„ç¬¦å·(å¸¸ç”¨) ..ï¼šåŒ¹é…å¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·(å¸¸ç”¨) +ï¼šåŒ¹é…å­ç±»ç±»å‹ åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¹¦å†™æŠ€å·§ æŒ‰æ ‡å‡†è§„èŒƒå¼€å‘ æŸ¥è¯¢æ“ä½œçš„è¿”å›å€¼å»ºè®®ä½¿ç”¨*åŒ¹é… å‡å°‘ä½¿ç”¨..çš„å½¢å¼æè¿°åŒ… å¯¹æ¥å£è¿›è¡Œæè¿°,ä½¿ç”¨*è¡¨ç¤ºæ¨¡å—å,ä¾‹å¦‚UserServiceçš„åŒ¹é…æè¿°ä¸º*Service æ–¹æ³•åä¹¦å†™ä¿ç•™åŠ¨è¯,ä¾‹å¦‚get ,ä½¿ç”¨*è¡¨ç¤ºåè¯,ä¾‹å¦‚getByIdåŒ¹é…æè¿°ä¸ºgetBy* å‚æ•°æ ¹æ®å®é™…æƒ…å†µçµæ´»è°ƒæ•´ 3.é€šçŸ¥ç±»å‹ï¼š å‰ç½®é€šçŸ¥ åç½®é€šçŸ¥ ç¯ç»•é€šçŸ¥(é‡ç‚¹) ç¯ç»•é€šçŸ¥ä¾èµ–å½¢å‚ProceedingJoinPointæ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ ç¯ç»•é€šçŸ¥å¯ä»¥éš”ç¦»åŸå§‹æ–¹æ³•çš„è°ƒç”¨æ‰§è¡Œ ç¯ç»•é€šçŸ¥è¿”å›å€¼è®¾ç½®ä¸º0bjectç±»å‹ ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥å¯¹åŸå§‹æ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸è¿›è¡Œå¤„ç† è¿”å›åé€šçŸ¥ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ 4.é€šçŸ¥è·å–æ•°æ®ï¼š è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•° JoinPointï¼šé€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥,è®¾ç½®ä¸ºæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå½¢å‚ ProceedJointPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿”å›å€¼ è¿”å›åé€šçŸ¥ . ç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ç¯ç»•é€šçŸ¥ 17.Springäº‹åŠ¡17.1 Springäº‹åŠ¡ç®€ä»‹äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ Springäº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚æˆ–ä¸šåŠ¡å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ æ¡ˆä¾‹ï¼šé“¶è¡Œè½¬è´¦ éœ€æ±‚:å®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ éœ€æ±‚å¾®ç¼©: Aè´¦æˆ·å‡é’±, Bè´¦æˆ·åŠ é’± åˆ†æ: â‘ æ•°æ®å±‚æä¾›åŸºç¡€æ“ä½œ, æŒ‡å®šè´¦æˆ·å‡é’±( outMoney ) , æŒ‡å®šè´¦æˆ·åŠ é’±( inMoney ) â‘¡ä¸šåŠ¡å±‚æä¾›è½¬è´¦æ“ä½œ( transfer ) , è°ƒç”¨å‡é’±ä¸åŠ é’±çš„æ“ä½œ â‘¢æä¾›2ä¸ªè´¦å·å’Œæ“ä½œé‡‘é¢æ‰§è¡Œè½¬è´¦æ“ä½œ â‘£åŸºäºSpringæ•´åˆMyBatisç¯å¢ƒæ­å»ºä¸Šè¿°æ“ä½œ JDKç‰ˆæœ¬ï¼š8 é¡¹ç›®ç»“æ„ï¼š pom.xml 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.5.6&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; com.spring.configåŒ…ä¸‹ï¼š JdbcConfig 12345678910111213141516171819202122232425262728public class JdbcConfig &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String userName; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; @Bean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); ds.setDriverClassName(driver); ds.setUrl(url); ds.setUsername(userName); ds.setPassword(password); return ds; &#125; //é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œmybatisä½¿ç”¨çš„æ˜¯jdbcäº‹åŠ¡ @Bean public PlatformTransactionManager transactionManager(DataSource dataSource)&#123; DataSourceTransactionManager transactionManager = new DataSourceTransactionManager(); transactionManager.setDataSource(dataSource); return transactionManager; &#125;&#125; MybatisConfig 1234567891011121314151617public class MybatisConfig &#123; @Bean public SqlSessionFactoryBean sqlSessionFactory(DataSource dataSource)&#123; SqlSessionFactoryBean ssfb = new SqlSessionFactoryBean(); ssfb.setTypeAliasesPackage(&quot;com.itheima.p&quot;); ssfb.setDataSource(dataSource); return ssfb; &#125; @Bean public MapperScannerConfigurer mapperScannerConfigurer()&#123; MapperScannerConfigurer msc = new MapperScannerConfigurer(); msc.setBasePackage(&quot;com.itheima.dao&quot;); return msc; &#125;&#125; æ ¸å¿ƒé…ç½®ç±»ï¼šSpringConfig 12345678@Configuration@ComponentScan(&quot;com.itheima&quot;)@PropertySource(&quot;classpath:jdbc.properties&quot;)@Import(&#123;JdbcConfig.class,MybatisConfig.class&#125;)//å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨@EnableTransactionManagementpublic class SpringConfig &#123;&#125; Account 123456789101112131415161718192021222324252627282930313233343536373839public class Account implements Serializable &#123; private Integer id; private String name; private Double money; public Integer getId() &#123; return id; &#125; public void setId(Integer id) &#123; this.id = id; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public Double getMoney() &#123; return money; &#125; public void setMoney(Double money) &#123; this.money = money; &#125; @Override public String toString() &#123; return &quot;Account&#123;&quot; + &quot;id=&quot; + id + &quot;, name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, money=&quot; + money + &#x27;&#125;&#x27;; &#125;&#125; com.spring.daoåŒ…ä¸‹ï¼š AccountDao 12345678public interface AccountDao &#123; @Update(&quot;update demo.account set money = money + #&#123;money&#125; where name = #&#123;name&#125;&quot;) void inMoney(@Param(&quot;name&quot;) String name, @Param(&quot;money&quot;) Double money); @Update(&quot;update demo.account set money = money - #&#123;money&#125; where name = #&#123;name&#125;&quot;) void outMoney(@Param(&quot;name&quot;) String name, @Param(&quot;money&quot;) Double money);&#125; AccountService 12345public interface AccountService &#123; //é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡ @Transactional public void transfer(String out,String in ,Double money) ;&#125; AccountServiceImpl 12345678910@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; public void transfer(String out,String in ,Double money) &#123; accountDao.outMoney(out,money); accountDao.inMoney(in,money); &#125;&#125; æµ‹è¯•ç±»ï¼šAccountServiceTest 1234567891011@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(classes = SpringConfig.class)public class AccountServiceTest &#123; @Autowired private AccountService accountService; @Test public void testTransfer() throws IOException &#123; accountService.transfer(&quot;Tom&quot;,&quot;Jerry&quot;,100D); &#125;&#125; 17.2 Springäº‹åŠ¡è§’è‰²äº‹åŠ¡è§’è‰² äº‹åŠ¡ç®¡ç†å‘˜ï¼šå‘èµ·äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸ä»£æŒ‡ä¸šåŠ¡å±‚å¼€å¯äº‹åŠ¡çš„æ–¹æ³• äº‹åŠ¡åè°ƒå‘˜ï¼šåŠ å…¥äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸ä»£æŒ‡æ•°æ®å±‚æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡å±‚çš„æ–¹æ³• 17.3 Springäº‹åŠ¡å±æ€§ å±æ€§ ä½œç”¨ ç¤ºä¾‹ readOnly è®¾ç½®æ˜¯å¦ä¸ºåªè¯»äº‹åŠ¡ readOnly&#x3D;true åªè¯»äº‹åŠ¡ timeout è®¾ç½®äº‹åŠ¡è¶…æ—¶æ—¶é—´ timeout&#x3D;-1 æ°¸ä¸è¶…æ—¶ rollbackFor è®¾ç½®äº‹åŠ¡å›æ»šå¼‚å¸¸(class) rollbackFor&#x3D;{NullPointException.class} rollbackForClassName è®¾ç½®äº‹åŠ¡å›æ»šå¼‚å¸¸(String) åŒä¸Šå­—ç¬¦ä¸²æ ¼å¼ noRollbackFor è®¾ç½®äº‹åŠ¡ä¸å›æ»šå¼‚å¸¸(class) norollbackFor&#x3D;{NullPointException.class} noRollbackForClassName è®¾ç½®äº‹åŠ¡ä¸å›æ»šå¼‚å¸¸(String) åŒä¸Šå­—ç¬¦ä¸²æ ¼å¼ propagation è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸º â€¦.. 12345678910111213@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; @Override public void transfer(String out, String in, Double money) throws IOException &#123; accountDao.outMoney(out,money); //æ·»åŠ IOExceptionç±»å‹é”™è¯¯ if(true) throw new IOException(); accountDao.inMoney(in,money); &#125;&#125; è¿è¡Œåï¼ŒæŠ¥é”™ï¼ŒoutMoneyæ–¹æ³•æ‰§è¡Œäº†ï¼Œä½†inMoneyæ–¹æ³•æ²¡æœ‰æ‰§è¡Œã€‚ å¹¶ä¸æ˜¯æ‰€æœ‰é”™è¯¯ç±»å‹éƒ½ä¼šå›æ»šï¼Œ æˆ‘ä»¬å¸Œæœ›transferæ–¹æ³•ï¼Œè°ƒç”¨çš„äº‹åŠ¡åŒå¤±è´¥ã€‚ åœ¨@Transactionalæ³¨è§£ä¸­çš„å±æ€§rollbackForæ·»åŠ é”™è¯¯çš„ç±»å‹ï¼š 12345public interface AccountService &#123; @Transactional(rollbackFor = &#123;IOException.class&#125;) void transfer(String out, String in, Double money) throws IOException;&#125; å†æ¬¡è¿è¡Œåï¼ŒæŠ¥é”™ï¼ŒoutMoneyå’ŒinMoneyæ–¹æ³•éƒ½æ²¡æœ‰æ‰§è¡Œ æ¡ˆä¾‹ï¼šè½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿— éœ€æ±‚:å®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ,å¹¶å¯¹æ¯æ¬¡è½¬è´¦æ“ä½œåœ¨æ•°æ®åº“è¿›è¡Œç•™ç—• éœ€æ±‚å¾®ç¼©: Aè´¦æˆ·å‡é’±, Bè´¦æˆ·åŠ é’±,æ•°æ®åº“è®°å½•æ—¥å¿— åˆ†æ: â‘ :åŸºäºè½¬è´¦æ“ä½œæ¡ˆä¾‹æ·»åŠ æ—¥å¿—æ¨¡å—,å®ç°æ•°æ®åº“ä¸­è®°å½•æ—¥å¿— â‘¡:ä¸šåŠ¡å±‚è½¬è´¦æ“ä½œ( transfer ) ,è°ƒç”¨å‡é’±ã€åŠ é’±ä¸è®°å½•æ—¥å¿—åŠŸèƒ½ å®ç°æ•ˆæœé¢„æœŸï¼š â€‹ æ— è®ºè½¬è´¦æ“ä½œæ˜¯å¦æˆåŠŸ,å‡è¿›è¡Œè½¬è´¦æ“ä½œçš„æ—¥å¿—ç•™ç—• 123456789101112131415161718192021@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; @Autowired private LogService logService; @Override public void transfer(String out, String in, Double money) throws IOException &#123; try&#123; accountDao.outMoney(out,money); int i = 1/0; accountDao.inMoney(in,money); &#125; finally&#123; logService.log(out,in,money); &#125; &#125;&#125; è¿è¡Œåï¼ŒoutMoneyæ–¹æ³•å’ŒinMoneyæ–¹æ³•è¿›è¡Œå›æ»šï¼ŒåŒæ—¶logæ–¹æ³•ä¹Ÿè¿›è¡Œäº†å›æ»šï¼Œæœªå°†æ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ å­˜åœ¨é—®é¢˜ï¼š æ—¥å¿—çš„è®°å½•ä¸è½¬è´¦æ“ä½œéš¶å±åŒä¸€ä¸ªäº‹åŠ¡ï¼ŒåŒæˆåŠŸåŒå¤±è´¥ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šäº‹åŠ¡åè°ƒå‘˜å¯¹äº‹ç‰©ç®¡ç†å‘˜æ‰€æºå¸¦äº‹åŠ¡çš„å¤„ç†æ€åº¦ åœ¨ä¸šåŠ¡å±‚æ¥å£æ·»åŠ Springäº‹åŠ¡ï¼Œ @Transactionalæ³¨è§£ä¸­çš„propagationå±æ€§è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºREQIRES_NEW(éœ€è¦æ–°äº‹åŠ¡) 123456@Servicepublic interface LogService &#123; //è®¾ç½®ä¸ºæ–°äº‹åŠ¡ @Transactional(propagation=Propagation.REQIRES_NEW) public void log(String out, String in, Double money);&#125; è¿è¡Œåï¼ŒoutMoneyæ–¹æ³•å’ŒinMoneyæ–¹æ³•è¿›è¡Œå›æ»šï¼Œäº‹åŠ¡æˆåŠŸã€‚ logæ–¹æ³•æ‰§è¡Œï¼Œå°†æ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ ä¼ æ’­å±æ€§ äº‹åŠ¡ç®¡ç†å‘˜ äº‹åŠ¡åè°ƒå‘˜ REQUIRED(é»˜è®¤) å¼€å¯T åŠ å…¥T æ—  æ–°å»ºT2 REQUIRES_NEW å¼€å¯T æ–°å»ºT2 æ—  æ–°å»ºT2 SUPPORTS å¼€å¯T åŠ å…¥T æ—  æ—  NOT_SUPPORTED å¼€å¯T æ—  æ—  æ—  MANDATORY å¼€å¯T åŠ å…¥T æ—  ERROR NEVER å¼€å¯T ERROR æ—  æ—  NESTED è®¾ç½®savePointï¼Œä¸€æ—¦äº‹åŠ¡å›æ»šï¼Œäº‹åŠ¡å°†å›æ»šåˆ°savePointå¤„ï¼Œäº¤ç”±å®¢æˆ·ç«¯æäº¤/å›æ»š â€‹ 18.ç»“è¯­ä½ ç«Ÿç„¶çœ‹å®Œäº†(ä¸æ•¢ç›¸ä¿¡ï¼ï¼)ï¼ŒçœŸçš„äººä¼šçœ‹å—ï¼çœŸçš„å—ï¼ã‚â—Ğ”â—ãƒ¾ æœ¬äººä¹Ÿæ˜¯åˆå­¦Springï¼Œç¬”è®°ä¸­å¦‚æœæœ‰ä»€ä¹ˆé—æ¼æˆ–é”™è¯¯çš„åœ°æ–¹æ¬¢è¿å¤§ä½¬æŒ‡æ­£ï¼ˆâ‰§âˆ€â‰¦ï¼‰ æœ¬äººQQï¼š2691936018 å¤‡æ³¨ï¼šSpring å¦å¤–å…³äºSpringæ¡†æ¶ï¼Œå¦‚æœæœ‰æ–°çš„å†…å®¹éœ€è¦è¡¥å……ï¼Œæœ¬äººä¹Ÿä¼šè¿›è¡Œæ›´æ–°çš„ æœ¬ç¬”è®°çš„å­¦ä¹ è§†é¢‘ï¼šé»‘é©¬2022æœ€æ–°SSMæ¡†æ¶ æˆ‘ä»¬SpringMVCè§ï¼ï¼(è¿˜æ˜¯ä¸å¤ªç›¸ä¿¡èƒ½æœ‰äººçœ‹â•®(â•¯â–½â•°)â•­)","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"SpringMVCæ¡†æ¶çš„å­¦ä¹ ç¬”è®°","slug":"Java/SpringMCVæ¡†æ¶","date":"2022-08-06T11:11:16.322Z","updated":"2022-07-07T06:25:56.557Z","comments":true,"path":"2022/08/06/Java/SpringMCVæ¡†æ¶/","link":"","permalink":"http://example.com/2022/08/06/Java/SpringMCV%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè®¤SpringMVC1.1 SpringMVCç®€ä»‹ SpringMVCæŠ€æœ¯ä¸ServletæŠ€æœ¯åŠŸèƒ½ç­‰åŒï¼Œå‡å±äºwebå±‚å¼€å‘æŠ€æœ¯ SpringMVCæ˜¯ä¸€ç§åŸºäºjavaå®ç°MVCæ¨¡å‹çš„è½»é‡çº§Webæ¡†æ¶ ä¼˜ç‚¹ï¼š ä½¿ç”¨ç®€å•ï¼Œå¼€å‘ä¾¿æ·(ç›¸æ¯”ä¸Servlet) çµæ´»æ€§å¼º é¡¹ç›®ç»“æ„ï¼š 1.2 SpringMVCå…¥é—¨1.ä½¿ç”¨SpringMVCæŠ€æœ¯éœ€è¦å…ˆå¯¼å…¥SpringMVCåæ ‡ä¸Servlet ä¸éœ€è¦å¯¼å…¥spring-contextåŒ…ï¼Œspring-webmvcåŒ…ä¸­åŒ…å«spring-contextåŒ… 2.å¯¼å…¥Tomcatæ’ä»¶ 12345678910111213141516171819202122232425&lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;!-- å’ŒTomcatæœ‰å†²çª --&gt; &lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;!--Tomcatæ’ä»¶--&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.1&lt;/version&gt; &lt;configuration&gt; &lt;port&gt;8888&lt;/port&gt; &lt;!--ç«¯å£å¯ä»»æ„åªè¦æ²¡æœ‰è¢«å ç”¨--&gt; &lt;path&gt;/&lt;/path&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; 3.åˆ›å»ºSpringMVCæ§åˆ¶å™¨ç±»(ç­‰åŒäºServletåŠŸèƒ½) 1234567891011@Controllerpublic class UserController &#123; //è®¾ç½®å½“å‰æ§åˆ¶å™¨æ–¹æ³•çš„è¯·æ±‚è·¯å¾„ @RequestMapping(&quot;/save&quot;) //è®¾ç½®å½“å‰æ§åˆ¶å™¨æ–¹æ³•å“åº”å†…å®¹ä¸ºå½“å‰è¿”å›å€¼ï¼Œæ— éœ€è§£æ @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; 4.åˆå§‹åŒ–SpringMVCç¯å¢ƒ(åŒSpringç¯å¢ƒ)ï¼Œè®¾å®šSpringMVCåŠ è½½å¯¹åº”çš„bean 12345//åˆ›å»ºSpringMVCçš„é…ç½®æ–‡ä»¶ï¼ŒåŠ è½½controllerå¯¹åº”çš„bean@Configuration@ComponentScan(&quot;com.springmvc.controller&quot;)public class SpringMvcConfig &#123;&#125; 5.åˆå§‹åŒ–Servletå®¹å™¨ï¼ŒåŠ è½½SpringMVCç¯å¢ƒï¼Œå¹¶è®¾ç½®SpringMVCæŠ€æœ¯å¤„ç†çš„è¯·æ±‚ 123456789101112131415161718192021//å®šä¹‰ä¸€ä¸ªservletå®¹å™¨å¯åŠ¨çš„é…ç½®ç±»ï¼Œåœ¨é‡Œé¢åŠ è½½Springçš„é…ç½®public class ServletContainerInitConfig extends AbstractDispatcherServletInitializer &#123; //åŠ è½½SpringMVCå®¹å™¨çš„é…ç½® @Override protected WebApplicationContext createServletApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringMvcConfig.class); return acwac; &#125; //è®¾å®šSpringMVCå¯¹åº”çš„è¯·æ±‚çš„æ˜ å°„è·¯å¾„ @Override protected String[] getServletMappings() &#123; //è®¾ç½®ä¸º/è¡¨ç¤ºæ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œä»»æ„è¯·æ±‚éƒ½å°†è½¬å…¥åˆ°SpringMVCä¸­è¿›è¡Œå¤„ç† return new String[]&#123;&quot;/&quot;&#125;; &#125; //åŠ è½½Springå®¹å™¨é…ç½®ï¼Œç°åœ¨ä¸éœ€è¦ @Override protected WebApplicationContext createRootApplicationContext() &#123; return null; &#125;&#125; å³é”®æ‰¾åˆ°Run Mavenå†æ‰¾åˆ°tomcat7:runç‚¹å‡»è¿è¡Œï¼Œæ‰“å¼€æµè§ˆå™¨æ‰“å¼€http://localhost:8888/save é¡µé¢å³å¯å‡ºç°å†…å®¹ï¼š 1&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125; æ­¤æ—¶æ§åˆ¶å°æ‰“å°å‡ºï¼š 1user is saving~~ 1.3 å…¥é—¨æ€»ç»“ SpringMVCå…¥é—¨ç¨‹åºå¼€å‘æ€»ç»“(1+N) ä¸€æ¬¡æ€§å·¥ä½œ åˆ›å»ºå·¥ç¨‹, è®¾ç½®æœåŠ¡å™¨ï¼ŒåŠ è½½å·¥ç¨‹ å¯¼å…¥åæ ‡ åˆ›å»ºwebå®¹å™¨å¯åŠ¨ç±», åŠ è½½SpringMVCé…ç½®ï¼Œ å¹¶è®¾ç½®SpringMVCè¯·æ±‚æ‹¦æˆªè·¯å¾„ SpringMVCæ ¸å¿ƒé…ç½®ç±» (è®¾ç½®é…ç½®ç±»,æ‰«æcontrolleråŒ…, åŠ è½½Controlleræ§åˆ¶å™¨bean) å¤šæ¬¡å·¥ä½œ å®šä¹‰å¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨ç±» å®šä¹‰å¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œ å¹¶é…ç½®æ˜ å°„è·¯å¾„@RequestMappingä¸è¿”å›jsonæ•°æ®@ResponseBody 1.4 å·¥ä½œæµç¨‹å…¥é—¨æ¡ˆä¾‹å·¥ä½œæµç¨‹åˆ†æ å¯åŠ¨æœåŠ¡å™¨åˆå§‹åŒ–è¿‡ç¨‹ æœåŠ¡å™¨å¯åŠ¨, æ‰§è¡ŒServletContainersInitConfigç±»,åˆå§‹åŒ–webå®¹å™¨ æ‰§è¡ŒcreateServletApplicationContextæ–¹æ³•ï¼Œåˆ›å»ºäº†WebApplicationContextå¯¹è±¡ åŠ è½½SpringMvcConfigé…ç½®æ–‡ä»¶ æ‰§è¡Œ@ComponentScanåŠ è½½å¯¹åº”çš„bean åŠ è½½UserController, æ¯ä¸ª@RequestMappingçš„åç§°å¯¹åº”ä¸€ ä¸ªå…·ä½“çš„æ–¹æ³• æ‰§è¡ŒgetServletMappingsæ–¹æ³•, å®šä¹‰æ‰€æœ‰çš„è¯·æ±‚éƒ½é€šè¿‡SpringMVC å•æ¬¡è¯·æ±‚è¿‡ç¨‹ å‘é€è¯·æ±‚http:localhost:8888/save webå®¹å™¨å‘ç°æ‰€æœ‰è¯·æ±‚éƒ½ç»è¿‡SpringMVC, å°†è¯·æ±‚äº¤ç»™SpringMVCå¤„ç† è§£æè¯·æ±‚è·¯å¾„&#x2F;save ç”±&#x2F;saveåŒ¹é…æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•save() æ‰§è¡Œsave() æ£€æµ‹åˆ°æœ‰@ResponseBodyç›´æ¥å°†save()æ–¹æ³•çš„è¿”å›å€¼ä½œä¸ºå“åº”æ±‚ä½“è¿”å›ç»™è¯·æ±‚æ–¹ 1.5 beanåŠ è½½æ§åˆ¶ com springmvc config controller service dao ControlleråŠ è½½æ§åˆ¶ä¸šåŠ¡ä¸ä¸šåŠ¡beanåŠ è½½æ§åˆ¶ SpringMVCç›¸å…³bean è¡¨ç°å±‚bean(Controller) Springæ§åˆ¶çš„bean ä¸šåŠ¡bean(Service) åŠŸèƒ½bean(DataSourseç­‰) SpringMVCç›¸å…³çš„beanåŠ è½½æ§åˆ¶ SpringMVCåŠ è½½çš„beanå¯¹åº”çš„åŒ…å‡åœ¨com.springnvc.controlleråŒ…å†… Springç›¸å…³beanåŠ è½½æ§åˆ¶ SpringåŠ è½½çš„beanè®¾å®šèŒƒå›´ä¸ºcom.springmvcï¼Œæ’é™¤controlleråŒ…å†…çš„bean SpringåŠ è½½çš„beanè®¾å®šèŒƒå›´ä¸ºç²¾å‡†èŒƒå›´ï¼Œå¦‚ï¼šcom.springmvc.daoã€com.springmvc.serviceç­‰(å¸¸ç”¨) ä¸åŒºåˆ†Springä¸SpringMVCçš„ç¯å¢ƒï¼ŒåŠ è½½åˆ°åŒä¸€ä¸ªç¯å¢ƒä¸­ æ–¹å¼ä¸€(å¸¸ç”¨)ï¼š 1234@Configuration@ComponentScan(&#123;&quot;com.springmvc.dao&quot;,&quot;com.springmvc.service&quot;&#125;)public class SpringConfig &#123;&#125; æ–¹å¼äºŒï¼š 123456789@Configuration@ComponentScan(value = &quot;com.springmvc&quot;, excludeFilters = @ComponentScan.Filter( type = FilterType.ANNOTATION, //æŒ‰ç…§æ³¨è§£æ’é™¤ classes = Controller.class //éœ€è¦æ’é™¤çš„æ³¨è§£ç±»å‹ ))public class SpringConfig &#123;&#125; åŠ è½½SpringMVCå’ŒSpringé…ç½® 123456789101112131415161718192021public class ServletContainerInitConfig extends AbstractDispatcherServletInitializer &#123; //åŠ è½½SpringMVCé…ç½® @Override protected WebApplicationContext createServletApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringMvcConfig.class); return acwac; &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;&quot;/&quot;&#125;; &#125; //åŠ è½½SpringMVCé…ç½® @Override protected WebApplicationContext createRootApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringConfig.class); return acwac; &#125;&#125; ç®€åŒ–æ“ä½œ(å¸¸ç”¨)ï¼š 1234567891011121314151617public class ServletContainerInitConfig extends AbstractAnnotationConfigDispatcherServletInitializer &#123; @Override protected Class&lt;?&gt;[] getRootConfigClasses() &#123; return new Class[]&#123;SpringConfig.class&#125;; &#125; @Override protected Class&lt;?&gt;[] getServletConfigClasses() &#123; return new Class[]&#123;SpringMvcConfig.class&#125;; &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;&quot;/&quot;&#125;; &#125;&#125; 2.è¯·æ±‚ä¸å“åº”2.1 è¯·æ±‚æ˜ å°„è·¯å¾„é¡¹ç›®ç»“æ„ï¼š BookControllerï¼š 123456789@Controllerpublic class BookController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;book is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; UserControllerï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; è¿è¡Œç¨‹åºåæŠ¥é”™ï¼Œæ— æ³•å¯åŠ¨ã€‚ å› ä¸ºè·¯å¾„éƒ½ä¸º/saveçš„è¯ï¼Œåœ¨ç½‘é¡µè¯·æ±‚/saveï¼Œç¨‹åºä¼šä¸çŸ¥é“è°ƒç”¨å“ªä¸ªæ§åˆ¶å™¨æ–¹æ³• æ”¹è¿›ï¼š BookControllerï¼š 123456789@Controllerpublic class BookController &#123; @RequestMapping(&quot;/book/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;book is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; UserControllerï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/user/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; è¿˜å¯ä»¥æ›´åŠ ç²¾ç®€ï¼Œå¢åŠ æ¨¡å—çš„è¯·æ±‚è·¯å¾„å‰ç¼€ï¼š @RequestMappingæ³¨è§£ï¼š è®¾ç½®åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸Šï¼šè¯·æ±‚è®¿é—®è·¯å¾„ è®¾ç½®åœ¨ç±»ä¸Šï¼šç»Ÿä¸€è®¾ç½®å½“å‰ç±»ä¸­æ§åˆ¶å™¨æ–¹æ³•è¯·æ±‚è·¯å¾„å‰ç¼€ BookControllerï¼š 12345678910@Controller@RequestMapping(&quot;/book&quot;)public class BookController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;book is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; UserControllerï¼š 12345678910@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; 2.2 è¯·æ±‚æ–¹å¼ Getè¯·æ±‚ Postè¯·æ±‚ æ‰€è¦è®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(String name, int age)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(&quot;name=&quot;+name+&quot; age=&quot;+age); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ä¼ å‚ï¼Œåœ°å€å‚æ•°è¦ä¸å½¢å‚å˜é‡åç›¸åŒï¼Œå®šä¹‰å½¢å‚å‡ ä¸ªæ¥æ”¶å‚æ•° è®¿é—®é“¾æ¥ï¼šhttp://localhost:8888/user/save?name=dahuang&amp;age=18 æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~name=dahuang age=18 postè¯·æ±‚ï¼š formè¡¨å•postè¯·æ±‚ä¼ å‚ï¼Œè¡¨å•å‚æ•°åè¦ä¸å½¢å‚å˜é‡åç›¸åŒï¼Œå®šä¹‰å½¢å‚å‡ ä¸ªæ¥æ”¶å‚æ•° è®¿é—®é“¾æ¥ï¼šhttp://localhost:8888/user/save æäº¤æ•°æ®å½¢å¼ï¼šx-www-form-urlencoded æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~name=dahei age=20 å¦‚æœå‚æ•°ä¸ºä¸­æ–‡å‘¢ï¼Ÿ æ§åˆ¶å°æ‰“å°ï¼Œä¼šä¹±ç ï¼š 12user is saving~~name=Ã¥Â¤Â§Ã©Â»Â„ age=20 Postè¯·æ±‚ä¸­æ–‡ä¹±ç å¤„ç†ï¼š åœ¨ServletContainerInitConfigé…ç½®æ–‡ä»¶ä¸­é‡å†™getServletFilters()æ–¹æ³• ä¸ºwebå®¹å™¨æ·»åŠ è¿‡æ»¤å™¨å¹¶æŒ‡å®šå­—ç¬¦é›†ï¼ŒSpring-webåŒ…ä¸­æä¾›äº†ä¸“ç”¨çš„å­—ç¬¦è¿‡æ»¤å™¨ 123456@Overrideprotected Filter[] getServletFilters() &#123; CharacterEncodingFilter aef = new CharacterEncodingFilter(); aef.setEncoding(&quot;UTF-8&quot;); return new Filter[]&#123;aef&#125;;&#125; å†æ¬¡è¿è¡Œåï¼Œæ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~name=å¤§é»„ age=20 2.3 5ç§ç±»å‹å‚æ•°ä¼ é€’ å‚æ•°ç§ç±» æ™®é€šå‚æ•° POJOå‚æ•° åµŒå¥—POJOå‚æ•° æ•°ç»„ç±»å‹å‚æ•° é›†åˆç±»å‹å‚æ•° æ™®é€šå‚æ•°ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚å˜é‡åä¸åŒï¼Œä½¿ç”¨@RequestParamæ³¨è§£ç»‘å®šå‚æ•°å…³ç³» 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestParam(&quot;name&quot;) String userName, int age)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(&quot;name=&quot;+userName+&quot; age=&quot;+age); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; POJOå‚æ•°ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚å¯¹è±¡åç›¸åŒï¼Œå®šä¹‰POJOç±»å‹å½¢å‚å³å¯æ¥æ”¶å‚æ•° åˆ›å»ºä¸€ä¸ªå®ä½“ç±»User 1234567891011121314151617public class User &#123; private String name; private int age; public String getName() &#123;return name;&#125; public void setName(String name) &#123;this.name = name;&#125; public int getAge() &#123;return age;&#125; public void setAge(int age) &#123;this.age = age;&#125; @Override public String toString() &#123; return &quot;User&#123;&quot; + &quot;name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, age=&quot; + age + &#x27;&#125;&#x27;; &#125;&#125; UserControllerä¸­ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(User user)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(user.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?name=dahei&amp;age=16 æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~User&#123;name=&#x27;dahei&#x27;, age=16&#125; åµŒå¥—POJOå‚æ•°ï¼šPOJOå¯¹è±¡ä¸­åŒ…å«POJOå¯¹è±¡ åˆ›å»ºä¸€ä¸ªæ–°å®ä½“ç±»Addressï¼š 1234567891011121314151617public class Address &#123; private String province; private String city; public String getProvince() &#123;return province;&#125; public void setProvince(String province) &#123;this.province = province;&#125; public String getCity() &#123;return city;&#125; public void setCity(String city) &#123;this.city = city;&#125; @Override public String toString() &#123; return &quot;Address&#123;&quot; + &quot;province=&#x27;&quot; + province + &#x27;\\&#x27;&#x27; + &quot;, city=&#x27;&quot; + city + &#x27;\\&#x27;&#x27; + &#x27;&#125;&#x27;; &#125;&#125; å°†Addresså¯¹è±¡åŠ å…¥åˆ°Userå¯¹è±¡ä¸­ï¼š 123456789101112131415161718192021public class User &#123; private String name; private int age; private Address address; public Address getAddress() &#123;return address;&#125; public void setAddress(Address address) &#123;this.address = address;&#125; public String getName() &#123;return name;&#125; public void setName(String name) &#123;this.name = name;&#125; public int getAge() &#123;return age;&#125; public void setAge(int age) &#123;this.age = age;&#125; @Override public String toString() &#123; return &quot;User&#123;&quot; + &quot;name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, age=&quot; + age + &quot;, address=&quot; + address + &#x27;&#125;&#x27;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?name=dahuang&amp;age=20&amp;address.province=tianjin&amp;address.city=baodi æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~User&#123;name=&#x27;dahuang&#x27;, age=20, address=Address&#123;province=&#x27;tianjin&#x27;, city=&#x27;baodi&#x27;&#125;&#125; æ•°ç»„å‚æ•°ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(String[] hobbies)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(Arrays.toString(hobbies)); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?hobbies=TV&amp;hobbies=game&amp;hobbies=food æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[TV, game, food] é›†åˆå‚æ•°ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestParam List&lt;String&gt; hobbies)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(hobbies.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?hobbies=TV&amp;hobbies=game&amp;hobbies=food æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[TV, game, food] 2.4 ä¼ é€’jsonæ•°æ®*å¯¼å…¥jacksonåæ ‡ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt; &lt;version&gt;2.9.0&lt;/version&gt;&lt;/dependency&gt; jsonæœ‰ä¸¤ç§æ ¼å¼ï¼š å¯¹è±¡æ ¼å¼ï¼š&#123;&quot;key1&quot;:obj,&quot;key2&quot;:obj,&quot;key3&quot;:obj...&#125; æ•°ç»„&#x2F;é›†åˆæ ¼å¼ï¼š[obj,obj,obj...] åœ¨SpringMvcConfigé…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ æ³¨è§£@EnableWebMvcï¼š @EnableWebMvcæ³¨è§£ï¼šå¼€å¯jsonæ•°æ®è½¬æ¢æˆå¯¹è±¡çš„åŠŸèƒ½ 12345@Configuration@ComponentScan(&quot;com.springmvc.controller&quot;)@EnableWebMvcpublic class SpringMvcConfig &#123;&#125; é›†åˆå‚æ•°ï¼šjsonæ ¼å¼ @RequestBodyæ³¨è§£ï¼šå°†è¯·æ±‚ä¸­è¯·æ±‚ä½“æ‰€åŒ…å«çš„æ•°æ®ä¼ é€’ç»™è¯·æ±‚å‚æ•°ï¼Œæ­¤æ³¨è§£ä¸€ä¸ªå¤„ç†å™¨æ–¹æ³•åªèƒ½ä½¿ç”¨ä¸€æ¬¡ 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestBody List&lt;String&gt; hobbies)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(hobbies.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[TV, game, food] POJOå‚æ•°ï¼šjsonæ ¼å¼ 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestBody User user)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(user.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~User&#123;name=&#x27;dahuang&#x27;, age=20, address=Address&#123;province=&#x27;tianjin&#x27;, city=&#x27;baodi&#x27;&#125;&#125; é›†åˆå¯¹è±¡å‚æ•°ï¼šjsonæ ¼å¼ 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestBody List&lt;User&gt; list)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(list.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[User&#123;name=&#x27;dahei&#x27;, age=20, address=Address&#123;province=&#x27;tianjin&#x27;, city=&#x27;baodi&#x27;&#125;&#125;, User&#123;name=&#x27;dahuang&#x27;, age=20, address=Address&#123;province=&#x27;guizhou&#x27;, city=&#x27;zunyi&#x27;&#125;&#125;] @RequestBodyä¸@RequestParamçš„åŒºåˆ«ï¼š åŒºåˆ« @RequestParamç”¨äºurlåœ°å€ä¼ å‚ï¼Œè¡¨å•ä¼ å‚ application/x-www-form-urlencoded @RequestBodyç”¨äºæ¥æ”¶jsonæ•°æ® application/json åº”ç”¨ åæœŸå¼€å‘ï¼Œå‘é€jsonæ ¼å¼æ•°æ®ä¸ºä¸»ï¼Œ@RequestBodyæ‹¥æœ‰è¾ƒå¹¿ å¦‚æœå‘é€éjsonæ ¼å¼æ•°æ®ï¼Œé€‰ç”¨@RequestParamæ¥æ”¶è¯·æ±‚å‚æ•° 2.5 æ—¥æœŸç±»å‹å‚æ•°ä¼ é€’æ—¥æœŸç±»å‹æ•°æ®åŸºäºç³»ç»Ÿä¸åŒæ ¼å¼ä¹Ÿä¸å°½ç›¸åŒ 2022-07-04 2022&#x2F;07&#x2F;04 07&#x2F;04&#x2F;2022 æ¥æ”¶å½¢å‚æ—¶ï¼Œæ ¹æ®ä¸åŒçš„æ—¥æœŸæ ¼å¼è®¾ç½®ä¸åŒçš„æ¥æ”¶æ–¹å¼ @DataTimeFormatæ³¨è§£ä¸­çš„patternå±æ€§æ¥è‡ªå®šä¹‰æ—¥æœŸæ—¶é—´å‹æ•°æ®æ ¼å¼ 1234567891011121314@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/date&quot;) @ResponseBody public String save(Date date1, @DateTimeFormat(pattern = &quot;yyyy-mm-dd&quot;) Date date2, @DateTimeFormat(pattern = &quot;yyyy/mm/dd HH:mm:ss&quot;) Date date3)&#123; System.out.println(&quot;date1==&gt;&quot;+date1); System.out.println(&quot;date2==&gt;&quot;+date2); System.out.println(&quot;date3==&gt;&quot;+date3); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 123date1==&gt;Mon Jul 04 00:00:00 CST 2022date2==&gt;Tue Jan 04 00:07:00 CST 2022date3==&gt;Tue Jan 04 23:10:00 CST 2022 ç±»å‹è½¬æ¢å™¨ï¼š Converteræ¥å£ 1234public interface Converter&lt;S, T&gt; &#123; @Nullable T convert(S val);&#125; è¯·æ±‚å‚æ•°å¹´é¾„æ•°æ®(String&#x3D;&#x3D;&gt;Integer) æ—¥æœŸæ ¼å¼è½¬æ¢(String&#x3D;&#x3D;&gt;Date) @EnableWebMvcæ³¨è§£ä½œç”¨ä¹‹ä¸€ï¼šæ ¹æ®ç±»å‹åŒ¹é…å¯¹åº”çš„ç±»å‹è½¬æ¢å™¨ 2.6 å“åº”æ•°æ® å“åº”é¡µé¢ å“åº”æ•°æ® æ–‡æœ¬æ•°æ® jsonæ•°æ® å“åº”é¡µé¢ï¼š åœ¨webappèµ„æºåŒ…ä¸­æ–°å»ºæ–‡ä»¶ï¼špage.jsp 12345&lt;html&gt;&lt;body&gt;&lt;h2&gt;Hello SpringMVC!&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt; é¡µé¢è·³è½¬ï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/jumpPage&quot;) public String jumpPage()&#123; System.out.println(&quot;é¡µé¢è·³è½¬&quot;); return &quot;page.jsp&quot;; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/jumpPage ä¼šè‡ªåŠ¨è·³è½¬åˆ°page.jspé¡µé¢ å“åº”æ–‡æœ¬æ•°æ®ï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/toText&quot;) @ResponseBody public String toText()&#123; System.out.println(&quot;è¿”å›çº¯æ–‡æœ¬æ•°æ®&quot;); return &quot;hello SpringMVC&quot;; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/toText é¡µé¢æ•°æ®ï¼š 1hello SpringMVC å“åº”POJOå¯¹è±¡ï¼š 123456789101112@Controllerpublic class UserController &#123; @RequestMapping(&quot;/toPojo&quot;) @ResponseBody public User toPojo()&#123; System.out.println(&quot;è¿”å›POJOæ•°æ®&quot;); User user = new User(); user.setName(&quot;å¤§é»„&quot;); user.setAge(18); return user; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/toPojo é¡µé¢æ•°æ®ï¼š 12345&#123; &quot;name&quot;: &quot;å¤§é»„&quot;, &quot;age&quot;: 18, &quot;address&quot;: null&#125; å…¶ä¸­æ˜¯jacksonè‡ªåŠ¨å°†å¯¹è±¡è½¬æ¢æˆjsonæ•°æ® æ‰€ä»¥ä¸€å®šè¦å¯¼å…¥jacksonåæ ‡ å“åº”POJOé›†åˆå¯¹è±¡ï¼š 123456789101112131415161718@Controllerpublic class UserController &#123; @RequestMapping(&quot;/toPojoList&quot;) @ResponseBody public List&lt;User&gt; toPojoList()&#123; System.out.println(&quot;è¿”å›POJOé›†åˆå¯¹è±¡æ•°æ®&quot;); User user1 = new User(); user1.setName(&quot;å¤§é»„&quot;); user1.setAge(18); User user2 = new User(); user2.setName(&quot;å¤§é»‘&quot;); user2.setAge(20); List&lt;User&gt; list = new ArrayList&lt;&gt;(); list.add(user1); list.add(user2); return list; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/toPojoList é¡µé¢æ•°æ®ï¼š 123456789101112[ &#123; &quot;name&quot;: &quot;å¤§é»„&quot;, &quot;age&quot;: 18, &quot;address&quot;: null &#125;, &#123; &quot;name&quot;: &quot;å¤§é»‘&quot;, &quot;age&quot;: 20, &quot;address&quot;: null &#125;] @ResponseBodyæ³¨è§£ï¼š è®¾ç½®å½“å‰æ§åˆ¶å™¨è¿”å›å€¼ä½œä¸ºå“åº”ä½“ æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼æ•°æ®ç±»å‹ä¸ºStringï¼Œåˆ™è¿”å›æ–‡æœ¬æ•°æ® æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼æ•°æ®ç±»å‹ä¸ºå¯¹è±¡ï¼Œåˆ™è‡ªåŠ¨å°†å¯¹è±¡è½¬æ¢æˆjsonæ•°æ® ç±»å‹è½¬æ¢å™¨ï¼š webè¯·æ±‚ä¸“ç”¨ç±»å‹è½¬æ¢å™¨ï¼šHttpMessageConverteræ¥å£ 3.RESTé£æ ¼3.1 RESTç®€ä»‹ REST(Representational State Transfer)ï¼šè¡¨ç°å½¢å¼çŠ¶æ€è½¬æ¢ ä¼ ç»Ÿé£æ ¼èµ„æºæè¿°å½¢å¼ http://localhost:8888/user/getById?id=1 http://localhost:8888/user/saveUser RESTé£æ ¼æè¿°å½¢å¼ http://localhost:8888/user/1 http://localhost:8888/user ä¼˜ç‚¹ï¼š éšè—èµ„æºçš„è®¿é—®è¡Œä¸ºï¼Œæ— æ³•é€šè¿‡åœ°å€å¾—çŸ¥å¯¹èµ„æºæ˜¯å¦‚ä½•æ“ä½œ ä¹¦å†™ç®€åŒ– æŒ‰ç…§RESTé£æ ¼è®¿é—®èµ„æºæ—¶ä½¿ç”¨è¡Œä¸ºåŠ¨ä½œåŒºåˆ†å¯¹èµ„æºè¿›è¡Œäº†ä½•ç§æ“ä½œ http://localhost:8888/users æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·ä¿¡æ¯(get) http://localhost:8888/users/1 æŸ¥è¯¢æŒ‡å®šç”¨æˆ·ä¿¡æ¯(post) http://localhost:8888/users æ·»åŠ ç”¨æˆ·ä¿¡æ¯(post) http://localhost:8888/users ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯(put) http://localhost:8888/users/1 åˆ é™¤ç”¨æˆ·ä¿¡æ¯(delete) æè¿°æ¨¡å—çš„åç§°é€šå¸¸ä½¿ç”¨å¤æ•°ï¼Œä¹Ÿå°±æ˜¯åŠ sçš„æ ¼å¼æè¿°ï¼Œè¡¨ç¤ºæ­¤ç±»èµ„æºï¼Œè€Œéå•ä¸ªèµ„æºã€‚ ä¾‹å¦‚ï¼šusersã€booksâ€¦. æ ¹æ®RESTé£æ ¼å¯¹èµ„æºè¿›è¡Œè®¿é—®ç§°ä¸ºRESTFul 3.2 RESTå…¥é—¨@RequestMappingæ³¨è§£ä¸­methodå±æ€§å¯ä»¥è®¾å®šhttpè¯·æ±‚åœ°å€ï¼Œä¾‹å¦‚ï¼šGETã€POSTã€PUTã€DELETEâ€¦ @PathVariableæ³¨è§£ï¼šç»‘å®šè·¯å¾„å‚æ•°ä¸å¤„ç†å™¨æ–¹æ³•å½¢å‚é—´çš„å…³ç³»ï¼Œè¦æ±‚è·¯å¾„å‚æ•°åä¸å½¢å‚åä¸€ä¸€å¯¹åº” 12345678910111213141516171819202122232425262728293031323334353637@Controllerpublic class UserController &#123; @RequestMapping(value = &quot;/users&quot;, method = RequestMethod.POST) @ResponseBody public String save()&#123; System.out.println(&quot;save~~&quot;); return &quot;save success&quot;; &#125; @RequestMapping(value = &quot;/users&quot;, method = RequestMethod.PUT) @ResponseBody public String update()&#123; System.out.println(&quot;update~~&quot;); return &quot;update success&quot;; &#125; @RequestMapping(value = &quot;/users/&#123;id&#125;&quot;, method = RequestMethod.DELETE) @ResponseBody public String delete(@PathVariable Integer id)&#123; //è·¯å¾„å˜é‡ System.out.println(&quot;delete~~&quot;); return &quot;delete success&quot;; &#125; @RequestMapping(value = &quot;/users&quot;, method = RequestMethod.GET) @ResponseBody public String getAll()&#123; System.out.println(&quot;getAll~~&quot;); return &quot;getAll success&quot;; &#125; @RequestMapping(value = &quot;/users/&#123;id&#125;&quot;, method = RequestMethod.POST) @ResponseBody public String getById(@PathVariable Integer id)&#123; System.out.println(&quot;getById~~&quot;); return &quot;getById success&quot;; &#125;&#125; @RequestBody @RequestParam @PathVariable åŒºåˆ« @RequestParamç”¨äºæ¥æ”¶urlåœ°å€ä¼ å‚æˆ–è¡¨å•ä¼ å‚ @RequestBodyç”¨äºæ¥æ”¶jsonæ•°æ® @PathVariab1eç”¨äºæ¥æ”¶è·¯å¾„å‚æ•°, ä½¿ç”¨{å‚æ•°åç§°}æè¿°è·¯å¾„å‚æ•° åº”ç”¨ åæœŸå¼€å‘ä¸­ï¼Œå‘é€è¯·æ±‚å‚æ•°è¶…è¿‡1ä¸ªæ—¶ï¼Œä»¥jsonæ ¼å¼ä¸ºä¸», @RequestBodyåº”ç”¨è¾ƒå¹¿ å¦‚æœå‘é€éjsonæ ¼å¼æ•°æ® ,é€‰ç”¨@RequestParamæ¥æ”¶è¯·æ±‚å‚æ•° é‡‡ç”¨RESTfulè¿›è¡Œå¼€å‘ï¼Œå½“å‚æ•°æ•°é‡è¾ƒå°‘æ—¶ï¼Œä¾‹å¦‚1ä¸ªï¼Œ å¯ä»¥é‡‡ç”¨@PathVariableæ¥æ”¶è¯·æ±‚è·¯å¾„å˜é‡ï¼Œé€šå¸¸ç”¨äºä¼ é€’idå€¼ 3.3 RESTå¿«é€Ÿå¼€å‘@ResponseBodyï¼š è®¾ç½®å½“å‰æ§åˆ¶å™¨ç±»ä¸ºRESTfulé£æ ¼ï¼Œç­‰åŒäº@Controllerä¸@ResponseBodyä¸¤ä¸ªæ³¨è§£ç»„åˆåŠŸèƒ½ æ ‡å‡†è¯·æ±‚åŠ¨ä½œæ˜ å°„ï¼š @GetMappingï¼šå¯¹åº”GETè¯·æ±‚ @PostMappingï¼šå¯¹åº”POSTè¯·æ±‚ @PutMappingï¼šå¯¹åº”PUTè¯·æ±‚ @DeleteMappingï¼šå¯¹åº”DELETEè¯·æ±‚ 12345678910111213141516171819202122232425262728293031323334//@ResponseBody + @Controller ==&gt; @RestController@RestController@RequestMapping(&quot;/users&quot;)public class UserController &#123; @PostMapping public String save()&#123; System.out.println(&quot;save~~&quot;); return &quot;save success&quot;; &#125; @PutMapping public String update()&#123; System.out.println(&quot;update~~&quot;); return &quot;update success&quot;; &#125; @DeleteMapping(&quot;/&#123;id&#125;&quot;) public String delete(@PathVariable Integer id)&#123; //è·¯å¾„å˜é‡ System.out.println(&quot;delete~~&quot;); return &quot;delete success&quot;; &#125; @GetMapping public String getAll()&#123; System.out.println(&quot;getAll~~&quot;); return &quot;getAll success&quot;; &#125; @PostMapping(&quot;/&#123;id&#125;&quot;) public String getById(@PathVariable Integer id)&#123; System.out.println(&quot;getById~~&quot;); return &quot;getById success&quot;; &#125;&#125; 4.SSMæ•´åˆ5.æ‹¦æˆªå™¨5.1 æ‹¦æˆªå™¨çš„æ¦‚å¿µ æ‹¦æˆªå™¨(Interceptor)æ˜¯ä¸€ç§åŠ¨æ€æ‹¦æˆªæ–¹æ³•è°ƒç”¨çš„æœºåˆ¶ï¼Œå†SpringMVCä¸­åŠ¨æ€æ‹¦æˆªæ§åˆ¶å™¨æ–¹æ³•çš„æ‰§è¡Œ ä½œç”¨ï¼š åœ¨æŒ‡å®šçš„æ–¹æ³•è°ƒç”¨å‰åæ‰§è¡Œé¢„å…ˆè®¾å®šçš„ä»£ç  é˜»æ­¢åŸå§‹æ–¹æ³•çš„æ‰§è¡Œ æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨çš„åŒºåˆ«ï¼š å½’å±ä¸åŒï¼šFilterå±äºServletæŠ€æœ¯ï¼ŒInterceptorå±äºSpringMVCæŠ€æœ¯ æ‹¦æˆªå†…å®¹ä¸åŒï¼šFilterå¯¹æ‰€æœ‰è®¿é—®è¿›è¡Œæ•°æ®å¢å¼ºï¼ŒInterceptorä»…é’ˆå¯¹SpringMVCçš„è®¿é—®è¿›è¡Œå¢å¼º 5.2 æ‹¦æˆªå™¨å…¥é—¨ åˆ¶ä½œæ‹¦æˆªå™¨åŠŸèƒ½ç±» é…ç½®æ‹¦æˆªå™¨çš„æ‰§è¡Œä½ç½® é¡¹ç›®ç»“æ„ï¼š ProjectInterceptorï¼š æ­¤æ—¶preHandleæ–¹æ³•çš„è¿”å›å€¼ä¸ºtrueï¼šæ‰§è¡Œè¯·æ±‚çš„æ–¹æ³• 123456789101112131415161718@Componentpublic class ProjectInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;preHandle~~~&quot;); return true; &#125; @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;postHandle~~~&quot;); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;afterCompletion~~~&quot;); &#125;&#125; SpringMvcSupportï¼š 12345678910@Configurationpublic class SpringMvcSupport extends WebMvcConfigurationSupport &#123; @Autowired private ProjectInterceptor projectInterceptor; @Override protected void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(projectInterceptor).addPathPatterns(&quot;/users&quot;); &#125;&#125; SpringMvcConfigä¸­æ·»åŠ æ‰«æè·¯å¾„â€com.springmvc.configâ€ 12345@Configuration@ComponentScan(&#123;&quot;com.springmvc.controller&quot;,&quot;com.springmvc.config&quot;&#125;)@EnableWebMvcpublic class SpringMvcConfig &#123;&#125; UserControllerï¼š 123456789101112131415161718192021222324252627282930313233@RestController@RequestMapping(&quot;/users&quot;)public class UserController &#123; @PostMapping public String save()&#123; System.out.println(&quot;save~~&quot;); return &quot;save success&quot;; &#125; @PutMapping public String update()&#123; System.out.println(&quot;update~~&quot;); return &quot;update success&quot;; &#125; @DeleteMapping(&quot;/&#123;id&#125;&quot;) public String delete(@PathVariable Integer id)&#123; //è·¯å¾„å˜é‡ System.out.println(&quot;delete~~&quot;); return &quot;delete success&quot;; &#125; @GetMapping public String getAll()&#123; System.out.println(&quot;getAll~~&quot;); return &quot;getAll success&quot;; &#125; @PostMapping(&quot;/&#123;id&#125;&quot;) public String getById(@PathVariable Integer id)&#123; System.out.println(&quot;getById~~&quot;); return &quot;getById success&quot;; &#125;&#125; é¡µé¢å±•ç¤ºï¼š 1getAll success æ§åˆ¶å°æ‰“å°ï¼š 1234preHandle~~~getAll~~postHandle~~~afterCompletion~~~ å¦‚æœpreHandleæ–¹æ³•çš„è¿”å›å€¼ä¸ºfalseï¼šä¸ä¼šæ‰§è¡Œè¯·æ±‚çš„æ–¹æ³• 123456789101112131415161718@Componentpublic class ProjectInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;preHandle~~~&quot;); return false; &#125; @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;postHandle~~~&quot;); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;afterCompletion~~~&quot;); &#125;&#125; é¡µé¢æ— å†…å®¹ï¼Œè¢«æ‹¦æˆª æ§åˆ¶å°æ‰“å°ï¼š 1preHandle~~~ æ‰€ä»¥å¯ä»¥é€šè¿‡ifè¯­å¥è¿›è¡ŒæŸç§åˆ¤æ–­ï¼Œè¿”å›trueæˆ–falseï¼Œæ¥æ˜¯å¦æ‰§è¡Œè¯·æ±‚çš„æ–¹æ³• 5.3 æ‹¦æˆªå™¨å‚æ•°å‰ç½®å¤„ç†ï¼š 1234567@Overridepublic boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;preHandle~~~&quot;); return true;&#125; å‚æ•°ï¼š requestï¼šè¯·æ±‚å¯¹è±¡ responseï¼šå“åº”å¯¹è±¡ handleï¼šè¢«è°ƒç”¨çš„å¤„ç†å™¨å¯¹è±¡ï¼Œæœ¬è´¨ä¸ºä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œå¯¹åå°„æŠ€æœ¯ä¸­çš„Methodå¯¹è±¡è¿›è¡Œäº†å†åŒ…è£… è¿”å›å€¼ï¼š è¿”å›å€¼ä¸ºfalseï¼Œè¢«æ‹¦æˆªçš„å¤„ç†å°†ä¸æ‰§è¡Œ è¿”å›å€¼ä¸ºtrueï¼Œè¢«æ‹¦æˆªçš„å¤„ç†å°†ä¼šæ‰§è¡Œ åç½®å¤„ç†ï¼š 1234567@Overridepublic void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;postHandle~~~&quot;);&#125; å‚æ•°ï¼š modelAndViewï¼šå¦‚æœå¤„ç†å™¨æ‰§è¡Œå®Œæˆå…·æœ‰è¿”å›ç»“æœï¼Œå¯ä»¥è¯»å–åˆ°å¯¹åº”æ•°æ®ä¸é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œè°ƒæ•´(äº†è§£å³å¯) å®Œæˆåå¤„ç†ï¼š 1234567@Overridepublic void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;afterCompletion~~~&quot;);&#125; å‚æ•°ï¼š exï¼šå¦‚æœå¤„ç†æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸å¯¹è±¡ï¼Œå¯ä»¥é’ˆå¯¹å¼‚å¸¸æƒ…å†µè¿›è¡Œå•ç‹¬å¤„ç†(äº†è§£å³å¯) 5.4 æ‹¦æˆªå™¨é“¾é…ç½®(äº†è§£) å½“é…ç½®å¤šä¸ªæ‹¦æˆªå™¨æ—¶ï¼Œå½¢æˆæ‹¦æˆªé“¾ æ‹¦æˆªå™¨é“¾çš„è¿è¡Œé¡ºåºï¼š preHandleï¼šä¸é…ç½®é¡ºåºç›¸åŒï¼Œå¿…å®šè¿è¡Œ postHandleï¼šä¸é…ç½®é¡ºåºç›¸åï¼Œå¯èƒ½ä¸è¿è¡Œ afterCompletionï¼šä¸é…ç½®é¡ºåºç›¸åï¼Œå¯èƒ½ä¸è¿è¡Œ ä½†æ‹¦æˆªå™¨å‡ºç°å¯¹åŸå§‹å¤„ç†å™¨çš„æ‹¦æˆªï¼Œåé¢çš„æ‹¦æˆªå™¨å‡ç»ˆæ­¢è¿è¡Œ å½“æ‹¦æˆªå™¨è¿è¡Œä¸­æ–­ï¼Œä»…è¿è¡Œé…ç½®å†å‰é¢çš„æ‹¦æˆªå™¨çš„afterCompletionæ“ä½œ é€šå¸¸å¼€å‘é¡¹ç›®æ—¶ï¼Œå¾ˆå°‘ä¼šç”¨åˆ°æ‹¦æˆªå™¨é“¾ï¼Œä¸€èˆ¬ä¸€ä¸ªæ‹¦æˆªå™¨å°±å¯ä»¥è§£å†³é—®é¢˜ æŒ‰ç…§1ã€2ã€3çš„é¡ºåºé…ç½® 12345678910111213141516@Configurationpublic class SpringMvcSupport extends WebMvcConfigurationSupport &#123; @Autowired private ProjectInterceptor1 projectInterceptor1; @Autowired private ProjectInterceptor2 projectInterceptor2; @Autowired private ProjectInterceptor3 projectInterceptor3; @Override protected void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(projectInterceptor1).addPathPatterns(&quot;/users&quot;); registry.addInterceptor(projectInterceptor2).addPathPatterns(&quot;/users&quot;); registry.addInterceptor(projectInterceptor3).addPathPatterns(&quot;/users&quot;); &#125;&#125; å…¨éƒ¨çš„preHandleæ–¹æ³•è¿”å›å€¼éƒ½ä¸ºtrueï¼š graph LR; pre1-->pre2-->pre3-->c(controller)-->post3-->post2-->post1-->after3-->after2-->after1; 3çš„preHandleæ–¹æ³•è¿”å›å€¼ä¸ºfalseï¼š graph LR; pre1-->pre2-->pre3-->after2-->after1; 2çš„preHandleæ–¹æ³•è¿”å›å€¼ä¸ºfalseï¼š graph LR; pre1-->pre2-->after1; 1çš„preHandleæ–¹æ³•è¿”å›å€¼ä¸ºfalseï¼š graph LR; pre1;","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"SpringCloudæ¡†æ¶çš„å­¦ä¹ ç¬”è®°","slug":"Java/SpringCloudæ¡†æ¶","date":"2022-08-06T11:11:16.320Z","updated":"2022-09-27T14:18:51.088Z","comments":true,"path":"2022/08/06/Java/SpringCloudæ¡†æ¶/","link":"","permalink":"http://example.com/2022/08/06/Java/SpringCloud%E6%A1%86%E6%9E%B6/","excerpt":"","text":"å¾®æœåŠ¡æŠ€æœ¯æ ˆï¼š å®ç”¨ç¯‡1.å¾®æœåŠ¡æ²»ç†1.1 è®¤è¯†å¾®æœåŠ¡å•ä½“æ¶æ„ï¼š å•ä½“æ¶æ„ï¼šå°†ä¸šåŠ¡çš„æ‰€æœ‰åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ªé¡¹ç›®å¼€å‘ï¼Œæ‰“æˆä¸€ä¸ªåŒ…éƒ¨ç½² ä¼˜ç‚¹ï¼š æ¶æ„ç®€å• éƒ¨ç½²æˆæœ¬ä½ ç¼ºç‚¹ï¼š è€¦åˆåº¦é«˜ ç‰¹ç‚¹ï¼š ç®€å•æ–¹ä¾¿ã€é«˜åº¦è€¦åˆã€æ‹“å±•æ€§å·®ã€é€‚åˆå°å‹é¡¹ç›® åˆ†å¸ƒå¼æ¶æ„ï¼š åˆ†å¸ƒå¼æ¶æ„ï¼šæ ¹æ®ä¸šåŠ¡åŠŸèƒ½å¯¹ç³»ç»Ÿè¿›è¡Œæ‹†åˆ†ï¼Œæ¯ä¸ªä¸šåŠ¡æ¨¡å—ä½œä¸ºç‹¬ç«‹é¡¹ç›®å¼€å‘ï¼Œç§°ä¸ºä¸€ä¸ªæœåŠ¡ ä¼˜ç‚¹ï¼š é™ä½æœåŠ¡è€¦åˆ æœ‰åˆ©äºæœåŠ¡å‡çº§æ‹“å±• åˆ†å¸ƒå¼æ¶æ„æ‰€è¦è€ƒè™‘çš„é—®é¢˜ï¼š æœåŠ¡æ‹†åˆ†ç²’åº¦å¦‚ä½•ï¼Ÿ æœåŠ¡é›†ç¾¤åœ°å€å¦‚ä½•ç»´æŠ¤ï¼Ÿ æœåŠ¡ä¹‹é—´å¦‚ä½•å®ç°è¿œç¨‹è°ƒç”¨ï¼Ÿ æœåŠ¡å¥åº·çŠ¶æ€å¦‚ä½•æ„ŸçŸ¥ï¼Ÿ ç‰¹ç‚¹ï¼š æ¾è€¦åˆã€æ‹“å±•æ€§å¥½ï¼Œä½†æ¶æ„å¤æ‚ã€éš¾åº¦å¤§ï¼Œé€‚åˆå¤§å‹äº’è”ç½‘é¡¹ç›® å¾®æœåŠ¡ç‰¹ç‚¹ï¼š å¾®æœåŠ¡æ˜¯ä¸€ç§ç»è¿‡è‰¯å¥½æ¶æ„è®¾è®¡çš„åˆ†å¸ƒå¼æ¶æ„ å¾®æœåŠ¡æ¶æ„ç‰¹å¾ï¼š å•ä¸€èŒè´£ï¼š å¾®æœåŠ¡æ‹†åˆ†ç²’åº¦æ›´å°ï¼Œæ¯ä¸€ä¸ªæœåŠ¡éƒ½å¯¹åº”å”¯ä¸€çš„ä¸šåŠ¡èƒ½åŠ›ï¼Œåšåˆ°å•ä¸€èŒè´£ï¼Œé¿å…å•ä¸€èŒè´£ï¼Œé¿å…é‡å¤å¼€å‘ é¢å‘æœåŠ¡ï¼š å¾®æœåŠ¡å¯¹å¤–æš´éœ²ä¸šåŠ¡æ¥å£ è‡ªæ²»ï¼š å›¢é˜Ÿç‹¬ç«‹ã€æŠ€æœ¯ç‹¬ç«‹ã€æ•°æ®ç‹¬ç«‹ã€éƒ¨ç½²ç‹¬ç«‹ éš”ç¦»æ€§å¼ºï¼š æœåŠ¡è°ƒç”¨åšå¥½éš”ç¦»ã€å®¹é”™ã€é™çº§ã€é¿å…å‡ºç°çº§è”é—®é¢˜ ä¼˜ç‚¹ï¼š æ‹†åˆ†ç²’åº¦æ›´å°ã€æœåŠ¡æ›´ç‹¬ç«‹ã€è€¦åˆåº¦æ›´ä½ ç¼ºç‚¹ï¼š æ¶æ„éå¸¸å¤æ‚ã€è¿ç»´ã€ç›‘æ§ã€éƒ¨ç½²éš¾åº¦æ›´é«˜ å¾®æœåŠ¡æŠ€æœ¯ï¼š å¾®æœåŠ¡è¿™ç§æ–¹æ¡ˆéœ€è¦æŠ€æœ¯è½åœ°ï¼Œå…¨çƒçš„äº’è”ç½‘å…¬å¸éƒ½åœ¨ç§¯æå°è¯•è‡ªå·±çš„å¾®æœåŠ¡è½åœ°æŠ€æœ¯ åœ¨å›½å†…æœ€çŸ¥åçš„å°±æ˜¯SpringCloudå’Œé˜¿é‡Œå·´å·´çš„Dubbo å¾®æœåŠ¡æŠ€æœ¯å¯¹æ¯”ï¼š Dubbo SpringCloud SpringCloudAlibaba æ³¨å†Œä¸­å¿ƒ zookeeperã€Redis Eurekaã€Consul Nacosã€Eureka æœåŠ¡è¿œç¨‹è°ƒç”¨ Dubboåè®®(RFCåè®®) Feign(httpåè®®) Dubboã€Feign é…ç½®ä¸­å¿ƒ æ—  SpringCloudConfig SpringCloudConfigã€Nacos æœåŠ¡ç½‘å…³ æ—  SpringCloudGatewayã€Zuul SpringCloudGatwayã€Zuul æœåŠ¡ç›‘æ§å’Œä¿æŠ¤ dubbo-admin(åŠŸèƒ½å¼±) Hystrix Sentinel ä¼ä¸šéœ€æ±‚ï¼š SpringCloud+Feign ä½¿ç”¨SpringCloudæŠ€æœ¯æ ˆ æœåŠ¡æ¥å£é‡‡ç”¨Restfulé£æ ¼ æœåŠ¡è°ƒç”¨é‡‡ç”¨Feignæ–¹å¼ SpringCloudAlibaba+Feign ä½¿ç”¨SpringCloudAlibabaæŠ€æœ¯æ ˆ æœåŠ¡æ¥å£é‡‡ç”¨Restfulé£æ ¼ æœåŠ¡è°ƒç”¨é‡‡ç”¨Feignæ–¹å¼ SpringCloudAlibaba+Dubbo ä½¿ç”¨SpringCloudAlibabaæŠ€æœ¯æ ˆ æœåŠ¡æ¥å£é‡‡ç”¨Dubboåè®®æ ‡å‡† æœåŠ¡è°ƒç”¨é‡‡ç”¨Dubboæ–¹å¼ DubboåŸå§‹æ¨¡å¼ åŸºäºDubboè€æ—§æŠ€æœ¯ä½“ç³» æœåŠ¡æ¥å£é‡‡ç”¨Dubboåè®®æ ‡å‡† æœåŠ¡è°ƒç”¨é‡‡ç”¨Dubboæ–¹å¼ SpringCloudï¼š SpringCloudæ˜¯ç›®å‰å›½å†…ä½¿ç”¨æœ€å¹¿æ³›çš„å¾®æœåŠ¡æ¡†æ¶ SpringCloudé›†æˆäº†å„ç§å¾®æœåŠ¡åŠŸèƒ½ç»„ä»¶ï¼Œå¹¶åŸºäºSpringBootå®ç°äº†è¿™äº›ç»„ä»¶çš„è‡ªåŠ¨è£…é…ï¼Œä»è€Œæä¾›äº†è‰¯å¥½çš„å¼€ç®±å³ç”¨ä½“éªŒï¼š SpringCloudä¸SpringBootçš„å­˜åœ¨ç‰ˆæœ¬å…¼å®¹å…³ç³» æœ¬æ¬¡å­¦ä¹ é‡‡ç”¨çš„ç‰ˆæœ¬ä¸º Hoxton.SR10ï¼Œå› æ­¤å¯¹åº”çš„SpringBootç‰ˆæœ¬ä¸º2.3.xç‰ˆæœ¬ 1.2 åˆ†å¸ƒå¼æœåŠ¡æ¶æ„æ¡ˆä¾‹æœåŠ¡æ‹†åˆ†æ³¨æ„äº‹é¡¹ï¼š ä¸åŒå¾®æœåŠ¡ï¼Œä¸è¦é‡å¤å¼€å‘ç›¸åŒä¸šåŠ¡ å¾®æœåŠ¡æ•°æ®ç‹¬ç«‹ï¼Œä¸è¦è®¿é—®å…¶ä»–å¾®æœåŠ¡çš„æ•°æ®åº“ å¾®æœåŠ¡å¯ä»¥å°†è‡ªå·±çš„ä¸šåŠ¡æš´éœ²ä¸ºæ¥å£ï¼Œä¾›å…¶ä»–çš„æœåŠ¡è°ƒç”¨ 1.3 æœåŠ¡æ‹†åˆ†æœåŠ¡æ‹†åˆ†æ³¨æ„äº‹é¡¹ï¼š 1.ä¸åŒå¾®æœåŠ¡ï¼Œä¸è¦é‡å¤å¼€å‘ç›¸åŒä¸šåŠ¡ 2.å¾®æœåŠ¡æ•°æ®ç‹¬ç«‹ï¼Œä¸è¦è®¿é—®å…¶å®ƒå¾®æœåŠ¡çš„æ•°æ®åº“ 3.å¾®æœåŠ¡å¯ä»¥å°†è‡ªå·±çš„ä¸šåŠ¡æš´éœ²ä¸ºæ¥å£ï¼Œä¾›å…¶ä»–å¾®æœåŠ¡è°ƒç”¨ æ¡ˆä¾‹ï¼šæ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•åŠŸèƒ½ éœ€æ±‚ï¼šæ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•çš„åŒæ—¶ï¼ŒæŠŠè®¢å•æ‰€å±çš„ç”¨æˆ·ä¿¡æ¯ä¸€èµ·è¿”å› æŸ¥è¯¢è®¢å•ä¿¡æ¯ï¼šhttp://localhost:8080/order/101 1234567&#123; &quot;id&quot;:101, &quot;price&quot;:699900, &quot;name&quot;:&quot;Apple è‹¹æœ iPhone 12 &quot;, &quot;num&quot;:1,&quot;userId&quot;:1, &quot;user&quot;:null&#125; userä¿¡æ¯ä¸ºnullï¼Œæˆ‘ä»¬éœ€è¦åœ¨æŸ¥è¯¢è®¢å•ä¿¡æ¯çš„åŒæ—¶ï¼Œä¹Ÿå¯ä»¥è·å¾—è®¢å•æ‰€å±ç”¨æˆ·ä¿¡æ¯ æˆ‘ä»¬å¯ä»¥è°ƒç”¨useræœåŠ¡çš„æ¥å£ åœ¨order-serviceæœåŠ¡çš„OrderApplicationä¸­æ³¨å†ŒRestTemplateï¼š 1234567891011121314@MapperScan(&quot;cn.itcast.order.mapper&quot;)@SpringBootApplicationpublic class OrderApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(OrderApplication.class, args); &#125; //åˆ›å»ºRestTemplateå¯¹è±¡å¹¶æ³¨å…¥Springå®¹å™¨ @Bean public RestTemplate restTemplate()&#123; return new RestTemplate(); &#125;&#125; OrderServiceä¸­æ·»åŠ httpè¯·æ±‚ï¼š 12345678910111213141516171819202122@Servicepublic class OrderService &#123; @Autowired private OrderMapper orderMapper; @Autowired private RestTemplate restTemplate; public Order queryOrderById(Long orderId) &#123; // 1.æŸ¥è¯¢è®¢å• Order order = orderMapper.findById(orderId); // 2.åˆ©ç”¨restTemplateå‘useræœåŠ¡å‘é€httpè¯·æ±‚ String url = &quot;http://localhost:8081/user/&quot; + order.getUserId(); User user = restTemplate.getForObject(url, User.class); order.setUser(user); // 3.è¿”å› return order; &#125;&#125; é‡æ–°æŸ¥è¯¢è®¢å•ä¿¡æ¯ï¼šhttp://localhost:8080/order/101 123456789101112&#123; &quot;id&quot;:101, &quot;price&quot;:699900, &quot;name&quot;:&quot;Apple è‹¹æœ iPhone 12 &quot;, &quot;num&quot;:1, &quot;userId&quot;:1, &quot;user&quot;:&#123; &quot;id&quot;:1, &quot;username&quot;:&quot;æŸ³å²©&quot;, &quot;address&quot;:&quot;æ¹–å—çœè¡¡é˜³å¸‚&quot; &#125;&#125; æˆåŠŸè·å¾—userä¿¡æ¯ï¼ 3.Eureka3.1 æä¾›è€…ä¸æ¶ˆè´¹è€… æœåŠ¡æä¾›è€…ï¼šä¸€æ¬¡ä¸šåŠ¡ï¼Œè¢«å…¶ä»–å¾®æœåŠ¡è°ƒç”¨çš„æœåŠ¡(æä¾›æ¥å£ç»™å…¶ä»–å¾®æœåŠ¡) æœåŠ¡æ¶ˆè´¹è€…ï¼šä¸€æ¬¡ä¸šåŠ¡ï¼Œè°ƒç”¨å…¶ä»–å¾®æœåŠ¡çš„æœåŠ¡(è°ƒç”¨å…¶ä»–å¾®æœåŠ¡æä¾›çš„æ¥å£) æœåŠ¡Aè°ƒç”¨äº†æœåŠ¡Bï¼ŒæœåŠ¡Båˆè°ƒç”¨æœåŠ¡Cï¼ŒæœåŠ¡Bå±äºä»€ä¹ˆï¼Ÿ ç›¸å¯¹äºAï¼Œå°±æ˜¯æ¶ˆè´¹è€…ï¼›ç›¸å¯¹äºCï¼Œå°±æ˜¯æä¾›è€… æä¾›è€…ä¸æ¶ˆè´¹è€…å…¶å®æ˜¯ç›¸å¯¹çš„ 3.2 EurekaåŸç†åˆ†æåœ¨OrderServiceä¸­ï¼š 1String url = &quot;http://localhost:8081/user/&quot; + order.getUserId(); å¦‚æœæ¯æ¬¡æ›´æ”¹æœåŠ¡ç«¯å£ï¼Œéƒ½éœ€è¦é‡æ–°ä¿®æ”¹ä»£ç å—ï¼Ÿ å¦‚æœæœ‰å¤šä¸ªuseræœåŠ¡å®ä¾‹ï¼Œä½†æ˜¯æ€»æ˜¯è°ƒç”¨ä¸€ä¸ªç«¯å£ï¼Œå…¶ä½™çš„useræœåŠ¡æ€ä¹ˆåŠï¼Ÿ æœåŠ¡æ¶ˆè´¹è€…è¯¥å¦‚ä½•è·å–æœåŠ¡æä¾›è€…çš„åœ°å€ä¿¡æ¯å‘¢ï¼Ÿ å¦‚æœæœ‰å¤šä¸ªæœåŠ¡æä¾›è€…ï¼Œæ¶ˆè´¹è€…è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ æ¶ˆè´¹è€…å¦‚ä½•å¾—åˆ°æœåŠ¡æä¾›è€…çš„å¥åº·çŠ¶æ€å‘¢ï¼Ÿ Eurekaçš„ä½œç”¨ï¼š æœåŠ¡æ¶ˆè´¹è€…è¯¥å¦‚ä½•è·å–æœåŠ¡æä¾›è€…çš„åœ°å€ä¿¡æ¯å‘¢ï¼Ÿ æœåŠ¡æä¾›è€…å¯åŠ¨æ—¶é—´å‘Eurekaæ³¨å†Œè‡ªå·±çš„ä¿¡æ¯ Eurekaä¿å­˜è¿™äº›ä¿¡æ¯ æ¶ˆè´¹è€…æ ¹æ®æœåŠ¡åç§°å‘Eurekaæ‹‰å–æä¾›è€…ä¿¡æ¯ å¦‚æœæœ‰å¤šä¸ªæœåŠ¡æä¾›è€…ï¼Œæ¶ˆè´¹è€…è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ æœåŠ¡æ¶ˆè´¹è€…åˆ©ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä»æœåŠ¡åˆ—è¡¨ä¸­æŒ‘é€‰ä¸€ä¸ª æ¶ˆè´¹è€…å¦‚ä½•å¾—åˆ°æœåŠ¡æä¾›è€…çš„å¥åº·çŠ¶æ€å‘¢ï¼Ÿ æœåŠ¡æä¾›è€…ä¼šæ¯éš”30ç§’å‘EurekaServerå‘é€å¿ƒè·³è¯·æ±‚ï¼ŒæŠ¥å‘Šå¥åº·çŠ¶å†µ Eurekaä¼šæ›´æ–°è®°å½•æœåŠ¡åˆ—è¡¨ä¿¡æ¯ï¼Œå¿ƒè·³ä¸ä¼šæ­£å¸¸ä¼šè¢«è¸¢å‡º æ¶ˆè´¹è€…å°±å¯ä»¥æ‹‰å–åˆ°æœ€æ–°çš„ä¿¡æ¯ åœ¨Eurekaæ¶æ„ä¸­ï¼Œå¾®æœåŠ¡è§’è‰²æœ‰ä¸¤ç±»ï¼š EurekaServerï¼šæœåŠ¡ç«¯ï¼Œæ³¨å†Œä¸­å¿ƒ è®°å½•æœåŠ¡ä¿¡æ¯ å¿ƒè·³ç›‘æ§ EurekaClientï¼š å®¢æˆ·ç«¯ providerï¼šæœåŠ¡æä¾›çœï¼Œä¾‹å¦‚æ¡ˆä¾‹ä¸­çš„ user-service æ³¨å†Œè‡ªå·±çš„ä¿¡æ¯åˆ°EurekaServer æ¯éš”30ç§’å‘Eureka Serverå‘é€å¿ƒè·³ consumerï¼šæœåŠ¡æ¶ˆè´¹è€…ï¼Œä¾‹å¦‚æ¡ˆä¾‹ä¸­çš„ order-service æ ¹æ®æœåŠ¡åç§°ä»Eurekaserveræ‹‰å–æœåŠ¡åˆ—è¡¨ åŸºäºæœåŠ¡åˆ—è¡¨åšè´Ÿè½½å‡è¡¡ï¼Œé€‰ä¸­ä¸€ä¸ªå¾®æœåŠ¡åå‘èµ·è¿œç¨‹è°ƒç”¨ 3.3 æ­å»ºEurekaæœåŠ¡ åˆ›å»ºé¡¹ç›®ï¼Œå¼•å…¥spring-cloud-starter-netflix-eureka-serverä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™å¯åŠ¨ç±»ï¼Œæ·»åŠ @EnableEurekaServeræ³¨è§£ 1234567@EnableEurekaServer@SpringBootApplicationpublic class EurekaApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(EurekaApplication.class, args); &#125;&#125; æ·»åŠ applcation.yamlæ–‡ä»¶ï¼Œé…ç½®ä¿¡æ¯ï¼š 123456789server: port: 10086 #æœåŠ¡ç«¯å£spring: application: name: eurekaserver #eurekaçš„æœåŠ¡åç§°eureka: client: service-url: #eurekaçš„åœ°å€ä¿¡æ¯ defaultZone: http://127.0.0.1:10086/eureka 3.4 æœåŠ¡æ³¨å†Œæ³¨å†Œuser-serviceæœåŠ¡æ³¨å†Œåˆ°EurekaServerï¼š åœ¨user-serviceé¡¹ç›®å¼•å…¥spring-cloud-starter-netflix-eureka-clientçš„ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨application.yamlæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢çš„é…ç½®ï¼š 1234567spring: application: name: userserviceeureka: client: service-url: defaultZone: http://localhost:10086/eureka æ³¨å†Œå¤šä¸ªuser-serviceæœåŠ¡ï¼š åœ¨ideaä¸­ï¼Œæ‰¾åˆ°user-serviceæœåŠ¡ï¼Œå³é”®é€‰æ‹©å¤åˆ¶é…ç½®ï¼š ç¬¬ä¸€ä¸ªuser-serviceæœåŠ¡çš„ç«¯å£ä¸º8081ï¼Œ æˆ‘å°†ç¬¬äºŒä¸ªuser-serviceæœåŠ¡çš„ç«¯å£è®¾ç½®ä¸º8082(å¯éšæ„è®¾ç½®ï¼Œä½†ä¸è¦ä½¿ç”¨å ç”¨çš„ç«¯å£) 3.5 æœåŠ¡å‘ç°åœ¨order-serviceå®ŒæˆæœåŠ¡æ‹‰å– æœåŠ¡æ‹‰å–åŸºäºæœåŠ¡åç§°è·å–æœåŠ¡åˆ—è¡¨ï¼Œç„¶ååœ¨å¯¹æœåŠ¡åˆ—è¡¨åšè´Ÿè½½å‡è¡¡ ä¿®æ”¹OrderServiceçš„ä»£ç ï¼Œä¿®æ”¹è®¿é—®çš„urlè·¯å¾„ï¼Œç”¨æœåŠ¡åæ›¿ä»£ipã€ç«¯å£ï¼š 1String url = &quot;http://userservice/user/&quot; + order.getUserId(); å®Œæ•´ä»£ç ï¼š 12345678910111213141516171819202122@Servicepublic class OrderService &#123; @Autowired private OrderMapper orderMapper; @Autowired private RestTemplate restTemplate; public Order queryOrderById(Long orderId) &#123; // 1.æŸ¥è¯¢è®¢å• Order order = orderMapper.findById(orderId); //åˆ©ç”¨restTemplateå‘useræœåŠ¡å‘é€httpè¯·æ±‚ String url = &quot;http://userservice/user/&quot; + order.getUserId(); User user = restTemplate.getForObject(url, User.class); order.setUser(user); // 4.è¿”å› return order; &#125;&#125; åœ¨order-serviceé¡¹ç›®çš„å¯åŠ¨ç±»OrderApplicationä¸­RestTemplateæ·»åŠ è´Ÿè½½å‡è¡¡æ³¨è§£ï¼š 12345@Bean@LoadBalanced //è´Ÿè½½å‡è¡¡æ³¨è§£public RestTemplate restTemplate()&#123; return new RestTemplate();&#125; å®Œæ•´ä»£ç ï¼š 1234567891011121314@MapperScan(&quot;cn.itcast.order.mapper&quot;)@SpringBootApplicationpublic class OrderApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(OrderApplication.class, args); &#125; @Bean @LoadBalanced public RestTemplate restTemplate()&#123; return new RestTemplate(); &#125;&#125; 3.6 æ€»ç»“ æ­å»ºEurekaServeræ³¨å†Œä¸­å¿ƒ å¼•å…¥eureka-serverä¾èµ– æ·»åŠ @EnableEurekaServeræ³¨è§£ åœ¨application.yamlä¸­é…ç½®eurekaåœ°å€ æœåŠ¡æ³¨å†Œ å¼•å…¥eureka-clientä¾èµ– åœ¨application.yamlä¸­æ·»åŠ eurekaåœ°å€ æœåŠ¡å‘ç° å¼•å…¥eureka-clientä¾èµ– åœ¨application.yamlä¸­æ·»åŠ eurekaåœ°å€ ç»™RestTemplateé…ç½®beanä¸­æ·»åŠ @LoadBalancedæ³¨è§£ ç”¨æœåŠ¡æä¾›è€…åœ¨eurekaæ³¨å†Œçš„æœåŠ¡åç§°è¿œç¨‹è°ƒç”¨ 4.Ribbon4.1 è´Ÿè½½å‡è¡¡åŸç†è´Ÿè½½å‡è¡¡æµç¨‹ï¼š graph LR A[order-service] B{Ribbonè´Ÿè½½å‡è¡¡} C(eureka-service) D[user-service:8081] E[user-service:8082] A--1.å‘èµ·è¯·æ±‚http://userservice/user/1-->B B--2.æ‹‰å–userservice-->C C--3.è¿”å›æœåŠ¡åˆ—è¡¨localhost:8081localhost:8082-->B B--4.è½®è¯¢åˆ°8081-->D B-->E è´Ÿè½½å‡è¡¡åŸç†ï¼š graph LR A[order-service] B[RibbonLoadBalancerClient] C[DynamicServerListLoadBalancer] D(eureka-service) E[IRule] F[user-service:8081] G[user-service:8082] A--1.å‘èµ·è¯·æ±‚http://userservice/user/1-->B C--3.æ‹‰å–userservice-->D D--4.è¿”å›æœåŠ¡åˆ—è¡¨localhost:8081localhost:8082-->C subgraph LoadBalancerInterceptorè´Ÿè½½å‡è¡¡æ‹¦æˆªå™¨ B--2.è·å–urlä¸­çš„æœåŠ¡iduserservice-->C C--5.æœåŠ¡è´Ÿè½½å‡è¡¡localhost:8081localhost:8082-->E E--6.é€‰æ‹©æŸä¸ªæœåŠ¡localhost:8081-->B end subgraph è¯·æ±‚ B-->F B-.->G end 4.2 è´Ÿè½½å‡è¡¡ç­–ç•¥(IRule)Ribbonçš„è´Ÿè½½å‡è¡¡æ˜¯ä¸€ä¸ªå«åšIRuleçš„æ¥å£æ¥å®šä¹‰çš„ï¼Œæ¯ä¸€ä¸ªå­æ¥å£éƒ½æ˜¯ä¸€ç§è§„åˆ™ï¼š classDiagram IRule A A-.éä¸´æ—¶å®ä¾‹nacosä¸»åŠ¨è¯¢é—®.->C A--ä¸»åŠ¨æ¨é€å˜æ›´ä¿¡æ¯push-->B åœ¨nacosé‡Œåˆ›å»ºçš„å®ä¾‹é»˜è®¤ä¸ºä¸´æ—¶å®ä¾‹ æœåŠ¡æ³¨å†Œåˆ°Nacosæ—¶ï¼Œå¯ä»¥é€‰æ‹©æ³¨å†Œä¸ºä¸´æ—¶æˆ–éä¸´æ—¶å®ä¾‹ï¼Œé€šè¿‡ä¸‹é¢çš„é…ç½®æ¥è®¾ç½®ï¼š 1234567spring: application: name: orderservice cloud: nacos: discovery: ephemeral: false #flaseä¸ºéä¸´æ—¶å®ä¾‹ï¼Œé»˜è®¤ä¸ºtrueä¸´æ—¶å®ä¾‹ æ€»ç»“ï¼š Nacosä¸eurekaçš„å…±åŒç‚¹ éƒ½æ”¯æŒæœåŠ¡æ³¨å†Œå’ŒæœåŠ¡æ‹‰å– éƒ½æ”¯æŒæœåŠ¡æä¾›è€…å¿ƒè·³æ–¹å¼åšå¥åº·æ£€æµ‹ Nacosä¸Eurekaçš„åŒºåˆ« Nacosæ”¯æŒæœåŠ¡ç«¯ä¸»åŠ¨æ£€æµ‹æä¾›è€…çŠ¶æ€ï¼šä¸´æ—¶å®ä¾‹é‡‡ç”¨å¿ƒè·³æ¨¡å¼ï¼Œéä¸´æ—¶å®ä¾‹é‡‡ç”¨ä¸»åŠ¨æ£€æµ‹æ¨¡å¼ ä¸´æ—¶å®ä¾‹å¿ƒè·³ä¸æ­£å¸¸ä¼šè¢«å‰”é™¤ï¼Œéä¸´æ—¶å®ä¾‹åˆ™ä¸ä¼šè¢«å‰”é™¤ Nacosæ”¯æŒæœåŠ¡åˆ—è¡¨å˜æ›´çš„æ¶ˆæ¯æ¨é€æ¨¡å¼ï¼ŒæœåŠ¡åˆ—è¡¨æ›´æ–°æ›´åŠæ—¶ Nacosé›†ç¾¤é»˜è®¤é‡‡ç”¨APæ–¹å¼ï¼Œå½“é›†ç¾¤ä¸­å­˜åœ¨éä¸´æ—¶å®ä¾‹æ—¶ï¼Œé‡‡ç”¨CPæ¨¡å¼ï¼›Eurekaé‡‡ç”¨APæ–¹å¼ 6.Nacosé…ç½®ç®¡ç†6.1 Nacoså®ç°é…ç½®ç®¡ç†ç»Ÿä¸€é…ç½®ç®¡ç† é…ç½®æ›´æ”¹çƒ­æ›´æ–°ï¼š æ–°å»ºé…ç½®ï¼š æ‰“å¼€Nacosæ§åˆ¶å°ï¼Œç‚¹å‡»é…ç½®ç®¡ç†-&gt;é…ç½®åˆ—è¡¨ï¼Œç‚¹å‡»å³è¾¹çš„+ å· å¡«å…¥é…ç½®ï¼š é…ç½®æ–‡ä»¶idåï¼š[æœåŠ¡åç§°]-[profile].[åç¼€å] åç¼€åä¸é…ç½®æ ¼å¼ä¸€è‡´ åˆ†ç»„ï¼šé»˜è®¤å³å¯ é…ç½®æ ¼å¼ï¼šæ¨èä½¿ç”¨yamlæ ¼å¼ ç¤ºä¾‹ï¼š è·å–é…ç½®æ­¥éª¤ï¼š graph LR A{é¡¹ç›®å¯åŠ¨} B(è¯»å–æœ¬åœ°é…ç½®æ–‡ä»¶application.yaml) C(åˆ›å»ºSpringå®¹å™¨) D(åŠ è½½bean) E(è¯»å–nacosä¸­çš„é…ç½®æ–‡ä»¶) A--naocsåœ°å€bootstrap.yaml-->E E-->B-->C-->D å¼•å…¥Nacosçš„é…ç½®ç®¡ç†å®¢æˆ·ç«¯ä¾èµ–ï¼š åœ¨user-serviceé¡¹ç›®å¼•å…¥ä¾èµ–ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨é…ç½®æ–‡ä»¶åŒçº§æ–‡ä»¶åŒ…ä¸­æ–°å»ºbootstrap.yamlï¼Œå¹¶åˆ é™¤application.yamlä¸­çš„nacosçš„ç›¸å…³é…ç½® bootstrap.yamlå†…å®¹å¦‚ä¸‹ï¼š 12345678910spring: application: name: userservice #æœåŠ¡åç§° profiles: active: dev #ç¯å¢ƒ cloud: nacos: server-addr: 43.142.167.75:8848 #nacosåœ°å€ config: file-extension: yaml #æ–‡ä»¶åç¼€ä¸ºyaml åœ¨UserControllerä¸­ï¼Œæµ‹è¯•è¯»å–Nacosä¸­çš„é…ç½®ï¼š 123456789101112@RestController@RequestMapping(&quot;/user&quot;)public class UserController &#123; //æ³¨å…¥nacosä¸­çš„é…ç½®å±æ€§ @Value(&quot;$&#123;pattern.dateformat&#125;&quot;) private String dateformat; //é€šè¿‡dateformatçš„æ—¶é—´æ ¼å¼ï¼Œè¿”å›æ ¼å¼åŒ–çš„æ—¶é—´ @GetMapping(&quot;/now&quot;) public String getDateformat()&#123; return LocalDateTime.now().format(DateTimeFormatter.ofPattern(dateformat)); &#125;&#125; æ€»ç»“ï¼š å°†é…ç½®äº¤ç»™Nacosç®¡ç†çš„æ­¥éª¤ï¼š åœ¨Nacosä¸­æ·»åŠ é…ç½®æ–‡ä»¶ åœ¨å¾®æœåŠ¡ä¸­å¼•å…¥nacosçš„configä¾èµ– åœ¨å¾®æœåŠ¡ä¸­æ·»åŠ bootstrap.ymlï¼Œ é…ç½®nacosåœ°å€å½“å‰ç¯å¢ƒã€æœåŠ¡åç§°ã€æ–‡ä»¶åç¼€åã€‚è¿™äº›å†³å®šäº†ç¨‹åºå¯åŠ¨æ—¶å»nacosè¯»å–å“ªä¸ªæ–‡ä»¶ 6.2 é…ç½®çƒ­æ›´æ–°Nacosä¸­éƒ½é…ç½®æ–‡ä»¶å˜æ›´åï¼Œå¾®æœåŠ¡æ— éœ€é‡å¯å°±å¯ä»¥æ„ŸçŸ¥ã€‚ä¸è¿‡éœ€è¦é€šè¿‡ä¸¤ç§é…ç½®å®ç°ï¼š æ–¹å¼ä¸€ï¼šåœ¨@Valueæ³¨å…¥çš„å˜é‡æ‰€åœ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@RefreshScope 123456789101112@RestController@RequestMapping(&quot;/user&quot;)@RefreshScopepublic class UserController &#123; @Value(&quot;$&#123;pattern.dateformat&#125;&quot;) private String dateformat; @GetMapping(&quot;/now&quot;) public String getDateformat()&#123; return LocalDateTime.now().format(DateTimeFormatter.ofPattern(dateformat)); &#125;&#125; æ–¹å¼äºŒï¼šä½¿ç”¨@ConfigurationProperties(prefix = &quot;&quot;)æ³¨è§£ æ–°å»ºconfigåŒ…ï¼Œåˆ›å»ºPatternPropertiesç±»ï¼š 123456@Data@Component //äº¤ç»™springç®¡ç†@ConfigurationProperties(prefix = &quot;pattern&quot;)public class PatternProperties &#123; private String dateformat;&#125; åœ¨UserControlleræ³¨å…¥PatternPropertiesï¼š 123456789101112@RestController@RequestMapping(&quot;/user&quot;)public class UserController &#123; //æ³¨å…¥PatternProperties @Autowired private PatternProperties patternProperties; @GetMapping(&quot;/now&quot;) public String getDateformat()&#123; return LocalDateTime.now().format(DateTimeFormatter.ofPattern(patternProperties.getDateformat())); &#125;&#125; æ€»ç»“ï¼š Nacosé…ç½®æ›´æ”¹åï¼Œå¾®æœåŠ¡å¯ä»¥å®ç°çƒ­æ›´æ–°ï¼Œæ–¹å¼å¦‚ä¸‹ï¼š é€šè¿‡@valueæ³¨è§£æ³¨å…¥ï¼Œç»“åˆ@Refreshscopeæ¥åˆ·æ–° é€šè¿‡@ConfiqurationPropertiesæ³¨å…¥ï¼Œè‡ªåŠ¨åˆ·æ–° æ³¨æ„äº‹é¡¹ï¼š ä¸æ˜¯æ‰€æœ‰çš„é…ç½®éƒ½é€‚åˆæ”¾åˆ°é…ç½®ä¸­å¿ƒï¼Œç»´æŠ¤èµ·æ¥æ¯”è¾ƒéº»çƒ¦ å»ºè®®å°†ä¸€äº›å…³é”®å‚æ•°ï¼Œéœ€è¦è¿è¡Œæ—¶è°ƒæ•´çš„å‚æ•°æ”¾åˆ°nacosé…ç½®ä¸­å¿ƒï¼Œä¸€èˆ¬éƒ½æ˜¯è‡ªå®šä¹‰é…ç½® 6.3 å¤šç¯å¢ƒé…ç½®å…±äº«å¾®æœåŠ¡å¯åŠ¨ä¼šä»nacosè¯»å–å¤šä¸ªé…ç½®æ–‡ä»¶ï¼š [spring.application.name]-[spring.profile.active].yamlï¼Œä¾‹å¦‚ï¼šuserservice-dev.yaml [spring.application.name].yamlï¼Œä¾‹å¦‚ï¼šuserservice.yaml æ— è®ºprofileå¦‚ä½•å˜åŒ–ï¼Œ[spring.application.name].yamlè¿™ä¸ªæ–‡ä»¶ä¸€å®šä¼šåŠ è½½çš„ï¼Œå› æ­¤å¯ä»¥å¤šç¯å¢ƒå…±äº«é…ç½®å¯ä»¥å†™å…¥è¿™ä¸ªæ–‡ä»¶ å¤šé…ç½®çš„ä¼˜å…ˆçº§ï¼š æœåŠ¡å-profile.yaml &gt; æœåŠ¡å.yaml &gt; æœ¬åœ°é…ç½® æ€»ç»“ï¼š å¾®æœåŠ¡ä¼šä»nacosè¯»å–çš„é…ç½®æ–‡ä»¶ï¼š [æœåŠ¡å]-[spring-profile.active].yamlï¼Œç¯å¢ƒé…ç½® [æœåŠ¡å].yamlï¼Œé»˜è®¤é…ç½®ï¼Œå¤šç¯å¢ƒå…±äº« ä¼˜å…ˆçº§ [æœåŠ¡å]-[ç¯å¢ƒ].yaml &gt; [æœåŠ¡å].yamlï¼æœ¬åœ°é…ç½® 6.4 Nacosé›†ç¾¤æ­å»ºNacosç”Ÿäº§ç¯å¢ƒä¸‹ä¸€å®šè¦éƒ¨ç½²ä¸ºé›†ç¾¤çŠ¶æ€ graph TB A(Nacosclient) B[Nginx] C(Nacosnode1) D(Nacosnode2) E(Nacosnode3) F[(MySQLä¸»)] G[(MySQLä»)] H[(MySQLä»)] A-->B B-->C-->F B-->D-->F B-->E-->F subgraph . F-.-G F-.-H end 7.Feign7.1 è¿œç¨‹è°ƒç”¨RestTemplateæ–¹å¼å­˜åœ¨çš„é—®é¢˜ï¼š RestTemplateå‘èµ·è¿œç¨‹è°ƒç”¨ï¼Œç¤ºä¾‹ä»£ç ï¼š 123//åˆ©ç”¨restTemplateå‘useræœåŠ¡å‘é€httpè¯·æ±‚String url = &quot;http://userservice/user/&quot; + order.getUserId();User user = restTemplate.getForObject(url, User.class); å­˜åœ¨é—®é¢˜ï¼š ä»£ç å¯è¯»æ€§å·®ï¼Œç¼–ç¨‹ä½“éªŒä¸ç»Ÿä¸€ å‚æ•°å¤æ‚ï¼ŒURLéš¾ä»¥ç»´æŠ¤ ä¸å¤Ÿä¼˜é›…ï¼ï¼ï¼ ä¼˜é›…çš„Feign ä»‹ç»ï¼š Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„httpå®¢æˆ·ç«¯ã€‚ å…¶ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬ä¼˜é›…çš„å®ç°httpè¯·æ±‚çš„å‘é€ï¼Œè§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ã€‚ ä½¿ç”¨Feignæ­¥éª¤ï¼š å¼•å…¥ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨order-serviceçš„å¯åŠ¨ç®¡ç†ç±»æ·»åŠ å¼€å¯FeignåŠŸèƒ½çš„æ³¨è§£@EnableFeignClientsï¼š 123456789@EnableFeignClients@MapperScan(&quot;cn.itcast.order.mapper&quot;)@SpringBootApplicationpublic class OrderApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(OrderApplication.class, args); &#125;&#125; æ–°å»ºclientsåŒ…ï¼ŒåŒ…ä¸­åˆ›å»ºUserClientï¼Œæ¥ç¼–å†™Feignå®¢æˆ·ç«¯ï¼š 123456@FeignClient(&quot;userservice&quot;)public interface UserClient &#123; @GetMapping(&quot;/user/&#123;id&#125;&quot;) User findById(@PathVariable Long id);&#125; ä½¿ç”¨Feignè¿›è¡Œè¿œç¨‹è°ƒç”¨ 1234567891011121314151617181920@Servicepublic class OrderService &#123; @Autowired private OrderMapper orderMapper; @Autowired private UserClient userClient; public Order queryOrderById(Long orderId) &#123; // 1.æŸ¥è¯¢è®¢å• Order order = orderMapper.findById(orderId); //ä½¿ç”¨Feignè¿œç¨‹è°ƒç”¨ User user = userClient.findById(order.getUserId()); order.setUser(user); // 4.è¿”å› return order; &#125;&#125; æ€»ç»“ï¼š Feignçš„ä½¿ç”¨æ­¥éª¤ï¼š å¼•å…¥ä¾èµ– æ·»åŠ @EnableFeignClientsæ³¨è§£ ç¼–å†™FeignClientæ¥å£ ä½¿ç”¨FiegnClientä¸­å®šä¹‰çš„æ–¹æ³•ä»£æ›¿RestTemplate 7.2 è‡ªå®šä¹‰é…ç½®Feignè¿è¡Œè‡ªå®šä¹‰é…ç½®æ¥è¦†ç›–é»˜è®¤é…ç½®ï¼Œå¯ä»¥ä¿®æ”¹çš„é…ç½®å¦‚ä¸‹ï¼š ç±»å‹ ä½œç”¨ è¯´æ˜ feign.Logger.Level ä¿®æ”¹æ—¥å¿—çº§åˆ« åŒ…å«å››ç§ä¸åŒçš„çº§åˆ«ï¼šNONEã€BASICã€HEADERSã€FULL feign.codec.Decoder å“åº”ç»“æœçš„è§£æå™¨ httpè¿œç¨‹è°ƒç”¨çš„ç»“æœåšè§£æï¼Œä¾‹å¦‚è§£æjsonå­—ç¬¦ä¸²ä¸ºjavaå¯¹è±¡ feign.codec.Encoder è¯·æ±‚å‚æ•°ç¼–ç  å°†è¯·æ±‚å‚æ•°ç¼–ç ï¼Œä¾¿äºé€šè¿‡httpè¯·æ±‚å‘é€ feign.Contract è¯·æ±‚å‚æ•°ç¼–ç  é»˜è®¤æ˜¯SpringMVCçš„æ³¨è§£ feign.Retryer å¤±è´¥é‡è¯•æœºåˆ¶ è¯·æ±‚å¤±è´¥çš„é‡è¯•æœºåˆ¶ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰ï¼Œä¸è¿‡ä¼šä½¿ç”¨Ribbonçš„é‡è¯• ä¸€èˆ¬æˆ‘ä»¬éœ€è¦é…ç½®çš„å°±æ˜¯æ—¥å¿—çº§åˆ« é…ç½®Feignæ—¥å¿—çš„ä¸¤ç§æ–¹å¼ï¼š æ–¹å¼ä¸€ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ å…¨å±€ç”Ÿæ•ˆï¼š 12345feign: client: config: default: #defaultå°±æ˜¯å…¨å±€é…ç½®ï¼Œå¦‚æœå†™çš„æ˜¯æœåŠ¡åç§°ï¼Œå°±æ˜¯é’ˆå¯¹æ­¤æœåŠ¡çš„é…ç½® loggerLevel: FULL #æ—¥å¿—çº§åˆ« å±€éƒ¨ç”Ÿæ•ˆ 12345feign: client: config: userservice: #defaultå°±æ˜¯å…¨å±€é…ç½®ï¼Œå¦‚æœå†™çš„æ˜¯æœåŠ¡åç§°ï¼Œå°±æ˜¯é’ˆå¯¹æ­¤æœåŠ¡çš„é…ç½® loggerLevel: FULL #æ—¥å¿—çº§åˆ« æ–¹å¼äºŒï¼šæ³¨è§£æ–¹å¼ å…ˆå£°æ˜ä¸€ä¸ªBeanï¼š 123456public class FeignClientConfig &#123; @Bean public Logger.Level feignLogLevel() &#123; return Logger.Level.BASIC; &#125;&#125; å…¨å±€é…ç½®ï¼Œå°†beanæ”¾åˆ°@EnableFeignClientsæ³¨è§£ä¸­ï¼š 1@EnableFeignClients(defaultConfiguration = FeignClientConfig.class) å±€éƒ¨é…ç½®ï¼Œå°†beanæ”¾åˆ°@FeignClientæ³¨è§£ä¸­ï¼š 1@FeignClient(value = &quot;userservice&quot;, configuration = FeignClientConfig.class) æ€»ç»“ï¼š Feignçš„æ—¥å¿—é…ç½®ï¼š æ–¹å¼ä¸€æ˜¯é…ç½®æ–‡ä»¶ï¼Œfeign.client.config.xxx.loggerLevel å¦‚æœxxxæ˜¯defaultåˆ™ä»£è¡¨å…¨å±€ å¦‚æœxxxæ˜¯æœåŠ¡åç§°ï¼Œä¾‹å¦‚userserviceåˆ™ä»£è¡¨æŸæœåŠ¡ æ–¹å¼äºŒæ˜¯javaä»£ç é…ç½®Logger.Levelè¿™ä¸ªBean å¦‚æœåœ¨@EnableFeignClientsæ³¨è§£å£°æ˜åˆ™ä»£è¡¨å…¨å±€ å¦‚æœåœ¨@FeignClientæ³¨è§£ä¸­å£°æ˜åˆ™ä»£è¡¨æŸæœåŠ¡ 7.3 æ€§èƒ½ä¼˜åŒ–Feignåº•å±‚çš„å®¢æˆ·ç«¯å®ç°ï¼š URLConnectionï¼šé»˜è®¤å®ç°ï¼Œä¸æ”¯æŒè¿æ¥æ±  Apache HttpClientï¼šæ”¯æŒè¿æ¥æ±  OKHttpï¼šæ”¯æŒè¿æ¥æ±  å› æ­¤ä¼˜åŒ–Feignçš„æ€§èƒ½ä¸»è¦åŒ…æ‹¬ï¼š ä½¿ç”¨è¿æ¥æ± ä»£æ›¿é»˜è®¤çš„URLConnection æ—¥å¿—çº§åˆ«ï¼Œæœ€å¥½ä¸ºbasicæˆ–none Feignæ·»åŠ HttpClientçš„æ”¯æŒï¼š å¼•å…¥ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;io.github.openfeign&lt;/groupId&gt; &lt;artifactId&gt;feign-httpclient&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®è¿æ¥æ± ï¼š 12345feign: httpclient: enabled: true #å¼€å¯feignå¯¹HttpClientçš„æ”¯æŒ max-connections: 200 #æœ€å¤§è¿æ¥æ•° max-connections-per-route: 50 #æ¯ä¸ªè·¯å¾„çš„æœ€å¤§è¿æ¥æ•° æ€»ç»“ï¼š Feignçš„ä¼˜åŒ–ï¼š æ—¥å¿—çº§åˆ«å°½é‡ç”¨basic ä½¿ç”¨HttpClientæˆ–OKHttpä»£æ›¿URLConnection å¼•å…¥feign-httpclientä¾èµ– é…ç½®æ–‡ä»¶å¼€å¯httpClientåŠŸèƒ½ï¼Œè®¾ç½®è¿æ¥æ± å‚æ•° 7.4 æœ€ä½³å®è·µFeignçš„æœ€ä½³å®è·µ æ–¹å¼ä¸€ï¼šç»§æ‰¿ ç»™æ¶ˆè´¹è€…çš„FeignClientå’Œæä¾›è€…çš„Controllerå®šä¹‰ç»Ÿä¸€çš„çˆ¶æ¥å£ä½œä¸ºæ ‡å‡† 2.Docker3.å¼‚æ­¥é€šä¿¡4.åˆ†å¸ƒå¼æœç´¢0","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"SpringBootæ¡†æ¶çš„å­¦ä¹ ç¬”è®°","slug":"Java/SpringBootæ¡†æ¶","date":"2022-08-06T11:11:16.318Z","updated":"2022-09-27T14:17:53.588Z","comments":true,"path":"2022/08/06/Java/SpringBootæ¡†æ¶/","link":"","permalink":"http://example.com/2022/08/06/Java/SpringBoot%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.çƒ­éƒ¨ç½²2.é…ç½®é«˜çº§2.1 è‡ªå®šä¹‰beanå±æ€§ç»‘å®šå¯¼å…¥lombokåæ ‡ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt;&lt;/dependency&gt; application.yamlé…ç½®ä¸­ï¼š 1234servers: ipAddress: 127.0.0.1 port: 2345 timeout: -1 ServerConfigç±»ä¸­ï¼š @ConfigurationPropertiesæ³¨è§£å°†application.yamlé…ç½®ä¸­çš„å±æ€§è¿›è¡Œç»‘å®š 12345678@Component@Data@ConfigurationProperties(prefix = &quot;servers&quot;)public class ServerConfig &#123; private String ipAddress; private int port; private long timeout;&#125; æµ‹è¯•ï¼š 12345678910@SpringBootTestclass ApplicationTests &#123; @Autowired private ServerConfig serverConfig; @Test void testGetServer() &#123; System.out.println(serverConfig); &#125;&#125; 2.2 ç¬¬ä¸‰æ–¹beanå±æ€§ç»‘å®šå¯¼å…¥druidåæ ‡ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt;&lt;/dependency&gt; application.yamlä¸­ï¼š 12dataSource: driverClassName: com.mysql.jdbc.driver123 é…ç½®beanï¼š 123456789101112@Configurationpublic class DataSourceConfig &#123; @Bean @ConfigurationProperties(prefix = &quot;datasource&quot;) public DruidDataSource dataSource() &#123; DruidDataSource dataSource = new DruidDataSource(); //ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§è¿›è¡Œæ³¨å…¥ //dataSource.setDriverClassName(&quot;com.mysql.jdbc.driver&quot;); return dataSource; &#125;&#125; æµ‹è¯•ï¼š 12345678910@SpringBootTestclass ApplicationTests &#123; @Autowired private DruidDataSource dataSource; @Test void testDataSource() &#123; System.out.println(dataSource.getDriverClassName()); &#125;&#125; @EnableConfigurationPropertiesæ³¨è§£ï¼š å¼€å¯å±æ€§ç»‘å®šå¹¶è®¾ç½®å¯¹åº”çš„ç›®æ ‡ å¯ä»¥å°†ä½¿ç”¨çš„@ConfigurationPropertiesæ³¨è§£å¯¹åº”çš„ç±»åŠ å…¥Springå®¹å™¨ @EnableConfigurationPropertiesæ³¨è§£ä¸@Componentæ³¨è§£ä¸èƒ½åŒæ—¶ä½¿ç”¨ 123456789101112@Configuration@EnableConfigurationProperties(ServerConfig.class)public class DataSourceConfig &#123; @Bean @ConfigurationProperties(prefix = &quot;datasource&quot;) public DruidDataSource dataSource() &#123; DruidDataSource dataSource = new DruidDataSource(); //dataSource.setDriverClassName(&quot;123456&quot;); return dataSource; &#125;&#125; æ­¤æ—¶è¦å°†ServerConfigä¸­çš„@Componentæ³¨é‡Šåˆ é™¤ï¼š å¦‚æœä¸åˆ é™¤@Componentæ³¨é‡Šï¼Œåˆ™ä¼šé€ æˆbeanåŠ è½½ä¸¤æ¬¡ï¼ŒæŠ¥é”™ 12345678//@Component@Data@ConfigurationProperties(prefix = &quot;servers&quot;)public class ServerConfig &#123; private String ipAddress; private int port; private long timeout;&#125; å¦‚æœideaå‡ºç°Spring Boot Configuration Annotation Processor not configuredé—®é¢˜ï¼š å¯¼å…¥åæ ‡å³å¯ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;&lt;/dependency&gt; 2.3 æ¾æ•£ç»‘å®š@ConfigurationPropertiesæ³¨è§£ï¼šç»‘å®šå±æ€§æ”¯æŒå±æ€§åå®½æ¾ç»‘å®š 12345678@Component@Data@ConfigurationProperties(prefix = &quot;servers&quot;)public class ServerConfig &#123; private String ipAddress; private int port; private long timeout;&#125; æ”¯æŒå¤šç§æ ¼å¼ï¼š 12345678servers: #ipAddress: 127.0.0.1 #é©¼å³°æ ¼å¼ #ipaddress: 127.0.0.1 #ip_address: 127.0.0.1 #unlineæ ¼å¼ #IPADDRESS: 127.0.0.1 #IP_ADDRESS: 127.0.0.1 #å¸¸é‡æ ¼å¼ #IP_ADD_RE_SS: 127.0.0.1 ip-address: 127.0.0.1 #çƒ¤è‚‰ä¸²æ ¼å¼ æ³¨æ„ï¼šå®½æ¾ç»‘å®šä¸æ”¯æŒ@value æ³¨è§£å¼•ç”¨å•ä¸ªå±æ€§çš„æ–¹å¼ @ConfigurationPropertiesæ³¨è§£ï¼šç»‘å®šå±æ€§æ”¯æŒå±æ€§åå®½æ¾ç»‘å®š ç»‘å®šå‰ç¼€è§„èŒƒï¼š æŒ‡çš„æ˜¯ï¼šprefix = &quot;datasource&quot;ä¸­çš„datasource ä»…èƒ½ç”¨ä½¿ç”¨å°å†™å­—æ¯ã€æ•°å­—ã€ä¸­åˆ’çº¿ä½œä¸ºåˆæ³•å­—ç¬¦ 1234567@Bean@ConfigurationProperties(prefix = &quot;datasource&quot;)public DruidDataSource dataSource() &#123; DruidDataSource dataSource = new DruidDataSource(); //dataSource.setDriverClassName(&quot;123456&quot;); return dataSource;&#125; 2.4 å¸¸ç”¨è®¡é‡å•ä½çš„åº”ç”¨123456servers: ipAddress: 127.0.0.1 #é©¼å³°æ ¼å¼ port: 2345 timeout: -1 serverTimeout: 3 dataSize: 10 æŒ‡å®šå•ä½ï¼š 123456789101112@Component@Data@ConfigurationProperties(prefix = &quot;servers&quot;)public class ServerConfig &#123; private String ipAddress; private int port; private long timeout; //longç±»å‹æè¿°æ—¶é—´å•ä½ä¸ºæ¯«ç§’ @DurationUnit(ChronoUnit.HOURS) //æŒ‡å®šæè¿°æ—¶é—´å•ä½ä¸ºå°æ—¶ private Duration serverTimeout; @DataSizeUnit(DataUnit.MEGABYTES) //æŒ‡å®šå†…å­˜å¤§å°å•ä½ä¸ºMB private DataSize dataSize;&#125; 2.4 beanå±æ€§æ ¡éªŒå¯¼å…¥JSR303è§„èŒƒæ¥å£çš„åæ ‡ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;javax.validation&lt;/groupId&gt; &lt;artifactId&gt;validation-api&lt;/artifactId&gt;&lt;/dependency&gt; å¯¼å…¥ä½¿ç”¨hibernateæ¡†æ¶æä¾›çš„æ ¡éªŒå™¨åšå®ç°ç±»çš„åæ ‡ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.hibernate.validator&lt;/groupId&gt; &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;&lt;/dependency&gt; @Validatedæ³¨è§£ä¸ºå¼€å¯beançš„æ ¡éªŒåŠŸèƒ½ï¼š @Minæ³¨è§£ä¸ºè®¾ç½®æœ€å°å€¼ï¼Œå¹¶è®¾ç½®æç¤ºä¿¡æ¯ @Maxæ³¨è§£ä¸ºè®¾ç½®æœ€å¤§å€¼ï¼Œå¹¶è®¾ç½®æç¤ºä¿¡æ¯ ç­‰ç­‰è¿˜æœ‰å¾ˆå¤šâ€¦ 123456789@Component@Data@ConfigurationProperties(prefix = &quot;servers&quot;)@Validatedpublic class ServerConfig &#123; @Min(value = 1000, message = &quot;æœ€å°å€¼ä¸èƒ½è¶…è¿‡1000&quot;) @Max(value = 8888, message = &quot;æœ€å¤§å€¼ä¸èƒ½è¶…è¿‡8888&quot;) private int port;&#125; 2.5 è¿›åˆ¶æ•°æ®è½¬æ¢è§„åˆ™é…ç½®æ–‡ä»¶çš„dataSourceä¸­çš„passwordè®¾ç½®ä¸º012345ï¼š 123dataSource: driverClassName: com.mysql.jdbc.driver123 password: 012345 æµ‹è¯•ï¼š 123456789@SpringBootTestclass ApplicationTests &#123; @Autowired private DruidDataSource dataSource; @Test void testDataSource() &#123; System.out.println(dataSource.getPassword()); &#125;&#125; è·å–çš„passordä¸º5347ï¼Œæ˜æ˜¾ä¸è®¾ç½®çš„å¯†ç ä¸ç¬¦ è¿™æ˜¯å› ä¸º0å¼€å¤´çš„å¯†ç è¢«å½“æˆå…«è¿›åˆ¶è¿›è¡Œå¤„ç†äº† å°†å¯†ç ç”¨æ”¹ç”¨å­—ç¬¦ä¸²å½¢å¼ï¼Œç”¨åŒå¼•å·åŒ…è£¹ï¼š 123dataSource: driverClassName: com.mysql.jdbc.driver123 password: &quot;012345&quot; yamlè¯­æ³•è§„åˆ™ å­—é¢å€¼è¡¨è¾¾æ–¹å¼ï¼š 12345678boolean: TRUE #TRUE true True FALSE False falseå‡å¯float: 3.14 #æ”¯æŒç§‘å­¦è®¡æ•°æ³• 6.5201314e+5int: 123 #æ”¯æŒäºŒè¿›åˆ¶ å…«è¿›åˆ¶ åå…­è¿›åˆ¶null: ~ #ä½¿ç”¨ ~ è¡¨ç¤ºnullstring1: HelloWord #å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥ä¹¦å†™string2: &quot;Hello Word&quot; #å¯ä»¥ä½¿ç”¨åŒå¼•å·åŒ…è£¹ç‰¹æ®Šå­—ç¬¦data: 2022-07-27 #æ—¥æœŸæ ¼å¼å¿…é¡»ä½¿ç”¨yyyy-MM-ddæ ¼å¼datatime: 2022-07-27T20:37:30+08:00 #æ—¥æœŸä¸æ—¶é—´ä¹‹é—´ä½¿ç”¨Tè¿æ¥ï¼Œæœ€åä½¿ç”¨+ä»£è¡¨æ—¶åŒº 3.æµ‹è¯•3.1 åŠ è½½æµ‹è¯•ä¸“ç”¨å±æ€§application.yamlé…ç½®æ–‡ä»¶ä¸­ï¼š 12test: prop: testVal æµ‹è¯•ï¼Œè¯»å–propå€¼ï¼š 1234567891011@SpringBootTestpublic class PropertiesAndArgsTest &#123; @Value(&quot;$&#123;test.prop&#125;&quot;) private String val; @Test void testProperties() &#123; System.out.println(val); &#125;&#125; è¿è¡Œç»“æœï¼štestVal ç¬¬ä¸€ç§æ–¹å¼ï¼špropertieså±æ€§ å¯ä»¥ä½¿ç”¨@SpringBootTestæ³¨è§£ä¸­ï¼š propertieså±æ€§å¯ä»¥ä¸ºå½“å‰æµ‹è¯•ç”¨ä¾‹æ·»åŠ ä¸´æ—¶çš„å±æ€§é…ç½® å¹¶ä¸”å¯ä»¥è¦†ç›–ä¸»é…ç½®æ–‡ä»¶çš„å±æ€§é…ç½® ä¼˜ç‚¹ï¼šæ¯”å¤šç¯å¢ƒå¼€å‘ä¸­çš„æµ‹è¯•ç¯å¢ƒå½±å“èŒƒå›´æ›´å°ï¼Œä»…å¯¹å½“å‰æµ‹è¯•ç±»æœ‰æ•ˆ 1234567891011@SpringBootTest(properties = &#123;&quot;test.prop=test1&quot;&#125;)public class PropertiesAndArgsTest &#123; @Value(&quot;$&#123;test.prop&#125;&quot;) private String val; @Test void testProperties() &#123; System.out.println(val); &#125;&#125; è¿è¡Œç»“æœï¼štest1 ç¬¬äºŒç§æ–¹å¼ï¼šargså±æ€§ å¯ä»¥ä½¿ç”¨@SpringBootTestæ³¨è§£ä¸­ï¼š argså±æ€§å¯ä»¥ä¸ºå½“å‰æµ‹è¯•ç”¨ä¾‹æ·»åŠ ä¸´æ—¶å‘½ä»¤è¡Œå‚æ•° å¹¶ä¸”å¯ä»¥è¦†ç›–ä¸»é…ç½®æ–‡ä»¶çš„å±æ€§é…ç½® 1234567891011@SpringBootTest(args = &#123;&quot;--test.prop=test2&quot;&#125;)public class PropertiesAndArgsTest &#123; @Value(&quot;$&#123;test.prop&#125;&quot;) private String val; @Test void testProperties() &#123; System.out.println(val); &#125;&#125; è¿è¡Œç»“æœï¼štest2 ç¬¬ä¸‰ç§æ–¹å¼ï¼šåŒæ—¶ä½¿ç”¨propertieså±æ€§ä»¥åŠargså±æ€§ 1234567891011@SpringBootTest(properties = &#123;&quot;test.prop=test1&quot;&#125;, args = &#123;&quot;--test.prop=test2&quot;&#125;)public class PropertiesAndArgsTest &#123; @Value(&quot;$&#123;test.prop&#125;&quot;) private String val; @Test void testProperties() &#123; System.out.println(val); &#125;&#125; è¿è¡Œç»“æœï¼štest2 æ‰€ä»¥ï¼Œä¼˜å…ˆçº§ä¸ºå‘½ä»¤è¡Œå‚æ•°argså±æ€§ &gt; propertieså±æ€§ &gt; application.yamlé…ç½®æ–‡ä»¶ 3.2 åŠ è½½æµ‹è¯•ä¸“ç”¨é…ç½®åœ¨teståŒ…ä¸‹åˆ›å»ºMsgConfigé…ç½®ç±»ï¼š ä»…æœåŠ¡äºæµ‹è¯•ä¸‹çš„ï¼Œä¸èƒ½å®šä¹‰åœ¨mainåŒ…ä¸‹ï¼Œå¦‚æœå®šä¹‰åˆ°mainåŒ…ä¸‹å°±å±äºæºç çº§åˆ«äº† å¯¼å…¥ç¬¬ä¸‰æ–¹beanå¤ªéº»çƒ¦ï¼Œç®€å•çš„å®šä¹‰ä¸€ä¸ªbean 1234567@Configurationpublic class MsgConfig &#123; @Bean public String Msg()&#123; return &quot;bean msg&quot;; &#125;&#125; ä½¿ç”¨@Importæ³¨è§£åŠ è½½å½“å‰æµ‹è¯•ç±»ä¸“ç”¨çš„é…ç½®ï¼š 1234567891011@SpringBootTest@Import(&#123;MsgConfig.class&#125;)public class ConfigTest &#123; @Autowired private String Msg; @Test void testGetMsg() &#123; System.out.println(Msg); &#125;&#125; 3.3 æµ‹è¯•ç±»å¯åŠ¨Webç¯å¢ƒå¯¼å…¥åæ ‡ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»ºä¸€ä¸ªUserControllerï¼š 12345678910@RestController@RequestMapping(&quot;/users&quot;)public class UserController &#123; @GetMapping public String getById()&#123; System.out.println(&quot;getById is running&quot;); return &quot;UserId&quot;; &#125;&#125; æµ‹è¯•ï¼š webEnvironmentå±æ€§ï¼š SpringBootTest.WebEnvironment.NONEä¸ºé»˜è®¤å…³é—­webç¯å¢ƒ SpringBootTest.WebEnvironment.DEFINED_PORTä¸ºé…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„ç«¯å£ SpringBootTest.WebEnvironment.RANDOM_PORTä¸ºéšæœºç«¯å£ 1234567@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)public class MvcTest &#123; @Test void testRandomPort() &#123; &#125;&#125; è™šæ‹Ÿå‘é€è¯·æ±‚ï¼š 12345678910111213@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)@AutoConfigureMockMvc //å¼€å¯è™šæ‹ŸMvcçš„è°ƒç”¨public class MvcTest &#123; @Test //æ³¨å…¥è™šæ‹ŸMvcè°ƒç”¨å¯¹è±¡ void testWeb(@Autowired MockMvc mockMvc) throws Exception &#123; //åˆ›å»ºè™šæ‹Ÿè¯·æ±‚ï¼Œå½“å‰è®¿é—®/booksï¼Œgetè¯·æ±‚ MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get(&quot;/users&quot;); //æ‰§è¡Œè¯·æ±‚ mockMvc.perform(builder); &#125;&#125; 3.4 è™šæ‹Ÿè¯·æ±‚åŒ¹é…å“åº”è™šæ‹Ÿè¯·æ±‚çŠ¶æ€åŒ¹é…ï¼š 12345678910111213141516@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)@AutoConfigureMockMvcpublic class MvcTest &#123; @Test void testStatus(@Autowired MockMvc mockMvc) throws Exception &#123; MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get(&quot;/users&quot;); ResultActions actions = mockMvc.perform(builder); //å®šä¹‰æœ¬æ¬¡è°ƒç”¨çš„é¢„æœŸå€¼ StatusResultMatchers status = MockMvcResultMatchers.status(); //é¢„è®¡æœ¬æ¬¡è°ƒç”¨æˆåŠŸï¼ŒçŠ¶æ€ä¸º200 ResultMatcher ok = status.isOk(); //æ·»åŠ é¢„è®¡å€¼åˆ°æœ¬æ¬¡è°ƒç”¨ä¸­è¿›è¡Œæ¯”è¾ƒ actions.andExpect(ok); &#125;&#125; è™šæ‹Ÿè¯·æ±‚ä½“åŒ¹é…ï¼š 12345678910111213141516@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)@AutoConfigureMockMvcpublic class MvcTest &#123; @Test void testBody(@Autowired MockMvc mockMvc) throws Exception &#123; MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get(&quot;/users&quot;); ResultActions actions = mockMvc.perform(builder); //å®šä¹‰æœ¬æ¬¡è°ƒç”¨çš„é¢„æœŸå€¼ ContentResultMatchers content = MockMvcResultMatchers.content(); //é¢„è®¡æœ¬æ¬¡è°ƒç”¨æˆåŠŸï¼Œå“åº”å€¼ä¸º&quot;UserId&quot; ResultMatcher result = content.string(&quot;UserId&quot;); //æ·»åŠ é¢„è®¡å€¼åˆ°æœ¬æ¬¡è°ƒç”¨ä¸­è¿›è¡Œæ¯”è¾ƒ actions.andExpect(result); &#125;&#125; è™šæ‹Ÿè¯·æ±‚ä½“(Json)åŒ¹é…ï¼š å¯¼å…¥åæ ‡ï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;cn.hutool&lt;/groupId&gt; &lt;artifactId&gt;hutool-all&lt;/artifactId&gt; &lt;version&gt;5.7.17&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºUserå®ä½“ç±»ï¼š 123456@Datapublic class User &#123; private int id; private String name; private int age;&#125; UserControllerä¸­ï¼š 1234567891011121314@RestController@RequestMapping(&quot;/users&quot;)public class UserController &#123; @GetMapping public User getById()&#123; System.out.println(&quot;getById is running&quot;); User user = new User(); user.setId(1); user.setAge(18); user.setName(&quot;å¤§é»„&quot;); return user; &#125;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)@AutoConfigureMockMvc //å¼€å¯è™šæ‹ŸMvcçš„è°ƒç”¨public class MvcTest &#123; @Test void testJson(@Autowired MockMvc mockMvc) throws Exception &#123; MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get(&quot;/users&quot;); ResultActions actions = mockMvc.perform(builder); //å®šä¹‰æœ¬æ¬¡è°ƒç”¨çš„é¢„æœŸå€¼ ContentResultMatchers content = MockMvcResultMatchers.content(); //é¢„è®¡æœ¬æ¬¡è°ƒç”¨æˆåŠŸï¼Œè¿”å›çš„å€¼ User user = new User(); user.setId(1); user.setAge(18); user.setName(&quot;å¤§é»„&quot;); String userJson = JSONUtil.toJsonStr(user); //è½¬æ¢æˆJson ResultMatcher result = content.json(userJson); //æ·»åŠ é¢„è®¡å€¼åˆ°æœ¬æ¬¡è°ƒç”¨ä¸­è¿›è¡Œæ¯”è¾ƒ actions.andExpect(result); &#125;&#125; è™šæ‹Ÿè¯·æ±‚å¤´åŒ¹é…ï¼š æµ‹è¯•ï¼š 12345678910111213141516@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)@AutoConfigureMockMvc //å¼€å¯è™šæ‹ŸMvcçš„è°ƒç”¨public class MvcTest &#123; @Test void testContentType(@Autowired MockMvc mockMvc) throws Exception &#123; MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get(&quot;/users&quot;); ResultActions actions = mockMvc.perform(builder); //å®šä¹‰æœ¬æ¬¡è°ƒç”¨çš„é¢„æœŸå€¼ HeaderResultMatchers header = MockMvcResultMatchers.header(); //é¢„è®¡æœ¬æ¬¡è°ƒç”¨æˆåŠŸï¼Œè¿”å›çš„å€¼ ResultMatcher contentType = header.string(&quot;Content-Type&quot;, &quot;application/json&quot;); //æ·»åŠ é¢„è®¡å€¼åˆ°æœ¬æ¬¡è°ƒç”¨ä¸­è¿›è¡Œæ¯”è¾ƒ actions.andExpect(contentType); &#125;&#125; é€šå¸¸æµ‹è¯•ï¼Œä¼šå†™åˆ°ä¸€èµ·ï¼š 123456789101112131415161718192021222324252627@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)@AutoConfigureMockMvc //å¼€å¯è™šæ‹ŸMvcçš„è°ƒç”¨public class MvcTest &#123; @Test void testGetById(@Autowired MockMvc mockMvc) throws Exception &#123; MockHttpServletRequestBuilder builder = MockMvcRequestBuilders.get(&quot;/users&quot;); ResultActions actions = mockMvc.perform(builder); StatusResultMatchers status = MockMvcResultMatchers.status(); ResultMatcher ok = status.isOk(); actions.andExpect(ok); HeaderResultMatchers header = MockMvcResultMatchers.header(); ResultMatcher contentType = header.string(&quot;Content-Type&quot;, &quot;application/json&quot;); actions.andExpect(contentType); ContentResultMatchers content = MockMvcResultMatchers.content(); User user = new User(); user.setId(1); user.setAge(18); user.setName(&quot;å¤§é»„&quot;); String userJson = JSONUtil.toJsonStr(user); //è½¬æ¢æˆJson ResultMatcher result = content.json(userJson); actions.andExpect(result); &#125;&#125; 3.5 ä¸šåŠ¡å±‚æµ‹è¯•äº‹åŠ¡å›æ»šå¯¼å…¥åæ ‡ï¼š 12345678910111213141516&lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.5.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.2.11&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ï¼š 1234567891011121314151617spring: datasource: druid: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://localhost:3306/demo?serverTimezone=UTC username: root password: 123456mybatis-plus: global-config: db-config: table-prefix: tbl_ #å°†idè®¾ä¸ºè‡ªåŠ¨å¢é•¿ id-type: auto configuration: #å¼€å¯æ—¥å¿—ï¼Œæ ‡å‡†è¾“å‡ºï¼šå°†æ•°æ®æ‰“å°åˆ°æ§åˆ¶å° log-impl: org.apache.ibatis.logging.stdout.StdOutImpl Daoå±‚ï¼š 1234@Mapperpublic interface BookDao extends BaseMapper&lt;Book&gt;&#123;&#125; Serviceå±‚ï¼š 123public interface BookService extends IService&lt;Book&gt; &#123; boolean saveBook(Book book);&#125; 12345678@Servicepublic class BookServiceImpl extends ServiceImpl&lt;BookDao, Book&gt; implements BookService &#123; @Override public boolean saveBook(Book book) &#123; return save(book); &#125;&#125; æµ‹è¯•ï¼š @Transactionalï¼šä¸ºæµ‹è¯•ç”¨ä¾‹æ·»åŠ äº‹åŠ¡ï¼ŒSpringBootä¼šå¯¹æµ‹è¯•ç”¨ä¾‹å¯¹åº”çš„äº‹åŠ¡æäº¤æ“ä½œè¿›è¡Œå›æ»š@Rollbackï¼šé»˜è®¤ä¸ºtrue(å¯ä¸å†™æ­¤æ³¨é‡Š)ï¼Œæ”¹ä¸ºfalseä¸ºæäº¤äº‹åŠ¡ï¼Œä¸å›æ»š 1234567891011121314151617@SpringBootTest@Transactional //å¼€å¯SpringBootäº‹åŠ¡@Rollback(value = true) //é»˜è®¤valueå€¼ä¸ºtrueï¼Œå¼€å¯å›æ»š(å¯ä¸å†™)ï¼›valueå€¼ä¸ºfalseï¼Œå…³é—­å›æ»špublic class DaoTest &#123; @Autowired private BookService bookService; @Test void testSave() &#123; Book book = new Book(); book.setName(&quot;springboot&quot;); book.setType(&quot;java&quot;); book.setDescription(&quot;è¿™æ˜¯ä¹¦&quot;); bookService.saveBook(book); &#125;&#125; 3.6 æµ‹è¯•ç”¨ä¾‹è®¾ç½®éšæœºæ•°æ®åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š 123456testcase: book: id: $&#123;random.int&#125; name: ç”¨æˆ·$&#123;random.value&#125; #å¯åŠ å‰ç¼€ uuid: $&#123;random.uuid&#125; time: $&#123;random.long&#125; æµ‹è¯•ï¼š 1234@Testvoid testBookCase(@Autowired BookCase bookCase) &#123; System.out.println(bookCase);&#125; å¤šæ¬¡è¿è¡Œï¼š 1BookCase(id=-1723189530, name=ç”¨æˆ·36fc0553fae0662a1398f194a79d702c, uuid=c4f742bf-85b8-4416-836d-ab656e20c050, time=9037975923279012585) 1BookCase(id=1758479696, name=ç”¨æˆ·4952f34e3caadde83261a58b5c9a439f, uuid=4a5747f7-80ff-4161-8771-8dfdce6c470a, time=-2080170540354815861) 1BookCase(id=1773052492, name=ç”¨æˆ·88777f3bd07cb35dfe29b18b4873e7ed, uuid=3bd7d980-d5d6-46f2-bbf3-c190cdfe28ec, time=-4024744750514505719) æµ‹è¯•é€šå¸¸é‡‡ç”¨éšæœºå€¼è¿›è¡Œæµ‹è¯•ï¼Œä½¿ç”¨SpringBootæä¾›çš„éšæœºæ•°ä¸ºå…¶èµ‹å€¼ï¼š 12345678testcase: book: id: $&#123;random.int&#125; # éšæœºæ•´æ•° id2: $&#123;random.int(10)&#125; # 10ä»¥å†…çš„æ•´æ•° id3: $&#123;random.int(5,10)&#125; # 5~10ä¹‹é—´çš„æ•´æ•° name: ç”¨æˆ·$&#123;random.value&#125; # éšæœºå­—ç¬¦ä¸²ï¼ŒMD5å­—ç¬¦ä¸²ï¼Œ32ä½ å¯åŠ å‰ç¼€ uuid: $&#123;random.uuid&#125; # éšæœºuuid time: $&#123;random.long&#125; # éšæœºæ•´æ•°ï¼ŒlongèŒƒå›´ å…¶ä¸­ï¼Œrandom.int(5,10)çš„æ‹¬å·()å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ï¼Œå¦‚[]ã€@@ã€!!ç­‰å‡å¯ 4.æ•°æ®å±‚è§£å†³æ–¹æ¡ˆç°æœ‰æ•°æ®å±‚è§£å†³æ–¹æ¡ˆæŠ€æœ¯é€‰å‹ï¼š Druid + MyBatis-Plus + MySQL æ•°æ®æºï¼šDruidDataSource æŒä¹…åŒ–æŠ€æœ¯ï¼šMyBatis / MyBatis-Plus æ•°æ®åº“ï¼šMySQL 4.1 å†…ç½®æ•°æ®æºæ•°æ®æºé…ç½®æ ¼å¼ï¼š æ ¼å¼ä¸€ï¼š 1234567spring: datasource: druid: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://localhost:3306/demo?serverTimezone=UTC username: root password: 123456 æ ¼å¼äºŒï¼š 1234567spring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://localhost:3306/demo?serverTimezone=UTC username: root password: 123456 type: com.alibaba.druid.pool.DruidDataSource ä»¥ä¸Šä¸¤ç§æ ¼å¼éƒ½æŒ‡å®šæ•°æ®æºä¸ºdruidï¼Œ å¦‚æœæœªæŒ‡å®šæ•°æ®æºå‘¢ï¼Ÿ 123456spring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://localhost:3306/demo?serverTimezone=UTC username: root password: 123456 è¿è¡Œåï¼Œé‡‡ç”¨çš„æ•°æ®æºä¾æ—§æ˜¯druid å› ä¸ºå¯¼å…¥druid-spring-boot-starterçš„åæ ‡ï¼Œä¼šè‡ªåŠ¨é…ç½®æ•°æ®æºï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.2.11&lt;/version&gt;&lt;/dependency&gt; å°†druid-spring-boot-starteråæ ‡æ³¨é‡Šæˆ–åˆ é™¤ï¼Œä¸æä¾›æ•°æ®æºï¼Œ SpringBootä¼šæä¾›3ç§å†…åµŒçš„æ•°æ®æºå¯¹è±¡ä¾›å¼€å‘è€…é€‰æ‹©ï¼š HikariCPï¼šé»˜è®¤å†…ç½®æ•°æ®æºå¯¹è±¡ Tomcatæä¾›DataSourceï¼šHikariCPåœ¨ä¸å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œä¸”åœ¨Webç¯å¢ƒä¸­ï¼Œå°†ä½¿ç”¨TomcatæœåŠ¡å™¨é…ç½®çš„æ•°æ®æºå¯¹è±¡ Commons DBCPï¼šHikariCPå’ŒTomcatæ•°æ®æºéƒ½ä¸å¯ç”¨ï¼Œå°†ä½¿ç”¨dbcpæ•°æ®æº HikariCPæ•°æ®æºé…ç½®ï¼š 12345678spring: datasource: url: jdbc:mysql://localhost:3306/demo?serverTimezone=UTC hikari: driver-class-name: com.mysql.cj.jdbc.Driver username: root password: 123456 maximum-pool-size: 8 4.2 JdbcTemplateSpringBootå†…ç½®JdbcTemplateæŒä¹…åŒ–è§£å†³æ–¹æ¡ˆï¼š å¯¼å…¥åæ ‡ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt; æ­¤å¤–ï¼ŒMyaBtis-Plusåæ ‡å·²ç»åŒ…å«äº†ä¸Šé¢çš„åæ ‡ æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536@SpringBootTestpublic class JdbcTest &#123; @Autowired private JdbcTemplate jdbcTemplate; @Test void testQueryForList() &#123; String sql = &quot;select * from tbl_book where id = 1&quot;; List&lt;Map&lt;String, Object&gt;&gt; books = jdbcTemplate.queryForList(sql); System.out.println(&quot;books = &quot; + books); &#125; @Test void testQuery() &#123; RowMapper&lt;Book&gt; rm = new RowMapper&lt;Book&gt;() &#123; @Override public Book mapRow(ResultSet resultSet, int i) throws SQLException &#123; Book book = new Book(); book.setId(resultSet.getInt(&quot;id&quot;)); book.setName(resultSet.getString(&quot;name&quot;)); book.setType(resultSet.getString(&quot;type&quot;)); book.setDescription(resultSet.getString(&quot;description&quot;)); return book; &#125; &#125;; String sql = &quot;select * from tbl_book&quot;; List&lt;Book&gt; books = jdbcTemplate.query(sql, rm); System.out.println(&quot;books = &quot; + books); &#125; @Test void testSave() &#123; String sql = &quot;insert into tbl_book values (null, &#x27;sss&#x27;, &#x27;aaa&#x27;, &#x27;bbb&#x27;)&quot;; jdbcTemplate.update(sql); &#125;&#125; JdbcTemplateé…ç½®ï¼š 123456spring: jdbc: template: fetch-size: -1 # ç¼“å­˜è¡Œæ•° query-timeout: -1 # æŸ¥è¯¢è¶…æ—¶æ—¶é—´ max-rows: -1 # æœ€å¤§è¡Œæ•° 4.3 å†…åµŒæ•°æ®åº“SpringBootæä¾›äº†3ç§å†…åµŒæ•°æ®åº“ä¾›å¼€å‘è€…é€‰æ‹©ï¼Œæé«˜å¼€å‘æµ‹è¯•æ•ˆç‡ï¼š H2 HSQL Derby ä»¥H2æ•°æ®åº“ä¸ºä¾‹ï¼š å¯¼å…¥åæ ‡ï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;com.h2database&lt;/groupId&gt; &lt;artifactId&gt;h2&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&lt;/dependency&gt; åŒæ—¶è¿˜éœ€è¦Webç¯å¢ƒï¼Œæ‰€ä»¥è¿˜è¦å¯¼å…¥åæ ‡ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ï¼š 1234567server: port: 8080spring: h2: console: path: /h2 enabled: true è®¿é—®ç”¨æˆ·åä¸ºsaï¼Œé»˜è®¤å¯†ç ä¸º123456 åœ¨æµè§ˆå™¨è¯·æ±‚é“¾æ¥ï¼šhttp://localhost:8080/h2 ç‚¹å‡»è¿æ¥ï¼Œç¬¬ä¸€æ¬¡è¿æ¥ä¼šæŠ¥é”™ï¼Œéœ€è¦åˆå§‹åŒ–æ·»åŠ ä¸Šé¢çš„ç›¸å…³é…ç½® æ·»åŠ H2æ•°æ®åº“é…ç½®ï¼š 12345678910111213server: port: 8080spring: h2: console: path: /h2 enabled: true datasource: url: jdbc:h2:~/test hikari: driver-class-name: org.h2.Driver username: sa password: 123456 è¿æ¥æˆåŠŸåï¼š åœ¨ä¸Šæ–¹çš„ç©ºç™½æ¡†ä¸­æ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼Œåˆ›å»ºè¡¨ï¼š 1create table tbl_book (id int, type varchar, name varchar, description varchar) æŸ¥è¯¢è¯­å¥ï¼š 1select * from tbl_book éœ€è¦åœæ­¢SpringBooté¡¹ç›®æœåŠ¡ï¼Œæ‰å¯ä»¥è¿›è¡Œæµ‹è¯• æµ‹è¯•ï¼š 1234567891011121314151617181920212223242526272829303132@SpringBootTestpublic class JdbcTest &#123; @Autowired private JdbcTemplate jdbcTemplate; @Test void testQuery() &#123; //æŸ¥è¯¢æ‰€æœ‰ RowMapper&lt;Book&gt; rm = new RowMapper&lt;Book&gt;() &#123; @Override public Book mapRow(ResultSet resultSet, int i) throws SQLException &#123; Book book = new Book(); book.setId(resultSet.getInt(&quot;id&quot;)); book.setName(resultSet.getString(&quot;name&quot;)); book.setType(resultSet.getString(&quot;type&quot;)); book.setDescription(resultSet.getString(&quot;description&quot;)); return book; &#125; &#125;; String sql = &quot;select * from tbl_book&quot;; List&lt;Book&gt; books = jdbcTemplate.query(sql, rm); System.out.println(&quot;books = &quot; + books); &#125; @Test void testSave() &#123; //æ’å…¥ String sql = &quot;insert into tbl_book values (2, &#x27;sss&#x27;, &#x27;aaa&#x27;, &#x27;bbb&#x27;)&quot;; jdbcTemplate.update(sql); &#125;&#125; æ”¹ç”¨MyBatis-PlusæŠ€æœ¯ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå¹¶ä¸”æ— ç¼è¡”æ¥ï¼Œåªéœ€å¯¼å…¥MyBatis-Plusåæ ‡ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.5.2&lt;/version&gt;&lt;/dependency&gt; æ·»åŠ MyBatis-Plusçš„é…ç½®ï¼š 123456789mybatis-plus: global-config: db-config: table-prefix: tbl_ #å°†idè®¾ä¸ºè‡ªåŠ¨å¢é•¿ id-type: auto configuration: #å¼€å¯æ—¥å¿—ï¼Œæ ‡å‡†è¾“å‡ºï¼šå°†æ•°æ®æ‰“å°åˆ°æ§åˆ¶å° log-impl: org.apache.ibatis.logging.stdout.StdOutImpl æµ‹è¯•ï¼š 1234567891011@SpringBootTestpublic class DaoTest &#123; @Autowired private BookService bookService; @Test void testSelectAll() &#123; List&lt;Book&gt; list = bookService.list(); System.out.println(&quot;list = &quot; + list); &#125;&#125; H2æ•°æ®åº“æ§åˆ¶å°ä»…ç”¨äºå¼€å‘é˜¶æ®µï¼Œçº¿ä¸Šé¡¹ç›®è¯·åŠ¡å¿…å…³é—­æ§åˆ¶å°åŠŸèƒ½ï¼š å°†enabledæ”¹ä¸ºfalse 1234567server: port: 8080spring: h2: console: path: /h2 enabled: false 5.æ•´åˆç¬¬ä¸‰æ–¹æŠ€æœ¯6.ç›‘æ§","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"Redisçš„å­¦ä¹ ç¬”è®°","slug":"Java/Redis","date":"2022-08-06T11:11:16.304Z","updated":"2022-08-13T09:42:41.489Z","comments":true,"path":"2022/08/06/Java/Redis/","link":"","permalink":"http://example.com/2022/08/06/Java/Redis/","excerpt":"","text":"åŸºç¡€ç¯‡1.åˆè¯†Redis1.1 è®¤è¯†NoSqlé”®å€¼æ•°æ®åº“æ˜¯ä¸€ç§NoSqlæ•°æ®åº“ key value 1001 { â€œidâ€:1001, â€œnameâ€:â€å¼ ä¸‰â€, â€œageâ€:20,} SQLï¼šå…³ç³»å‹æ•°æ®åº“ NoSQLï¼šéå…³ç³»å‹æ•°æ®åº“ SQLä¸NoSQlçš„æ¯”è¾ƒï¼š SQL NoSQL æ•°æ®ç»“æ„ ç»“æ„åŒ– éç»“æ„åŒ–ï¼š1.é”®å€¼ç±»å‹(Redis)2.æ–‡æ¡£ç±»å‹(MongoDB)3.åˆ—ç±»å‹(HBase)4.Graphç±»å‹(Neo4j) æ•°æ®å…³è” å…³è”çš„(æ•°æ®æœ‰å…³è”) æ— å…³è”çš„ æŸ¥è¯¢æ–¹å¼ SQLæŸ¥è¯¢(SQLè¯­æ³•é€šç”¨) éSQL(è¯­æ³•ä¸ç»Ÿä¸€) äº‹åŠ¡ç‰¹æ€§ ACID BASE å­˜å‚¨æ–¹å¼ ç£ç›˜ å†…å­˜ æ‰©å±•æ€§ å‚ç›´ æ°´å¹³ ä½¿ç”¨åœºæ™¯ 1.æ•°æ®ç»“æ„å›ºå®š2.ç›¸å…³ä¸šåŠ¡æ•°æ®å®‰å…¨æ€§ã€ä¸€è‡´æ€§è¦æ±‚è¾ƒé«˜ 1.æ•°æ®ç»“æ„ä¸å›ºå®š2.ç›¸å…³ä¸šåŠ¡æ•°æ®å®‰å…¨æ€§ã€ä¸€è‡´æ€§è¦æ±‚ä¸é«˜3.å¯¹æ€§èƒ½è¦æ±‚ 1.2 è®¤è¯†RedisRedisè¯ç”Ÿäº2009å¹´å…¨ç§°æ—¶Remote Dictionary Serverï¼Œè¿œç¨‹è¯å…¸æœåŠ¡å™¨ï¼Œæ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„é”®å€¼å‹NoSQLæ•°æ®åº“ã€‚ ç‰¹å¾ï¼š é”®å€¼(key-value)å‹ï¼švalueæ”¯æŒå¤šç§ä¸åŒæ•°æ®ç»“æ„ï¼ŒåŠŸèƒ½ä¸°å¯Œ å•çº¿ç¨‹ï¼šæ¯ä¸ªå‘½ä»¤å…·å¤‡åŸå­æ€§ ä½å»¶è¿Ÿã€é€Ÿåº¦å¿«ï¼šåŸºäºå†…å­˜ã€IOå¤šè·¯å¤ç”¨ã€è‰¯å¥½çš„ç¼–ç (Cè¯­è¨€å¼€å‘) æ”¯æŒæ•°æ®æŒä¹…åŒ– æ”¯æŒä¸»ä»é›†ç¾¤ã€åˆ†ç‰‡é›†ç¾¤ æ”¯æŒå¤šè¯­è¨€å®¢æˆ·ç«¯ 1.3 Redisçš„å®‰è£…åŠå…¶é…ç½®(ä¸è¦çœ‹è¿™ä¸ªæ•™ç¨‹å®‰è£…ï¼Œæœ‰é—®é¢˜æˆ‘è¿˜è¦æ”¹)â€‹ å¤§å¤šä¼ä¸šéƒ½æ˜¯åŸºäºLinuxæœåŠ¡å™¨æ¥éƒ¨ç½²é¡¹ç›®ï¼Œè€Œä¸”Rediså®˜æ–¹ä¹Ÿæ²¡æœ‰æä¾›Windowsç‰ˆæœ¬çš„å®‰è£…åŒ…ã€‚å› æ­¤ä¼šä½¿ç”¨åŸºäºLinuxç³»ç»Ÿæ¥å®‰è£…Redisã€‚ Rediså®˜ç½‘ï¼šRedis Linuxç‰ˆæœ¬ä¸ºï¼šCentOS7 æ³¨æ„ï¼šä¸‹é¢çš„å®‰è£…Redisæ–¹æ³•ä¸é€‚ç”¨äºUbuntu æ‰“å¼€å‘½ä»¤è¡Œï¼Œä¾æ¬¡è¾“å…¥ä¸€ä¸‹å†…å®¹ï¼š 123456789101112131415#è½¬æ¢æˆrootæƒé™su - #è¾“å…¥å¯†ç #å®‰è£…gccä¾èµ–yum install -y gcc tcl#è¿›å…¥åˆ°srcç›®å½•cd /usr/local/src#ä¸‹è½½redis-6.2.6.tar.gzwget https://download.redis.io/releases/redis-6.2.6.tar.gz#è§£å‹redis-6.2.6.tar.gztar -zxvf redis-6.2.6.tar.gz#è¿›å…¥redis-6.2.6cd redis-6.2.6#è¿è¡Œç¼–è¯‘å‘½ä»¤make &amp;&amp; make install é»˜è®¤å®‰è£…è·¯å¾„ä¸º/usr/local/binç›®å½•ä¸‹ï¼š 1ll /usr/local/bin çœ‹åˆ°è¿™ä¸ªæ ·å­å®‰è£…åŸºæœ¬æˆåŠŸäº† Redisçš„é…ç½®æ–‡ä»¶ï¼š é‡æ–°æ‰“å¼€å‘½ä»¤è¡Œï¼š 12345678su -#è¾“å…¥å¯†ç #è¿›å…¥åˆ°redis-6.2.6ç›®å½•cd /usr/local/src/redis-6.2.6#å¤‡ä»½redis.confcp redis.conf redis.conf.bck#æ‰“å¼€redis.confé…ç½®æ–‡ä»¶vi redis.conf ä¿®æ”¹redis.confæ–‡ä»¶çš„ä¸€äº›é…ç½®ï¼š 123456#bind 127.0.0.1 -::ä¼šå¯¼è‡´åªèƒ½åœ¨æœ¬åœ°è®¿é—®ï¼Œä¿®æ”¹ä¸º0.0.0.0å°±å¯ä»¥åœ¨ä»»æ„ipè®¿é—®ï¼Œç”Ÿäº§ç¯å¢ƒä¸è¦è®¾ç½®ä¸º0.0.0.0bind 0.0.0.0#å®ˆæŠ¤è¿›ç¨‹ï¼Œä¿®æ”¹ä¸ºyeså³å¯åå°è¿è¡Œdaemonize yes#è®¾ç½®å¯†ç ä¸º123456requirepass 123456 æŸ¥æ‰¾ï¼š/+æ‰€è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ï¼›æŒ‰nå‘ä¸‹æŸ¥æ‰¾ï¼ŒæŒ‰Nå‘ä¸ŠæŸ¥æ‰¾ è¾“å…¥iå³å¯ä¿®æ”¹æ•°æ®ï¼Œä¿®æ”¹å®ŒæˆåæŒ‰ESCé€€å‡ºç¼–è¾‘ :wqä¸ºä¿å­˜å¹¶é€€å‡º é€€å‡ºåï¼š 12345redis-server redis.conf#æŸ¥çœ‹redisè¿›ç¨‹ps -ef|grep redis #æ€æ­»è¿›ç¨‹kill -9 ç«¯å£å· æ¥ç€è®¾ç½®å¼€æœºè‡ªå¯ï¼š 12#æ–°å»ºä¸€ä¸ªç³»ç»ŸæœåŠ¡æ–‡ä»¶vi /etc/systemd/system/redis.service å°†ä¸‹é¢å†…å®¹å…¨éƒ¨å¤åˆ¶åˆ°redis.serviceæ–‡ä»¶ä¸­ï¼š 1234567891011[Unit]Description=redis-serverAfter=network.target[Service]Type=forkingExecStart=/usr/local/bin/redis-server /usr/local/src/redis-6.2.6/redis.confPrivateTmp=true[Install]WantedBy=multi-user.target ä¿å­˜é€€å‡ºåï¼Œ æ¥ç€: 12345678910#é‡è½½ç³»ç»ŸæœåŠ¡systemctl daemon-reload#å¯åŠ¨redissystemctl start redis#æŸ¥çœ‹redisçŠ¶æ€systemctl status redis#åœæ­¢redissystemctl stop redis#rediså¼€æœºè‡ªå¯systemctl enable redis 2.Rediså‘½ä»¤2.1 Redisæ•°æ®ç»“æ„ä»‹ç»Redisæ˜¯ä¸€ä¸ªkey-valueçš„æ•°æ®åº“ï¼Œkeyä¸€èˆ¬æ˜¯Stringç±»å‹ï¼Œä¸è¿‡valueçš„ç±»å‹å¤šç§å¤šæ ·ï¼š æ•°æ®ç±»å‹ æ ¼å¼ String hello Redis Hash {name: â€œjackâ€, age: 21} List [A -&gt; B -&gt; C -&gt; D] Set {A, B, C} SortSet {A: 1, B: 2, C: 3} GEO(åœ°ç†åæ ‡) {A: (120.3, 30.5)} BitMap 0101001001100101011001000110100101110011 HyperLog 0101001001100101011001000110100101110011 åŸºæœ¬ç±»å‹ï¼šStringã€Hashã€Listã€Setã€SortSet ç‰¹æ®Šç±»å‹ï¼šGEOã€BitMapã€HyperLog 2.2 Redisé€šç”¨å‘½ä»¤ å‘½ä»¤ è§£é‡Š ä¸¾ä¾‹ KEYS æŸ¥çœ‹ç¬¦åˆæ¨¡æ¿çš„æ‰€æœ‰keyï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒè®¾å¤‡ä¸Šä½¿ç”¨(æ•ˆç‡ä½) KEYS *ï¼šæŸ¥çœ‹æ‰€æœ‰keyKEYS n*ï¼šæŸ¥çœ‹æ‰€æœ‰nå¼€å¤´çš„key DEL åˆ é™¤ä¸€ä¸ªæŒ‡å®škey DEL nameï¼šåˆ é™¤name EXISTS åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ EXISTS nameï¼šå­˜åœ¨è¿”å›1ï¼Œå¦åˆ™è¿”å›0 EXPIRE ç»™ä¸€ä¸ªkeyè®¾ç½®æœ‰æ•ˆæœŸï¼Œæœ‰æ•ˆæœŸåˆ°æœŸkeyä¼šè¢«è‡ªåŠ¨åˆ é™¤ EXPIRE name 20ï¼šè®¾ç½®nameçš„æœ‰æ•ˆæœŸä¸º20ç§’ TTL æŸ¥çœ‹ä¸€ä¸ªkeyçš„å‰©ä½™æœ‰æ•ˆæœŸ TTL nameï¼šæŸ¥çœ‹nameçš„æœ‰æ•ˆæœŸï¼Œå¦‚æœè¿”å›-2ï¼Œåˆ™è¯´æ˜åˆ°æœŸäº†å¦‚æœè¿”å›-1ï¼Œåˆ™è¯´æ˜æ°¸ä¹…æœ‰æ•ˆ 2.3 Stringç±»å‹Stringç±»å‹ã€ä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ˜¯Redisä¸­æœ€ç®€å•çš„å­˜å‚¨ç±»å‹ å…¶valueæ˜¯å­—ç¬¦ä¸²ï¼Œä¸è¿‡æ ¹æ®å­—ç¬¦ä¸²çš„æ ¼å¼ä¸åŒï¼Œåˆå¯ä»¥åˆ†ç±»ä¸º3ç±»ï¼š stringï¼šæ™®é€šå­—ç¬¦ä¸² intï¼šæ•´æ•°ç±»å‹ï¼Œå¯ä»¥åšè‡ªå¢ã€è‡ªå‡æ“ä½œ floatï¼šæµ®ç‚¹ç±»å‹ï¼Œå¯ä»¥åšè‡ªå¢ã€è‡ªå‡æ“ä½œ ä¸ç®¡æ˜¯å“ªç§æ ¼å¼ï¼Œåº•å±‚éƒ½æ˜¯å­—èŠ‚æ•°ç»„å½¢å¼å­˜å‚¨ï¼Œå­—ç¬¦ä¸²ç±»å‹çš„æœ€å¤§ç©ºé—´ä¸èƒ½è¶…è¿‡512m Key Value msg hello Redis num 10 score 98.5 Stringç±»å‹å¸¸è§å‘½ä»¤ï¼š å‘½ä»¤ SET key value æ·»åŠ æˆ–ä¿®æ”¹å·²ç»å­˜åœ¨çš„ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ SET name Jerryï¼šæŠŠnameçš„valueè®¾ç½®ä¸ºJerry GET key æ ¹æ®keyè·å–Stringç±»å‹çš„value GET nameï¼šè·å–åˆ°valueä¸ºâ€Jerryâ€ MSET æ‰¹é‡æ·»åŠ å¤šä¸ªStringç±»å‹çš„é”®å€¼å¯¹ MSET score 12.5 age 18ï¼šæ·»åŠ å¤šä¸ªé”®å€¼å¯¹ MGET æ ¹æ®å¤šä¸ªkeyè·å–å¤šä¸ªStringç±»å‹çš„value MGET name score ageï¼šå¾—åˆ°å¤šä¸ªvalueä¸ºâ€Jreeyâ€ â€œ12.5â€ â€œ18â€ INCR è®©ä¸€ä¸ªæ•´å‹çš„keyè‡ªå¢1 INCR ageï¼šageçš„valueåŠ 1ï¼Œç”±18å˜ä¸º19 INCRBY è®©ä¸€ä¸ªæ•´å‹çš„keyè‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿ INCRBY age 2ï¼šageçš„valueåŠ 2ï¼Œç”±19å˜ä¸º21 INCRBYFLOAT è®©ä¸€ä¸ªæµ®ç‚¹ç±»å‹çš„æ•°å­—è‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿ INCRBYFLOAT score 0.5ï¼šscoreçš„valueåŠ 0.5ï¼Œç”±12.5å˜ä¸º13.0 SETNX æ·»åŠ ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ï¼Œå‰ææ˜¯è¿™ä¸ªkeyä¸å­˜åœ¨ï¼Œå¦åˆ™ä¸æ‰§è¡Œ(æ–°å¢æ•ˆæœ) SETNX name Tomï¼šä¸æ‰§è¡Œï¼Œè¿”å›0SETNX k1 v1ï¼šæ‰§è¡Œï¼Œè¿”å›1 SETEX æ·»åŠ ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ï¼Œå¹¶ä¸”æŒ‡å®šæœ‰æ•ˆæœŸ SETEX name 10 jerry ï¼šæ·»åŠ é”®å€¼å¯¹ï¼Œå¹¶å°†æœ‰æ•ˆæœŸè®¾ç½®ä¸º10ç§’ 2.4 Keyçš„å±‚çº§æ ¼å¼Redisæ²¡æœ‰ç±»ä¼¼äºMySQLä¸­çš„Tableè¡¨çš„æ¦‚å¿µ Redisçš„Keyå…è®¸æœ‰å¤šä¸ªå•è¯å½¢æˆå±‚çº§ç»“æ„ï¼Œå¤šä¸ªå•è¯ä¹‹é—´ç”¨:éš”å¼€ï¼Œæ ¼å¼(ä¸å›ºå®š)å¦‚ä¸‹ï¼š é¡¹ç›®å:ä¸šåŠ¡å:ç±»å‹:id ä¾‹å¦‚é¡¹ç›®åå«demoï¼Œæœ‰userå’Œbookä¸¤ç§ä¸åŒç±»å‹çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰Keyï¼š userç›¸å…³çš„Keyï¼šdemo:user:1 bookç›¸å…³çš„Keyï¼šdemo:book:1 å¦‚æœValueæ˜¯ä¸€ä¸ªjavaå¯¹è±¡ï¼Œä¾‹å¦‚ä¸€ä¸ªUserå¯¹è±¡ï¼Œåˆ™å¯ä»¥å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºjsonå­—ç¬¦ä¸²åå­˜å‚¨ï¼š Key Value demo:user:1 {â€œidâ€: 1, â€œnameâ€: â€œJerryâ€, â€œageâ€: 18} demo:book:1 {â€œidâ€: 1, â€œnameâ€: â€œBOOKâ€, â€œpriceâ€: 15} æ’å…¥æ“ä½œ(æ³¨æ„ï¼šValueå€¼è¦åŠ &#39;&#39;)ï¼š set demo:user:1 &#39;&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;Jerry&quot;, &quot;age&quot;: 18&#125;&#39; set demo:book:1 &#39;&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;BOOK&quot;, &quot;price&quot;: 15&#125;&#39; æ‰“å¼€å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯æŸ¥çœ‹ï¼š 2.5 Hashç±»å‹Hashç±»å‹ï¼Œä¹Ÿå«æ•£åˆ—ï¼Œå…¶valueæ˜¯ä¸€ä¸ªæ— åºå­—å…¸ï¼Œç±»ä¼¼äºjavaä¸­çš„HashMapç»“æ„ Stringç»“æ„æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºjsonå­—ç¬¦ä¸²åå­˜å‚¨ï¼Œå½“éœ€è¦ä¿®æ”¹å¯¹è±¡æŸä¸ªå­—æ®µæ—¶å¾ˆä¸æ–¹ä¾¿(éœ€è¦ä¿®æ”¹æ•´ä¸ªå­—ç¬¦ä¸²)ï¼š Key Value demo:user:1 {â€œidâ€: 1, â€œnameâ€: â€œJerryâ€, â€œageâ€: 18} demo:user:2 {â€œidâ€: 2, â€œnameâ€: â€œTomâ€, â€œpriceâ€: 20} è€ŒHashç»“æ„å¯ä»¥å°†å¯¹è±¡ä¸­æ¯ä¸ªå­—æ®µç‹¬ç«‹å­˜å‚¨ï¼Œå¯ä»¥é’ˆå¯¹å•ä¸ªå­—æ®µåšCRUDï¼š Key Value field value demo:user:1 name Jerry age 18 demo:user:2 name Tom age 20 Hashç±»å‹å¸¸è§å‘½ä»¤ï¼š å‘½ä»¤ HSET key field value æ·»åŠ æˆ–ä¿®æ”¹hashç±»å‹keyçš„fieldçš„å€¼ HSET demo:user:2 name LiHuaï¼šæŠŠnameçš„valueè®¾ç½®ä¸ºLihua HGET key field è·å–ä¸€ä¸ªhashç±»å‹keyçš„fieldçš„å€¼ HGET demo:user:2 nameï¼šè·å–åˆ°valueä¸ºâ€LiHuaâ€ HMSET æ‰¹é‡æ·»åŠ å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼ HMSET demo:user:3 name LiLei age 22ï¼šæ·»åŠ å¤šä¸ªfieldçš„å€¼ HMGET æ‰¹é‡è·å–æ ¹æ®å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼ HMGET demo:user:3 name ageï¼šå¾—åˆ°å¤šä¸ªfieldçš„å€¼ä¸ºâ€LiLeiâ€ â€œ22â€ HGETALL è·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„fieldå’Œvalue HGETALL demo:user:3ï¼šè·å–åˆ°keyä¸­æ‰€æœ‰çš„fieldå’Œvalue HKEYS è·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„field HKEYS demo:user:3ï¼šè·å–keyä¸­æ‰€æœ‰çš„field HVALS è·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„value HVALS demo:user:3ï¼šè·å–keyä¸­æ‰€æœ‰çš„value HINCRBY è®©ä¸€ä¸ªhashç±»å‹çš„keyçš„å­—æ®µè‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿ HINCRBY demo:user:3 age 2ï¼šageçš„valueåŠ 2ï¼Œç”±22å˜ä¸º24 HSETNX æ·»åŠ ä¸€ä¸ªhashç±»å‹çš„keyçš„fieldå€¼ï¼Œå‰ææ˜¯è¿™ä¸ªfieldä¸å­˜åœ¨ï¼Œå¦åˆ™ä¸æ‰§è¡Œ(æ–°å¢æ•ˆæœ) HSETNX demo:user:3 name XXXï¼šå­˜åœ¨fieldå€¼ä¸æ‰§è¡Œï¼Œè¿”å›0HSETNX demo:user:3 sex manï¼šä¸å­˜åœ¨fieldå€¼æ‰§è¡Œï¼Œè¿”å›1 2.6 Listç±»å‹Redisä¸­çš„Listç±»å‹ä¸javaä¸­çš„LinkListç±»ä¼¼ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ç»“æ„ï¼Œæ—¢å¯ä»¥æ”¯æŒæ­£å‘æ£€ç´¢ä¹Ÿå¯ä»¥æ”¯æŒåå‘æ£€ç´¢ã€‚ ç‰¹å¾ä¸LinkListä¹Ÿç±»ä¼¼ï¼š æœ‰åº å…ƒç´ å¯ä»¥é‡å¤ æ’å…¥å’Œåˆ é™¤å¿« æŸ¥è¯¢é€Ÿåº¦ä¸€èˆ¬ å¸¸ç”¨æ¥å­˜å‚¨ä¸€ä¸ªæœ‰åºæ•°æ®ï¼Œå¦‚ï¼šè¯„è®ºåˆ—è¡¨ã€ç‚¹èµåˆ—è¡¨ç­‰ Listç±»å‹çš„å¸¸è§å‘½ä»¤ï¼š LPUSH key element å‘åˆ—è¡¨å·¦ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  LPUSH user 1 2 3ï¼šè¡¨ä¸­ä»ç¬¬ä¸€ä½ä¾æ¬¡ä¸º â€œ3â€ â€œ2â€ â€œ1â€ LPOP key ç§»é™¤å¹¶è¿”å›åˆ—è¡¨å·¦ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›nil LPOP user 1 RPUSH key element å‘åˆ—è¡¨å³ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  RPUSH user 4 5 6ï¼šè¡¨ä¸­ä»ç¬¬ä¸€ä½ä¾æ¬¡ä¸º â€œ4â€ â€œ5â€ â€œ6â€ RPOP key ç§»é™¤å¹¶è¿”å›åˆ—è¡¨å³ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´  LRANGE key star end è¿”å›ä¸€æ®µè§’æ ‡èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´  LRANGE 1 star 2ï¼šä»0å¼€å§‹ï¼Œè·å–åˆ°1~2ä¹‹é—´çš„å…ƒç´  BLPOP ä¸LPOPç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨æ²¡æœ‰å…ƒç´ æ—¶ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›nil BLPOP user2 1 100ï¼šç§»é™¤å¹¶è¿”å›åˆ°å·¦ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰åˆ™ç­‰å¾…100ç§’ï¼Œè¶…æ—¶è¿”å›nil BRPOP ä¸RPOPç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨æ²¡æœ‰å…ƒç´ æ—¶ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›nil Listç»“æ„æ¨¡æ‹Ÿä¸€ä¸ªæ ˆ å…¥å£å’Œå‡ºå£åœ¨åŒä¸€è¾¹ å¦‚ï¼šLPUSHå’ŒLPOPæˆ–è€… RPUSHå’ŒRPOP Listç»“æ„æ¨¡æ‹Ÿä¸€ä¸ªé˜Ÿåˆ— å…¥å£å’Œå‡ºå£ä¸åœ¨åŒä¸€è¾¹ å¦‚ï¼šLPUSHå’ŒRPOP æˆ–è€… RPUSHå’ŒLPOP Listç»“æ„æ¨¡æ‹Ÿä¸€ä¸ªé˜»å¡é˜Ÿåˆ— å…¥å£å’Œå‡ºå£ä¸åœ¨åŒä¸€è¾¹ å‡ºé˜Ÿé‡‡ç”¨BLPOPæˆ–è€…BRPOP å¦‚ï¼šLPUSHå’ŒBRPOP æˆ–è€… RPUSHå’ŒBLPOP 2.7 Setç±»å‹Redisçš„Setç»“æ„ä¸Javaä¸­çš„Hashsetç±»ä¼¼ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªvalueä¸ºnullçš„HashMapã€‚å› ä¸ºä¹Ÿæ˜¯ä¸€ä¸ªhashè¡¨ï¼Œå› æ­¤å…·å¤‡ä¸Hashsetç±»ä¼¼çš„ç‰¹å¾ï¼š æ— åº å…ƒç´ ä¸å¯é‡å¤ æŸ¥æ‰¾å¿« æ”¯æŒäº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰åŠŸèƒ½ Setç±»å‹çš„å¸¸è§å‘½ä»¤ï¼š SADD key member å‘setä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  SADD s1 a b c SREM key member ç§»é™¤setä¸­çš„æŒ‡å®šå…ƒç´  SREM s1 a SCARD key è¿”å›setä¸­å…ƒç´ çš„ä¸ªæ•° SCARD s1 SISMEMBER key member åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºsetä¸­ SISMEMBER s1 a SMEMBERS è·å–setä¸­çš„æ‰€æœ‰å…ƒç´  SMEMBERS SINTER key1 key2 æ±‚key1ä¸key2çš„äº¤é›† SDIFF key1 key2 æ±‚key1ä¸key2çš„å·®é›† SUNION key1 key2 æ±‚key1ä¸key2çš„å¹¶é›† 2.8 SortedSetç±»å‹Redisçš„SortedSetæ˜¯ä¸€ä¸ªå¯æ’åºçš„seté›†åˆï¼Œä¸javaä¸­çš„TreeSetæœ‰äº›ç±»ä¼¼ï¼Œä½†åº•å±‚æ•°æ®ç»“æ„å´å·®åˆ«å¾ˆå¤§Sortedsetä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¸¦æœ‰ä¸€ä¸ªscoreå±æ€§ï¼Œå¯ä»¥åŸºäºscoreå±æ€§å¯¹å…ƒç´ æ’åºï¼Œåº•å±‚çš„å®ç°æ˜¯ä¸€ä¸ªè·³è¡¨(SkipList)åŠ hashè¡¨ã€‚SortedSetå…·å¤‡ä¸‹åˆ—ç‰¹æ€§ï¼š å¯æ’åº å…ƒç´ ä¸é‡å¤ æŸ¥è¯¢é€Ÿåº¦å¿« å› ä¸ºSortedsetçš„å¯æ’åºç‰¹æ€§ï¼Œç»å¸¸è¢«ç”¨æ¥å®ç°æ’è¡Œæ¦œè¿™æ ·çš„åŠŸèƒ½ã€‚ SortedSetç±»å‹çš„å¸¸è§å‘½ä»¤ï¼š ZADD key score member æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åˆ°sorted setï¼Œå¦‚æœå·²ç»å­˜åœ¨åˆ™æ›´æ–°å…¶scoreå€¼ ZADD SSet 85 Tom 98 Jerry 77 Rose 78 Jackï¼šå‘SSetä¸­æ·»åŠ å…ƒç´ ï¼Œå¹¶æŒ‰ç…§å‡åºæ’åˆ— ZREM key member åˆ é™¤sorted setä¸­çš„ä¸€ä¸ªæŒ‡å®šå…ƒç´  ZREM SSet Tomï¼šåˆ é™¤Tom ZSCORE key member è·å–sorted setä¸­çš„æŒ‡å®šå…ƒç´ çš„scoreå€¼ ZRANK key member è·å–sorted set ä¸­çš„æŒ‡å®šå…ƒç´ å‡åºçš„æ’å ZRANK SSet Roseï¼šæŒ‰ç…§å‡åºçš„åºåˆ—ï¼Œä»0å¼€å§‹ï¼Œè¿”å›Roseçš„æ’å ZREVRANK key member è·å–sorted set ä¸­çš„æŒ‡å®šå…ƒç´ é™åºçš„æ’å ZRANK SSet Roseï¼šæŒ‰ç…§é™åºçš„åºåˆ—ï¼Œä»0å¼€å§‹ï¼Œè¿”å›Roseçš„æ’å ZCARD key è·å–sorted setä¸­çš„å…ƒç´ ä¸ªæ•° ZCOUNT key min max ç»Ÿè®¡scoreå€¼åœ¨ç»™å®šèŒƒå›½å†…çš„æ‰€æœ‰å…ƒç´ çš„ä¸ªæ•° ZINCRBY key increment member è®©sorted setä¸­çš„æŒ‡å®šå…ƒç´ è‡ªå¢ï¼Œæ­¥é•¿ä¸ºæŒ‡å®šçš„incrementå€¼ ZRANGE key min max æŒ‰ç…§scoreå‡åºæ’åºåï¼Œè·å–æŒ‡å®šæ’åèŒƒå›´å†…çš„å…ƒç´  ZCOUNT SSet 0 2ï¼šæŒ‰ç…§å‡åºçš„æƒ…å†µï¼Œè·å–0~2èŒƒå›´çš„å…ƒç´  ZREVRANGE key min max æŒ‰ç…§scoreçš„é™åºæ’åºåï¼Œè·å–æŒ‡å®šæ’åèŒƒå›´å†…çš„å…ƒç´  ZCOUNT SSet 0 2ï¼šæŒ‰ç…§é™åºçš„æƒ…å†µï¼Œè·å–0~2èŒƒå›´çš„å…ƒç´  ZRANGEBYSCORE key min max æŒ‰ç…§scoreæ’åºåï¼Œè·å–æŒ‡å®šscoreèŒƒå›½å†…çš„å…ƒç´  ZRANGEBYSCORE SSet 0 80ï¼šè¿”å›0~80åˆ†æ•°çš„å…ƒç´  ZDIFFã€ZINTERã€ZUNION æ±‚å·®é›†ã€äº¤é›†ã€å¹¶é›† æ³¨æ„ï¼šæ‰€æœ‰æ’åé»˜è®¤éƒ½æ˜¯å‡åºï¼Œå¦‚æœé™åºåˆ™åœ¨å‘½ä»¤çš„Zåé¢æ·»åŠ REVå³å¯ ä¾‹å¦‚ï¼šZREVRANK 3.Redisçš„javaå®¢æˆ·ç«¯Rediså®˜ç½‘ä¸­æä¾›äº†å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ Javaï¼š Jedisï¼šä»¥Rediså‘½ä»¤ä½œä¸ºæ–¹æ³•åç§°ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼Œç®€å•å®ç”¨ä½†æ˜¯Jediså®ä¾‹æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦åŸºäºè¿æ¥æ± æ¥ä½¿ç”¨ Lettuceï¼šåŸºäºNettyå®ç°çš„ï¼Œæ”¯æŒåŒæ­¥ã€å¼‚æ­¥å’Œå“åº”å¼ç¼–ç¨‹æ–¹å¼ï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ”¯æŒRedisçš„å“¨å…µæ¨¡å¼ã€é›†ç¾¤æ¨¡å¼å’Œç®¡é“æ¨¡å¼ Redissonï¼šæ˜¯ä¸€ä¸ªåŸºäºRediså®ç°çš„åˆ†å¸ƒå¼ã€å¯ä¼¸ç¼©çš„Javaæ•°æ®ç»“æ„é›†åˆã€‚åŒ…å«äº†è¯¸å¦‚Mapã€Queueã€LockSemaphoreã€Atomiclongç­‰å¼ºå¤§åŠŸèƒ½ å…¶ä¸­Springæ•´åˆäº†Jediså’ŒLettuceï¼Œåªéœ€å¯¼å…¥åæ ‡Spring Data Redis 3.1 Jediså¿«é€Ÿå…¥é—¨Jedisï¼šJediså®˜ç½‘ å¼•å…¥jedisä¾èµ–ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;version&gt;3.7.0&lt;/version&gt;&lt;/dependency&gt; å®Œæ•´ä¾èµ–ï¼š 123456789101112131415&lt;dependencies&gt; &lt;!-- jedisä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;version&gt;3.7.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- æµ‹è¯•ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt; &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt; &lt;version&gt;5.7.0&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; ä»¥ä¸‹åœ¨Testä¸­è¿›è¡Œï¼š å»ºç«‹è¿æ¥ 123456789@BeforeEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„æ–¹æ³• void setUp() &#123; //å»ºç«‹è¿æ¥ jedis = new Jedis(&quot;127.0.0.1&quot;,6379); //è®¾ç½®å¯†ç  jedis.auth(&quot;123456&quot;); //é€‰æ‹©åº“ jedis.select(0); &#125; æµ‹è¯•Stringç±»å‹ 12345@Testvoid testString() &#123; jedis.set(&quot;name&quot;,&quot;Tom&quot;); System.out.println(jedis.get(&quot;name&quot;));&#125; é‡Šæ”¾èµ„æº 123456@AfterEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„æ–¹æ³•void tearDown() &#123; if (jedis != null)&#123; jedis.close(); &#125;&#125; å®Œæ•´æµ‹è¯•ï¼š 12345678910111213141516171819202122232425262728293031323334public class JedisTest &#123; private Jedis jedis; @BeforeEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„æ–¹æ³• void setUp() &#123; //å»ºç«‹è¿æ¥ jedis = new Jedis(&quot;127.0.0.1&quot;,6379); //è®¾ç½®å¯†ç  jedis.auth(&quot;123456&quot;); //é€‰æ‹©åº“ jedis.select(0); &#125; @Test void testString() &#123; jedis.set(&quot;name&quot;,&quot;Tom&quot;); System.out.println(jedis.get(&quot;name&quot;)); &#125; @Test void testHash() &#123; jedis.hset(&quot;demo:user:2&quot;,&quot;name&quot;,&quot;Jerry&quot;); jedis.hset(&quot;demo:user:2&quot;,&quot;age&quot;,&quot;18&quot;); Map&lt;String, String&gt; map = jedis.hgetAll(&quot;demo:user:2&quot;); System.out.println(map); &#125; @AfterEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„æ–¹æ³• void tearDown() &#123; if (jedis != null)&#123; jedis.close(); &#125; &#125;&#125; jedisä½¿ç”¨çš„åŸºæœ¬æ­¥éª¤ï¼š å¼•å…¥ä¾èµ– åˆ›å»ºjediså¯¹è±¡ï¼Œå»ºç«‹è¿æ¥ ä½¿ç”¨jedisçš„æ–¹æ³•åä¸Rediså‘½ä»¤ä¸€è‡´ é‡Šæ”¾èµ„æº 3.2 Jedisçš„è¿æ¥æ± Jedisæœ¬èº«çº¿ç¨‹æ˜¯ä¸å®‰å…¨çš„ï¼Œå¹¶ä¸”é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯è¿æ¥ä¼šæœ‰æ€§èƒ½æŸè€—ï¼Œå› æ­¤æ¨èä½¿ç”¨Jedisè¿æ¥æ± æ›¿ä»£Jedisçš„ç›´è¿æ–¹æ³• åˆ›å»ºJedisConnectionFactoryå·¥å…·ç±»ï¼š 12345678910111213141516171819202122232425262728public class JedisConnectionFactory &#123; private static final JedisPool jedisPool; static &#123; //é…ç½®è¿æ¥æ±  JedisPoolConfig jedisPoolConfig = new JedisPoolConfig(); //æœ€å¤§è¿æ¥æ•° jedisPoolConfig.setMaxTotal(8); //æœ€å¤§ç©ºé—²è¿æ¥ jedisPoolConfig.setMaxIdle(8); //æœ€å°ç©ºé—²è¿æ¥ jedisPoolConfig.setMinIdle(0); //ç­‰å¾…æ—¶é•¿ jedisPoolConfig.setMaxWaitMillis(1000); //åˆ›å»ºè¿æ¥æ± å¯¹è±¡ jedisPool = new JedisPool(jedisPoolConfig, &quot;127.0.0.1&quot;, 6379, 1000, &quot;123456&quot;); &#125; public static Jedis getJedis()&#123; return jedisPool.getResource(); &#125;&#125; æµ‹è¯•ç±»ä¸­ï¼š 123456789101112131415161718192021222324252627public class JedisTest &#123; private Jedis jedis; @BeforeEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„æ–¹æ³• void setUp() &#123; //å»ºç«‹è¿æ¥ jedis = JedisConnectionFactory.getJedis(); //é€‰æ‹©åº“ jedis.select(0); &#125; @Test void testHash() &#123; jedis.hset(&quot;demo:user:2&quot;,&quot;name&quot;,&quot;Jerry&quot;); jedis.hset(&quot;demo:user:2&quot;,&quot;age&quot;,&quot;18&quot;); Map&lt;String, String&gt; map = jedis.hgetAll(&quot;demo:user:2&quot;); System.out.println(map); &#125; @AfterEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„æ–¹æ³• void tearDown() &#123; if (jedis != null)&#123; //closeæ–¹æ³•å½“æ£€æµ‹åˆ°æ˜¯è¿æ¥æ± æ—¶ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„å…³é—­è¿æ¥ï¼Œè€Œæ˜¯å°†å¯¹è±¡å½’è¿˜ç»™è¿æ¥æ±  jedis.close(); &#125; &#125;&#125; 3.3 åˆè¯†SpringDataRedisSpringDataæ˜¯Springä¸­æ•°æ®æ“ä½œçš„æ¨¡å—ï¼ŒåŒ…å«å¯¹å„ç§æ•°æ®åº“çš„é›†æˆï¼Œå…¶ä¸­å¯¹Redisçš„é›†æˆæ¨¡å—å°±å«åšSpringDataRedis æä¾›äº†å¯¹ä¸åŒRediså®¢æˆ·ç«¯çš„æ•´åˆ ï¼ˆLettuceå’ŒJedisï¼‰ æä¾›äº†RedisTemplateç»Ÿä¸€APIæ¥æ“ä½œRedis æ”¯æŒRedisçš„å‘å¸ƒè®¢é˜…æ¨¡å‹ æ”¯æŒRediså“¨å…µå’ŒRedisé›†ç¾¤ æ”¯æŒåŸºäºLettuceçš„å“åº”å¼ç¼–ç¨‹ æ”¯æŒåŸºäºJDKã€JSONã€å­—ç¬¦ä¸²ã€Springå¯¹è±¡çš„æ•°æ®åºåˆ—åŒ–åŠååºåˆ—åŒ– æ”¯æŒåŸºäºRedisçš„JDKCollectionå®ç° SpringDataRedisä¸­æä¾›äº†RedisTemplateå·¥å…·ç±»ï¼Œå…¶ä¸­å°è£…äº†å„ç§å¯¹Redisçš„æ“ä½œã€‚å¹¶ä¸”å°†ä¸åŒæ•°æ®ç±»å‹çš„æ“ä½œAPIå°è£…åˆ°äº†ä¸åŒçš„ç±»å‹ä¸­ï¼š API è¿”å›å€¼ç±»å‹ è§£é‡Š redisTemplate.opsForValue() ValueOperations æ“ä½œStringç±»å‹æ•°æ® redisTemplate.opsForHash() HashOperations æ“ä½œHashç±»å‹æ•°æ® redisTemplate.opsForList() ListOperations æ“ä½œListç±»å‹æ•°æ® redisTemplate.opsForSet() SetOperations æ“ä½œSetç±»å‹æ•°æ® redisTemplate.opsForZSet() ZSetOperations æ“ä½œSortedSetç±»å‹æ•°æ® redisTemplate é€šç”¨å‘½ä»¤ 3.4 SpringDataRediså¿«é€Ÿå…¥é—¨SpringBootå·²ç»æä¾›äº†å¯¹SpringDataRedisçš„æ”¯æŒï¼Œå…¶ä¸­Springé»˜è®¤æ”¯æŒLettuceï¼Œå¦‚éœ€ä½¿ç”¨Jediséœ€è¦é¢å¤–å¯¼å…¥ä¾èµ– å¯¼å…¥ä¾èµ– 12345678910&lt;!-- Redisä¾èµ– --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- è¿æ¥æ± ä¾èµ– --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ 1234567891011spring: redis: host: 127.0.0.1 port: 6379 password: 123456 lettuce: pool: max-active: 8 # æœ€å¤§è¿æ¥æ•° max-idle: 8 #æœ€å¤§ç©ºé—²è¿æ¥æ•° min-idle: 0 #æœ€å°ç©ºé—²è¿æ¥æ•° max-wait: 100ms # è¿æ¥ç­‰å¾…æ—¶é—´ æ³¨å…¥RedisTemplateï¼Œè¿›è¡Œæµ‹è¯•ï¼š 12345678910111213@SpringBootTestpublic class RedisTemplateTest &#123; @Autowired private RedisTemplate redisTemplate; @Test void testString() &#123; //æ’å…¥ä¸€æ¡Stringç±»å‹çš„æ•°æ® redisTemplate.opsForValue().set(&quot;name&quot;,&quot;dahuang&quot;); //è·å–Stringç±»å‹çš„æ•°æ® System.out.println(redisTemplate.opsForValue().get(&quot;name&quot;)); &#125;&#125; SpringDataRedisçš„ä½¿ç”¨æ­¥éª¤ï¼š å¼•å…¥spring-boot-starter-data-redisä¾èµ– åœ¨application.ymlé…ç½®Redisä»¥åŠè¿æ¥æ± ä¿¡æ¯ æ³¨å…¥RedisTemplate 3.5 SpringDataRedisçš„åºåˆ—åŒ–æ–¹å¼RedisTemplateå¯ä»¥æ¥æ”¶ä»»æ„Objectä½œä¸ºå€¼å†™å…¥Redisï¼Œåªä¸è¿‡å†™å…¥å‰ä¼šæŠŠObjectåºåˆ—åŒ–ä¸ºå­—èŠ‚å½¢å¼ï¼Œé»˜è®¤é‡‡ç”¨JDKåºåˆ—åŒ–ï¼Œåˆšæ‰å­˜å…¥çš„æ•°æ®çš„ç»“æœæ˜¯è¿™æ ·ï¼š ç¼ºç‚¹ï¼š å¯è¯»æ€§å·® å†…å­˜å ç”¨è¾ƒå¤§ éœ€è¦å¯¼å…¥jacksonä¾èµ–ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;&lt;/dependency&gt; å¯ä»¥è‡ªå®šä¹‰RedisTemplateçš„åºåˆ—åŒ–æ–¹å¼ï¼š 123456789101112131415161718192021@Configurationpublic class RedisConfig &#123; @Bean public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory redisConnectionFactory)&#123; //åˆ›å»ºRedisTemplate RedisTemplate&lt;String,Object&gt; redisTemplate = new RedisTemplate&lt;&gt;(); //è®¾ç½®è¿æ¥å·¥å‚ redisTemplate.setConnectionFactory(redisConnectionFactory); //è®¾ç½®jsonåºåˆ—åŒ– GenericJackson2JsonRedisSerializer gjjrs = new GenericJackson2JsonRedisSerializer(); //è®¾ç½®keyçš„åºåˆ—åŒ– redisTemplate.setKeySerializer(RedisSerializer.string()); redisTemplate.setHashKeySerializer(RedisSerializer.string()); //è®¾ç½®valueçš„åºåˆ—åŒ– redisTemplate.setValueSerializer(gjjrs); redisTemplate.setHashValueSerializer(gjjrs); return redisTemplate; &#125;&#125; åˆ›å»ºä¸€ä¸ªå®ä½“ç±»ï¼š 123456789101112@Datapublic class User &#123; private String name; public Integer age; public User()&#123;&#125; public User(String name, Integer age) &#123; this.name = name; this.age = age; &#125;&#125; è¿›è¡Œæµ‹è¯•ï¼š 123456@Testvoid testString() &#123; redisTemplate.opsForValue().set(&quot;demo:user:3&quot;,new User(&quot;dahuang&quot;,18)); User u = (User) redisTemplate.opsForValue().get(&quot;demo:user:3&quot;); System.out.println(&quot;u = &quot; + u);&#125; æ§åˆ¶å°æ‰“å°ï¼š 1u = User(name=dahuang, age=18) Redisä¸­çš„æ•°æ®ï¼š 12345&#123; &quot;@class&quot;: &quot;com.redis.pojo.User&quot;, &quot;name&quot;: &quot;dahuang&quot;, &quot;age&quot;: 18&#125; 3.6 StringRedisTemplate å°½ç®¡jsonçš„åºåˆ—åŒ–æ–¹å¼å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ ä¸ºäº†åœ¨ååºåˆ—åŒ–æ—¶çŸ¥é“å¯¹è±¡çš„ç±»å‹ï¼Œjsonåºåˆ—åŒ–å™¨ä¼šå°†ç±»çš„classç±»å‹å†™å…¥jsonç»“æœä¸­ï¼Œå­˜å…¥Redisï¼Œä¼šå¸¦æ¥é¢å¤–çš„å†…å­˜å¼€é”€ ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå¹¶ä¸ä¼šä½¿ç”¨jsonåºåˆ—åŒ–å™¨æ¥å¤„ç†valueï¼Œè€Œæ˜¯ç»Ÿä¸€ä½¿ç”¨Stringåºåˆ—åŒ–å™¨ï¼Œè¦æ±‚åªèƒ½å­˜å‚¨Stringç±»å‹çš„keyå’Œvalue å½“å­˜å‚¨javaå¯¹è±¡æ—¶ï¼Œæ‰‹åŠ¨å®Œæˆå¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ– graph LR; å®ä½“ç±» --> |æ‰‹åŠ¨åºåˆ—åŒ–|jsonå­—ç¬¦ä¸² --> |æ’å…¥|Redis Redis -->|è·å–| jsonå­—ç¬¦ä¸² --> |æ‰‹åŠ¨ååºåˆ—åŒ–|å®ä½“ç±» Springé»˜è®¤æä¾›äº†ä¸€ä¸ªSpringRedisTemplateç±»ï¼Œå®ƒçš„keyå’Œvalueçš„åºåˆ—åŒ–æ–¹å¼é»˜è®¤å°±æ˜¯Stringæ–¹å¼ã€‚çœå»äº†è‡ªå®šä¹‰RedisTemplateçš„è¿‡ç¨‹ï¼š 12345678910111213141516171819202122@SpringBootTestpublic class StringRedisTemplateTest &#123; @Autowired private StringRedisTemplate stringRedisTemplate; //jsonå·¥å…· private static final ObjectMapper mapper = new ObjectMapper(); @Test void testStringTemplate() throws JsonProcessingException &#123; User user = new User(&quot;dahei&quot;, 22); //æ‰‹åŠ¨åºåˆ—åŒ– String json = mapper.writeValueAsString(user); //æ’å…¥æ•°æ® stringRedisTemplate.opsForValue().set(&quot;demo:user:5&quot;,json); //è·å–æ•°æ® String val = stringRedisTemplate.opsForValue().get(&quot;demo:user:5&quot;); //æ‰‹åŠ¨ååºåˆ—åŒ– User u = mapper.readValue(val, User.class); //æ‰“å°user System.out.println(&quot;u = &quot; + u); &#125;&#125; RedisTemplateçš„ä¸¤ç§åºåˆ—åŒ–å®è·µæ–¹æ¡ˆï¼š æ–¹æ¡ˆä¸€ï¼š è‡ªå®šä¹‰RedisTemplate ä¿®æ”¹RedisTemplateçš„åºåˆ—åŒ–å™¨ä¸ºGenericJackson2JsonRedisSerializer æ–¹æ¡ˆäºŒï¼š ä½¿ç”¨StringRedisTemplate å†™å…¥Redisæ—¶ï¼Œéœ€æ‰‹åŠ¨æŠŠå¯¹è±¡åºåˆ—åŒ–ä¸ºjson è¯»å–Redisæ—¶ï¼Œæ‰‹åŠ¨æŠŠè¯»å–åˆ°çš„jsonååºåˆ—åŒ–ä¸ºå¯¹è±¡ 3.7 RedisTemplateæ“ä½œHashç±»å‹12345678@Testvoid testHash() &#123; stringRedisTemplate.opsForHash().put(&quot;user:6&quot;,&quot;name&quot;,&quot;dahei&quot;); stringRedisTemplate.opsForHash().put(&quot;user:6&quot;,&quot;age&quot;,&quot;22&quot;); Map&lt;Object, Object&gt; entries = stringRedisTemplate.opsForHash().entries(&quot;user:6&quot;); System.out.println(&quot;entries = &quot; + entries);&#125; å®æˆ˜ç¯‡ æ­¤é¡¹ç›®ä¸ºé»‘é©¬ç‚¹è¯„ï¼Œå¦‚éœ€è¯·åˆ°vxæœç´¢é»‘é©¬ç¨‹åºå‘˜è·å–èµ„æº é¡¹ç›®ç»“æ„ï¼š application.yamlçš„é…ç½®ï¼š 123456789101112131415161718192021222324252627server: port: 8081spring: application: name: hmdp datasource: driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://localhost:3306/hmdp?useSSL=false&amp;serverTimezone=UTC username: root password: 123456 redis: host: 127.0.0.1 port: 6379 password: 123456 lettuce: pool: max-active: 10 max-idle: 10 min-idle: 1 time-between-eviction-runs: 10s jackson: default-property-inclusion: non_null # JSONå¤„ç†æ—¶å¿½ç•¥éç©ºå­—æ®µmybatis-plus: type-aliases-package: com.hmdp.entity # åˆ«åæ‰«æåŒ…logging: level: com.hmdp: debug 1.çŸ­ä¿¡ç™»å½•1.1 åŸºäºSessionå®ç°çŸ­ä¿¡ç™»å½•æµç¨‹å‘é€çŸ­ä¿¡éªŒè¯ç ï¼š çŸ­ä¿¡éªŒè¯ç ç™»å½•ã€æ³¨å†Œï¼š æ ¡éªŒç™»å½•çŠ¶æ€ï¼š 1.2 å®ç°å‘é€çŸ­ä¿¡éªŒè¯ç IUserServiceï¼š 1234public interface IUserService extends IService&lt;User&gt; &#123; Result sendCode(String phone, HttpSession session);&#125; UserServiceImplä¸­å®ç°sendCodeæ–¹æ³•ï¼š 12345678910111213141516@Overridepublic Result sendCode(String phone, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(phone)) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //ç¬¦åˆï¼Œç”ŸæˆéªŒè¯ç  String code = RandomUtil.randomNumbers(6); //ä¿å­˜éªŒè¯ç åˆ°Session session.setAttribute(&quot;code&quot;,code); //å‘é€éªŒè¯ç ï¼Œæ¨¡æ‹Ÿä¸€ä¸‹ log.debug(&quot;å‘é€éªŒè¯ç æˆåŠŸï¼ŒéªŒè¯ç ä¸ºï¼š&quot;+code); //è¿”å›OK return Result.ok();&#125; UserControllerï¼š 12345@PostMapping(&quot;code&quot;)public Result sendCode(@RequestParam(&quot;phone&quot;) String phone, HttpSession session) &#123; //å‘é€çŸ­ä¿¡éªŒè¯ç å¹¶ä¿å­˜éªŒè¯ç  return userService.sendCode(phone, session);&#125; æ—¥å¿—æ‰“å°ï¼š 1å‘é€éªŒè¯ç æˆåŠŸï¼ŒéªŒè¯ç ä¸ºï¼š608824 1.3 å®ç°çŸ­ä¿¡éªŒè¯ç™»å½•ä¸æ³¨å†Œ1234public interface IUserService extends IService&lt;User&gt; &#123; Result sendCode(String phone, HttpSession session); Result login(LoginFormDTO loginForm, HttpSession session);&#125; 1234567891011121314151617181920212223242526272829303132@Overridepublic Result login(LoginFormDTO loginForm, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(loginForm.getPhone())) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //æ ¡éªŒéªŒè¯ç  String code = (String) session.getAttribute(&quot;code&quot;); if (code == null || !code.equals(loginForm.getCode())) &#123; //ä¸ä¸€è‡´ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;éªŒè¯ç é”™è¯¯&quot;); &#125; //ä¸€è‡´ï¼ŒæŸ¥è¯¢æ‰‹æœºå·æ˜¯å¦å­˜åœ¨ User user = query().eq(&quot;phone&quot;, loginForm.getPhone()).one(); if (user == null) &#123; //ä¸å­˜åœ¨ï¼Œæ’å…¥åˆ°æ•°æ®åº“ï¼Œå®Œæˆæ³¨å†Œ user = createUserByPhone(loginForm.getPhone()); &#125; //ä¿å­˜ç”¨æˆ·åˆ°Session session.setAttribute(&quot;user&quot;,user); //æ¯ä¸ªsessionéƒ½æœ‰å”¯ä¸€çš„idï¼Œä¸éœ€è¦ç™»é™†å‡­è¯ return Result.ok();&#125;private User createUserByPhone(String phone) &#123; User user = new User(); user.setPhone(phone); user.setNickName(USER_NICK_NAME_PREFIX + RandomUtil.randomNumbers(10)); save(user); return user;&#125; 12345@PostMapping(&quot;/login&quot;)public Result login(@RequestBody LoginFormDTO loginForm, HttpSession session)&#123; //å®ç°ç™»å½•åŠŸèƒ½ return userService.login(loginForm,session);&#125; 1.4 å®ç°ç™»å½•æ ¡éªŒæ‹¦æˆªå™¨è°ƒç”¨/user/meæ¥å£è·å–ç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œå“åº”ä¸­åŒ…å«äº†æ‰‹æœºå·ã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œå¹¶ä¸”å‘é€çš„å¤šä½™ä¿¡æ¯å¢åŠ äº†æœåŠ¡å™¨çš„å‹åŠ›ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç”¨æˆ·æ˜µç§°ã€å¤´åƒå’Œidç­‰çš„éƒ¨åˆ†ä¿¡æ¯ã€‚ å®šä¹‰ä¸€ä¸ªUserDtoï¼š 123456@Datapublic class UserDTO &#123; private Long id; //id private String nickName;//æ˜µç§° private String icon;//å¤´åƒ&#125; å°†UserServiceImplçš„loginæ–¹æ³•ä¸­å­˜å…¥sessionçš„Userè½¬æ¢æˆUserDtoç±»å‹ï¼š 1session.setAttribute(&quot;user&quot;, BeanUtil.copyProperties(user, UserDTO.class)); æ–°å»ºLoginInterceptoræ‹¦æˆªå™¨ï¼š 12345678910111213141516171819202122232425public class LoginInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //è·å–session HttpSession session = request.getSession(); //è·å–ç”¨æˆ·ä¿¡æ¯ UserDTO user = (UserDTO) session.getAttribute(&quot;user&quot;); //ä¸å­˜åœ¨ï¼Œæ‹¦æˆª if (user == null)&#123; //è¿”å›çŠ¶æ€ç 401ï¼Œæœªæˆæƒ response.setStatus(401); return false; &#125; //å­˜åœ¨ï¼Œä¿å­˜åˆ°TheadLocal UserHolder.saveUser(user); //æ”¾è¡Œ return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; //ç§»é™¤ç”¨æˆ· UserHolder.removeUser(); &#125;&#125; æ–°å»ºMvcConfigé…ç½®ç±»ï¼Œæ·»åŠ æ‹¦æˆªå™¨å¹¶æ·»åŠ æ’åºè·¯å¾„ï¼š 12345678910111213141516@Configurationpublic class MvcConfig implements WebMvcConfigurer &#123; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(new LoginInterceptor()) .excludePathPatterns( //æ’é™¤è·¯å¾„ &quot;/user/login&quot;, &quot;/user/code&quot;, &quot;/shop/**&quot;, &quot;/shop-type/**&quot;, &quot;/blog/hot&quot;, &quot;/upload/**&quot;, &quot;/voucher/**&quot; ); &#125;&#125; UserControllerä¸­å®ç°è·å–ç”¨æˆ·ä¿¡æ¯ï¼š 123456@GetMapping(&quot;/me&quot;)public Result me()&#123; //è·å–å½“å‰ç™»å½•çš„ç”¨æˆ·å¹¶è¿”å› UserDTO user = UserHolder.getUser(); return Result.ok(user);&#125; 1.5 Sessionå…±äº«é—®é¢˜åˆ†æsessionå…±äº«é—®é¢˜ï¼šå¤šå°Tomcatä¸èƒ½å…±äº«sessionå­˜å‚¨ç©ºé—´ï¼Œå½“è¯·æ±‚åˆ‡æ¢åˆ°ä¸åŒçš„TomcatæœåŠ¡å™¨æ—¶å¯¼è‡´æ•°æ®å¯¹æ˜¯é—®é¢˜ sessionçš„æ›¿ä»£æ–¹æ¡ˆåº”è¯¥æ»¡è¶³ï¼š æ•°æ®å…±äº« å†…å­˜å­˜å‚¨ keyã€valueç»“æ„ Rediséƒ½èƒ½è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œå¹¶ä¸”å»¶æ—¶ä½ 1.6 åŸºäºRediså®ç°å…±äº«Sessionç™»å½•æµç¨‹å‘é€çŸ­ä¿¡éªŒè¯ç ï¼š å¯ä»¥é‡‡ç”¨Stringæ•°æ®ç±»å‹å­˜å‚¨ï¼š key value æ‰‹æœºå· éªŒè¯ç  çŸ­ä¿¡éªŒè¯ç™»å½•ã€æ³¨å†Œï¼š ä¿å­˜ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨Stringç»“æ„ï¼Œä»¥jsonå­—ç¬¦ä¸²æ¥ä¿å­˜ï¼Œæ¯”è¾ƒç›´è§‚ Hashç»“æ„å¯ä»¥å°†å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå­—æ®µç‹¬ç«‹å­˜å‚¨ï¼Œå¯ä»¥é’ˆå¯¹å•ä¸ªå­—æ®µåšCRUDï¼Œå¹¶ä¸”å†…å­˜å ç”¨å°‘(æ¨è) ä¿å­˜ç”¨æˆ·åˆ°Redisï¼š key value éšæœºtokenä¸ºkeyå­˜å‚¨ç”¨æˆ·æ•°æ® {name:Tom} æ ¡éªŒç™»å½•çŠ¶æ€ï¼š 1.7 åŸºäºRediså®ç°çŸ­ä¿¡ç™»å½•*ä¿®æ”¹UserServiceImplä¸­çš„sendCodeæ–¹æ³•ï¼š 12345678910111213141516171819202122@Resourceprivate StringRedisTemplate stringRedisTemplate;@Overridepublic Result sendCode(String phone, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(phone)) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //ç¬¦åˆï¼Œç”ŸæˆéªŒè¯ç  String code = RandomUtil.randomNumbers(6); //ä¿å­˜éªŒè¯ç åˆ°Redisï¼Œè®¾ç½®æœ‰æ•ˆæœŸ stringRedisTemplate.opsForValue().set(RedisConstants.LOGIN_CODE_KEY +phone, //key code, //value RedisConstants.LOGIN_CODE_TTL, // 2 TimeUnit.MINUTES);//æŒ‡å®šå•ä½ä¸ºåˆ†é’Ÿ //å‘é€éªŒè¯ç ï¼Œæ¨¡æ‹Ÿä¸€ä¸‹ log.debug(&quot;å‘é€éªŒè¯ç æˆåŠŸï¼ŒéªŒè¯ç ä¸ºï¼š&quot;+code); //è¿”å›OK return Result.ok();&#125; ä¿®æ”¹UserServiceImplä¸­çš„loginæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041@Resourceprivate StringRedisTemplate stringRedisTemplate;@Overridepublic Result login(LoginFormDTO loginForm, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(loginForm.getPhone())) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //æ ¡éªŒéªŒè¯ç  String code = stringRedisTemplate.opsForValue().get(RedisConstants.LOGIN_CODE_KEY + loginForm.getPhone()); if (code == null || !code.equals(loginForm.getCode())) &#123; //ä¸ä¸€è‡´ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;éªŒè¯ç é”™è¯¯&quot;); &#125; //ä¸€è‡´ï¼ŒæŸ¥è¯¢æ‰‹æœºå·æ˜¯å¦å­˜åœ¨ User user = query().eq(&quot;phone&quot;, loginForm.getPhone()).one(); if (user == null) &#123; //ä¸å­˜åœ¨ï¼Œæ’å…¥åˆ°æ•°æ®åº“ï¼Œå®Œæˆæ³¨å†Œ user = createUserByPhone(loginForm.getPhone()); &#125; //éšæœºç”Ÿæˆç™»å½•ä»¤ç‰Œtokenï¼Œ String token = UUID.randomUUID().toString(true); //å°†Userå¯¹è±¡è½¬æˆUserDtoåœ¨è½¬æ¢æˆMapæ•°æ®ç±»å‹ UserDTO userDTO = BeanUtil.copyProperties(user, UserDTO.class); //mapæ•°æ®ç±»å‹çš„é”®å€¼å¯¹éƒ½éœ€è¦æ˜¯Stringç±»å‹çš„ Map&lt;String, Object&gt; userMap = BeanUtil.beanToMap(userDTO, new HashMap&lt;&gt;(), CopyOptions.create().setIgnoreNullValue(true) //å¿½ç•¥ç©ºçš„å€¼ .setFieldValueEditor((fieldName, fieldValue) -&gt; fieldValue.toString()));//æ‰€æœ‰valueå€¼è½¬æ¢ä¸ºString //ä¿å­˜ç”¨æˆ·åˆ°Redis String key = RedisConstants.LOGIN_USER_KEY + token; stringRedisTemplate.opsForHash().putAll(key, userMap); //è®¾ç½®æœ‰æ•ˆæœŸ30åˆ†é’Ÿ stringRedisTemplate.expire(key, //key RedisConstants.LOGIN_USER_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //è¿”å›token return Result.ok(token); &#125; MVcConfigé…ç½®ç±»ä¸­æ³¨å…¥StringRedisTemplateï¼š 12345678910111213141516171819@Configurationpublic class MvcConfig implements WebMvcConfigurer &#123; @Resource private StringRedisTemplate stringRedisTemplate; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(new LoginInterceptor(stringRedisTemplate)) .excludePathPatterns( //æ’é™¤è·¯å¾„ &quot;/user/login&quot;, &quot;/user/code&quot;, &quot;/shop/**&quot;, &quot;/shop-type/**&quot;, &quot;/blog/hot&quot;, &quot;/upload/**&quot;, &quot;/voucher/**&quot; ); &#125;&#125; LoginInterceptorä¸­è·å–Redisä¸­çš„æ•°æ®ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public class LoginInterceptor implements HandlerInterceptor &#123; private StringRedisTemplate stringRedisTemplate; public LoginInterceptor(StringRedisTemplate stringRedisTemplate) &#123; this.stringRedisTemplate = stringRedisTemplate; &#125; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //è·å–tokenï¼Œå‰ç«¯ä¼šå°†tokenæ”¾å…¥åˆ°è¯·æ±‚å¤´ä¸­ String token = request.getHeader(&quot;authorization&quot;); if (StrUtil.isBlank(token)) &#123; //è¿”å›çŠ¶æ€ç 401ï¼Œæœªæˆæƒ response.setStatus(401); return false; &#125; //è·å–ç”¨æˆ·ä¿¡æ¯ Map&lt;Object, Object&gt; userMap = stringRedisTemplate.opsForHash().entries(RedisConstants.LOGIN_USER_KEY + token); //ä¸å­˜åœ¨ï¼Œæ‹¦æˆª if (userMap.isEmpty())&#123; //è¿”å›çŠ¶æ€ç 401ï¼Œæœªæˆæƒ response.setStatus(401); return false; &#125; //å°†mapè½¬æ¢æˆUserDto UserDTO user = BeanUtil.fillBeanWithMap(userMap,new UserDTO(),false); //å­˜åœ¨ï¼Œä¿å­˜åˆ°TheadLocal UserHolder.saveUser(user); //åˆ·æ–°æœ‰æ•ˆæœŸ stringRedisTemplate.expire(RedisConstants.LOGIN_USER_KEY + token, //key RedisConstants.LOGIN_USER_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //æ”¾è¡Œ return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; //ç§»é™¤ç”¨æˆ· UserHolder.removeUser(); &#125;&#125; 1.8 è§£å†³çŠ¶æ€ç™»å½•åˆ·æ–°é—®é¢˜æ‹¦æˆªå™¨ è·å–token æŸ¥è¯¢Redisçš„ç”¨æˆ·ä¿¡æ¯ ä¸å­˜åœ¨ï¼Œåˆ™æ‹¦æˆª å­˜åœ¨ï¼Œåˆ™ç»§ç»­ ä¿å­˜åˆ°ThreadLocal åˆ·æ–°tokençš„æœ‰æ•ˆæœŸ æ”¾è¡Œ æ‹¦æˆªå™¨åªä¼šæ‹¦æˆªç™»å½•çš„è·¯å¾„ï¼Œä»è€Œåˆ·æ–°tokenæœ‰æ•ˆæœŸã€‚ ä½†æ˜¯å…¶ä»–çš„ä¸€äº›ä¸éœ€è¦ç™»å½•ä¹Ÿå¯ä»¥æŸ¥çœ‹çš„é¡µé¢ï¼Œæ¯”å¦‚é¦–é¡µï¼Œåˆ™ä¸ä¼šåˆ·æ–°tokenæœ‰æ•ˆæœŸã€‚ æœ‰å¯èƒ½é•¿æ—¶é—´æŸ¥çœ‹å…¶ä»–é¡µé¢ï¼Œå¯¼è‡´åœ¨æŸ¥çœ‹éœ€è¦ç™»å½•çš„è·¯å¾„ï¼Œtokenè¿‡äº†æœ‰æ•ˆæœŸï¼Œéœ€è¦é‡æ–°ç™»å½•çš„é—®é¢˜ sequenceDiagram ç”¨æˆ·-->>æ‹¦æˆªå™¨1:å‘é€è¯·æ±‚ note over æ‹¦æˆªå™¨1:æ‹¦æˆªä¸€åˆ‡è·¯å¾„1. è·å–token2. æŸ¥è¯¢Redisçš„ç”¨æˆ·3. ä¿å­˜åˆ°ThreadLocal4. åˆ·æ–°tokençš„æœ‰æ•ˆæœŸ5. æ”¾è¡Œ æ‹¦æˆªå™¨1->>æ‹¦æˆªå™¨2:è¿›å…¥ note over æ‹¦æˆªå™¨2:æ‹¦æˆªéœ€è¦ç™»å½•çš„è·¯å¾„æŸ¥çœ‹tokenå­˜åœ¨ï¼Œåˆ™æ‹¦æˆªä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­ æ‹¦æˆªå™¨2->>UserController:è¿›å…¥ RefreshTokenInterceptorä¸­ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public class RefreshTokenInterceptor implements HandlerInterceptor &#123; private StringRedisTemplate stringRedisTemplate; public RefreshTokenInterceptor(StringRedisTemplate stringRedisTemplate) &#123; this.stringRedisTemplate = stringRedisTemplate; &#125; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //è·å–token String token = request.getHeader(&quot;authorization&quot;); //tokenä¸å­˜åœ¨ï¼Œç›´æ¥æ”¾è¡Œï¼Œä¸æ·»åŠ åˆ°ThreadLocal if (StrUtil.isBlank(token)) &#123; return true; &#125; //è·å–ç”¨æˆ·ä¿¡æ¯ Map&lt;Object, Object&gt; userMap = stringRedisTemplate.opsForHash().entries(RedisConstants.LOGIN_USER_KEY + token); //ç”¨æˆ·ä¿¡æ¯ä¸å­˜åœ¨ï¼Œç›´æ¥æ”¾è¡Œï¼Œä¸æ·»åŠ åˆ°ThreadLocal if (userMap.isEmpty())&#123; return true; &#125; //å°†mapè½¬æ¢æˆUserDto UserDTO user = BeanUtil.fillBeanWithMap(userMap,new UserDTO(),false); //ä¿å­˜åˆ°TheadLocal UserHolder.saveUser(user); //åˆ·æ–°æœ‰æ•ˆæœŸ stringRedisTemplate.expire(RedisConstants.LOGIN_USER_KEY + token, //key RedisConstants.LOGIN_USER_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //æ”¾è¡Œ return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; //ç§»é™¤ç”¨æˆ· UserHolder.removeUser(); &#125;&#125; LoginInterceptorä¸­ï¼š 1234567891011121314public class LoginInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //åˆ¤æ–­ThreadLocalæ˜¯å¦å­˜åœ¨ç”¨æˆ· if (UserHolder.getUser() == null)&#123; //æ²¡æœ‰ï¼Œæ‹¦æˆªï¼Œè®¾ç½®çŠ¶æ€ç  response.setStatus(401); return false; &#125; //æœ‰ç”¨æˆ·æ”¾è¡Œ return true; &#125;&#125; MvcConfigé…ç½®ç±»ä¸­ï¼š 123456789101112131415161718192021222324@Configurationpublic class MvcConfig implements WebMvcConfigurer &#123; @Resource private StringRedisTemplate stringRedisTemplate; @Override public void addInterceptors(InterceptorRegistry registry) &#123; //tokenåˆ·æ–°æ‹¦æˆªå™¨ registry.addInterceptor(new RefreshTokenInterceptor(stringRedisTemplate)) .addPathPatterns(&quot;/**&quot;) //æ‹¦æˆªæ‰€æœ‰è·¯å¾„ .order(0); // æ³¨å†Œé¡ºåºä¸º0 //ç™»å½•æ‹¦æˆªå™¨ registry.addInterceptor(new LoginInterceptor()) .excludePathPatterns( //æ’é™¤è·¯å¾„ &quot;/user/login&quot;, &quot;/user/code&quot;, &quot;/shop/**&quot;, &quot;/shop-type/**&quot;, &quot;/blog/hot&quot;, &quot;/upload/**&quot;, &quot;/voucher/**&quot; ).order(1); //æ³¨å†Œé¡ºåºä¸º1 &#125;&#125; 2.å•†æˆ·æŸ¥è¯¢ç¼“å­˜2.1 ä»€ä¹ˆæ˜¯ç¼“å­˜ç¼“å­˜å°±æ˜¯æ•°æ®äº¤æ¢çš„ç¼“å†²åŒº(ç§°ä½œCache)ï¼Œæ˜¯è´®å­˜æ•°æ®çš„ä¸´æ—¶åœ°æ–¹ï¼Œä¸€èˆ¬è¯»å†™æ€§èƒ½è¾ƒé«˜ graph LR æµè§ˆå™¨ç¼“å­˜ --> Tomcatåº”ç”¨å±‚ç¼“å­˜ --> æ•°æ®åº“ç¼“å­˜ --> CPUç¼“å­˜ æ•°æ®åº“ç¼“å­˜ --> ç£ç›˜ç¼“å­˜ ç¼“å­˜çš„ä½œç”¨ é™ä½åç«¯çš„è´Ÿè½½ æé«˜è¯»å†™æ•ˆç‡ï¼Œé™ä½å“åº”æ—¶é—´ ç¼“å­˜çš„æˆæœ¬ æ•°æ®ä¸€è‡´æ€§æˆæœ¬ ä»£ç ç»´æŠ¤æˆæœ¬ è¿ç»´æˆæœ¬ 2.2 æ·»åŠ Redisç¼“å­˜ç¼“å­˜çš„ä½œç”¨æ¨¡å‹ï¼š sequenceDiagram å®¢æˆ·ç«¯->>Redis:è¯·æ±‚ Redis->>å®¢æˆ·ç«¯:å‘½ä¸­(åˆ†æ”¯1) Redis->>æ•°æ®åº“:æœªå‘½ä¸­(åˆ†æ”¯2) æ•°æ®åº“->>Redis:å†™ç¼“å­˜ æ•°æ®åº“->>å®¢æˆ·ç«¯:å“åº” æ ¹æ®idæŸ¥è¯¢å•†é“ºç¼“å­˜çš„æµç¨‹ï¼š IShopServiceåˆ›å»ºä¸€ä¸ªqueryByIdæ–¹æ³•ï¼š 1234public interface IShopService extends IService&lt;Shop&gt; &#123; // ctrl+bè½¬åˆ°å®ç°ç±» Result queryById(Long id);&#125; åœ¨ShopServiceImplä¸­å®ç°queryByIdæ–¹æ³•ï¼Œä»è€Œå®ç°å•†é“ºä¿¡æ¯ç¼“å­˜ï¼š è¿™é‡Œé€‰æ‹©è·å–å’Œå­˜å‚¨Redisçš„æ•°æ®ç±»å‹ä¸ºString 12345678910111213141516171819202122232425@Resourceprivate StringRedisTemplate stringRedisTemplate;@Overridepublic Result queryById(Long id) &#123; String key = RedisConstants.CACHE_SHOP_KEY + id; //ä»RedisæŸ¥è¯¢å•†é“ºç¼“å­˜ï¼ŒRedisæ•°æ®ç±»å‹ä¸ºString String shopJson = stringRedisTemplate.opsForValue().get(key); //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ if (StrUtil.isNotBlank(shopJson)) &#123; //å­˜åœ¨ï¼Œè¿”å›ä¿¡æ¯ Shop shop = JSONUtil.toBean(shopJson, Shop.class); return Result.ok(shop); &#125; //ä¸å­˜åœ¨ï¼Œæ ¹æ®idæŸ¥è¯¢ Shop shop = getById(id); //idä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ if (shop == null) &#123; return Result.fail(&quot;åº—é“ºä¸å­˜åœ¨&quot;); &#125; //idå­˜åœ¨ï¼Œå°†æ•°æ®å†™å…¥Redis stringRedisTemplate.opsForValue().set(key, JSONUtil.toJsonStr(shop)); //è¿”å›å•†é“ºä¿¡æ¯ return Result.ok(shop);&#125; ShopControllerä¸­ï¼š 12345@GetMapping(&quot;/&#123;id&#125;&quot;)public Result queryShopById(@PathVariable(&quot;id&quot;) Long id) &#123; //é€šè¿‡idè·å–å•†é“ºä¿¡æ¯ return shopService.queryById(id);&#125; è¿™é‡Œé€‰æ‹©è·å–å’Œå­˜å‚¨Redisçš„æ•°æ®ç±»å‹ä¸ºHash 2.3 ç¼“å­˜æ›´æ–°ç­–ç•¥ å†…å­˜æ·˜æ±° è¶…æ—¶å‰”é™¤ ä¸»åŠ¨æ›´æ–° è¯´æ˜ ä¸ç”¨è‡ªå·±ç»´æŠ¤ï¼Œåˆ©ç”¨Redisçš„å†…å­˜æ·˜æ±°æœºåˆ¶ï¼Œå½“å†…å­˜ä¸è¶³æ—¶è‡ªåŠ¨æ·˜æ±°éƒ¨åˆ†æ•°æ®ã€‚ä¸‹æ¬¡æŸ¥è¯¢æ—¶æ›´æ–°ç¼“å­˜ã€‚ ç»™ç¼“å­˜æ•°æ®æ·»åŠ TTLæ—¶é—´ï¼Œåˆ°æœŸåè‡ªåŠ¨åˆ é™¤ç¼“å­˜ã€‚ä¸‹æ¬¡æŸ¥è¯¢æ—¶æ›´æ–°ç¼“å­˜ã€‚ ç¼–å†™ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨ä¿®æ”¹æ•°æ®åº“çš„åŒæ—¶ï¼Œæ›´æ–°ç¼“å­˜ã€‚ ä¸€è‡´æ€§ å·® ä¸€èˆ¬ å¥½ ç»´æŠ¤æˆæœ¬ æ—  ä½ é«˜ ä¸šåŠ¡åœºæ™¯ï¼š ä½ä¸€è‡´æ€§éœ€æ±‚ï¼š ä½¿ç”¨å†…å­˜æ·˜æ±°æœºåˆ¶ã€‚ä¾‹å¦‚ï¼šåº—é“ºç±»å‹çš„æŸ¥è¯¢ç¼“å­˜ é«˜ä¸€è‡´æ€§éœ€æ±‚ï¼š ä¸»åŠ¨æ›´æ–°ï¼Œå¹¶ä»¥è¶…æ—¶å‰”é™¤ä¸ºå…œåº•æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼šåº—é“ºè¯¦æƒ…æŸ¥è¯¢çš„ç¼“å­˜ ä¸»åŠ¨æ›´æ–°ç­–ç•¥ï¼š æ–¹æ¡ˆä¸€ï¼šCache Aside Pattern(å¯æ§æ€§é«˜ï¼Œä¼ä¸šå¼€å‘å¸¸ç”¨) ç”±ç¼“å­˜çš„è°ƒç”¨è€…ï¼Œåœ¨æ›´æ–°æ•°æ®åº“çš„åŒæ—¶æ›´æ–°ç¼“å­˜ã€‚ æ–¹æ¡ˆäºŒï¼šRead&#x2F;Write Through Pattern ç¼“å­˜ä¸æ•°æ®åº“æ•´åˆä¸ºä¸€ä¸ªæœåŠ¡ï¼Œç”±æœåŠ¡æ¥ç»´æŠ¤ä¸€è‡´æ€§ã€‚è°ƒç”¨è€…è°ƒç”¨è¯¥æœåŠ¡ï¼Œæ— éœ€å…³å¿ƒç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚ æ–¹æ¡ˆä¸‰ï¼šWrite Behind Caching Pattern è°ƒç”¨è€…åªæ“ä½œç¼“å­˜ï¼Œç”±å…¶å®ƒçº¿ç¨‹å¼‚æ­¥çš„å°†ç¼“å­˜æ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“ï¼Œä¿è¯æœ€ç»ˆä¸€è‡´ã€‚ è¯´æ˜ï¼š å¯ä»¥å¤šæ¬¡ä¿®æ”¹ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œåœ¨å°†ç¼“å­˜çš„æ•°æ®ä¸€æ¬¡æ€§æ›´æ–°åˆ°æ•°æ®åº“ä¸­ å¦‚æœç¼“å­˜ä¸­çš„æ•°æ®æœªæ›´æ–°åˆ°æ•°æ®åº“æ—¶ï¼Œå‡ºç°å®•æœºæ•°æ®å°±ä¼šå®Œå…¨ä¸¢å¤± :cherry_blossom:æ–¹æ¡ˆä¸€ï¼šCache Aside Pattern æ“ä½œç¼“å­˜å’Œæ•°æ®åº“æ—¶æœ‰ä¸‰ä¸ªé—®é¢˜éœ€è¦è€ƒè™‘ï¼š åˆ é™¤ç¼“å­˜è¿˜æ˜¯æ›´æ–°ç¼“å­˜ï¼Ÿ æ›´æ–°ç¼“å­˜ï¼šæ¯æ¬¡æ›´æ–°æ•°æ®åº“éƒ½è¦æ›´æ–°ç¼“å­˜ï¼Œæ— æ•ˆå†™æ“ä½œè¾ƒå¤š:negative_squared_cross_mark: åˆ é™¤ç¼“å­˜ï¼šæ›´æ–°æ•°æ®åº“æ—¶è®©ç¼“å­˜å¤±æ•ˆï¼ŒæŸ¥è¯¢æ—¶åœ¨æ›´æ–°ç¼“å­˜:white_check_mark: å¦‚ä½•ä¿è¯ç¼“å­˜ä¸æ•°æ®åº“çš„æ“ä½œçš„åŒæ—¶æˆåŠŸæˆ–å¤±è´¥ï¼Ÿ å•ä½“ç³»ï¼Œå°†ç¼“å­˜ä¸æ•°æ®åº“çš„æ“ä½œæ”¾åœ¨ä¸€ä¸ªäº‹åŠ¡ åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œåˆ©ç”¨TTCç­‰åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆ å…ˆæ“ä½œç¼“å­˜è¿˜æ˜¯å…ˆæ“ä½œæ•°æ®åº“ï¼Ÿ(æ•°æ®åº“çš„æ•°æ®æ“ä½œç›¸æ¯”Redisçš„æ•°æ®æ“ä½œæ…¢) å…ˆåˆ é™¤ç¼“å­˜ï¼Œåœ¨æ“ä½œæ•°æ®åº“ å¼‚å¸¸æƒ…å†µï¼š(å‡ºç°æƒ…å†µé«˜) çº¿ç¨‹1åˆ é™¤ç¼“å­˜åï¼Œçº¿ç¨‹2æŸ¥è¯¢ç¼“å­˜æœªå‘½ä¸­ï¼Œå†æŸ¥è¯¢æ•°æ®åº“ã€‚å°†æ•°æ®åº“ä¸­çš„æ—§æ•°æ®åˆå†™å…¥äº†ç¼“å­˜åï¼Œçº¿ç¨‹1æ‰å°†æ•°æ®åº“çš„æ•°æ®è¿›è¡Œäº†æ›´æ–°ã€‚å¯¼è‡´çº¿ç¨‹2ä¹‹å‰æ‹¿åˆ°çš„æ•°æ®åº“çš„æ•°æ®ä¸ºæ—§æ•°æ®ã€‚ å…ˆæ“ä½œæ•°æ®åº“ï¼Œåœ¨åˆ é™¤ç¼“å­˜:cherry_blossom:(èƒœå‡º) å¼‚å¸¸æƒ…å†µï¼š(å‡ºç°æƒ…å†µä½) çº¿ç¨‹1æŸ¥è¯¢ç¼“å­˜æœªå‘½ä¸­ï¼Œå†æŸ¥è¯¢æ•°æ®åº“è·å–åˆ°æ—§æ•°æ®åï¼Œçº¿ç¨‹2è¿™æ—¶æ›´æ–°äº†æ•°æ®åº“çš„æ•°æ®ï¼Œåˆ é™¤äº†ç¼“å­˜åï¼Œçº¿ç¨‹1æ‰å¼€å§‹å†™å…¥ç¼“å­˜ã€‚å¯¼è‡´çº¿ç¨‹1ä¹‹å‰æ‹¿åˆ°çš„æ•°æ®åº“çš„æ•°æ®ä¸ºæ—§æ•°æ®ã€‚ æ€»ç»“ï¼š ç¼“å­˜æ›´æ–°ç­–ç•¥çš„æœ€ä½³å®è·µæ–¹æ¡ˆ ä½ä¸€è‡´æ€§éœ€æ±‚ï¼šä½¿ç”¨Redisè‡ªå¸¦çš„å†…å­˜æ·˜æ±°æœºåˆ¶ é«˜ä¸€è‡´æ€§éœ€æ±‚ï¼šä¸»åŠ¨æ›´æ–°ï¼Œå¹¶ä»¥è¶…æ—¶å‰”é™¤ä¸ºå…œåº•æ–¹æ¡ˆ è¯»æ“ä½œï¼š ç¼“å­˜å‘½ä¸­ç›´æ¥è¿”å› ç¼“å­˜æœªå‘½ä¸­åˆ™æŸ¥è¯¢æ•°æ®åº“ï¼Œå¹¶å†™å…¥ç¼“å­˜ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ å†™æ“ä½œï¼š å…ˆå†™æ•°æ®åº“ï¼Œç„¶åå†åˆ é™¤ç¼“å­˜ è¦ç¡®ä¿æ•°æ®åº“ä¸ç¼“å­˜æ“ä½œçš„åŸå­æ€§ 2.4 æ·»åŠ ç¼“å­˜æ›´æ–°ç­–ç•¥ç»™æŸ¥è¯¢å•†é“ºçš„ç¼“å­˜æ·»åŠ è¶…æ—¶å‰”é™¤å’Œä¸»åŠ¨æ›´æ–°çš„ç­–ç•¥ ä¿®æ”¹ShopControllerä¸­çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ»¡è¶³ä¸€ä¸‹çš„éœ€æ±‚ï¼š æ ¹æ®idæŸ¥è¯¢åº—é“ºæ—¶ï¼Œå¦‚æœç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ™æŸ¥è¯¢æ•°æ®åº“ï¼Œå°†æ•°æ®åº“çš„ç»“æœå†™å…¥ç¼“å­˜ï¼Œå¹¶è®¾ç½®è¶…æ—¶æ—¶é—´ æ ¹æ®idä¿®æ”¹åº—é“ºæ—¶ï¼Œå…ˆä¿®æ”¹æ•°æ®åº“ï¼Œåœ¨åˆ é™¤ç¼“å­˜ ä¿®æ”¹ShopServiceImplä¸­çš„queryByIdæ–¹æ³•ï¼Œå°†å†™å…¥Redisçš„æ•°æ®è®¾ç½®æœ‰æ•ˆæœŸï¼š 12345678910111213141516171819202122232425262728@Resourceprivate StringRedisTemplate stringRedisTemplate;@Overridepublic Result queryById(Long id) &#123; String key = RedisConstants.CACHE_SHOP_KEY + id; //ä»RedisæŸ¥è¯¢å•†é“ºç¼“å­˜ String shopJson = stringRedisTemplate.opsForValue().get(key); //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ if (StrUtil.isNotBlank(shopJson)) &#123; //å­˜åœ¨ï¼Œè¿”å›ä¿¡æ¯ Shop shop = JSONUtil.toBean(shopJson, Shop.class); return Result.ok(shop); &#125; //ä¸å­˜åœ¨ï¼Œæ ¹æ®idæŸ¥è¯¢ Shop shop = getById(id); //idä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ if (shop == null) &#123; return Result.fail(&quot;åº—é“ºä¸å­˜åœ¨&quot;); &#125; //idå­˜åœ¨ï¼Œå°†æ•°æ®å†™å…¥Redisï¼Œè®¾ç½®æœ‰æ•ˆæœŸ stringRedisTemplate.opsForValue().set(key, //key JSONUtil.toJsonStr(shop), // value RedisConstants.CACHE_SHOP_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //è¿”å›å•†é“ºä¿¡æ¯ return Result.ok(shop);&#125; IShopServiceä¸­åˆ›å»ºupdateæ–¹æ³•ï¼š 123456public interface IShopService extends IService&lt;Shop&gt; &#123; // ctrl+bè½¬åˆ°å®ç°ç±» Result queryById(Long id); Result update(Shop shop);&#125; ShopServiceImplä¸­,å®ç°updateæ–¹æ³•ï¼š 12345678910111213141516171819@Resourceprivate StringRedisTemplate stringRedisTemplate;@Override@Transactionalpublic Result update(Shop shop) &#123; Long id = shop.getId(); //åˆ¤æ–­å•†é“ºæ˜¯å¦å­˜åœ¨ if (id == null) &#123; //è¿”å›cu return Result.fail(&quot;å•†é“ºidä¸èƒ½ä¸ºç©º&quot;); &#125; //æ›´æ–°æ•°æ®åº“ updateById(shop); //åˆ é™¤ç¼“å­˜ï¼Œä¸‹æ¬¡ç”¨å†å– stringRedisTemplate.delete(RedisConstants.CACHE_SHOP_KEY + id); //è¿”å›æˆåŠŸä¿¡æ¯ return Result.ok();&#125; ShopControllerä¸­ï¼š 12345@PutMappingpublic Result updateShop(@RequestBody Shop shop) &#123; //æ›´æ–°æ•°æ® return shopService.update(shop);&#125; 2.5 ç¼“å­˜ç©¿é€ç¼“å­˜ç©¿é€æ˜¯æŒ‡å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®åœ¨ç¼“å­˜ä¸­å’Œæ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨ï¼Œè¿™æ ·ç¼“å­˜æ°¸è¿œä¸ä¼šç”Ÿæ•ˆï¼Œè¿™äº›è¯·æ±‚åˆ°ä¼šæ‰“åˆ°æ•°æ®åº“ã€‚(å¤šæ¬¡æŸ¥è¯¢ä¸å­˜åœ¨çš„ä¿¡æ¯ï¼Œé¢‘ç¹è¯·æ±‚æ•°æ®åº“ï¼Œæœ‰å¯èƒ½å¯¼è‡´æ•°æ®åº“å´©æºƒ) å¸¸è§çš„è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š ç¼“å­˜ç©ºå¯¹è±¡ ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œç»´æŠ¤æ–¹ä¾¿ ç¼ºç‚¹ï¼š é¢å¤–çš„å†…å­˜æ¶ˆè€— å¯èƒ½é€ æˆçŸ­æœŸçš„ä¸ä¸€è‡´ (æŸ¥è¯¢ä¸€ä¸ªidæœªå‘½ä¸­ï¼ŒRediså†™å…¥ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæ­¤æ—¶æ•°æ®åº“æ’å…¥è¿™ä¸ªidï¼Œå¯¼è‡´ä¿¡æ¯ä¸ä¸€è‡´) sequenceDiagram å®¢æˆ·ç«¯->>Redis:è¯·æ±‚ note left of Redis:æœªå‘½ä¸­ Redis->>æ•°æ®åº“:è¯·æ±‚ note left of æ•°æ®åº“:æœªå‘½ä¸­ æ•°æ®åº“->>Redis:ç¼“å­˜nullè®¾ç½®TTL å¸ƒéš†è¿‡æ»¤ ä¼˜ç‚¹ï¼šå†…å­˜å ç”¨è¾ƒå°‘ï¼Œæ²¡æœ‰å¤šä½™çš„key ç¼ºç‚¹ï¼š å®ç°å¤æ‚ å­˜åœ¨è¯¯åˆ¤å¯èƒ½ sequenceDiagram å®¢æˆ·ç«¯->>å¸ƒéš†è¿‡æ»¤:è¯·æ±‚ å¸ƒéš†è¿‡æ»¤->>å®¢æˆ·ç«¯:æ‹’ç» note left of å¸ƒéš†è¿‡æ»¤:ä¸å­˜åœ¨ å¸ƒéš†è¿‡æ»¤->>Redis:æ”¾è¡Œï¼Œè¯·æ±‚ note left of Redis:å­˜åœ¨ Redis->>å®¢æˆ·ç«¯:è¿”å› note over Redis,å®¢æˆ·ç«¯:å‘½ä¸­ Redis->>æ•°æ®åº“:è¯·æ±‚ note left of æ•°æ®åº“:æœªå‘½ä¸­ æ•°æ®åº“->>Redis:ç¼“å­˜æ•°æ® æ•°æ®åº“->>å®¢æˆ·ç«¯:è¿”å›æ•°æ® 2.6 è§£å†³ç¼“å­˜ç©¿é€é—®é¢˜å°±æ˜¯å°†ä¹‹å‰åˆ¤æ–­å•†é“ºä¸å­˜åœ¨æ—¶ï¼Œè¿”å›404ä¿¡æ¯æ”¹ä¸ºå°†ç©ºå€¼å†™å…¥Redis 123456789101112131415161718192021222324252627282930313233343536373839@Resourceprivate StringRedisTemplate stringRedisTemplate;@Overridepublic Result queryById(Long id) &#123; String key = RedisConstants.CACHE_SHOP_KEY + id; //ä»RedisæŸ¥è¯¢å•†é“ºç¼“å­˜ String shopJson = stringRedisTemplate.opsForValue().get(key); //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ if (StrUtil.isNotBlank(shopJson)) &#123; //å­˜åœ¨ï¼Œè¿”å›ä¿¡æ¯ Shop shop = JSONUtil.toBean(shopJson, Shop.class); return Result.ok(shop); &#125; //å‘½ä¸­çš„æ˜¯å¦ä¸ºç©ºå­—ç¬¦ä¸² if (&quot;&quot;.equals(shopJson)) &#123; //è¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;åº—é“ºä¸å­˜åœ¨&quot;); &#125; //ä¸å­˜åœ¨ï¼Œæ ¹æ®idæŸ¥è¯¢ Shop shop = getById(id); //idä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ if (shop == null) &#123; //å°†ç©ºå€¼å†™å…¥Redis stringRedisTemplate.opsForValue().set(key,//key &quot;&quot;, //ç©ºå€¼ RedisConstants.CACHE_NULL_TTL,// 2 TimeUnit.MINUTES); //åˆ†é’Ÿ //è¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;åº—é“ºä¸å­˜åœ¨&quot;); &#125; //idå­˜åœ¨ï¼Œå°†æ•°æ®å†™å…¥Redisï¼Œè®¾ç½®æœ‰æ•ˆæœŸ stringRedisTemplate.opsForValue().set(key, //key JSONUtil.toJsonStr(shop), // value RedisConstants.CACHE_SHOP_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //è¿”å›å•†é“ºä¿¡æ¯ return Result.ok(shop);&#125; ç¼“å­˜ç©¿é€äº§ç”Ÿçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ ç”¨æˆ·è¯·æ±‚çš„æ•°æ®å†ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨ï¼Œä¸æ–­å‘èµ·è¿™æ ·çš„è¯·æ±‚ï¼Œç»™æ•°æ®åº“å¸¦æ¥äº†å·¨å¤§å‹åŠ› ç¼“å­˜ç©¿é€çš„è§£å†³æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ ç¼“å­˜nullå€¼ å¸ƒéš†è¿‡æ»¤ å¢åŠ idçš„å¤æ‚åº¦ï¼Œé¿å…è¢«çŒœåˆ°idè§„å¾‹ åšå¥½æ•°æ®çš„åŸºç¡€æ ¼å¼æ ¡éªŒ 2.7 ç¼“å­˜é›ªå´©ç¼“å­˜é›ªå´©æ˜¯æŒ‡åŒä¸€æ—¶é—´å¤§é‡çš„ç¼“å­˜keyåŒæ—¶å¤±æ•ˆæˆ–è€…RedisæœåŠ¡å®•æœºï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚åˆ°è¾¾æ•°æ®åº“ï¼Œå¸¦æ¥å‹åŠ›ã€‚ sequenceDiagram å®¢æˆ·ç«¯->>Redis:è¯·æ±‚ note over Redis:å®•æœºæˆ–å¤§é‡ç¼“å­˜åŒæ—¶å¤±æ•ˆ Redis->>æ•°æ®åº“:å¤§é‡è¯·æ±‚ note left of æ•°æ®åº“:å¸¦æ¥å·¨å¤§å‹åŠ› æ•°æ®åº“->>å®¢æˆ·ç«¯:è¿”å› è§£å†³æ–¹æ¡ˆï¼š ç»™ä¸åŒçš„keyçš„TTLæ·»åŠ éšæœºå€¼ åˆ©ç”¨Redisé›†ç¾¤æé«˜æœåŠ¡çš„å¯ç”¨æ€§ ç»™ç¼“å­˜ä¸šåŠ¡æ·»åŠ é™çº§é™æµç­–ç•¥ ç»™ä¸šåŠ¡æ·»åŠ å¤šçº§ç¼“å­˜ 2.X ç¼“å­˜å‡»ç©¿2.X ç¼“å­˜å·¥å…·å°è£…3.è¾¾äººæ¢åº—4.ä¼˜æƒ åˆ¸ç§’æ€5.å¥½å‹å…³æ³¨6.é™„è¿‘çš„å•†æˆ·7.ç”¨æˆ·ç­¾åˆ°8.UVç»Ÿè®¡é«˜çº§ç¯‡åŸç†ç¯‡st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå· cond=>condition: æ ¡éªŒæ‰‹æœºå· code=>operation: ç”ŸæˆéªŒè¯ç  save=>operation: éªŒè¯ç ä¿å­˜åˆ°Session send=>operation: å‘é€éªŒè¯ç  e=>end: ç»“æŸ st->op->cond(yes)->code->save->send->e cond(no)->op{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-0-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-0-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-0\", options);st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå·å’ŒéªŒè¯ç  cond1=>condition: æ ¡éªŒéªŒè¯ç  code=>operation: æ ¹æ®æ‰‹æœºå·æŸ¥è¯¢ç”¨æˆ· cond2=>condition: ç”¨æˆ·æ˜¯å¦å­˜åœ¨ login=>operation: ç™»å½• register=>operation: åˆ›å»ºæ–°ç”¨æˆ· save1=>operation: ä¿å­˜ç”¨æˆ·åˆ°Session save2=>operation: ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“ e=>end: ç»“æŸ st->op->cond1(yes)->code->cond2(yes)->login->save1->e cond1(no)->op cond2(no)->register->save2->save1{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-1-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-1-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-1\", options);st=>start: å¼€å§‹ op=>operation: è¯·æ±‚å¹¶æºå¸¦cookie get=>operation: ä»Sessionè·å–ç”¨æˆ· cond=>condition: åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ save=>operation: ä¿å­˜ç”¨æˆ·åˆ°TreadLocal pass=>operation: æ”¾è¡Œ intercept=>operation: æ‹¦æˆª e=>end: ç»“æŸ st->op->get->cond(yes)->save->pass->e cond(no)->intercept->e{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-2-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-2-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-2\", options);st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå· cond=>condition: æ ¡éªŒæ‰‹æœºå· code=>operation: ç”ŸæˆéªŒè¯ç  save=>operation: éªŒè¯ç ä¿å­˜åˆ°Redis send=>operation: å‘é€éªŒè¯ç  e=>end: ç»“æŸ st->op->cond(yes)->code->save->send->e cond(no)->op{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-3-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-3-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-3\", options);st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå·å’ŒéªŒè¯ç  cond1=>condition: æ ¡éªŒéªŒè¯ç  code=>operation: æ ¹æ®æ‰‹æœºå·æŸ¥è¯¢ç”¨æˆ· cond2=>condition: ç”¨æˆ·æ˜¯å¦å­˜åœ¨ login=>operation: ç™»å½• register=>operation: åˆ›å»ºæ–°ç”¨æˆ· save1=>operation: ä¿å­˜ç”¨æˆ·åˆ°Redis save2=>operation: ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“ back=>operation: è¿”å›tokenç»™å®¢æˆ·ç«¯ e=>end: ç»“æŸ st->op->cond1(yes)->code->cond2(yes)->login->save1->back->e cond1(no)->op cond2(no)->register->save2->save1{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-4-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-4-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-4\", options);st=>start: å¼€å§‹ op=>operation: è¯·æ±‚å¹¶æºå¸¦token get=>operation: ä»Redisè·å–ç”¨æˆ· cond=>condition: åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ save=>operation: ä¿å­˜ç”¨æˆ·åˆ°TreadLocal pass=>operation: æ”¾è¡Œ intercept=>operation: æ‹¦æˆª e=>end: ç»“æŸ st->op->get->cond(yes)->save->pass->e cond(no)->intercept->e{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-5-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-5-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-5\", options);st=>start: å¼€å§‹ op=>operation: æäº¤å•†é“ºid get=>operation: ä»RedisæŸ¥è¯¢å•†é“ºç¼“å­˜ cond1=>condition: ç¼“å­˜æ˜¯å¦å‘½ä¸­ resp=>operation: è¿”å›å•†é“ºä¿¡æ¯ select=>operation: æ ¹æ®idæŸ¥è¯¢æ•°æ®åº“ cond2=>condition: åˆ¤æ–­å•†é“ºæ˜¯å¦å­˜åœ¨ exist=>operation: å°†å•†é“ºæ•°æ®å†™å…¥Redis non-existent=>operation: è¿”å›404 e=>end: ç»“æŸ st->op->get->cond1(yes)->resp->e cond1(no)->select->cond2(yes)->exist(left)->resp cond2(no)->non-existent->e{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-6-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-6-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-6\", options);st=>start: å¼€å§‹ op=>operation: æäº¤å•†é“ºid get=>operation: ä»RedisæŸ¥è¯¢å•†é“ºç¼“å­˜ cond1=>condition: ç¼“å­˜æ˜¯å¦å‘½ä¸­ resp=>operation: è¿”å›å•†é“ºä¿¡æ¯ select=>operation: æ ¹æ®idæŸ¥è¯¢æ•°æ®åº“ cond2=>condition: åˆ¤æ–­å•†é“ºæ˜¯å¦å­˜åœ¨ exist=>operation: å°†å•†é“ºæ•°æ®å†™å…¥Redis non-existent=>operation: å°†ç©ºå€¼å†™å…¥Redis e=>end: ç»“æŸ st->op->get->cond1(yes)->resp->e cond1(no)->select->cond2(yes)->exist(left)->resp cond2(no)->non-existent->e{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-7-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-7-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-7\", options);","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"}]},{"title":"","slug":"Java/MyBatis-Plusæ¡†æ¶","date":"2022-08-06T11:11:16.302Z","updated":"2022-07-15T01:04:44.519Z","comments":true,"path":"2022/08/06/Java/MyBatis-Plusæ¡†æ¶/","link":"","permalink":"http://example.com/2022/08/06/Java/MyBatis-Plus%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè¯†MyBatis-PlusMyBatis-Plusæ˜¯MyBatisçš„å¢å¼ºå·¥å…·ï¼Œåœ¨MyBatisçš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºäº†ç®€åŒ–å¼€å‘ï¼Œæé«˜æ•ˆç‡è€Œç”Ÿ å®˜ç½‘ï¼šMyBatis-Plus ç‰¹æ€§ï¼š æ— å…¥ä¾µï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¯¼å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ã€‚ æŸè€—å°ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬CRUDï¼Œæ€§èƒ½åŸºæœ¬ä¸æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ å¼ºå¤§çš„CRUDæ“ä½œï¼šå†…ç½®é€šç”¨Mapperã€é€šç”¨Service ,ä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ†CRUDæ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚ æ”¯æŒLambdaå½¢å¼è°ƒç”¨ï¼šé€šè¿‡Lambdaè¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™ æ”¯æŒå¤šç§æ•°æ®åº“ï¼šæ”¯æŒMySQLã€MariaDBã€ Oracleã€ DB2ã€ H2ã€ HSQLã€ SQLiteã€ Postgreã€SQL Serverç­‰å¤šç§æ•°æ®åº“ æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆï¼šæ”¯æŒå¤šè¾¾4ç§ä¸»é”®ç­–ç•¥(å†…å«åˆ†å¸ƒå¼å”¯ä¸€IDç”Ÿæˆå™¨- Sequence)ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜ æ”¯æŒXMLçƒ­åŠ è½½ï¼šMapperå¯¹åº”çš„XMLæ”¯æŒçƒ­åŠ è½½ï¼Œå¯¹äºç®€å•çš„CRUDæ“ä½œï¼Œç”šè‡³å¯ä»¥æ— XMLå¯åŠ¨ æ”¯æŒActiveRecordæ¨¡å¼ï¼šæ”¯æŒActiveRecordå½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿Modelç±»å³å¯è¿›è¡Œå¼ºå¤§çš„CRUDæ“ä½œ æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥(Write onceï¼Œuse anywhere) æ”¯æŒå…³é”®è¯è‡ªåŠ¨è½¬ä¹‰ï¼šæ”¯æŒæ•°æ®åº“å…³é”®è¯( orderã€ keyâ€¦. )è‡ªåŠ¨è½¬ä¹‰ï¼Œè¿˜å¯è‡ªå®šä¹‰å…³é”®è¯ å†…ç½®ä»£ç ç”Ÿæˆå™¨ï¼šé‡‡ç”¨ä»£ç æˆ–è€…Mavenæ’ä»¶å¯å¿«é€Ÿç”ŸæˆMapperã€ Modelã€Serviceã€Controllerå±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨ å†…ç½®åˆ†é¡µæ’ä»¶ï¼šåŸºäºMyBatisç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€šListæŸ¥è¯¢ å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶ï¼šå¯è¾“å‡ºSqlè¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢ å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶ï¼šæä¾›å…¨è¡¨deleteã€update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ å†…ç½®Sqlæ³¨å…¥å‰¥ç¦»å™¨ï¼šæ”¯æŒSqlæ³¨å…¥å‰¥ç¦»ï¼Œæœ‰æ•ˆé¢„é˜²Sqlæ³¨å…¥æ”»å‡» 2.åˆ›å»ºæ•°æ®åº“åˆ›å»ºæ•°æ®åº“ï¼š æ•°æ®åï¼šmp å­—ç¬¦é›†ï¼šutf-8 åˆ›å»ºè¡¨ï¼š 123456789101112131415161718192021-- åˆ›å»ºæµ‹è¯•è¡¨CREATE TABLE `tb_user` (`id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#x27;ä¸»é”®ID&#x27;,`user_name` varchar(20) NOT NULL COMMENT &#x27;ç”¨æˆ·å&#x27;,`password` varchar(20) NOT NULL COMMENT &#x27;å¯†ç &#x27;,`name` varchar(30) DEFAULT NULL COMMENT &#x27;å§“å&#x27;,`age` int(11) DEFAULT NULL COMMENT &#x27;å¹´é¾„&#x27;,`email` varchar(50) DEFAULT NULL COMMENT &#x27;é‚®ç®±&#x27;,PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;-- æ’å…¥æµ‹è¯•æ•°æ®INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;1&#x27;, &#x27;zhangsan&#x27;, &#x27;123456&#x27;, &#x27;å¼ ä¸‰&#x27;, &#x27;18&#x27;, &#x27;test1@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;2&#x27;, &#x27;lisi&#x27;, &#x27;123456&#x27;, &#x27;æå››&#x27;, &#x27;20&#x27;, &#x27;test2@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;3&#x27;, &#x27;wangwu&#x27;, &#x27;123456&#x27;, &#x27;ç‹äº”&#x27;, &#x27;28&#x27;, &#x27;test3@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;4&#x27;, &#x27;zhaoliu&#x27;, &#x27;123456&#x27;, &#x27;èµµå…­&#x27;, &#x27;21&#x27;, &#x27;test4@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;5&#x27;, &#x27;sunqi&#x27;, &#x27;123456&#x27;, &#x27;å­™ä¸ƒ&#x27;, &#x27;24&#x27;, &#x27;test5@itcast.cn&#x27;); 3.Mybatis-Pluså¿«é€Ÿå…¥é—¨å¯¼å…¥æ‰€æœ‰ä¾èµ–ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940&lt;dependencies&gt; &lt;!-- mybatis-plusæ’ä»¶ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus&lt;/artifactId&gt; &lt;version&gt;3.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- mysql --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt; &lt;/dependency&gt; &lt;!-- æ•°æ®åº“è¿æ¥æ±  --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt; &lt;/dependency&gt; &lt;!-- ç®€åŒ–beanä»£ç å·¥å…· --&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;version&gt;1.18.24&lt;/version&gt; &lt;/dependency&gt; &lt;!-- å•å…ƒæµ‹è¯•æ’ä»¶ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- æ—¥å¿—æ’ä»¶ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.36&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; resoursesèµ„æºåŒ…ä¸­ï¼Œæ–°å»ºlog4j.propertiesæ–‡ä»¶ï¼š 1234log4j.rootLogger=DEBUG,A1log4j.appender.A1=org.apache.log4j.ConsoleAppenderlog4j.appender.A1.layout=org.apache.log4j.PatternLayoutlog4j.appender.A1.layout.ConversionPattern=[%t] [%c]-[%p] %m%n åˆ›å»ºUserå®ä½“ç±»ï¼š 1234567891011@Data //ç”Ÿæˆgetterå’Œsetterdæ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; é¡¹ç›®ç»“æ„ï¼š 3.1 Mybatiså®ç°æŸ¥è¯¢åœ¨resourcesèµ„æºåŒ…ä¸­ï¼Œåˆ›å»ºmybatis-config.xmlæ–‡ä»¶ï¼š 12345678910111213141516171819202122&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt; &lt;environments default=&quot;development&quot;&gt; &lt;environment id=&quot;development&quot;&gt; &lt;transactionManager type=&quot;JDBC&quot;/&gt; &lt;dataSource type=&quot;POOLED&quot;&gt; &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mp?useUnicode=true&amp;amp;characterEncoding=utf8&amp;amp;autoReconnect=true&amp;amp;allowMultiQueries=true&amp;amp;useSSL=false&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;mapper resource=&quot;UserMapper.xml&quot;/&gt; &lt;/mappers&gt;&lt;/configuration&gt; åˆ›å»ºUserMapperæ¥å£ï¼š 1234public interface UserMapper &#123; List&lt;User&gt; findAll(); &#125; åœ¨resourcesèµ„æºåŒ…åˆ›å»ºUserMapper.xmlæ–‡ä»¶:ï¼š namespaceä¸ºUserMapperæ¥å£çš„ä½ç½® idä¸ºUserMapperä¸­çš„æ–¹æ³•å resultTypeä¸ºå®ä½“ç±»çš„ä½ç½® 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.mybatisp.mapper.UserMapper&quot;&gt; &lt;select id=&quot;findAll&quot; resultType=&quot;com.mybatisp.pojo.User&quot;&gt; select * from tb_user &lt;/select&gt;&lt;/mapper&gt; å•å…ƒæµ‹è¯•ï¼š 1234567891011@Testpublic void testFindAll() throws IOException &#123; InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is); SqlSession sqlSession = sqlSessionFactory.openSession(); UserMapper userMapper = sqlSession.getMapper(UserMapper.class); System.out.println(userMapper.findAll());&#125; æ§åˆ¶å°æ‰“å°ï¼š 1[User(id=1, userName=null, password=123456, name=å¼ ä¸‰, age=18, email=test1@itcast.cn), User(id=2, userName=null, password=123456, name=æå››, age=20, email=test2@itcast.cn), User(id=3, userName=null, password=123456, name=ç‹äº”, age=28, email=test3@itcast.cn), User(id=4, userName=null, password=123456, name=èµµå…­, age=21, email=test4@itcast.cn), User(id=5, userName=null, password=123456, name=å­™ä¸ƒ, age=24, email=test5@itcast.cn)] 3.2 Mybatis+MPå®ç°æŸ¥è¯¢å°†UserMapperç»§æ‰¿BaseMapperï¼Œå°†æ‹¥æœ‰äº†BaseMapperä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼š 1234public interface UserMapper extends BaseMapper&lt;User&gt; &#123; List&lt;User&gt; findAll();&#125; å•å…ƒæµ‹è¯•ï¼š 123456789101112@Testpublic void testFindAll2() throws IOException &#123; InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;); //è¿™é‡Œä½¿ç”¨çš„æ˜¯MPä¸­çš„MybatisSqlSessionFactoryBuilder SqlSessionFactory sqlSessionFactory = new MybatisSqlSessionFactoryBuilder().build(is); SqlSession sqlSession = sqlSessionFactory.openSession(); UserMapper userMapper = sqlSession.getMapper(UserMapper.class); System.out.println(userMapper.findAll()); &#125; è¿è¡ŒæˆåŠŸï¼ æ”¹ç”¨BaseMapperä¸­å®šä¹‰çš„æ–¹æ³•æŸ¥è¯¢æ‰€æœ‰ï¼š 1234567891011@Testpublic void testFindAll2() throws IOException &#123; InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;); SqlSessionFactory sqlSessionFactory = new MybatisSqlSessionFactoryBuilder().build(is); SqlSession sqlSession = sqlSessionFactory.openSession(); UserMapper userMapper = sqlSession.getMapper(UserMapper.class); //System.out.println(userMapper.findAll()); System.out.println(userMapper.selectList(null));&#125; æŠ¥é”™ï¼š 1Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table &#x27;mp.user&#x27; doesn&#x27;t exist æŠ¥é”™åŸå› æ˜¯æ²¡æœ‰æ‰¾åˆ°userè¡¨ï¼Œå› ä¸ºæ•°æ®åº“ä¸­çš„è¡¨åä¸ºtb_useræ‰€ä»¥å¯¼è‡´æ²¡æœ‰æ‰¾åˆ°è¯¥è¡¨ã€‚éœ€è¦æŒ‡å®šè¡¨ï¼š åœ¨Userå®ä½“ç±»ä¸­ä¸æ•°æ®åº“ä¸­çš„è¡¨è¿›è¡Œæ˜ å°„ï¼š 123456789101112@Data //ç”Ÿæˆgetterå’Œsetteræ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°@TableName(&quot;tb_user&quot;) //æŒ‡å®šä¸ºtb_userè¡¨public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; å†æ¬¡è¿è¡Œï¼ŒæˆåŠŸï¼ 3.3 Spring+Mybatis+MPæ–°å»ºé¡¹ç›®ï¼š å¯¼å…¥ä¾èµ–ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus&lt;/artifactId&gt; &lt;version&gt;3.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;version&gt;1.18.24&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.36&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åœ¨resourcesèµ„æºåŒ…ä¸­åˆ›å»ºlog4j.propertiesæ–‡ä»¶ï¼š 1234log4j.rootLogger=DEBUG,A1log4j.appender.A1=org.apache.log4j.ConsoleAppenderlog4j.appender.A1.layout=org.apache.log4j.PatternLayoutlog4j.appender.A1.layout.ConversionPattern=[%t] [%c]-[%p] %m%n åœ¨resourcesèµ„æºåŒ…ä¸­åˆ›å»ºjdbc.propertiesæ–‡ä»¶ï¼š 1234jdbc.driver=com.mysql.jdbc.driverjdbc.url=jdbc:mysql://localhost:3306/mp?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=falsejdbc.username=rootjdbc.password=123456 åœ¨resourcesèµ„æºåŒ…ä¸­åˆ›å»ºapplicationContext.xmlæ–‡ä»¶ 1234567891011121314151617181920212223242526272829&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans.xsdhttp://www.springframework.org/schema/contexthttp://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;context:property-placeholder location=&quot;classpath*:*.properties&quot;/&gt; &lt;!-- å®šä¹‰æ•°æ®æº --&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot; destroy-method=&quot;close&quot;&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt; &lt;property name=&quot;maxActive&quot; value=&quot;10&quot;/&gt; &lt;property name=&quot;minIdle&quot; value=&quot;5&quot;/&gt; &lt;/bean&gt; &lt;!--è¿™é‡Œä½¿ç”¨MPæä¾›çš„sqlSessionFactoryï¼Œå®Œæˆäº†Springä¸MPçš„æ•´åˆ--&gt; &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--æ‰«æmapperæ¥å£ï¼Œä½¿ç”¨çš„ä¾ç„¶æ˜¯MybatisåŸç”Ÿçš„æ‰«æå™¨--&gt; &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt; &lt;property name=&quot;basePackage&quot; value=&quot;com.mybatisp.mapper&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; åˆ›å»ºUserå®ä½“ç±»ï¼š 123456789101112@Data //ç”Ÿæˆgetterå’Œsetteræ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°@TableName(&quot;tb_user&quot;)public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; åˆ›å»ºUerMapperæ¥å£ï¼š 12public interface UserMapper extends BaseMapper&lt;User&gt; &#123;&#125; å•å…ƒæµ‹è¯•ï¼š 1234567891011@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations = &quot;classpath:applicationContext.xml&quot;)public class MybatisTest &#123; @Autowired private UserMapper userMapper; @Test public void testSelectList()&#123; System.out.println(userMapper.selectList(null)); &#125;&#125; è¿è¡ŒæˆåŠŸï¼ 3.4 SpringBoot+Mybaits+MPxmlç‰ˆ é¡¹ç›®ç»“æ„ï¼š åˆ›å»ºspringbooté¡¹ç›®è‡ªåŠ¨å¯¼å…¥ä¾èµ–ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.4.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.2.11&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt; &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-boot.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.3.7.RELEASE&lt;/version&gt; &lt;configuration&gt; &lt;mainClass&gt;com.mybatisp.SpringbootMpApplication&lt;/mainClass&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;repackage&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;repackage&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; application.ymlï¼š 1234567spring: datasource: druid: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://localhost:3306/mp?serverTimezone=UTC username: root password: 123456 Userå®ä½“ç±»ï¼š 123456789101112@Data //ç”Ÿæˆgetterå’Œsetteræ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°@TableName(&quot;tb_user&quot;)public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; UserMapperæ¥å£ï¼š 123@Mapperpublic interface UserMapper extends BaseMapper&lt;User&gt; &#123;&#125; å•å…ƒæµ‹è¯•ï¼š 12345678910@SpringBootTestpublic class UserMapperTest &#123; @Autowired private UserMapper userMapper; @Test public void findAll() &#123; System.out.println(userMapper.selectList(null)); &#125;&#125; è¿è¡ŒæˆåŠŸï¼ 9.ä»£ç ç”Ÿæˆå™¨åˆ›å»ºSpringbooté¡¹ç›®ï¼š æ·»åŠ ä¸‹é¢çš„ä¾èµ–ï¼š 1234567891011&lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt; &lt;version&gt;3.5.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.freemarker&lt;/groupId&gt; &lt;artifactId&gt;freemarker&lt;/artifactId&gt; &lt;version&gt;2.3.31&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç±»ï¼š 12345678910111213141516171819202122232425public class FastAutoGeneratorTest &#123; public static void main(String[] args) &#123; FastAutoGenerator.create(&quot;jdbc:mysql://localhost:3306/mp?serverTimezone=UTC&quot;, &quot;root&quot;, &quot;123456&quot;) .globalConfig(builder -&gt; &#123; builder.author(&quot;baomidou&quot;) // è®¾ç½®ä½œè€… //.enableSwagger() // å¼€å¯ swagger æ¨¡å¼ .fileOverride() // è¦†ç›–å·²ç”Ÿæˆæ–‡ä»¶ .outputDir(&quot;E:\\\\Java_Web\\\\Mybatis-p\\\\mp_04_generator\\\\src\\\\main\\\\java&quot;); // æŒ‡å®šè¾“å‡ºç›®å½• &#125;) .packageConfig(builder -&gt; &#123; builder.parent(&quot;com&quot;) // è®¾ç½®çˆ¶åŒ…å .moduleName(&quot;mybatisp&quot;) // è®¾ç½®çˆ¶åŒ…æ¨¡å—å .pathInfo(Collections.singletonMap(OutputFile.xml, &quot;E:\\\\Java_Web\\\\Mybatis-p\\\\mp_04_generator\\\\src\\\\main\\\\resources\\\\mapper&quot;)); // è®¾ç½®mapperXmlç”Ÿæˆè·¯å¾„ &#125;) .strategyConfig(builder -&gt; &#123; builder.addInclude(&quot;tb_user&quot;) // è®¾ç½®éœ€è¦ç”Ÿæˆçš„è¡¨å .addTablePrefix(&quot;tb_&quot;, &quot;c_&quot;); // è®¾ç½®è¿‡æ»¤è¡¨å‰ç¼€ &#125;) .templateEngine(new FreemarkerTemplateEngine()) // ä½¿ç”¨Freemarkerå¼•æ“æ¨¡æ¿ï¼Œé»˜è®¤çš„æ˜¯Velocityå¼•æ“æ¨¡æ¿ .execute(); &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12345608:57:51.095 [main] DEBUG com.baomidou.mybatisplus.generator.AutoGenerator - ==========================å‡†å¤‡ç”Ÿæˆæ–‡ä»¶...==========================08:57:51.521 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - æ‰§è¡ŒSQL:show table status WHERE 1=1 AND NAME IN (&#x27;tb_user&#x27;)08:57:51.538 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - è¿”å›è®°å½•æ•°:1,è€—æ—¶(ms):1608:57:51.550 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - æ‰§è¡ŒSQL:show full fields from `tb_user`08:57:51.559 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - è¿”å›è®°å½•æ•°:6,è€—æ—¶(ms):908:57:51.652 [main] DEBUG com.baomidou.mybatisplus.generator.AutoGenerator - ==========================æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼ï¼ï¼========================== ä»¥ä¸‹ä¸ºç”Ÿæˆçš„æ–‡ä»¶ï¼š","categories":[],"tags":[]},{"title":"MongoDBçš„å­¦ä¹ ç¬”è®°","slug":"Java/MongoDB","date":"2022-08-06T11:11:16.300Z","updated":"2022-09-21T13:32:51.507Z","comments":true,"path":"2022/08/06/Java/MongoDB/","link":"","permalink":"http://example.com/2022/08/06/Java/MongoDB/","excerpt":"","text":"æœªå®Œå¾…ç»­ 1.MongoDBç›¸å…³æ¦‚å¿µä¸šåŠ¡åœºæ™¯ ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“(å¦‚ï¼šMySQL)ï¼Œåœ¨æ•°æ®æ“ä½œçš„â€œä¸‰é«˜â€éœ€æ±‚ä»¥åŠåº”å¯¹Web2.0ç½‘ç«™éœ€æ±‚é¢å‰ï¼Œæ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚ â€œä¸‰é«˜â€éœ€æ±‚ï¼š High performanceï¼šå¯¹æ•°æ®åº“é«˜å¹¶å‘è¯»å†™çš„éœ€æ±‚ Huge Storageï¼šå¯¹æµ·é‡æ•°æ®çš„é«˜æ•ˆç‡å­˜å‚¨å’Œè®¿é—®çš„éœ€æ±‚ã€‚ High Scalability &amp;&amp; High Availabilityï¼šå¯¹æ•°æ®åº“çš„é«˜å¯æ‰©å±•æ€§å’Œé«˜å¯ç”¨æ€§çš„éœ€æ±‚ã€‚ è€ŒMongoDBå¯åº”å¯¹â€ä¸‰é«˜â€éœ€æ±‚ï¼Œè²ä½“çš„åº”ç”¨åœºæ™¯å¦‚ï¼š ç¤¾äº¤åœºæ™¯ï¼šä½¿ç”¨MongoDB å­˜å‚¨å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œä»¥åŠç”¨æˆ·å‘è¡¨çš„æœ‹å‹åœ–ä¿¡æ¯ï¼Œé€šè¿‡åœ°ç†ä½ç½®ç´ å¼•1å®ç°é™„è¿‘çš„äººã€åœ°ç‚¹ç­‰åŠŸèƒ½ã€‚ æ¸¸æˆåœºæ™¯ï¼šä½¿ç”¨ MongoDB å­˜å‚¨æ¸¸æˆç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·çš„è£…å¤‡ã€ç§¯åˆ†ç­‰ç›´æ¥ä»¥å†…åµŒæ–‡æ¡£çš„å½¢å¼å­˜å‚¨ï¼Œæ–¹ä¾¿æŸ¥è¯¢é«˜æ•ˆç‡å­˜å‚¨å’Œè®¿é—®ã€‚ ç‰©æµåœºå‘˜ï¼šä½¿ç”¨ MongoDB å­˜å‚¨è®¢å•ä¿¡æ¯ï¼Œè®¢å•çŠ¶æ€åœ¨è¿é€è¿‡ç¨‹ä¸­ä¼šä¸æ–­æ›´æ–°ï¼Œä»¥MongODB å†…åµŒæ•°ç»„çš„å¼€å¼æ¥å­˜å‚¨ï¼Œä¸€æ¬¡æŸ¥è¯¢å°±èƒ½å°†è®¢å•æ‰€æœ‰çš„å˜æ›´è¯»å–å‡ºæ¥ã€‚ ç‰©è”ç½‘åœºæ™¯ï¼šä½¿ç”¨MongoDB å­˜å‚¨æ‰€æœ‰æ¥å…¥çš„æ™ºèƒ½è®¾å¤‡ä¿¡æ¯ï¼Œä»¥åŠè®¾å¤‡æ±‡æŠ¥çš„æ—¥å¿—ä¿¡æ¯ï¼Œå¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œå¤šç»´åº¦çš„åˆ†æã€‚ è§†é¢‘ç›´æ’­ï¼šä½¿ç”¨ MongoDB å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€ç‚¹èµäº’åŠ¨ä¿¡æ¯ç­‰ã€‚ è¿™äº›åº”ç”¨åœºæ™¯ï¼Œå¯¹æ•°æ®æ“ä½œæ–¹é¢çš„å…±åŒç‰¹ç‚¹æ˜¯ï¼š æ•°æ®é‡å¤§ å†™å…¥æ“ä½œé¢‘ç¹(è¯»å†™å¾ˆé¢‘ç¹) ä»·å€¼è¾ƒä½çš„æ•°æ®ï¼Œå¯¹äº‹åŠ¡æ€§è¦æ±‚ä¸é«˜(ç¼ºç‚¹) å¯¹äºè¿™æ ·çš„æ•°æ®ï¼Œæˆ‘ä»¬æ›´é€‚åˆä½¿ç”¨MongoDBæ¥å®ç°æ•°æ®çš„å­˜å‚¨ ä½•æ—¶é€‰æ‹©MongoDBï¼Ÿ åœ¨æ¶æ„é€‰å‹ä¸Šï¼Œé™¤äº†ä¸Šè¿°çš„ä¸‰ä¸ªç‰¹ç‚¹å¤–ï¼Œå¦‚æœä½ è¿˜çŠ¹è±«æ˜¯å¦è¦é€‰æ‹©å®ƒï¼Ÿå¯ä»¥è€ƒå¿ ä»¥ä¸‹çš„ä¸€äº›é—®é¢˜ï¼š åº”ç”¨ä¸éœ€è¦è»ŠåŠ¡åŠå¤æ‚ ioin æ”¯æŒ æ–°åº”ç”¨ï¼Œéœ€æ±‚ä¼šå˜ï¼Œæ•°æ®æ¨¡å‹æ— æ³•ç¡®å®šï¼Œæƒ³å¿«é€Ÿè¿­ä»£å¼€å‘ åº”ç”¨éœ€è¦2000-3000ä»¥ä¸Šçš„è¯»å†™OPSï¼ˆæ›´é«˜ä¹Ÿå¯ä»¥ï¼‰ åº”ç”¨éœ€è¦TBç”šè‡³ PBçº§åˆ«æ•°æ®å­˜å‚¨ åº”ç”¨å‘å±•è¿…é€Ÿï¼Œéœ€è¦èƒ½å¿«é€Ÿæ°´å¹³æ‰©å±• åº”ç”¨è¦æ±‚å­˜å‚¨çš„æ•°æ®ä¸å¤©å¤± åº”ç”¨éœ€è¦99.999%é«˜å¯ç”¨ åº”ç”¨éœ€è¦å¤§é‡çš„åœ°ç†ä½ç½®æŸ¥è¯¢ã€æ–‡æœ¬æŸ¥è¯¢ å¦‚æœä¸Šè¿°æœ‰1ä¸ªç¬¦åˆï¼Œå¯ä»¥è€ƒè™‘MongoDBï¼Œ 2ä¸ªåŠä»¥ä¸Šçš„ç¬¦åˆï¼Œé€‰æ‹©MongoDB ç»ä¸ä¼šåæ‚”ã€‚ æ•°æ®åº“ï¼šarticledb ä¸“æ æ–‡ç« è¯„è®º(è¡¨)ï¼šcomment å­—æ®µåç§° å­—æ®µå«ä¹‰ å­—æ®µç±»å‹ å¤‡æ³¨ _id ID ObjectIdæˆ–String Mongoçš„ä¸»é”®çš„å­—æ®µ articleid æ–‡ç« ID String content è¯„è®ºå†…å®¹ String userid è¯„è®ºäººID String nickname è¯„è®ºäººæ˜µç§° String createdatetime è¯„è®ºçš„æ—¥æœŸæ—¶é—´ Date likenum ç‚¹èµæ•° Int32 replynum å›å¤æ•° Int32 state çŠ¶æ€ String 0ï¼šä¸å¯è§1ï¼šå¯è§ parentid ä¸Šçº§ID String å¦‚æœä¸º0è¡¨ç¤ºæ–‡ç« çš„é¡¶çº§è¯„è®º 2.MongoDBçš„ç›¸å…³å‘½ä»¤2.1 æ•°æ®åº“çš„åˆ›å»ºä¸åˆ é™¤ å‘½ä»¤ è§£é‡Š ä¾‹å­ use æ•°æ®åº“å é€‰æ‹©æ•°æ®åº“ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º use articledb show dbsæˆ–show databases æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ db æŸ¥çœ‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“ db.dropDatabase() åˆ é™¤å½“å‰æ­£åœ¨çš„ä½¿ç”¨çš„æ•°æ®åº“ db.createCollection(name)name: è¦åˆ›å»ºçš„é›†åˆåç§° æ˜¾ç¤ºåˆ›å»ºé›†åˆ(äº†è§£) db.createCollection(â€œmycollectionâ€) show collectionsæˆ–show tables æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„è¡¨ db.é›†åˆ.drop() åˆ é™¤å½“å‰æ­£åœ¨çš„ä½¿ç”¨çš„æ•°æ®åº“ä¸­çš„é›†åˆ db.mycollection.drop() æ–‡æ¡£(document)çš„æ•°æ®ç»“æ„ä¸JSONåŸºæœ¬ä¸€è‡´ï¼Œæ‰€æœ‰å­˜å‚¨åœ¨é›†åˆä¸­çš„æ•°æ®éƒ½æ˜¯BSONæ ¼å¼ 2.2 æ–‡æ¡£çš„æ’å…¥1234567db.collection.insert( &lt;document or array of documents&gt;, &#123; writeConcern: &lt;document&gt;, ordered: &lt;boolean&gt; &#125;) å•ä¸ªæ–‡æ¡£æ’å…¥ï¼š ä½¿ç”¨insert()æˆ–save()æ–¹æ³•æ’å…¥ï¼š db.collection.insert(document) ç¤ºä¾‹ï¼š å‘commenté›†åˆä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼š 12345678db.comment.insert(&#123; &quot;articleid&quot;:&quot;100000&quot;, &quot;content&quot;:&quot;ä»Šå¤©å¤©æ°”çœŸå¥½ï¼Œé˜³å…‰æ˜åªš&quot;, &quot;userid&quot;:&quot;1001&quot;, &quot;nickname&quot;:&quot;Tom&quot;, &quot;createdatetime&quot;:new Date(), &quot;likenum&quot;:NumberInt(10), &quot;state&quot;:null&#125;) commenté›†åˆå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šéšå¼åˆ›å»º ã€‚ mongoä¸­çš„æ•°å­—ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯doubleç±»å‹ï¼Œå¦‚æœè¦å­˜æ•´å‹ï¼Œå¿…é¡»ä½¿ç”¨å‡½æ•°NumberInt(æ•´å‹æ•°å­—)ï¼Œå¦åˆ™å–å‡ºæ¥å°±æœ‰é—®é¢˜äº†ã€‚ æ’å…¥å½“å‰æ—¥æœŸä½¿ç”¨ new Date() æ’å…¥çš„æ•°æ®æ²¡æœ‰æŒ‡å®š _id ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸»é”®å€¼ å¦‚æœæŸå­—æ®µæ²¡å€¼ï¼Œå¯ä»¥èµ‹å€¼ä¸ºnullï¼Œæˆ–ä¸å†™è¯¥å­—æ®µã€‚ å¦‚æœå‡ºç°ï¼šWriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)ï¼Œè¯´æ˜æ’å…¥æˆåŠŸã€‚ å¤šæ¡æ–‡æ¡£æ’å…¥ï¼š db.comment.insertMany([document1,document2,â€¦]) ç¤ºä¾‹ï¼š å‘commenté›†åˆä¸­æ’å…¥å¤šæ¡æ•°æ®ï¼š 123456789101112131415161718db.comment.insertMany([ &#123;&quot;_id&quot;:&quot;1&quot;, &quot;articleid&quot;:&quot;100001&quot;, &quot;content&quot;:&quot;æˆ‘ä»¬ä¸åº”è¯¥æŠŠæ¸…æ™¨æµªè´¹åœ¨æ‰‹æœºä¸Šï¼Œå¥åº·å¾ˆé‡è¦ï¼Œä¸€æ¯æ¸©æ°´å¹¸ç¦ä½ æˆ‘ä»–ã€‚&quot;, &quot;userid&quot;:&quot;1002&quot;, &quot;nickname&quot;:&quot;ç›¸å¿˜äºæ±Ÿæ¹–&quot;, &quot;createdatetime&quot;:new Date(&quot;2019-08-05T22:08:15.522Z&quot;), &quot;likenum&quot;:NumberInt(1000), &quot;state&quot;:&quot;1&quot;&#125;, &#123;&quot;_id&quot;:&quot;2&quot;, &quot;articleid&quot;:&quot;100001&quot;, &quot;content&quot;:&quot;æˆ‘å¤å¤©ç©ºè…¹å–å‡‰å¼€æ°´ï¼Œå†¬å¤©å–æ¸©å¼€æ°´&quot;, &quot;userid&quot;:&quot;1005&quot;, &quot;nickname&quot;:&quot;ä¼Šäººæ†”æ‚´&quot;, &quot;createdatetime&quot;:new Date(&quot;2019-08-05T23:58:51.485Z&quot;), &quot;likenum&quot;:NumberInt(888), &quot;state&quot;:&quot;1&quot;&#125;]) æ’å…¥æ—¶æŒ‡å®šäº† _id ï¼Œåˆ™ä¸»é”®å°±æ˜¯è¯¥å€¼ã€‚ å¦‚æœæŸæ¡æ•°æ®æ’å…¥å¤±è´¥ï¼Œå°†ä¼šç»ˆæ­¢æ’å…¥ï¼Œä½†å·²ç»æ’å…¥æˆåŠŸçš„æ•°æ®ä¸ä¼šå›æ»šæ‰ã€‚ æ‰¹é‡æ’å…¥ç”±äºæ•°æ®è¾ƒå¤šå®¹æ˜“å‡ºç°å¤±è´¥ï¼Œå› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨try catchè¿›è¡Œå¼‚å¸¸æ•æ‰å¤„ç†ï¼Œæµ‹è¯•çš„æ—¶å€™å¯ä»¥ä¸å¤„ç†ã€‚å¦‚ï¼ˆäº†è§£ï¼‰ï¼š 12345678910111213141516171819202122try &#123;db.comment.insertMany([ &#123;&quot;_id&quot;:&quot;1&quot;, &quot;articleid&quot;:&quot;100001&quot;, &quot;content&quot;:&quot;æˆ‘ä»¬ä¸åº”è¯¥æŠŠæ¸…æ™¨æµªè´¹åœ¨æ‰‹æœºä¸Šï¼Œå¥åº·å¾ˆé‡è¦ï¼Œä¸€æ¯æ¸©æ°´å¹¸ç¦ä½ æˆ‘ä»–ã€‚&quot;, &quot;userid&quot;:&quot;1002&quot;, &quot;nickname&quot;:&quot;ç›¸å¿˜äºæ±Ÿæ¹–&quot;, &quot;createdatetime&quot;:new Date(&quot;2019-08-05T22:08:15.522Z&quot;), &quot;likenum&quot;:NumberInt(1000), &quot;state&quot;:&quot;1&quot;&#125;, &#123;&quot;_id&quot;:&quot;2&quot;, &quot;articleid&quot;:&quot;100001&quot;, &quot;content&quot;:&quot;æˆ‘å¤å¤©ç©ºè…¹å–å‡‰å¼€æ°´ï¼Œå†¬å¤©å–æ¸©å¼€æ°´&quot;, &quot;userid&quot;:&quot;1005&quot;, &quot;nickname&quot;:&quot;ä¼Šäººæ†”æ‚´&quot;, &quot;createdatetime&quot;:new Date(&quot;2019-08-05T23:58:51.485Z&quot;), &quot;likenum&quot;:NumberInt(888), &quot;state&quot;:&quot;1&quot;&#125;])&#125; catch (e) &#123;print (e);&#125; 2.3 æ–‡æ¡£çš„æŸ¥è¯¢1db.collection.find(&lt;query&gt;, [projection]) æŸ¥è¯¢æ‰€æœ‰ï¼š æŸ¥è¯¢commenté›†åˆçš„æ‰€æœ‰æ–‡æ¡£ 12db.comment.find() æˆ– db.comment.find(&#123;&#125;) æ¡ä»¶æŸ¥è¯¢ï¼š æŸ¥è¯¢è¯¢useridä¸º1003çš„è®°å½• 1db.comment.find(&#123;userid:&#x27;1003&#x27;&#125;) å¦‚æœåªéœ€è¦è¿”å›ç¬¬ä¸€æ¡æ•°æ® 1db.comment.findOne(&#123;userid:&#x27;1003&#x27;&#125;) æŠ•å½±æŸ¥è¯¢ï¼šæŸ¥è¯¢ç»“æœè¿”å›éƒ¨åˆ†å­—æ®µ æŸ¥è¯¢ç»“æœæ˜¾ç¤ºuseridå’Œnicknameï¼š 1db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:1,nickname:1&#125;) ç»“æœï¼š 12&#123; &quot;_id&quot; : &quot;4&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125;&#123; &quot;_id&quot; : &quot;5&quot;, &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125; é»˜è®¤ _id ä¼šæ˜¾ç¤ºã€‚ æŸ¥è¯¢ç»“æœåªæ˜¾ç¤ºuseridå’Œnicknameï¼Œä¸æ˜¾ç¤º_idï¼š 1db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:1,nickname:1,_id:0&#125;) ç»“æœï¼š 12&#123; &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125; &#123; &quot;userid&quot; : &quot;1003&quot;, &quot;nickname&quot; : &quot;å‡¯æ’’&quot; &#125; 2.4 æ–‡æ¡£çš„æ›´æ–°1234567891011121314db.collection.update(query, update, options)æˆ–db.collection.update(&lt;query&gt;,&lt;update&gt;,&#123;upsert: &lt;boolean&gt;,multi: &lt;boolean&gt;,writeConcern: &lt;document&gt;,collation: &lt;document&gt;,arrayFilters: [ &lt;filterdocument1&gt;, ... ],hint: &lt;document|string&gt; // Available starting in MongoDB 4.2&#125;) è¦†ç›–ä¿®æ”¹ï¼š ä¿®æ”¹_idä¸º1çš„è®°å½•ï¼Œç‚¹èµé‡ä¸º1001 1db.comment.update(&#123;_id:&quot;1&quot;&#125;,&#123;likenum:NumberInt(1001)&#125;) æ‰§è¡Œåï¼Œè¿™æ¡æ–‡æ¡£é™¤äº†likenumå­—æ®µå…¶å®ƒå­—æ®µéƒ½ä¸è§äº† å±€éƒ¨ä¿®æ”¹ï¼šä»¬éœ€è¦ä½¿ç”¨ä¿®æ”¹å™¨$setæ¥å®ç° ä¿®æ”¹_idä¸º2çš„è®°å½•ï¼Œç‚¹èµé‡ä¸º889 1db.comment.update(&#123;_id:&quot;2&quot;&#125;,&#123;$set:&#123;likenum:NumberInt(889)&#125;&#125;) æ‰¹é‡ä¿®æ”¹ï¼š æ›´æ–°ç”¨æˆ·idä¸º1003çš„ç”¨æˆ·çš„æ˜µç§°ä¸ºå¤§é»„ 1234//é»˜è®¤åªä¿®æ”¹ç¬¬ä¸€æ¡æ•°æ®db.comment.update(&#123;userid:&quot;1003&quot;&#125;,&#123;$set:&#123;nickname:&quot;å¤§é»„&quot;&#125;&#125;)//ä¿®æ”¹æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®db.comment.update(&#123;userid:&quot;1003&quot;&#125;,&#123;$set:&#123;nickname:&quot;å¤§é»„&quot;&#125;&#125;,&#123;multi:true&#125;) åˆ—å€¼å¢é•¿ä¿®æ”¹ï¼šä½¿ç”¨$incè¿ç®—ç¬¦æ¥å®ç°å¯¹æŸåˆ—å€¼åœ¨åŸæœ‰å€¼çš„åŸºç¡€ä¸Šè¿›è¡Œå¢åŠ æˆ–å‡å°‘ å¯¹3å·æ•°æ®çš„ç‚¹èµæ•°ï¼Œæ¯æ¬¡é€’å¢1 1db.comment.update(&#123;_id:&quot;3&quot;&#125;,&#123;$inc:&#123;likenum:NumberInt(1)&#125;&#125;) 2.5 æ–‡æ¡£çš„åˆ é™¤1db.é›†åˆåç§°.remove(æ¡ä»¶) å°†æ•°æ®å…¨éƒ¨åˆ é™¤ï¼š(è°¨æ…ä½¿ç”¨) 1db.comment.remove(&#123;&#125;) åˆ é™¤_id&#x3D;1çš„è®°å½•ï¼š 1db.comment.remove(&#123;_id:&quot;1&quot;&#125;) 2.6 æ–‡æ¡£çš„åˆ†é¡µæŸ¥è¯¢ç»Ÿè®¡æŸ¥è¯¢ï¼š 1db.collection.count(query, options) ç»Ÿè®¡æ‰€æœ‰è®°å½•æ•°ï¼š 1db.comment.count() æŒ‰æ¡ä»¶ç»Ÿè®¡è®°å½•æ•°ï¼š ç»Ÿè®¡useridä¸º1003çš„è®°å½•æ¡æ•° 1db.comment.count(&#123;userid:&quot;1003&quot;&#125;) åˆ†é¡µåˆ—è¡¨æŸ¥è¯¢ï¼šä½¿ç”¨limit()æ–¹æ³•æ¥è¯»å–æŒ‡å®šæ•°é‡çš„æ•°æ®ï¼Œä½¿ç”¨skip()æ–¹æ³•æ¥è·³è¿‡æŒ‡å®šæ•°é‡çš„æ•°æ®ã€‚ 1db.COLLECTION_NAME.find().limit(NUMBER).skip(NUMBER) è¿”å›æŒ‡å®šæ¡æ•°çš„è®°å½•ï¼Œå¯ä»¥åœ¨findæ–¹æ³•åè°ƒç”¨limitæ¥è¿”å›ç»“æœ(TopN)ï¼Œé»˜è®¤å€¼20 1db.comment.find().limit(3) skipæ–¹æ³•åŒæ ·æ¥å—ä¸€ä¸ªæ•°å­—å‚æ•°ä½œä¸ºè·³è¿‡çš„è®°å½•æ¡æ•°ã€‚ï¼ˆå‰Nä¸ªä¸è¦ï¼‰,é»˜è®¤å€¼æ˜¯0 1db.comment.find().skip(3) åˆ†é¡µæŸ¥è¯¢ï¼šéœ€æ±‚ï¼šæ¯é¡µ2ä¸ªï¼Œç¬¬äºŒé¡µå¼€å§‹ï¼šè·³è¿‡å‰ä¸¤æ¡æ•°æ®ï¼Œæ¥ç€å€¼æ˜¾ç¤º3å’Œ4æ¡æ•°æ® 123456//ç¬¬ä¸€é¡µdb.comment.find().skip(0).limit(2)//ç¬¬äºŒé¡µdb.comment.find().skip(2).limit(2)//ç¬¬ä¸‰é¡µdb.comment.find().skip(4).limit(2) æ’åºæŸ¥è¯¢ï¼š sort() æ–¹æ³•å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œsort() æ–¹æ³•å¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®šæ’åºçš„å­—æ®µï¼Œ å¹¶ä½¿ç”¨ 1 å’Œ -1 æ¥æŒ‡å®šæ’åºçš„æ–¹å¼ï¼Œå…¶ä¸­ 1 ä¸ºå‡åºæ’åˆ—ï¼Œè€Œ -1 æ˜¯ç”¨ äºé™åºæ’åˆ—ã€‚ 123db.COLLECTION_NAME.find().sort(&#123;KEY:1&#125;)æˆ–db.é›†åˆåç§°.find().sort(æ’åºæ–¹å¼) å¯¹useridé™åºæ’åˆ—ï¼Œå¹¶å¯¹è®¿é—®é‡è¿›è¡Œå‡åºæ’åˆ— 1db.comment.find().sort(&#123;userid:-1,likenum:1&#125;) skip(), limilt(), sort()ä¸‰ä¸ªæ”¾åœ¨ä¸€èµ·æ‰§è¡Œçš„æ—¶å€™ï¼Œ æ‰§è¡Œçš„é¡ºåºï¼šsort()&#x3D;&gt;skip()&#x3D;&gt;limit()ï¼Œå’Œå‘½ä»¤ç¼–å†™é¡ºåºæ— å…³ 2.7 æ–‡æ¡£çš„æ›´å¤šæŸ¥è¯¢æ­£åˆ™çš„å¤æ‚æ¡ä»¶æŸ¥è¯¢ï¼š æ­£åˆ™è¡¨è¾¾å¼æ˜¯jsçš„è¯­æ³•ï¼Œç›´æ¥é‡çš„å†™æ³•ã€‚ 123db.collection.find(&#123;field:/æ­£åˆ™è¡¨è¾¾å¼/&#125;)æˆ–db.é›†åˆ.find(&#123;å­—æ®µ:/æ­£åˆ™è¡¨è¾¾å¼/&#125;) æŸ¥è¯¢è¯„è®ºå†…å®¹åŒ…å«â€œå¼€æ°´â€çš„æ‰€æœ‰æ–‡æ¡£ 1db.comment.find(&#123;content:/å¼€æ°´/&#125;) æŸ¥è¯¢è¯„è®ºçš„å†…å®¹ä¸­ä»¥â€œä¸“å®¶â€å¼€å¤´çš„ 1db.comment.find(&#123;content:/^ä¸“å®¶/&#125;) æ¯”è¾ƒæŸ¥è¯¢ï¼š 12345db.é›†åˆåç§°.find(&#123; &quot;field&quot; : &#123; $gt: value &#125;&#125;) // å¤§äº: field &gt; valuedb.é›†åˆåç§°.find(&#123; &quot;field&quot; : &#123; $lt: value &#125;&#125;) // å°äº: field &lt; valuedb.é›†åˆåç§°.find(&#123; &quot;field&quot; : &#123; $gte: value &#125;&#125;) // å¤§äºç­‰äº: field &gt;= valuedb.é›†åˆåç§°.find(&#123; &quot;field&quot; : &#123; $lte: value &#125;&#125;) // å°äºç­‰äº: field &lt;= valuedb.é›†åˆåç§°.find(&#123; &quot;field&quot; : &#123; $ne: value &#125;&#125;) // ä¸ç­‰äº: field != valueã€ æŸ¥è¯¢è¯„è®ºç‚¹èµæ•°é‡å¤§äº700çš„è®°å½• 1db.comment.find(&#123;likenum:&#123;$gt:NumberInt(700)&#125;&#125;) åŒ…å«æŸ¥è¯¢ï¼šåŒ…å«ä½¿ç”¨$inæ“ä½œç¬¦ï¼Œä¸åŒ…å«ä½¿ç”¨$ninæ“ä½œç¬¦ æŸ¥è¯¢è¯„è®ºé›†åˆä¸­useridå­—æ®µåŒ…å«1003æˆ–1004çš„æ–‡æ¡£ 1db.comment.find(&#123;userid:&#123;$in:[&quot;1003&quot;,&quot;1004&quot;]&#125;&#125;) æŸ¥è¯¢è¯„è®ºé›†åˆä¸­useridå­—æ®µä¸åŒ…å«1003å’Œ1004çš„æ–‡æ¡£ 1db.comment.find(&#123;userid:&#123;$nin:[&quot;1003&quot;,&quot;1004&quot;]&#125;&#125;) æ¡ä»¶è¿æ¥æŸ¥è¯¢ï¼š æŸ¥è¯¢åŒæ—¶æ»¡è¶³ä¸¤ä¸ªä»¥ä¸Šæ¡ä»¶ï¼Œéœ€è¦ä½¿ç”¨$andæ“ä½œç¬¦å°†æ¡ä»¶è¿›è¡Œå…³è” 1$and:[ &#123; &#125;,&#123; &#125;,&#123; &#125; ] æŸ¥è¯¢è¯„è®ºé›†åˆä¸­likenumå¤§äºç­‰äº700 å¹¶ä¸”å°äº2000çš„æ–‡æ¡£ 1db.comment.find(&#123;$and:[&#123;likenum:&#123;$gte:NumberInt(700)&#125;&#125;,&#123;likenum:&#123;$lt:NumberInt(2000)&#125;&#125;]&#125;) ä¸¤ä¸ªä»¥ä¸Šæ¡ä»¶ä¹‹é—´æ˜¯æˆ–è€…çš„å…³ç³»ï¼Œæˆ‘ä»¬ä½¿ç”¨ $or æ“ä½œç¬¦è¿›è¡Œå…³è” 1$or:[ &#123; &#125;,&#123; &#125;,&#123; &#125; ] æŸ¥è¯¢è¯„è®ºé›†åˆä¸­useridä¸º1003ï¼Œæˆ–è€…ç‚¹èµæ•°å°äº1000çš„æ–‡æ¡£è®°å½• 1db.comment.find(&#123;$or:[ &#123;userid:&quot;1003&quot;&#125; ,&#123;likenum:&#123;$lt:1000&#125; &#125;]&#125;) 2.8 å¸¸ç”¨å‘½ä»¤å°ç»“*1234567891011121314151617181920212223242526272829303132//é€‰æ‹©åˆ‡æ¢æ•°æ®åº“ï¼šuse articledb//æ’å…¥æ•°æ®ï¼šdb.comment.insert(&#123;bsonæ•°æ®&#125;)//æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼šdb.comment.find();//æ¡ä»¶æŸ¥è¯¢æ•°æ®ï¼šdb.comment.find(&#123;æ¡ä»¶&#125;)//æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€æ¡è®°å½•ï¼šdb.comment.findOne(&#123;æ¡ä»¶&#125;)//æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„å‰å‡ æ¡è®°å½•ï¼šdb.comment.find(&#123;æ¡ä»¶&#125;).limit(æ¡æ•°)//æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„è·³è¿‡çš„è®°å½•ï¼šdb.comment.find(&#123;æ¡ä»¶&#125;).skip(æ¡æ•°)//ä¿®æ”¹æ•°æ®ï¼šdb.comment.update(&#123;æ¡ä»¶&#125;,&#123;ä¿®æ”¹åçš„æ•°æ®&#125;) æˆ–db.comment.update(&#123;æ¡ä»¶&#125;,&#123;$set:&#123;è¦ä¿®æ”¹éƒ¨åˆ†çš„å­—æ®µ:æ•°æ®&#125;)//ä¿®æ”¹æ•°æ®å¹¶è‡ªå¢æŸå­—æ®µå€¼ï¼šdb.comment.update(&#123;æ¡ä»¶&#125;,&#123;$inc:&#123;è‡ªå¢çš„å­—æ®µ:æ­¥è¿›å€¼&#125;&#125;)//åˆ é™¤æ•°æ®ï¼šdb.comment.remove(&#123;æ¡ä»¶&#125;)//ç»Ÿè®¡æŸ¥è¯¢ï¼šdb.comment.count(&#123;æ¡ä»¶&#125;)//æ¨¡ç³ŠæŸ¥è¯¢ï¼šdb.comment.find(&#123;å­—æ®µå:/æ­£åˆ™è¡¨è¾¾å¼/&#125;)//æ¡ä»¶æ¯”è¾ƒè¿ç®—ï¼šdb.comment.find(&#123;å­—æ®µå:&#123;$gt:å€¼&#125;&#125;)//åŒ…å«æŸ¥è¯¢ï¼šdb.comment.find(&#123;å­—æ®µå:&#123;$in:[å€¼1ï¼Œå€¼2]&#125;&#125;)æˆ–db.comment.find(&#123;å­—æ®µå:&#123;$nin:[å€¼1ï¼Œå€¼2]&#125;&#125;)//æ¡ä»¶è¿æ¥æŸ¥è¯¢ï¼šdb.comment.find(&#123;$and:[&#123;æ¡ä»¶1&#125;,&#123;æ¡ä»¶2&#125;]&#125;)æˆ–db.comment.find(&#123;$or:[&#123;æ¡ä»¶1&#125;,&#123;æ¡ä»¶2&#125;]&#125;) 3.ç´¢å¼•ç´¢å¼•æ”¯æŒåœ¨MongoDBä¸­é«˜æ•ˆåœ°æ‰§è¡ŒæŸ¥è¯¢ã€‚ å¦‚æœæ²¡æœ‰ç´¢å¼•ï¼ŒMongoDBå¿…é¡»æ‰§è¡Œå…¨é›†åˆæ‰«æï¼Œå³æ‰«æé›†åˆä¸­çš„æ¯ä¸ªæ–‡æ¡£ï¼Œä»¥é€‰æ‹©ä¸æŸ¥è¯¢è¯­å¥åŒ¹é…çš„æ–‡æ¡£ã€‚ è¿™ç§æ‰«æå…¨é›†åˆçš„æŸ¥è¯¢æ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼Œç‰¹åˆ«åœ¨å¤„ç†å¤§é‡çš„æ•°æ®æ—¶ï¼ŒæŸ¥è¯¢å¯ä»¥è¦èŠ±è´¹å‡ åç§’ç”šè‡³å‡ åˆ†é’Ÿï¼Œè¿™å¯¹ç½‘ç«™çš„æ€§èƒ½æ˜¯éå¸¸è‡´å‘½çš„ã€‚ ç´¢å¼•æ˜¯ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œå®ƒä»¥æ˜“äºéå†çš„å½¢å¼å­˜å‚¨é›†åˆæ•°æ®é›†çš„ä¸€å°éƒ¨åˆ†ã€‚ ç´¢å¼•å­˜å‚¨ç‰¹å®šå­—æ®µæˆ–ä¸€ç»„å­—æ®µçš„å€¼ï¼ŒæŒ‰å­—æ®µå€¼æ’åºã€‚ ç´¢å¼•é¡¹çš„æ’åºæ”¯æŒæœ‰æ•ˆçš„ç›¸ç­‰åŒ¹é…å’ŒåŸºäºèŒƒå›´çš„æŸ¥è¯¢æ“ä½œã€‚ æ­¤å¤–ï¼ŒMongoDBè¿˜å¯ä»¥ä½¿ç”¨ç´¢å¼•ä¸­çš„æ’åºè¿”å›æ’åºç»“æœã€‚ MongoDBç´¢å¼•ä½¿ç”¨Bæ ‘æ•°æ®ç»“æ„ï¼ˆç¡®åˆ‡çš„è¯´æ˜¯B-Treeï¼ŒMySQLæ˜¯B+Treeï¼‰ 3.1 ç´¢å¼•çš„ç±»å‹å•å­—æ®µç´¢å¼•ï¼š MongoDBæ”¯æŒåœ¨æ–‡æ¡£çš„å•ä¸ªå­—æ®µä¸Šåˆ›å»ºç”¨æˆ·å®šä¹‰çš„å‡åº&#x2F;é™åºç´¢å¼•ï¼Œç§°ä¸ºå•å­—æ®µç´¢å¼•(Single Field Index) å¯¹äºå•ä¸ªå­—æ®µç´¢å¼•å’Œæ’åºæ“ä½œï¼Œç´¢å¼•é”®çš„æ’åºé¡ºåº(å³å‡åºæˆ–é™åº)å¹¶ä¸é‡è¦ï¼Œå› ä¸ºMongoDBå¯ä»¥åœ¨ä»»ä½•æ–¹å‘ä¸Šéå†ç´¢å¼• å¤åˆç´¢å¼•ï¼š MongoDBè¿˜æ”¯æŒå¤šä¸ªå­—æ®µçš„ç”¨æˆ·å®šä¹‰ç´¢å¼•ï¼Œå³å¤åˆç´¢å¼•(Compound Index) å¤åˆç´¢å¼•ä¸­åˆ—å‡ºçš„å­—æ®µé¡ºåºå…·æœ‰é‡è¦æ„ä¹‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå¤åˆç´¢å¼•ç”± { userid: 1, score: -1 } ç»„æˆï¼Œåˆ™ç´¢å¼•é¦–å…ˆæŒ‰useridæ­£åºæ’åºï¼Œç„¶å åœ¨æ¯ä¸ªuseridçš„å€¼å†…ï¼Œå†åœ¨æŒ‰scoreå€’åºæ’åºã€‚ å…¶ä»–ç´¢å¼•ï¼š åœ°ç†ç©ºé—´ç´¢å¼•(Geospatial Index)ã€æ–‡æœ¬ç´¢å¼•(Text Indexes)ã€å“ˆå¸Œç´¢å¼•(Hashed Indexes)ã€‚ åœ°ç†ç©ºé—´ç´¢å¼•(Geospatial Index)ï¼š ä¸ºäº†æ”¯æŒå¯¹åœ°ç†ç©ºé—´åæ ‡æ•°æ®çš„æœ‰æ•ˆæŸ¥è¯¢ï¼ŒMongoDBæä¾›äº†ä¸¤ç§ç‰¹æ®Šçš„ç´¢å¼•ï¼šè¿”å›ç»“æœæ—¶ä½¿ç”¨å¹³é¢å‡ ä½•çš„äºŒç»´ç´¢å¼•å’Œè¿”å›ç»“æœæ—¶ä½¿ç”¨çƒé¢ å‡ ä½•çš„äºŒç»´çƒé¢ç´¢å¼•ã€‚ æ–‡æœ¬ç´¢å¼•(Text Indexes)ï¼š MongoDBæä¾›äº†ä¸€ç§æ–‡æœ¬ç´¢å¼•ç±»å‹ï¼Œæ”¯æŒåœ¨é›†åˆä¸­æœç´¢å­—ç¬¦ä¸²å†…å®¹ã€‚è¿™äº›æ–‡æœ¬ç´¢å¼•ä¸å­˜å‚¨ç‰¹å®šäºè¯­è¨€çš„åœæ­¢è¯ï¼ˆä¾‹å¦‚â€œtheâ€ã€â€œaâ€ã€â€œorâ€ï¼‰ï¼Œ è€Œå°†é›†åˆä¸­çš„è¯ä½œä¸ºè¯å¹²ï¼Œåªå­˜å‚¨æ ¹è¯ã€‚ å“ˆå¸Œç´¢å¼•(Hashed Indexes)ï¼š ä¸ºäº†æ”¯æŒåŸºäºæ•£åˆ—çš„åˆ†ç‰‡ï¼ŒMongoDBæä¾›äº†æ•£åˆ—ç´¢å¼•ç±»å‹ï¼Œå®ƒå¯¹å­—æ®µå€¼çš„æ•£åˆ—è¿›è¡Œç´¢å¼•ã€‚è¿™äº›ç´¢å¼•åœ¨å…¶èŒƒå›´å†…çš„å€¼åˆ†å¸ƒæ›´åŠ éšæœºï¼Œä½†åªæ”¯ æŒç›¸ç­‰åŒ¹é…ï¼Œä¸æ”¯æŒåŸºäºèŒƒå›´çš„æŸ¥è¯¢ã€‚ 3.2 ç´¢å¼•çš„ç®¡ç†æ“ä½œç´¢å¼•çš„æŸ¥çœ‹ï¼šè¿”å›ä¸€ä¸ªé›†åˆä¸­çš„æ‰€æœ‰ç´¢å¼•çš„æ•°ç»„ 1db.collection.getIndexes() //è¯¥è¯­æ³•å‘½ä»¤è¿è¡Œè¦æ±‚æ˜¯MongoDB 3.0+ ä¾‹ï¼šæŸ¥çœ‹commenté›†åˆä¸­æ‰€æœ‰çš„ç´¢å¼•æƒ…å†µ 1db.comment.getIndexes() ç»“æœï¼š 12345678910[ &#123; &quot;v&quot; : 2, &quot;key&quot; : &#123; &quot;_id&quot; : 1 &#125;, &quot;name&quot; : &quot;_id_&quot;, &quot;ns&quot; : &quot;articledb.comment&quot; &#125;] é»˜è®¤_idç´¢å¼•ï¼š MongoDBåœ¨åˆ›å»ºé›†åˆçš„è¿‡ç¨‹ä¸­ï¼Œåœ¨ _id å­—æ®µä¸Šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•ï¼Œé»˜è®¤åå­—ä¸º _id_ ï¼Œè¯¥ç´¢å¼•å¯é˜²æ­¢å®¢æˆ·ç«¯æ’å…¥ä¸¤ä¸ªå…·æœ‰ç›¸åŒå€¼çš„æ–‡ æ¡£ï¼Œä¸èƒ½åœ¨_idå­—æ®µä¸Šåˆ é™¤æ­¤ç´¢å¼•ã€‚ æ³¨æ„ï¼šè¯¥ç´¢å¼•æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œå› æ­¤å€¼ä¸èƒ½é‡å¤ï¼Œå³ _id å€¼ä¸èƒ½é‡å¤çš„ã€‚åœ¨åˆ†ç‰‡é›†ç¾¤ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ _id ä½œä¸ºç‰‡é”®ã€‚ ç´¢å¼•çš„åˆ›å»ºï¼šåœ¨é›†åˆä¸Šåˆ›å»ºç´¢å¼• 1db.collection.createIndex(keys, options) åœ¨3.0.0ç‰ˆæœ¬å‰åˆ›å»ºç´¢å¼•æ–¹æ³•ä¸ºdb.collection.ensureIndex()ï¼Œä¹‹åçš„ç‰ˆæœ¬ä½¿ç”¨äº† db.collection.createIndex()æ–¹æ³•ï¼ŒensureIndex()è¿˜èƒ½ç”¨ï¼Œä½†åªæ˜¯createIndex()çš„åˆ«å å•å­—æ®µç´¢å¼•ç¤ºä¾‹ï¼šå¯¹ userid å­—æ®µå»ºç«‹ç´¢å¼• 1db.comment.createIndex(&#123;userid:1&#125;) ç»“æœï¼š 123456&#123; &quot;createdCollectionAutomatically&quot; : false, //æŒ‰å‡åºåˆ›å»ºç´¢å¼• &quot;numIndexesBefore&quot; : 1, &quot;numIndexesAfter&quot; : 2, &quot;ok&quot; : 1&#125; æŸ¥çœ‹ç´¢å¼•ï¼š 1db.comment.getIndexes() ç»“æœï¼š 123456789101112131415161718[ &#123; &quot;v&quot; : 2, &quot;key&quot; : &#123; &quot;_id&quot; : 1 &#125;, &quot;name&quot; : &quot;_id_&quot;, &quot;ns&quot; : &quot;articledb.comment&quot; &#125;, &#123; &quot;v&quot; : 2, &quot;key&quot; : &#123; &quot;userid&quot; : 1 &#125;, &quot;name&quot; : &quot;userid_1&quot;, &quot;ns&quot; : &quot;articledb.comment&quot; &#125;] ç´¢å¼•çš„ç§»é™¤ï¼šå¯ä»¥ç§»é™¤æŒ‡å®šçš„ç´¢å¼•ï¼Œæˆ–ç§»é™¤æ‰€æœ‰ç´¢å¼• æŒ‡å®šç´¢å¼•çš„ç§»é™¤ï¼š 1db.collection.dropIndex(index) ä¾‹ï¼šåˆ é™¤ comment é›†åˆä¸­ userid å­—æ®µä¸Šçš„å‡åºç´¢å¼• 1db.comment.dropIndex(&#123;userid:1&#125;) æ‰€æœ‰ç´¢å¼•çš„ç§»é™¤ï¼š 1db.collection.dropIndexes() ä¾‹ï¼šåˆ é™¤é›†åˆä¸­æ‰€æœ‰ç´¢å¼• 1db.comment.dropIndexes() //_idçš„å­—æ®µçš„ç´¢å¼•æ˜¯æ— æ³•åˆ é™¤çš„ï¼Œåªèƒ½åˆ é™¤é_idå­—æ®µçš„ç´¢å¼• ç»“æœï¼š 12345&#123; &quot;nIndexesWas&quot; : 2, &quot;msg&quot; : &quot;non-_id indexes dropped for collection&quot;, &quot;ok&quot; : 1&#125; 3.3 ç´¢å¼•çš„ä½¿ç”¨æ‰§è¡Œè®¡åˆ’ï¼š åˆ†ææŸ¥è¯¢æ€§èƒ½ï¼ˆAnalyze Query Performanceï¼‰é€šå¸¸ä½¿ç”¨æ‰§è¡Œè®¡åˆ’ï¼ˆè§£é‡Šè®¡åˆ’ã€Explain Planï¼‰æ¥æŸ¥çœ‹æŸ¥è¯¢çš„æƒ…å†µï¼Œå¦‚ï¼šæŸ¥è¯¢è€—è´¹çš„æ—¶é—´ã€æ˜¯ å¦åŸºäºç´¢å¼•æŸ¥è¯¢ç­‰ã€‚ å»ºç«‹çš„ç´¢å¼•æ˜¯å¦æœ‰æ•ˆï¼Œæ•ˆæœå¦‚ä½•ï¼Œéƒ½éœ€è¦é€šè¿‡æ‰§è¡Œè®¡åˆ’æŸ¥çœ‹ï¼š 1db.collection.find(query,options).explain(options) ä¾‹ï¼šæŸ¥çœ‹æ ¹æ®useridæŸ¥è¯¢æ•°æ®çš„æƒ…å†µ 1db.comment.find(&#123;userid:&quot;1003&quot;&#125;).explain() ç»“æœï¼š 1234567891011121314151617181920212223242526272829&#123; &quot;queryPlanner&quot; : &#123; &quot;plannerVersion&quot; : 1, &quot;namespace&quot; : &quot;articledb.comment&quot;, &quot;indexFilterSet&quot; : false, &quot;parsedQuery&quot; : &#123; &quot;userid&quot; : &#123; &quot;$eq&quot; : &quot;1003&quot; &#125; &#125;, &quot;winningPlan&quot; : &#123; &quot;stage&quot; : &quot;COLLSCAN&quot;, //è¡¨ç¤ºå…¨é›†åˆæ‰«æ &quot;filter&quot; : &#123; &quot;userid&quot; : &#123; &quot;$eq&quot; : &quot;1003&quot; &#125; &#125;, &quot;direction&quot; : &quot;forward&quot; &#125;, &quot;rejectedPlans&quot; : [ ] &#125;, &quot;serverInfo&quot; : &#123; &quot;host&quot; : &quot;9ef3740277ad&quot;, &quot;port&quot; : 27017, &quot;version&quot; : &quot;4.0.10&quot;, &quot;gitVersion&quot; : &quot;c389e7f69f637f7a1ac3cc9fae843b635f20b766&quot; &#125;, &quot;ok&quot; : 1&#125; ä¾‹ï¼šå¯¹useridå»ºç«‹ç´¢å¼• 1db.comment.createIndex(&#123;userid:1&#125;) ç»“æœï¼š 123456&#123; &quot;createdCollectionAutomatically&quot; : false, &quot;numIndexesBefore&quot; : 1, &quot;numIndexesAfter&quot; : 2, &quot;ok&quot; : 1&#125; å†æ¬¡æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼š 1db.comment.find(&#123;userid:&quot;1013&quot;&#125;).explain() ç»“æœÂ·ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344&#123; &quot;queryPlanner&quot; : &#123; &quot;plannerVersion&quot; : 1, &quot;namespace&quot; : &quot;articledb.comment&quot;, &quot;indexFilterSet&quot; : false, &quot;parsedQuery&quot; : &#123; &quot;userid&quot; : &#123; &quot;$eq&quot; : &quot;1013&quot; &#125; &#125;, &quot;winningPlan&quot; : &#123; &quot;stage&quot; : &quot;FETCH&quot;, &quot;inputStage&quot; : &#123; &quot;stage&quot; : &quot;IXSCAN&quot;, //åŸºäºç´¢å¼•çš„æ‰«æ &quot;keyPattern&quot; : &#123; &quot;userid&quot; : 1 &#125;, &quot;indexName&quot; : &quot;userid_1&quot;, &quot;isMultiKey&quot; : false, &quot;multiKeyPaths&quot; : &#123; &quot;userid&quot; : [ ] &#125;, &quot;isUnique&quot; : false, &quot;isSparse&quot; : false, &quot;isPartial&quot; : false, &quot;indexVersion&quot; : 2, &quot;direction&quot; : &quot;forward&quot;, &quot;indexBounds&quot; : &#123; &quot;userid&quot; : [ &quot;[\\&quot;1013\\&quot;, \\&quot;1013\\&quot;]&quot; ] &#125; &#125; &#125;, &quot;rejectedPlans&quot; : [ ] &#125;, &quot;serverInfo&quot; : &#123; &quot;host&quot; : &quot;9ef3740277ad&quot;, &quot;port&quot; : 27017, &quot;version&quot; : &quot;4.0.10&quot;, &quot;gitVersion&quot; : &quot;c389e7f69f637f7a1ac3cc9fae843b635f20b766&quot; &#125;, &quot;ok&quot; : 1&#125; æ¶µç›–çš„æŸ¥è¯¢ï¼š å½“æŸ¥è¯¢æ¡ä»¶å’ŒæŸ¥è¯¢çš„æŠ•å½±ä»…åŒ…å«ç´¢å¼•å­—æ®µæ—¶ï¼ŒMongoDBç›´æ¥ä»ç´¢å¼•è¿”å›ç»“æœï¼Œè€Œä¸æ‰«æä»»ä½•æ–‡æ¡£æˆ–å°†æ–‡æ¡£å¸¦å…¥å†…å­˜ã€‚ è¿™äº›è¦†ç›–çš„æŸ¥è¯¢å¯ä»¥éå¸¸æœ‰æ•ˆ 1db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:1,_id:0&#125;) ç»“æœï¼š 12&#123; &quot;userid&quot; : &quot;1003&quot; &#125;&#123; &quot;userid&quot; : &quot;1003&quot; &#125; 1db.comment.find(&#123;userid:&quot;1003&quot;&#125;,&#123;userid:1,_id:0&#125;).explain() ç»“æœï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&#123; &quot;queryPlanner&quot; : &#123; &quot;plannerVersion&quot; : 1, &quot;namespace&quot; : &quot;articledb.comment&quot;, &quot;indexFilterSet&quot; : false, &quot;parsedQuery&quot; : &#123; &quot;userid&quot; : &#123; &quot;$eq&quot; : &quot;1003&quot; &#125; &#125;, &quot;winningPlan&quot; : &#123; &quot;stage&quot; : &quot;PROJECTION&quot;, &quot;transformBy&quot; : &#123; &quot;userid&quot; : 1, &quot;_id&quot; : 0 &#125;, &quot;inputStage&quot; : &#123; &quot;stage&quot; : &quot;IXSCAN&quot;, &quot;keyPattern&quot; : &#123; &quot;userid&quot; : 1 &#125;, &quot;indexName&quot; : &quot;userid_1&quot;, &quot;isMultiKey&quot; : false, &quot;multiKeyPaths&quot; : &#123; &quot;userid&quot; : [ ] &#125;, &quot;isUnique&quot; : false, &quot;isSparse&quot; : false, &quot;isPartial&quot; : false, &quot;indexVersion&quot; : 2, &quot;direction&quot; : &quot;forward&quot;, &quot;indexBounds&quot; : &#123; &quot;userid&quot; : [ &quot;[\\&quot;1003\\&quot;, \\&quot;1003\\&quot;]&quot; ] &#125; &#125; &#125;, &quot;rejectedPlans&quot; : [ ] &#125;, &quot;serverInfo&quot; : &#123; &quot;host&quot; : &quot;bobohost.localdomain&quot;, &quot;port&quot; : 27017, &quot;version&quot; : &quot;4.0.10&quot;, &quot;gitVersion&quot; : &quot;c389e7f69f637f7a1ac3cc9fae843b635f20b766&quot; &#125;, &quot;ok&quot; : 1&#125; 4.æ–‡ç« è¯„è®º4.1 æ¡ˆä¾‹åˆ†ææ¡ˆä¾‹ï¼šå®ç°æŸå¤´æ¡çš„æ–‡ç« è¯„è®º éœ€è¦å®ç°ä¸€ä¸‹åŠŸèƒ½ï¼š åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥API æ ¹æ®æ–‡ç« idæŸ¥è¯¢è¯„è®º è¯„è®ºç‚¹èµ æ•°æ®åº“ï¼šarticledb ä¸“æ æ–‡ç« è¯„è®º(è¡¨)ï¼šcomment å­—æ®µåç§° å­—æ®µå«ä¹‰ å­—æ®µç±»å‹ å¤‡æ³¨ _id ID ObjectIdæˆ–String Mongoçš„ä¸»é”®çš„å­—æ®µ articleid æ–‡ç« ID String content è¯„è®ºå†…å®¹ String userid è¯„è®ºäººID String nickname è¯„è®ºäººæ˜µç§° String createdatetime è¯„è®ºçš„æ—¥æœŸæ—¶é—´ Date likenum ç‚¹èµæ•° Int32 replynum å›å¤æ•° Int32 state çŠ¶æ€ String 0ï¼šä¸å¯è§1ï¼šå¯è§ parentid ä¸Šçº§ID String å¦‚æœä¸º0è¡¨ç¤ºæ–‡ç« çš„é¡¶çº§è¯„è®º æŠ€æœ¯é€‰å‹ï¼š mongodb-driver(äº†è§£) mongodb-driveræ˜¯mongoå®˜æ–¹æ¨å‡ºçš„javaè¿æ¥mongoDBçš„é©±åŠ¨åŒ…ï¼Œç›¸å½“äºJDBCé©±åŠ¨ SpringDataMongoDB SpringDataå®¶æ—æˆå‘˜ä¹‹ä¸€ï¼Œç”¨äºæ“ä½œMongoDBçš„æŒä¹…å±‚æ¡†æ¶ï¼Œå°è£…äº†åº•å±‚çš„mongodb-driverã€‚ é¡¹ç›®ç»“æ„ï¼š 4.2 æ–‡ç« å¾®æœåŠ¡æ¨¡å—æ­å»ºå¯¼å…¥åæ ‡ï¼š 1234567891011121314151617181920212223242526&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;aliyun-rds-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt; &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åœ¨application.ymlä¸­ï¼š 123456789spring: #æ•°æ®æºé…ç½® data: mongodb: host: 127.0.0.1 #é»˜è®¤ä¸»æœºåœ°å€ database: articledb port: 27017 #é»˜è®¤ç«¯å£27017 #ä¹Ÿå¯ä»¥ä½¿ç”¨uriè¿æ¥ #uri: mongodb://localhost:27017/articledb 4.3 æ–‡ç« è¯„è®ºåŸºæœ¬çš„CRUDCommentå®ä½“ç±»ä¸­ï¼š 1234567891011121314151617181920212223242526/*æŠŠä¸€ä¸ªjavaç±»å£°æ˜ä¸ºmongodbçš„æ–‡æ¡£ï¼Œå¯ä»¥é€šè¿‡collectionå‚æ•°æŒ‡å®šè¿™ä¸ªç±»å¯¹åº”çš„æ–‡æ¡£ã€‚@Document(collection=&quot;mongodb å¯¹åº” collection å&quot;) è‹¥æœªåŠ  @Document ï¼Œè¯¥ bean save åˆ° mongo çš„ comment collection è‹¥æ·»åŠ  @Document ï¼Œåˆ™ save åˆ° comment collectionå¤åˆç´¢å¼•@CompoundIndex( def = &quot;&#123;&#x27;userid&#x27;: 1, &#x27;nickname&#x27;: -1&#125;&quot;) */@Document(collection=&quot;comment&quot;)//å¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ç±»åå°å†™æ˜ å°„é›†åˆ@Datapublic class Comment &#123; @Id //ä¸»é”®æ ‡è¯†ï¼Œè¯¥å±æ€§çš„å€¼ä¼šè‡ªåŠ¨å¯¹åº”mongodbçš„ä¸»é”®å­—æ®µ&quot;_id&quot;ï¼Œå¦‚æœè¯¥å±æ€§åå°±å«â€œidâ€,åˆ™è¯¥æ³¨è§£å¯ä»¥çœç•¥ï¼Œå¦åˆ™å¿…é¡»å†™ private String id;//ä¸»é”® @Field(&quot;content&quot;) //è¯¥å±æ€§å¯¹åº”mongodbçš„å­—æ®µçš„åå­—ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™æ— éœ€è¯¥æ³¨è§£ private String content;//åæ§½å†…å®¹ private Date publishtime;//å‘å¸ƒæ—¥æœŸ @Indexed //æ·»åŠ äº†ä¸€ä¸ªå•å­—æ®µçš„ç´¢å¼• private String userid;//å‘å¸ƒäººID private String nickname;//æ˜µç§° private LocalDateTime createdatetime;//è¯„è®ºçš„æ—¥æœŸæ—¶é—´ private Integer likenum;//ç‚¹èµæ•° private Integer replynum;//å›å¤æ•° private String state;//çŠ¶æ€ private String parentid;//ä¸Šçº§ID private String articleid;&#125; CommentRepositoryä¸­ï¼š 123public interface CommentRepository extends MongoRepository&lt;Comment,String&gt; &#123; Page&lt;Comment&gt; findByParentid(String parentid, Pageable pageable);&#125; CommentServiceä¸­ï¼š 1234567891011121314public interface CommentService &#123; //ä¿å­˜ä¸€ä¸ªè¯„è®º void saveComment(Comment comment); //æ›´æ–°è¯„è®º void updateComment(Comment comment); //æ ¹æ®idåˆ é™¤è¯„è®º void deleteCommentById(String id); //æŸ¥è¯¢æ‰€æœ‰è¯„è®º List&lt;Comment&gt; findCommentList(); //æ ¹æ®idæŸ¥è¯¢è¯„è®º Comment findCommentById(String id); //æ ¹æ®çˆ¶idï¼ŒæŸ¥è¯¢å­è¯„è®ºçš„åˆ†é¡µåˆ—è¡¨ Page&lt;Comment&gt; findCommentListPageByParentid(String parentid, int page, int size);&#125; CommentServiceImplä¸­ï¼š 1234567891011121314151617181920212223242526272829303132333435@Servicepublic class CommentServiceImpl implements CommentService &#123; @Autowired private CommentRepository commentRepository; @Override public void saveComment(Comment comment) &#123; commentRepository.save(comment); &#125; @Override public void updateComment(Comment comment) &#123; commentRepository.save(comment); &#125; @Override public void deleteCommentById(String id) &#123; commentRepository.deleteById(id); &#125; @Override public List&lt;Comment&gt; findCommentList() &#123; return commentRepository.findAll(); &#125; @Override public Comment findCommentById(String id) &#123; return commentRepository.findById(id).get(); &#125; @Override public Page&lt;Comment&gt; findCommentListPageByParentid(String parentid, int page, int size) &#123; return commentRepository.findByParentid(parentid, PageRequest.of(page-1,size)); &#125;&#125; æµ‹è¯•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@SpringBootTestpublic class CommentServiceTest &#123; @Autowired private CommentService commentService; @Test void testSave() &#123; Comment comment=new Comment(); comment.setArticleid(&quot;100001&quot;); comment.setContent(&quot;ä¸è¦åƒæˆ‘&quot;); comment.setCreatedatetime(LocalDateTime.now()); comment.setUserid(&quot;1004&quot;); comment.setNickname(&quot;Jerry&quot;); comment.setState(&quot;1&quot;); comment.setParentid(&quot;62ddfe4c2f8d0c6ca75ba67f&quot;); //çˆ¶è¯„è®ºid comment.setLikenum(0); comment.setReplynum(0); commentService.saveComment(comment); commentService.saveComment(comment); &#125; @Test void testFindById() &#123;//idæŸ¥æ‰¾ System.out.println(commentService.findCommentById(&quot;62ddfe4c2f8d0c6ca75ba67f&quot;)); &#125; @Test void testDeleteById() &#123;//åˆ é™¤ commentService.deleteCommentById(&quot;666&quot;); &#125; @Test void testFindAll() &#123;//æŸ¥æ‰¾æ‰€æœ‰ System.out.println(commentService.findCommentList()); &#125; @Test void testUpdate() &#123; //æ›´æ–° Comment comment = commentService.findCommentById(&quot;62ddfe4c2f8d0c6ca75ba67f&quot;); comment.setLikenum(666); commentService.updateComment(comment); &#125; @Test void testFindCommentListByParentid() &#123; //åˆ†é¡µæŸ¥æ‰¾ Page&lt;Comment&gt; commentPage = commentService.findCommentListPageByParentid(&quot;62ddfe4c2f8d0c6ca75ba67f&quot;, 1, 2); System.out.println(&quot;----æ€»è®°å½•æ•°ï¼š&quot;+commentPage.getTotalElements()); System.out.println(&quot;----å½“å‰é¡µæ•°æ®ï¼š&quot;+commentPage.getContent()); &#125;&#125; 4.4 MongoTemplateå®ç°è¯„è®ºç‚¹èµä»¥ä¸‹ä¸ºç‚¹èµçš„ä¸´æ—¶ç¤ºä¾‹ä»£ç ï¼š CommentService æ–°å¢updateThumbupæ–¹æ³• 12345public void updateCommentThumbupToIncrementingOld(String id)&#123; Comment comment = CommentRepository.findById(id).get(); comment.setLikenum(comment.getLikenum()+1); CommentRepository.save(comment);&#125; ä»¥ä¸Šæ–¹æ³•è™½ç„¶å®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯æ‰§è¡Œæ•ˆç‡å¹¶ä¸é«˜ æˆ‘åªéœ€è¦å°†ç‚¹èµæ•°åŠ 1å°±å¯ä»¥äº†ï¼Œæ²¡å¿…è¦æŸ¥è¯¢å‡ºæ‰€æœ‰å­—æ®µä¿®æ”¹åå†æ›´æ–°æ‰€æœ‰å­—æ®µã€‚ å¯ä»¥ä½¿ç”¨MongoTemplateç±»æ¥å®ç°å¯¹æŸåˆ—çš„æ“ä½œã€‚ åœ¨CommentServiceå£°æ˜ä¸€ä¸ªupdateCommentLikenumæ–¹æ³•ï¼š 1234public interface CommentService &#123; //ç‚¹èµæ•°+1 void updateCommentLikenum(String id);&#125; CommentServiceImplä¸­å®ç°updateCommentLikenumæ–¹æ³•ï¼š 123456789101112131415@Autowiredprivate MongoTemplate mongoTemplate;public void updateCommentLikenum(String id)&#123; //æŸ¥è¯¢å¯¹è±¡ Query query = Query.query(Criteria.where(&quot;_id&quot;).is(id)); //æ›´æ–°å¯¹è±¡ Update update =new Update(); //å±€éƒ¨æ›´æ–°ï¼Œç›¸å½“äº$set update.set(key,value) //é€’å¢$inc update.inc(&quot;likenum&quot;,1) é»˜è®¤å¢åŠ 1 update.inc(&quot;likenum&quot;); //å‚æ•°1ï¼šæŸ¥è¯¢å¯¹è±¡ å‚æ•°2ï¼šæ›´æ–°å¯¹è±¡ å‚æ•°3ï¼šé›†åˆçš„åå­—æˆ–å®ä½“ç±»çš„ç±»å‹Comment.class mongoTemplate.updateFirst(query,update,&quot;comment&quot;);&#125; æµ‹è¯•ï¼š 1234@Testvoid testUpdateLikenum() &#123; //ç‚¹èµåŠ 1 commentService.updateCommentLikenum(&quot;62ddfe4c2f8d0c6ca75ba67f&quot;);&#125;","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"}]},{"title":"","slug":"Java/ELKæœç´¢","date":"2022-08-06T11:11:16.298Z","updated":"2022-09-21T13:33:04.504Z","comments":true,"path":"2022/08/06/Java/ELKæœç´¢/","link":"","permalink":"http://example.com/2022/08/06/Java/ELK%E6%90%9C%E7%B4%A2/","excerpt":"","text":"1.ELKç®€ä»‹ELKæ˜¯åŒ…å«ä½†ä¸é™äºElasticsearch(ç®€ç§°ES)ã€Logstashã€Kibanaä¸‰ä¸ªå¼€æºè½¯ä»¶çš„ç»„æˆçš„ä¸€ä¸ªæ•´ä½“ï¼Œè¿™ä¸‰ä¸ªè½¯ä»¶åˆæˆELKã€‚ æœ¬è¯¾ç¨‹ä»åˆ†åˆ«å¯¹ä¸‰ä¸ªç»„ä»¶ç»è¡Œè¯¦ç»†ä»‹ç»ï¼š Elasticsearchï¼šå› ä¸ºå®ƒæ˜¯elkçš„æ ¸å¿ƒã€‚æœ¬è¯¾ç¨‹ä»esåº•å±‚å¯¹æ–‡æ¡£ã€ç´¢å¼•ã€ æœç´¢ã€èšåˆã€é›†ç¾¤ç»è¡Œä»‹ç»ï¼Œä»æœç´¢å’Œèšåˆåˆ†æå®ä¾‹æ¥å±•ç°esçš„é­…åŠ›ã€‚ Logstashï¼šä»å†…éƒ¨å¦‚ä½•é‡‡é›†æ•°æ®åˆ°æŒ‡å®šåœ°æ–¹æ¥å±•ç°å®ƒæ•°æ®é‡‡é›†çš„åŠŸèƒ½ã€‚ Kibanaï¼šä»æ•°æ®ç»˜å›¾å±•ç°æ•°æ®å¯è§†åŒ–çš„åŠŸèƒ½ã€‚ 2.Elastic Stackæ¦‚å¿µéšç€ELKçš„å‘å±•ï¼Œåˆæœ‰æ–°æˆå‘˜Beatsã€elastic cloudçš„åŠ å…¥ï¼Œæ‰€ä»¥å°±å½¢æˆäº†Elastic Stackã€‚ æ‰€ä»¥è¯´ï¼ŒELKæ˜¯æ—§çš„ç§°å‘¼ï¼ŒElastic Stackæ˜¯æ–°çš„åå­— 2.1 Elastic Stackç‰¹è‰² å¤„ç†æ–¹å¼çµæ´»ï¼šElasticsearchæ˜¯ç›®å‰æœ€æµè¡Œçš„å‡†å®æ—¶å…¨æ–‡æ£€ç´¢å¼•æ“ï¼Œå…·æœ‰é«˜é€Ÿæ£€ç´¢å¤§æ•°æ®çš„èƒ½åŠ› é…ç½®ç®€å•ï¼šå®‰è£…ELKçš„æ¯ä¸ªç»„ä»¶ï¼Œä»…éœ€é…ç½®æ¯ä¸ªç»„ä»¶çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯ï¼Œä¿®æ”¹å¤„ä¸å¤šï¼Œå› ä¸ºå¤§é‡å‚æ•°å·²ç»é»˜è®¤é…åœ¨ç³»ç»Ÿä¸­ï¼Œä¿®æ”¹æƒ³è¦ä¿®æ”¹çš„é€‰é¡¹å³å¯ æ¥å£ç®€å•ï¼šé‡‡ç”¨jsonå½¢å¼RESTFUL APlæ¥å—æ•°æ®å¹¶å“åº”ï¼Œæ— å…³è¯­è¨€ æ€§èƒ½é«˜æ•ˆï¼šElasticsearchåŸºäºä¼˜ç§€çš„å…¨æ–‡æœç´¢æŠ€æœ¯Luceneï¼Œé‡‡ç”¨å€’æ’ç´¢å¼•ï¼Œå¯ä»¥è½»æ˜“åœ°åœ¨ç™¾äº¿çº§åˆ«æ•°æ®ä¸‹ï¼Œæœç´¢å‡ºæƒ³è¦çš„å†…å®¹ï¼Œå¹¶ä¸”æ˜¯ç§’çº§å“åº” çµæ´»æ‰©å±•ï¼šElasticsearchå’ŒLogstashéƒ½å¯ä»¥æ ¹æ®é›†ç¾¤è§„æ¨¡çº¿æ€§æ‹“å±•ï¼ŒElasticsearchå†…éƒ¨è‡ªåŠ¨å®ç°é›†ç¾¤åä½œ æ•°æ®å±•ç°åä¸½ï¼šKibanaä½œä¸ºå‰ç«¯å±•ç°å·¥å…·ï¼Œå›¾è¡¨åä¸½ï¼Œé…ç½®ç®€å• 2.2 Elastic Stackç»„ä»¶ Elasticsearchï¼š Elasticsearch æ˜¯ä½¿ç”¨javaå¼€å‘ï¼ŒåŸºäºLuceneåˆ†å¸ƒå¼ã€é€šè¿‡Restfulæ–¹å¼è¿›è¡Œäº¤äº’çš„è¿‘å®æ—¶æœæ³°å¹³å°æ¡†æ¶ã€‚å®ƒçš„ç‰¹ç‚¹æœ‰ï¼šåˆ†å¸ƒå¼ï¼Œé›¶é…ç½®ï¼Œè‡ªåŠ¨å‘ç°ï¼Œç´¢å¼•è‡ªåŠ¨åˆ†ç‰‡ï¼Œç´¢å¼•å‰¯æœ¬æœºåˆ¶ï¼Œrestfulé£æ ¼æ¥å£ï¼Œå¤šæ•°æ®æºï¼Œè‡ªåŠ¨æœç´¢è´Ÿè½½ç­‰ã€‚ Logstashï¼š Logstash åŸºäºjavaå¼€å‘ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®æŠ½å–è½¬åŒ–å·¥å…·ã€‚ä¸€èˆ¬å·¥ä½œæ–¹å¼ä¸ºC&#x2F;Sæ¶æ„ï¼Œclientç«¯å®‰è£…åœ¨éœ€è¦æ”¶é›†ä¿¡æ¯çš„ä¸»æœºä¸Šï¼Œserverç«¯è´Ÿè´£å°†æ”¶åˆ°çš„å„èŠ‚ç‚¹æ—¥å¿—è¿›è¡Œè¿‡æ»¤ã€ ä¿®æ”¹ç­‰æ“ä½œåœ¨ä¸€å¹¶å‘å¾€Elasticsearchæˆ–å…¶ä»–ç»„ä»¶å»ã€‚ Kibanaï¼š Kibana åŸºäºnodejsï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¼€æºå’Œå…è´¹çš„å¯è§†åŒ–å·¥å…·ï¼ŒKibanaå¯ä»¥ä¸ºLogstashå’ŒElasticsearch æä¾›çš„æ—¥å¿—åˆ†æå‹å¥½çš„webç•Œé¢ï¼Œå¯ä»¥æ±‡æ€»ã€åˆ†æå’Œæœç´¢é‡è¦æ•°æ®æ—¥å¿—ã€‚ Beatsï¼š Beatså¹³å°é›†åˆäº†å¤šç§å•ä¸€ç”¨é€”æ•°æ®é‡‡é›†å™¨ã€‚å®ƒä»¬ä»æˆç™¾ä¸Šåƒæˆ–æˆåƒä¸Šä¸‡å°æœºå™¨å’Œç³»ç»Ÿå‘Logstashæˆ–Elasticsearchå‘é€æ•°æ®ã€‚ Beatsç”±å¦‚ä¸‹ç»„æˆï¼š Packetbeatï¼š è½»é‡å‹ç½‘ç»œæ•°æ®é‡‡é›†å™¨ï¼Œç”¨äºæ·±æŒ–ç½‘çº¿ä¸Šä¼ è¾“çš„æ•°æ®ï¼Œäº†è§£åº”ç”¨ç¨‹åºåŠ¨æ€ã€‚Packetbeat æ˜¯ä¸€æ¬¾è½»é‡å‹ç½‘ç»œæ•°æ®åŒ…åˆ†æå™¨ï¼Œèƒ½å¤Ÿå¤šå°†æ•°æ®å‘é€è‡³Logstash æˆ– Elasticsearchã€‚å…¶æ”¯æŒICMP (V4 and v6)ã€DNSã€HTTPã€MySQLã€PostgreSQLã€Redisã€MongoDBã€Memcacheç­‰åè®®ã€‚ Filebeatï¼š è½»é‡å‹æ—¥å¿—é‡‡é›†å™¨ï¼Œ å½“æ‚¨è¦é¢å¯¹æˆç™¾ä¸Šåƒå…¶è‡³æˆåƒä¸Šä¸‡çš„çš„æœåŠ¡å™¨ã€è™šæ‹Ÿæœºå’Œå®¹å™¨ç”Ÿæˆçš„å¿—æ—¶ï¼Œè¯·å‘Šåˆ« SSH å§ã€‚Filebeat å°†ä¸ºæ‚¨æä¾›ä¸€ç§è½»é‡å‹æ–¹æ³•ï¼Œç”¨äºè½¬å‘å’Œæ±‡æ€»æ—¥å¿—ä¸æ–‡ä»¶ï¼Œè®©ç®€å•çš„äº‹æƒ…ä¸å†ç¹æ‚ã€‚ Metricbeatï¼š è½»é‡å‹æŒ‡æ ‡é‡‡é›†å™¨ã€‚Metricbeat èƒ½å¤Ÿå¤šä»¥ä¸€ç§è½»é‡å‹çš„æ–¹å¼è¾“é€å„ç§ç³»ç»Ÿå’ŒæœåŠ¡ç»Ÿè®¡æ•°æ®ï¼Œä»CPUåˆ°å†…å­˜ï¼Œä» Redis åˆ°Nginxï¼Œä¸ä¸€è€Œè¶³ã€‚å¯å®šæœŸè·å–å¤–éƒ¨ç³»ç»Ÿçš„ç›‘æ§æŒ‡æ ‡ä¿¡æ¯ï¼Œå…¶å¯ä»¥ç›‘æ§ã€æ”¶é›† Apacheã€httpã€HAProxyã€MongoDBã€MySQLã€Nginxã€PostgreSQLã€Redisã€Systemã€Zookeeperç­‰æœåŠ¡ã€‚ Winlogbeatï¼š è½»é‡å‹ Windows äº‹ä»¶æ—¥å¿—é‡‡é›†å™¨ã€‚ç”¨äºå¯†åˆ‡ç›‘æ§åŸºäºWindows çš„åŸºç¡€è®¾æ–½ä¸Šå‘ç”Ÿçš„äº‹ä»¶ã€‚Winlogbeat èƒ½å¤Ÿå¤šä»¥ä¸€ç§è½»é‡å‹çš„æ–¹å¼ï¼Œå°†Windows äº‹ä»¶æ—¥å¿—å®æ—¶åœ°æµå¼ä¼ è¾“è‡³ Elasticsearch å’Œ Logstashã€‚ Auditbeatï¼š è½»é‡å‹ç”³è®¡æ—¥å¿—é‡‡é›†å™¨ã€‚æ”¶é›†æ‚¨ Linux å®¡è®¡æ¡†æ¶çš„æ•°æ®ï¼Œç›‘æ§æ–‡ä»¶å®Œæ•´æ€§ã€‚Auditbeat å®æ—¶é‡‡é›†è¿™äº›äº‹ä»¶ï¼Œç„¶åå‘é€åˆ° Elastic Stack å…¶ä»–éƒ¨åˆ†åšè¿›ä¸€æ­¥åˆ†æã€‚ Heartbeatï¼š é¢å‘è¿è¡ŒçŠ¶æ€ç›‘æµ‹çš„è½»é‡å‹é‡‡é›†å™¨ã€‚é€šè¿‡ä¸»åŠ¨æ¢æµ‹æ¥ç›‘æµ‹æœåŠ¡çš„å¯ç”¨æ€§ã€‚é€šè¿‡ç»™å®š URLåˆ—è¡¨ï¼ŒHeartbeat ä»…ä»…è¯¢é—®ï¼šç½‘ç«™è¿è¡Œæ­£å¸¸å—ï¼ŸHeartbeat ä¼šå°†æ­¤ä¿¡æ¯å’Œå“åº”æ—¶é—´å‘é€è‡³ Elastic çš„å…¶ä»–éƒ¨åˆ†ï¼Œä»¥è¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚ Elastic cloudï¼š åŸºäº Elasticsearch çš„è½¯ä»¶å³æœåŠ¡(SaaS)è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡ Elastic çš„å®˜æ–¹åˆä½œä¼™ä¼´ä½¿ç”¨æ‰˜ç®¡çš„ Elasticsearch æœåŠ¡ã€‚ 3.Elasticsearchæ¦‚å¿µ3.1 æœç´¢æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼šç”¨æˆ·è¾“å…¥æƒ³è¦çš„å…³é”®è¯ï¼Œè¿”å›å«æœ‰è¯¥å…³é”®è¯çš„æ‰€æœ‰ä¿¡æ¯ åœºæ™¯ï¼š äº’è”ç½‘æœç´¢ï¼šè°·æ­Œã€ç™¾åº¦ ç«™å†…æœç´¢(å‚ç›´æœç´¢)ï¼šæœç´¢å•†å“(æ·˜å®ã€äº¬ä¸œ) 3.2 æ•°æ®åº“æœç´¢ç«™å†…æœç´¢(å‚ç›´æœç´¢)ï¼š æ•°æ®é‡å°ã€ç®€å•æœç´¢ï¼Œå¯ä»¥ä½¿ç”¨æ•°æ®åº“ å­˜åœ¨é—®é¢˜ï¼š å­˜å‚¨é—®é¢˜ã€‚ç”µå•†ç½‘ç«™å•†å“ä¸Šäº¿æ¡æ—¶ï¼Œæ¶‰åŠåˆ°å•è¡¨æ•°æ®è¿‡å¤§å¿…é¡»æ‹†åˆ†è¡¨ï¼Œæ•°æ®ç£ç›˜å ç”¨è¿‡å¤§å¿…é¡»åˆ†åº“(mycat)ã€‚ æ€§èƒ½é—®é¢˜ï¼šè§£å†³ä¸Šé¢é—®é¢˜åï¼ŒæŸ¥è¯¢â€ç¬”è®°æœ¬ç”µè„‘â€ç­‰å…³é”®è¯æ—¶ï¼Œä¸Šäº¿æ¡æ•°æ®çš„å•†å“åå­—æ®µé€è¡Œæ‰«æï¼Œæ€§èƒ½è·Ÿä¸ä¸Šã€‚ ä¸èƒ½åˆ†è¯ï¼šå¦‚æœç´¢&quot;ç¬”è®°æœ¬ç”µè„‘&quot;ï¼Œåªèƒ½æœç´¢å®Œå…¨å’Œå…³é”®è¯ä¸€æ ·çš„æ•°æ®ï¼Œé‚£ä¹ˆæ•°æ®é‡å°æ—¶ï¼Œå¦‚æœæœç´¢&quot;ç¬”è®°ç”µè„‘&quot;ï¼Œ&quot;ç”µè„‘&quot;æ•°æ®è¦ä¸è¦ç»™ç”¨æˆ·ã€‚ äº’è”ç½‘æœç´¢ï¼šæ•°æ®é‡è¿‡å¤§(PBçº§)ï¼Œä¸ä¼šä½¿ç”¨æ•°æ®åº“ã€‚ 3.3 å…¨æ–‡æ£€ç´¢å€’æ’ç´¢å¼•ï¼š æ•°æ®å­˜å‚¨æ—¶ ï¼Œç»è¡Œåˆ†è¯å»ºç«‹termç´¢å¼•åº“ã€‚ å€’æ’ç´¢å¼•ï¼šæºäºå®é™…åº”ç”¨ä¸­éœ€è¦æ ¹æ®å±æ€§çš„å€¼æ¥æŸ¥æ‰¾è®°å½•ã€‚è¿™ç§ç´¢å¼•è¡¨ä¸­çš„æ¯é¡¹éƒ½åŒ…æ‹¬ä¸€ä¸ªå±æ€§å€¼å’Œå…·æœ‰è¯¥å±æ€§å€¼çš„å„è®°å½•çš„åœ°å€ã€‚ç”±äºä¸æ˜¯ç”±è®°å½•æ¥ç¡®å®šå±æ€§å€¼ï¼Œè€Œæ˜¯ç”±å±æ€§å€¼æ¥ç¡®å®šè®°å½•çš„ä½ç½®ï¼Œå› è€Œç§°ä¸ºå€’æ’ç´¢å¼•(inverted index)ã€‚å¸¦æœ‰å€’æ’ç´¢å¼•çš„æ–‡ä»¶æˆ‘ä»¬ç§°ä¸ºå€’æ’ç´¢å¼•æ–‡ä»»ï¼Œç®€ç§°å€’æ’æ–‡ä»»(inverted file)ã€‚ Luceneï¼š å°±æ˜¯ä¸€ä¸ªjaråŒ…ï¼Œé‡Œé¢å°è£…äº†å…¨æ–‡æ£€ç´¢çš„å¼•æ“ã€æœç´¢çš„ç®—æ³•ä»£ç ã€‚ å¼€å‘æ—¶ï¼Œå¼•å…¥Luceneçš„jaråŒ…ï¼Œé€šè¿‡apiå¼€å‘æœç´¢ç›¸å…³ä¸šåŠ¡ã€‚åº•å±‚ä¼šåœ¨ç£ç›˜å»ºç«‹ç´¢å¼•åº“ã€‚ 3.4 åˆè¯†ElasticsearchElasticsearchæ˜¯ä¸€ä¸ªåŸºäºLunceneçš„æœç´¢æœåŠ¡å™¨ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€RESTful é£æ ¼çš„æœç´¢å’Œæ•°æ®åˆ†æå¼•æ“ åŠŸèƒ½ä»‹ç»ï¼š åˆ†å¸ƒå¼çš„æœç´¢å¼•æ“å’Œæ•°æ®åˆ†æå¼•æ“ æœç´¢ï¼šäº’è”ç½‘æœç´¢ã€ç”µå•†ç½‘ç«™ç«™å†…æœç´¢ã€OAç³»ç»ŸæŸ¥è¯¢ æ•°æ®åˆ†æï¼šç”µå•†ç½‘ç«™æŸ¥è¯¢è¿‘â€”å‘¨å“ªäº›å“ç±»çš„å›¾ä¹¦é”€å”®å‰åï¼Œæ–°å›½ç½‘ç«™ï¼Œæœ€è¿‘3å¤©é˜…è¯»é‡æœ€é«˜çš„åä¸ªå…³é”®è¯ï¼Œèˆ†æƒ…åˆ†æ å…¨æ–‡æ£€ç´¢ï¼Œç»“æ„åŒ–æ£€ç´¢ï¼Œæ•°æ®åˆ†æ å…¨æ–‡æ£€ç´¢ï¼š æœç´¢å•†å“åç§°åŒ…å«javaçš„å›¾ä¹¦ select * from books where book_name like &quot;%java%&quot; ç»“æ„åŒ–æ£€ç´¢ï¼š æœç´¢å•†å“åˆ†ç±»ä¸ºspringçš„å›¾ä¹¦éƒ½æœ‰å“ªäº› select * from books where category _id=&#39;spring&#39; æ•°æ®åˆ†æï¼š åˆ†ææ¯ä¸€ä¸ªåˆ†ç±»ä¸‹æœ‰å¤šå°‘ç§å›¾ä¹¦ select category _id,count(*) from books group by category_id å¯¹æµ·é‡æ•°æ®è¿›è¡Œè¿‘å®æ—¶çš„å¤„ç† åˆ†å¸ƒå¼ï¼šESè‡ªåŠ¨å¯ä»¥å°†æµ·é‡æ•°æ®åˆ†æ•£åˆ°å¤šå°æœåŠ¡å™¨ä¸Šå»å­˜å‚¨å’Œæ£€ç´¢,ç»è¡Œå¹¶è¡ŒæŸ¥è¯¢ï¼Œæé«˜æœç´¢æ•ˆç‡ã€‚ç›¸å¯¹çš„ï¼ŒLuceneæ˜¯å•æœºåº”ç”¨ã€‚ è¿‘å®æ—¶ï¼šæ•°æ®åº“ä¸Šäº¿æ¡æ•°æ®æŸ¥è¯¢ï¼Œæœç´¢ä¸€æ¬¡è€—æ—¶å‡ ä¸ªå°æ—¶ï¼Œæ˜¯æ‰¹å¤„ç†(batch-processingï¼‰ã€‚è€ŒESåªéœ€ç§’çº§å³å¯æŸ¥è¯¢æµ·é‡æ•°æ®ï¼Œæ‰€ä»¥å«è¿‘å®æ—¶ï¼Œç§’çº§ã€‚ ä½¿ç”¨åœºæ™¯ï¼š ç»´åŸºç™¾ç§‘ï¼šå…¨æ–‡æœç´¢ã€é«˜äº®ã€æœç´¢æ¨è GitHubï¼šæœç´¢ä¸Šåƒè¡Œä»£ç  ç”µå•†ç½‘ç«™ï¼šæ£€ç´¢å•†å“ã€æœç´¢æ¨è æ—¥å¿—æ•°æ®åˆ†æï¼šLogstashé‡‡é›†æ—¥å¿—ï¼ŒESè¿›è¡Œå¤æ‚çš„æ•°æ®åˆ†æï¼ŒKibanaæ•°æ®å¯è§†åŒ– ç™¾åº¦æœç´¢ï¼šç¬¬ä¸€æ¬¡æŸ¥è¯¢ä½¿ç”¨es OAã€ERPç³»ç»Ÿç«™å†…æœç´¢ ç‰¹ç‚¹ï¼š å¯æ‹“å±•æ€§é«˜ï¼š å¤§å‹åˆ†å¸ƒå¼é›†ç¾¤ï¼ˆæ•°ç™¾å°æœåŠ¡å™¨ï¼‰æŠ€æœ¯ï¼Œå¤„ç†PBçº§æ•°æ®ï¼Œå¤§å…¬å¸å¯ä»¥ä½¿ç”¨ã€‚å°å…¬å¸æ•°æ®é‡å°ï¼Œä¹Ÿå¯ä»¥éƒ¨ç½²åœ¨å•æœºã€‚å¤§æ•°æ®é¢†åŸŸä½¿ç”¨å¹¿æ³›ã€‚ æŠ€æœ¯æ•´åˆï¼š å°†å…¨æ–‡æ£€ç´¢ã€æ•°æ®åˆ†æã€åˆ†å¸ƒå¼ç›¸å…³æŠ€æœ¯æ•´åˆåœ¨ä¸€èµ·lucene(å…¨æ–‡æ£€ç´¢)ã€å•†ç”¨çš„æ•°æ®åˆ†æè½¯ä»¶(BIè½¯ä»¶)ã€åˆ†å¸ƒå¼æ•°æ®åº“(mycat) éƒ¨ç½²ç®€å•ï¼š å¼€ç®±å³ç”¨ï¼Œå¾ˆå¤šé»˜è®¤é…ç½®ä¸éœ€å…³å¿ƒï¼Œè§£å‹å®Œæˆç›´æ¥è¿è¡Œå³å¯ï¼Œæ‹“å±•æ—¶ï¼Œåªéœ€å¤šéƒ¨ç½²å‡ ä¸ªå®ä¾‹å³å¯ï¼Œè´Ÿè½½å‡è¡¡ã€åˆ†ç‰‡è¿ç§»é›†ç¾¤å†…éƒ¨è‡ªå·±å®æ–½ã€‚ æ¥å£ç®€å•ï¼š ä½¿ç”¨restful apiç»è¡Œäº¤äº’ï¼Œè·¨è¯­è¨€ã€‚ åŠŸèƒ½å¼ºå¤§ï¼š Elasticsearchä½œä¸ºä¼ ç»Ÿæ•°æ®åº“çš„ä¸€ä¸ªè¡¥å……ï¼Œæä¾›äº†æ•°æ®åº“æ‰€ä¸ä¸èƒ½æä¾›çš„å¾ˆå¤šåŠŸèƒ½ï¼Œå¦‚å…¨æ–‡æ£€ç´¢ã€åŒä¹‰è¯å¤„ç†ã€ç›¸å…³åº¦æ’åã€‚ Luceneä¸Elasticsearchçš„å…³ç³»ï¼š Lunceneï¼š æœ€å…ˆè¿›ã€åŠŸèƒ½æœ€å¼ºå¤§çš„æœç´¢åº“ï¼Œç›´æ¥åŸºäºluceneå¼€å‘ï¼Œéå¸¸å¤æ‚ï¼Œapiå¤æ‚ Elasticsearchï¼š åŸºäºluceneï¼Œå°è£…äº†è®¸å¤šluceneåº•å±‚åŠŸèƒ½ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„restful apiæ¥å£å’Œè®¸å¤šè¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œå¦‚javaçš„é«˜çº§å®¢æˆ·ç«¯(Java High Level REST Client)å’Œåº•å±‚å®¢æˆ·ç«¯(Java Low Level REST Client ) 3.5 Elasticsearchæ ¸å¿ƒæ¦‚å¿µ NRT(Near Realtime)ï¼šè¿›å®æ—¶ å†™å…¥æ•°æ®æ—¶ï¼Œè¿‡1ç§’æ‰ä¼šè¢«æœç´¢åˆ°ï¼Œå› ä¸ºå†…éƒ¨åœ¨åˆ†è¯ã€å½•å…¥ç´¢å¼•ã€‚ esæœç´¢æ—¶ï¼šæœç´¢å’Œåˆ†ææ•°æ®éœ€è¦ç§’çº§å‡ºç»“æœã€‚ Clusterï¼šé›†ç¾¤ åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¯åŠ¨ç€eså®ä¾‹çš„æœºå™¨ç¾¤ã€‚é€šå¸¸ä¸€å°æœºå™¨èµ·ä¸€ä¸ªeså®ä¾‹ã€‚åŒä¸€ç½‘ç»œä¸‹ï¼Œé›†åä¸€æ ·çš„å¤šä¸ªeså®ä¾‹è‡ªåŠ¨ç»„æˆé›†ç¾¤ï¼Œè‡ªåŠ¨å‡è¡¡åˆ†ç‰‡ç­‰è¡Œä¸ºã€‚é»˜è®¤é›†ç¾¤åä¸ºâ€œelasticsearchâ€ã€‚ Nodeï¼šèŠ‚ç‚¹ æ¯ä¸ªeså®ä¾‹ç§°ä¸ºä¸€ä¸ªèŠ‚ç‚¹ã€‚èŠ‚ç‚¹åè‡ªåŠ¨åˆ†é…ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨é…ç½®ã€‚ Indexï¼šç´¢å¼• åŒ…å«ä¸€å †æœ‰ç›¸ä¼¼ç»“æ„çš„æ–‡æ¡£æ•°æ®ã€‚ ç´¢å¼•åˆ›å»ºè§„åˆ™ï¼š ä»…é™å°å†™å­—æ¯ ä¸èƒ½åŒ…å«\\ / * ? &quot; &lt; &gt; | #ä»¥åŠç©ºæ ¼ç¬¦ç­‰ç‰¹æ®Šç¬¦å· ä»7.0ç‰ˆæœ¬å¼€å§‹ä¸å†åŒ…å«å†’å· ä¸èƒ½ä»¥- _ +å¼€å¤´ ä¸èƒ½è¶…è¿‡255ä¸ªå­—èŠ‚ï¼ˆæ³¨æ„å®ƒæ˜¯å­—èŠ‚ï¼Œå› æ­¤å¤šå­—èŠ‚å­—ç¬¦å°†è®¡å…¥255ä¸ªé™åˆ¶ï¼‰ Documentï¼šæ–‡æ¡£ esä¸­çš„æœ€å°æ•°æ®å•å…ƒã€‚ä¸€ä¸ªdocumentå°±åƒæ•°æ®åº“ä¸­çš„ä¸€æ¡è®°å½•ã€‚é€šå¸¸ä»¥jsonæ ¼å¼æ˜¾ç¤ºã€‚å¤šä¸ªdocumentå­˜å‚¨äºä¸€ä¸ªç´¢å¼•ï¼ˆIndexï¼‰ä¸­ã€‚ 12345678book document&#123; &quot;book_id&quot;: &quot;1&quot;, &quot;book_name&quot;: &quot;javaç¼–ç¨‹æ€æƒ³&quot;, &quot;book_desc&quot;: &quot;ä»Javaçš„åŸºç¡€è¯­æ³•åˆ°æœ€é«˜çº§ç‰¹æ€§ï¼ˆæ·±å…¥çš„[é¢å‘å¯¹è±¡](https://baike.baidu.com/item/é¢å‘å¯¹è±¡)æ¦‚å¿µã€å¤šçº¿ç¨‹ã€è‡ªåŠ¨é¡¹ç›®æ„å»ºã€å•å…ƒæµ‹è¯•å’Œè°ƒè¯•ç­‰ï¼‰ï¼Œæœ¬ä¹¦éƒ½èƒ½é€æ­¥æŒ‡å¯¼ä½ è½»æ¾æŒæ¡ã€‚&quot;, &quot;category_id&quot;: &quot;2&quot;, &quot;category_name&quot;: &quot;java&quot;&#125; Fieldï¼šå­—æ®µ å°±åƒæ•°æ®åº“ä¸­çš„åˆ—ï¼ˆColumnsï¼‰ï¼Œå®šä¹‰æ¯ä¸ªdocumentåº”è¯¥æœ‰çš„å­—æ®µã€‚ Typeï¼šç±»å‹ æ¯ä¸ªç´¢å¼•é‡Œéƒ½å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªtypeï¼Œtypeæ˜¯indexä¸­çš„ä¸€ä¸ªé€»è¾‘æ•°æ®åˆ†ç±»ï¼Œä¸€ä¸ªtypeä¸‹çš„documentï¼Œéƒ½æœ‰ç›¸åŒçš„fieldã€‚ æ³¨æ„ï¼š6.0ä¹‹å‰çš„ç‰ˆæœ¬æœ‰typeï¼ˆç±»å‹ï¼‰æ¦‚å¿µï¼Œtypeç›¸å½“äºå…³ç³»æ•°æ®åº“çš„è¡¨ï¼ŒESå®˜æ–¹å°†åœ¨ES9.0ç‰ˆæœ¬ä¸­å½»åº•åˆ é™¤typeã€‚æœ¬æ•™ç¨‹typeéƒ½ä¸º_docã€‚ Shardï¼šåˆ†ç‰‡ indexæ•°æ®è¿‡å¤§æ—¶ï¼Œå°†indexé‡Œé¢çš„æ•°æ®ï¼Œåˆ†ä¸ºå¤šä¸ªshardï¼Œåˆ†å¸ƒå¼çš„å­˜å‚¨åœ¨å„ä¸ªæœåŠ¡å™¨ä¸Šé¢ã€‚å¯ä»¥æ”¯æŒæµ·é‡æ•°æ®å’Œé«˜å¹¶å‘ï¼Œæå‡æ€§èƒ½å’Œååé‡ï¼Œå……åˆ†åˆ©ç”¨å¤šå°æœºå™¨çš„cpuã€‚ Replicaï¼šå‰¯æœ¬ åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œä»»ä½•ä¸€å°æœºå™¨éƒ½ä¼šéšæ—¶å®•æœºï¼Œå¦‚æœå®•æœºï¼Œindexçš„ä¸€ä¸ªåˆ†ç‰‡æ²¡æœ‰ï¼Œå¯¼è‡´æ­¤indexä¸èƒ½æœç´¢ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„å®‰å…¨ï¼Œæˆ‘ä»¬ä¼šå°†æ¯ä¸ªindexçš„åˆ†ç‰‡ç»è¡Œå¤‡ä»½ï¼Œå­˜å‚¨åœ¨å¦å¤–çš„æœºå™¨ä¸Šã€‚ä¿è¯å°‘æ•°æœºå™¨å®•æœºesé›†ç¾¤ä»å¯ä»¥æœç´¢ã€‚ èƒ½æ­£å¸¸æä¾›æŸ¥è¯¢å’Œæ’å…¥çš„åˆ†ç‰‡æˆ‘ä»¬å«åšä¸»åˆ†ç‰‡(primary shard)ï¼Œå…¶ä½™çš„æˆ‘ä»¬å°±ç®¡ä»–ä»¬å«åšå¤‡ä»½çš„åˆ†ç‰‡ (replica shard)ã€‚ es6é»˜è®¤æ–°å»ºç´¢å¼•æ—¶ï¼Œ5åˆ†ç‰‡ï¼Œ2å‰¯æœ¬ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸»ä¸€å¤‡ï¼Œå…±10ä¸ªåˆ†ç‰‡ã€‚æ‰€ä»¥ï¼Œesé›†ç¾¤æœ€å°è§„æ¨¡ä¸ºä¸¤å°ã€‚ Elasticsearchä¸æ•°æ®åº“æ¯”è¾ƒï¼š å…³ç³»å‹æ•°æ®åº“(MySQL) éå…³ç³»å‹æ•°æ®åº“(Elasticsearch) æ•°æ®åº“Database ç´¢å¼•Index è¡¨Table ç´¢å¼•Index(åŸä¸ºType) æ•°æ®è¡ŒRow æ–‡æ¡£Document æ•°æ®åˆ—Column å­—æ®µField çº¦æŸ Schema çº¦æŸ Schema 4.ESå¿«é€Ÿå…¥é—¨4.1 æ–‡æ¡£(document)çš„æ•°æ®æ ¼å¼ åº”ç”¨ç³»ç»Ÿçš„æ•°æ®ç»“æ„éƒ½æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œå…·æœ‰å¤æ‚çš„æ•°æ®ç»“æ„ å¯¹è±¡å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œéœ€è¦å°†å…³è”çš„å¤æ‚å¯¹è±¡å±æ€§æ’åˆ°å¦ä¸€å¼ è¡¨ï¼ŒæŸ¥è¯¢æ—¶å†æ‹¼æ¥èµ·æ¥ã€‚ ESé¢å‘æ–‡æ¡£ï¼Œæ–‡æ¡£ä¸­å­˜å‚¨çš„æ•°æ®ç»“æ„ï¼Œä¸å¯¹è±¡ä¸€è‡´ã€‚æ‰€ä»¥ä¸€ä¸ªå¯¹è±¡å¯ä»¥ç›´æ¥å­˜æˆä¸€ä¸ªæ–‡æ¡£ã€‚ ESçš„documentç”¨jsonæ•°æ®æ ¼å¼æ¥è¡¨è¾¾ã€‚ 123456789&#123; &quot;id&quot;:&quot;1&quot;, &quot;name&quot;: &quot;å¼ ä¸‰&quot;, &quot;last_name&quot;: &quot;zhang&quot;, &quot;classInfo&quot;: &#123; &quot;id&quot;: &quot;1&quot;, &quot;className&quot;: &quot;ä¸‰å¹´äºŒç­&quot;, &#125;&#125; 4.2 ç®€å•çš„é›†ç¾¤ç®¡ç†ä½¿ç”¨kibanaçš„æ§åˆ¶å°ï¼Œæµè§ˆå™¨è®¿é—®ï¼šhttp://ä¸»æœºåœ°å€:5601/app/dev_tools#/console æ£€æŸ¥é›†ç¾¤çš„å¥åº·çŠ¶å†µï¼š 1GET /_cat/health?v å“åº”ç»“æœï¼š 12epoch timestamp cluster status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent1660972717 05:18:37 docker-cluster green 1 1 11 11 0 0 0 0 - 100.0% å¥åº·çŠ¶å†µçš„ä¸‰ç§æƒ…å†µï¼š greenï¼šæ¯ä¸ªç´¢å¼•çš„primary shardå’Œreplica shardéƒ½æ˜¯activeçŠ¶æ€çš„ yellowï¼šæ¯ä¸ªç´¢å¼•çš„primary shardéƒ½æ˜¯activeçŠ¶æ€çš„ï¼Œä½†æ˜¯éƒ¨åˆ†replica shardä¸æ˜¯activeçŠ¶æ€ï¼Œå¤„äºä¸å¯ç”¨çš„çŠ¶æ€ redï¼šä¸æ˜¯æ‰€æœ‰ç´¢å¼•çš„primary shardéƒ½æ˜¯activeçŠ¶æ€çš„ï¼Œéƒ¨åˆ†ç´¢å¼•æœ‰æ•°æ®ä¸¢å¤±äº† æŸ¥çœ‹é›†ç¾¤ä¸­çš„ç´¢å¼•ï¼š 1GET /_cat/indexes?v å“åº”ç»“æœï¼š 123456789health status index uuid pri rep docs.count docs.deleted store.size pri.store.sizegreen open .geoip_databases dGx7TrfoTCuOqVS7y6CTRA 1 0 41 0 38.9mb 38.9mbgreen open .kibana_7.17.5_001 JGFQAr7hRWqaoIfIpo_Liw 1 0 438 2 6.7mb 6.7mbgreen open .apm-custom-link f8HqzrG-TWipwqbNoGLQEA 1 0 0 0 226b 226bgreen open kibana_sample_data_ecommerce -WV4YJoiTaWtfACqobRV9g 1 0 4675 0 4.2mb 4.2mbgreen open .apm-agent-configuration hoLYS7CRRTCooCP3ndNt6Q 1 0 0 0 226b 226bgreen open .kibana_task_manager_7.17.5_001 lSfnkGiSSzKTvesWhYZgaQ 1 0 17 77315 8.2mb 8.2mbgreen open .async-search _bMoH_6WQkKhHkGAcpl1MA 1 0 0 0 249b 249bgreen open .tasks jBJ9hH7TTn2TXtFwmYDjVw 1 0 6 0 23kb 23kb ç®€å•çš„ç´¢å¼•æ“ä½œï¼š åˆ›å»ºç´¢å¼•ï¼š 1PUT /demo_index å“åº”ç»“æœï¼š 12345&#123; &quot;acknowledged&quot; : true, &quot;shards_acknowledged&quot; : true, &quot;index&quot; : &quot;demo_index&quot;&#125; åˆ é™¤ç´¢å¼•ï¼š 1DELETE /demo_index å“åº”ç»“æœï¼š 123&#123; &quot;acknowledged&quot; : true&#125; 4.3 æ¡ˆä¾‹ä»‹ç»æœ‰ä¸€ä¸ªå”®å–å›¾ä¹¦çš„ç½‘ç«™ï¼Œéœ€è¦ä¸ºå…¶åŸºäºESæ„å»ºä¸€ä¸ªåå°ç³»ç»Ÿï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š å¯¹å•†å“ä¿¡æ¯è¿›è¡ŒCRUDï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰æ“ä½œ æ‰§è¡Œç®€å•çš„ç»“æ„åŒ–æŸ¥è¯¢ å¯ä»¥æ‰§è¡Œç®€å•çš„å…¨æ–‡æ£€ç´¢ï¼Œä»¥åŠå¤æ‚çš„phraseï¼ˆçŸ­è¯­ï¼‰æ£€ç´¢ å¯¹äºå…¨æ–‡æ£€ç´¢çš„ç»“æœï¼Œå¯ä»¥è¿›è¡Œé«˜äº®æ˜¾ç¤º å¯¹æ•°æ®è¿›è¡Œç®€å•çš„èšåˆåˆ†æ 4.4 å•†å“çš„CRUDæ“ä½œdocumentçš„CRUDæ“ä½œ **æ–°å»ºå›¾ä¹¦ç´¢å¼•book**ï¼šPUT /index 1PUT /book **æ–°å¢å›¾ä¹¦(æ–‡æ¡£)**ï¼šPUT /index/type/id æ–°å¢å›¾ä¹¦1ï¼š 12345678910PUT /book/_doc/1&#123;&quot;name&quot;: &quot;Bootstrapå¼€å‘&quot;,&quot;description&quot;: &quot;Bootstrapæ˜¯ç”±Twitteræ¨å‡ºçš„ä¸€ä¸ªå‰å°é¡µé¢å¼€å‘cssæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å¼€å‘æ¡†æ¶ï¼Œæ­¤æ¡†æ¶é›†æˆäº†å¤šç§é¡µé¢æ•ˆæœã€‚æ­¤å¼€å‘æ¡†æ¶åŒ…å«äº†å¤§é‡çš„CSSã€JSç¨‹åºä»£ç ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯ä¸æ“…é•¿cssé¡µé¢å¼€å‘çš„ç¨‹åºäººå‘˜ï¼‰è½»æ¾çš„å®ç°ä¸€ä¸ªcssï¼Œä¸å—æµè§ˆå™¨é™åˆ¶çš„ç²¾ç¾ç•Œé¢cssæ•ˆæœã€‚&quot;,&quot;studymodel&quot;: &quot;201002&quot;,&quot;price&quot;:38.6,&quot;timestamp&quot;:&quot;2019-08-25 19:11:35&quot;,&quot;pic&quot;:&quot;group1/M00/00/00/wKhlQFs6RCeAY0pHAAJx5ZjNDEM428.jpg&quot;,&quot;tags&quot;: [ &quot;bootstrap&quot;, &quot;dev&quot;]&#125; æ–°å¢å›¾ä¹¦1ï¼š 12345678910PUT /book/_doc/2&#123;&quot;name&quot;: &quot;javaç¼–ç¨‹æ€æƒ³&quot;,&quot;description&quot;: &quot;javaè¯­è¨€æ˜¯ä¸–ç•Œç¬¬ä¸€ç¼–ç¨‹è¯­è¨€ï¼Œåœ¨è½¯ä»¶å¼€å‘é¢†åŸŸä½¿ç”¨äººæ•°æœ€å¤šã€‚&quot;,&quot;studymodel&quot;: &quot;201001&quot;,&quot;price&quot;:68.6,&quot;timestamp&quot;:&quot;2019-08-25 19:11:35&quot;,&quot;pic&quot;:&quot;group1/M00/00/00/wKhlQFs6RCeAY0pHAAJx5ZjNDEM428.jpg&quot;,&quot;tags&quot;: [ &quot;java&quot;, &quot;dev&quot;]&#125; æŸ¥çœ‹æ‰€æœ‰å›¾ä¹¦ï¼šGET /index/_search **æŸ¥è¯¢å›¾ä¹¦(æ£€ç´¢æ–‡æ¡£)**ï¼šGET /index/type/id æŸ¥çœ‹å›¾ä¹¦1 1GET /book/_doc/1 å“åº”ç»“æœï¼š 123456789101112131415161718192021&#123; &quot;_index&quot; : &quot;book&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;name&quot; : &quot;Bootstrapå¼€å‘&quot;, &quot;description&quot; : &quot;Bootstrapæ˜¯ç”±Twitteræ¨å‡ºçš„ä¸€ä¸ªå‰å°é¡µé¢å¼€å‘cssæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å¼€å‘æ¡†æ¶ï¼Œæ­¤æ¡†æ¶é›†æˆäº†å¤šç§é¡µé¢æ•ˆæœã€‚æ­¤å¼€å‘æ¡†æ¶åŒ…å«äº†å¤§é‡çš„CSSã€JSç¨‹åºä»£ç ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯ä¸æ“…é•¿cssé¡µé¢å¼€å‘çš„ç¨‹åºäººå‘˜ï¼‰è½»æ¾çš„å®ç°ä¸€ä¸ªcssï¼Œä¸å—æµè§ˆå™¨é™åˆ¶çš„ç²¾ç¾ç•Œé¢cssæ•ˆæœã€‚&quot;, &quot;studymodel&quot; : &quot;201002&quot;, &quot;price&quot; : 38.6, &quot;timestamp&quot; : &quot;2019-08-25 19:11:35&quot;, &quot;pic&quot; : &quot;group1/M00/00/00/wKhlQFs6RCeAY0pHAAJx5ZjNDEM428.jpg&quot;, &quot;tags&quot; : [ &quot;bootstrap&quot;, &quot;dev&quot; ] &#125;&#125; ä¿®æ”¹å›¾ä¹¦ï¼š å…¨å±€æ›¿æ¢ï¼š 12345678910PUT /book/_doc/1&#123; &quot;name&quot;: &quot;Bootstrapå¼€å‘æ•™ç¨‹&quot;, &quot;description&quot;: &quot;Bootstrapæ˜¯ç”±Twitteræ¨å‡ºçš„ä¸€ä¸ªå‰å°é¡µé¢å¼€å‘cssæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å¼€å‘æ¡†æ¶ï¼Œæ­¤æ¡†æ¶é›†æˆäº†å¤šç§é¡µé¢æ•ˆæœã€‚æ­¤å¼€å‘æ¡†æ¶åŒ…å«äº†å¤§é‡çš„CSSã€JSç¨‹åºä»£ç ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯ä¸æ“…é•¿cssé¡µé¢å¼€å‘çš„ç¨‹åºäººå‘˜ï¼‰è½»æ¾çš„å®ç°ä¸€ä¸ªcssï¼Œä¸å—æµè§ˆå™¨é™åˆ¶çš„ç²¾ç¾ç•Œé¢cssæ•ˆæœã€‚&quot;, &quot;studymodel&quot;: &quot;201002&quot;, &quot;price&quot;:38.6, &quot;timestamp&quot;:&quot;2019-08-25 19:11:35&quot;, &quot;pic&quot;:&quot;group1/M00/00/00/wKhlQFs6RCeAY0pHAAJx5ZjNDEM428.jpg&quot;, &quot;tags&quot;: [ &quot;bootstrap&quot;, &quot;å¼€å‘&quot;]&#125; æ›¿æ¢æ“ä½œæ˜¯æ•´ä½“è¦†ç›–ï¼Œè¦å¸¦ä¸Šæ‰€æœ‰ä¿¡æ¯ã€‚ æ¯æ¬¡æ‰§è¡Œåï¼Œè¿”å›ç»“æœä¸­ç‰ˆæœ¬å·_versionåœ¨ä¸æ–­å¢åŠ ï¼Œæ­¤è¿‡ç¨‹ä¸ºå…¨é‡æ›¿æ¢ã€‚ å®è´¨ï¼šæ—§æ–‡æ¡£çš„å†…å®¹ä¸ä¼šç«‹å³åˆ é™¤ï¼Œåªæ˜¯æ ‡è®°ä¸ºdeletedã€‚é€‚å½“çš„æ—¶æœºï¼Œé›†ç¾¤ä¼šå°†è¿™äº›æ–‡æ¡£åˆ é™¤ã€‚ å±€éƒ¨æ›¿æ¢ï¼š POST /index/_update/idæˆ– POST /index/type/id/_update 123456POST /book/_update/1&#123; &quot;doc&quot;: &#123; &quot;name&quot;: &quot; Bootstrapå¼€å‘æ•™ç¨‹é«˜çº§&quot; &#125;&#125; å†…éƒ¨ä¸å…¨é‡æ›¿æ¢æ˜¯ä¸€æ ·çš„ï¼Œæ—§æ–‡æ¡£æ ‡è®°ä¸ºåˆ é™¤ï¼Œæ–°å»ºä¸€ä¸ªæ–‡æ¡£ã€‚ ä¼˜ç‚¹ï¼š å¤§å¤§å‡å°‘ç½‘ç»œä¼ è¾“æ¬¡æ•°å’Œæµé‡ï¼Œæå‡æ€§èƒ½ å‡å°‘å¹¶å‘å†²çªå‘ç”Ÿçš„æ¦‚ç‡ **åˆ é™¤å›¾ä¹¦(åˆ é™¤æ–‡æ¡£)**ï¼šDELETE /index/type/id 1DELETE /book/_doc/1 å®è´¨ï¼šæ—§æ–‡æ¡£çš„å†…å®¹ä¸ä¼šç«‹å³åˆ é™¤ï¼Œåªæ˜¯æ ‡è®°ä¸ºdeletedã€‚é€‚å½“çš„æ—¶æœºï¼Œé›†ç¾¤ä¼šå°†è¿™äº›æ–‡æ¡£åˆ é™¤ã€‚ 5.æ–‡æ¡£documentå…¥é—¨1GET /book/_doc/1 å“åº”ç»“æœï¼š 123456789101112131415161718192021&#123; &quot;_index&quot; : &quot;book&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 1, &quot;_seq_no&quot; : 0, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;name&quot; : &quot;Bootstrapå¼€å‘&quot;, &quot;description&quot; : &quot;Bootstrapæ˜¯ç”±Twitteræ¨å‡ºçš„ä¸€ä¸ªå‰å°é¡µé¢å¼€å‘cssæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å¼€å‘æ¡†æ¶ï¼Œæ­¤æ¡†æ¶é›†æˆäº†å¤šç§é¡µé¢æ•ˆæœã€‚æ­¤å¼€å‘æ¡†æ¶åŒ…å«äº†å¤§é‡çš„CSSã€JSç¨‹åºä»£ç ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯ä¸æ“…é•¿cssé¡µé¢å¼€å‘çš„ç¨‹åºäººå‘˜ï¼‰è½»æ¾çš„å®ç°ä¸€ä¸ªcssï¼Œä¸å—æµè§ˆå™¨é™åˆ¶çš„ç²¾ç¾ç•Œé¢cssæ•ˆæœã€‚&quot;, &quot;studymodel&quot; : &quot;201002&quot;, &quot;price&quot; : 38.6, &quot;timestamp&quot; : &quot;2019-08-25 19:11:35&quot;, &quot;pic&quot; : &quot;group1/M00/00/00/wKhlQFs6RCeAY0pHAAJx5ZjNDEM428.jpg&quot;, &quot;tags&quot; : [ &quot;bootstrap&quot;, &quot;dev&quot; ] &#125;&#125; 5.1 å­—æ®µè§£æ _index å«ä¹‰ï¼šæ­¤æ–‡æ¡£å±äºå“ªä¸ªç´¢å¼• åŸåˆ™ï¼šç±»ä¼¼æ•°æ®æ”¾åœ¨ä¸€ä¸ªç´¢å¼•ä¸­ã€‚æ•°æ®åº“ä¸­è¡¨çš„å®šä¹‰è§„åˆ™ã€‚å¦‚å›¾ä¹¦ä¿¡æ¯æ”¾åœ¨bookç´¢å¼•ä¸­ï¼Œå‘˜å·¥ä¿¡æ¯æ”¾åœ¨employeeç´¢å¼•ä¸­ã€‚å„ä¸ªç´¢å¼•å­˜å‚¨å’Œæœç´¢æ—¶äº’ä¸å½±å“ã€‚ å®šä¹‰è§„åˆ™ï¼šè‹±æ–‡å°å†™ã€‚å°½é‡ä¸è¦ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ã€‚order user _type å«ä¹‰ï¼šç±»åˆ«ã€‚book java node æ³¨æ„ï¼šä»¥åçš„es9å°†å½»åº•åˆ é™¤æ­¤å­—æ®µï¼Œæ‰€ä»¥å½“å‰ç‰ˆæœ¬åœ¨ä¸æ–­å¼±åŒ–typeã€‚ä¸éœ€è¦å…³æ³¨ã€‚è§åˆ°_typeéƒ½ä¸º_docã€‚ _id å«ä¹‰ï¼šæ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ã€‚å°±åƒè¡¨çš„idä¸»é”®ã€‚ç»“åˆç´¢å¼•å¯ä»¥æ ‡è¯†å’Œå®šä¹‰ä¸€ä¸ªæ–‡æ¡£ã€‚ ç”Ÿæˆï¼šæ‰‹åŠ¨ï¼ˆput &#x2F;index&#x2F;_doc&#x2F;idï¼‰ã€è‡ªåŠ¨ 5.2 è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£id1234POST /book/_doc&#123; &quot;name&quot;:&quot;ELK&quot;&#125; å“åº”ç»“æœï¼š 1234567891011121314&#123; &quot;_index&quot; : &quot;book&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;FrnSuoIB-YsVyRxk4XeZ&quot;, &quot;_version&quot; : 1, &quot;result&quot; : &quot;created&quot;, &quot;_shards&quot; : &#123; &quot;total&quot; : 2, &quot;successful&quot; : 1, &quot;failed&quot; : 0 &#125;, &quot;_seq_no&quot; : 3, &quot;_primary_term&quot; : 1&#125; è‡ªåŠ¨ç”Ÿæˆçš„idå°±ä¸ºFrnSuoIB-YsVyRxk4XeZ ç‰¹ç‚¹ï¼šé•¿åº¦ä¸º20ä¸ªå­—ç¬¦ï¼ŒURLå®‰å…¨ï¼Œbase64ç¼–ç ï¼ŒGUIDï¼Œåˆ†å¸ƒå¼ç”Ÿæˆä¸å†²çª 5.3 å®šåˆ¶è¿”å›å­—æ®µå°±åƒsqlä¸€æ ·ä¸æ˜¯æŸ¥è¯¢æ‰€æœ‰select * from bookï¼Œè€Œæ˜¯select name, price from book æŸ¥è¯¢idä¸º1çš„ä¹¦åä»¥åŠä»·æ ¼ï¼š 1GET /book/_doc/1?_source_includes=name,price æ³¨æ„ï¼šnameä¸priceä¸­é—´åªæœ‰,ä¸èƒ½æœ‰ç©ºæ ¼ å“åº”ç»“æœï¼š 12345678910111213&#123; &quot;_index&quot; : &quot;book&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 2, &quot;_seq_no&quot; : 2, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;price&quot; : 38.6, &quot;name&quot; : &quot; Bootstrapå¼€å‘æ•™ç¨‹é«˜çº§&quot; &#125;&#125; 5.4 æ–‡æ¡£çš„å¼ºåˆ¶æ›¿æ¢å¼ºåˆ¶åˆ›å»ºï¼šPUT /index/ _doc/id/_create ä¸ºé˜²æ­¢è¦†ç›–åŸæœ‰æ•°æ®ï¼Œæˆ‘ä»¬åœ¨æ–°å¢æ—¶ï¼Œè®¾ç½®ä¸ºå¼ºåˆ¶åˆ›å»ºï¼Œä¸ä¼šè¦†ç›–åŸæœ‰æ–‡æ¡£ã€‚ 123456POST /book/_doc/1/_create&#123; &quot;doc&quot;: &#123; &quot;name&quot;: &quot; Bootstrapå¼€å‘æ•™ç¨‹é«˜çº§666&quot; &#125;&#125; å“åº”ç»“æœï¼š 12345678910111213141516171819&#123; &quot;error&quot; : &#123; &quot;root_cause&quot; : [ &#123; &quot;type&quot; : &quot;version_conflict_engine_exception&quot;, &quot;reason&quot; : &quot;[1]: version conflict, document already exists (current version [4])&quot;, &quot;index_uuid&quot; : &quot;_GEFBf0rSxG9GxzJtG8w5A&quot;, &quot;shard&quot; : &quot;0&quot;, &quot;index&quot; : &quot;book&quot; &#125; ], &quot;type&quot; : &quot;version_conflict_engine_exception&quot;, &quot;reason&quot; : &quot;[1]: version conflict, document already exists (current version [4])&quot;, &quot;index_uuid&quot; : &quot;_GEFBf0rSxG9GxzJtG8w5A&quot;, &quot;shard&quot; : &quot;0&quot;, &quot;index&quot; : &quot;book&quot; &#125;, &quot;status&quot; : 409&#125; 5.5 è„šæœ¬æ›´æ–°eså¯ä»¥å†…ç½®è„šæœ¬æ‰§è¡Œå¤æ‚æ“ä½œã€‚ä¾‹å¦‚painlessè„šæœ¬ã€‚ æ³¨æ„ï¼šgroovyè„šæœ¬åœ¨es6ä»¥åå°±ä¸æ”¯æŒäº†ã€‚åŸå› æ˜¯è€—å†…å­˜ï¼Œä¸å®‰å…¨è¿œç¨‹æ³¨å…¥æ¼æ´ã€‚ å†…ç½®è„šæœ¬ éœ€æ±‚1ï¼šä¿®æ”¹æ–‡æ¡£1çš„numå­—æ®µ+1ã€‚ æ’å…¥æ•°æ®ï¼š 1234PUT /test/_doc/1&#123; &quot;num&quot;: 0&#125; æ‰§è¡Œè„šæœ¬ï¼š 1234POST /test/_update/1&#123; &quot;script&quot; : &quot;ctx._source.num+=1&quot;&#125; æŸ¥è¯¢æ–‡æ¡£1ï¼š 1GET /test/_doc/1 å“åº”æ•°æ®ï¼š 123456789101112&#123; &quot;_index&quot; : &quot;test&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_version&quot; : 2, &quot;_seq_no&quot; : 1, &quot;_primary_term&quot; : 1, &quot;found&quot; : true, &quot;_source&quot; : &#123; &quot;num&quot; : 1 &#125;&#125; éœ€æ±‚2ï¼šæœç´¢æ‰€æœ‰æ–‡æ¡£ï¼Œå°†numå­—æ®µä¹˜ä»¥2è¾“å‡º æ’å…¥æ•°æ®ï¼š 1234PUT /test/_doc/2&#123; &quot;num&quot;: 5&#125; æŸ¥è¯¢æ‰€æœ‰å°†num x 2ï¼š æ³¨æ„ï¼šæºæ•°æ®ä¸å˜ï¼Œåªæ˜¯å°†æŸ¥è¯¢çš„æ•°æ® x 2 1234567891011121314GET /test/_search&#123; &quot;script_fields&quot;: &#123; &quot;my_doubled_field&quot;: &#123; &quot;script&quot;: &#123; &quot;lang&quot;: &quot;expression&quot;, &quot;source&quot;: &quot;doc[&#x27;num&#x27;] * mul&quot;, &quot;params&quot;: &#123; &quot;mul&quot;: 2 &#125; &#125; &#125; &#125;&#125; å“åº”ç»“æœï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041&#123; &quot;took&quot; : 364, &quot;timed_out&quot; : false, &quot;_shards&quot; : &#123; &quot;total&quot; : 1, &quot;successful&quot; : 1, &quot;skipped&quot; : 0, &quot;failed&quot; : 0 &#125;, &quot;hits&quot; : &#123; &quot;total&quot; : &#123; &quot;value&quot; : 2, &quot;relation&quot; : &quot;eq&quot; &#125;, &quot;max_score&quot; : 1.0, &quot;hits&quot; : [ &#123; &quot;_index&quot; : &quot;test&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;1&quot;, &quot;_score&quot; : 1.0, &quot;fields&quot; : &#123; &quot;my_doubled_field&quot; : [ 2.0 #ç”±1å˜æˆ2 ] &#125; &#125;, &#123; &quot;_index&quot; : &quot;test&quot;, &quot;_type&quot; : &quot;_doc&quot;, &quot;_id&quot; : &quot;2&quot;, &quot;_score&quot; : 1.0, &quot;fields&quot; : &#123; &quot;my_doubled_field&quot; : [ 10.0 #ç”±5å˜æˆ10 ] &#125; &#125; ] &#125;&#125; å¤–éƒ¨è„šæœ¬ï¼š æ³¨æ„ï¼šè„šæœ¬æ€§èƒ½ä½ä¸‹ï¼Œä¸”å®¹æ˜“å‘ç”Ÿæ³¨å…¥ï¼Œæœ¬æ•™ç¨‹å¿½ç•¥ è‡ªè¡Œäº†è§£ï¼šå®˜æ–¹æ–‡æ¡£ 6.ESçš„å¹¶å‘é—®é¢˜å¦‚åŒç§’æ€ï¼Œå¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼ŒesåŒæ ·ä¼šå‡ºç°å¹¶å‘å†²çªé—®é¢˜ã€‚ 6.1 ä¹è§‚é”ä¸æ‚²è§‚é”ä¸ºæ§åˆ¶å¹¶å‘é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸é‡‡ç”¨é”æœºåˆ¶ã€‚ åˆ†ä¸ºæ‚²è§‚é”å’Œä¹è§‚é”ä¸¤ç§æœºåˆ¶ï¼š æ‚²è§‚é”ï¼šå¾ˆæ‚²è§‚ï¼Œæ‰€æœ‰æƒ…å†µéƒ½ä¸Šé”ã€‚æ­¤æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ“ä½œæ•°æ®ã€‚å…·ä½“ä¾‹å­ä¸ºæ•°æ®åº“ä¸­çš„è¡Œçº§é”ã€è¡¨çº§é”ã€è¯»é”ã€å†™é”ç­‰ã€‚ ç‰¹ç‚¹ï¼šä¼˜ç‚¹æ˜¯æ–¹ä¾¿ï¼Œç›´æ¥åŠ é”ï¼Œå¯¹ç¨‹åºé€æ˜ã€‚ç¼ºç‚¹æ˜¯æ•ˆç‡ä½ã€‚ ä¹è§‚é”ï¼šå¾ˆä¹è§‚ï¼Œå¯¹æ•°æ®æœ¬èº«ä¸åŠ é”ã€‚æäº¤æ•°æ®æ—¶ï¼Œé€šè¿‡ä¸€ç§æœºåˆ¶éªŒè¯æ˜¯å¦å­˜åœ¨å†²çªï¼Œå¦‚esä¸­é€šè¿‡ç‰ˆæœ¬å·éªŒè¯ã€‚ ç‰¹ç‚¹ï¼šä¼˜ç‚¹æ˜¯å¹¶å‘èƒ½åŠ›é«˜ã€‚ç¼ºç‚¹æ˜¯æ“ä½œç¹çï¼Œåœ¨æäº¤æ•°æ®æ—¶ï¼Œå¯èƒ½åå¤é‡è¯•å¤šæ¬¡ã€‚ 6.2 åŸºäº_versionä¹è§‚é”æ§åˆ¶","categories":[],"tags":[]},{"title":"çˆ¬å–æŸæ˜“äº‘çš„å…è´¹éŸ³ä¹","slug":"Python/çˆ¬è™«/çˆ¬å–æŸæ˜“äº‘éŸ³ä¹","date":"2022-08-06T10:59:00.000Z","updated":"2022-08-06T11:16:47.702Z","comments":true,"path":"2022/08/06/Python/çˆ¬è™«/çˆ¬å–æŸæ˜“äº‘éŸ³ä¹/","link":"","permalink":"http://example.com/2022/08/06/Python/%E7%88%AC%E8%99%AB/%E7%88%AC%E5%8F%96%E6%9F%90%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90/","excerpt":"","text":"è·å–åŠ å¯†çš„å­—ç¬¦ä¸²ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253import jsonfrom base64 import b64encodefrom Crypto.Cipher import AES# å‰ç«¯è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²å¸¸é‡_g = &quot;0CoJUm6Qyw8W8jud&quot;# 16ä½éšæœºæ•°# å¿…é¡»è¦è‡ªå·±æ‰‹åŠ¨å›ºå®š# å› ä¸ºdataä¸­çš„paramså’ŒencSecKeyåˆ°äº†æœåŠ¡å™¨è§£æåä¼šå¯¹æ¯”éšæœºæ•°æ˜¯å¦ç›¸åŒ# è·å–encSecKeyè¿‡ç¨‹ä¸­å”¯ä¸€çš„å˜é‡å°±æ˜¯è¿™ä¸ªéšæœºæ•°ï¼Œå›ºå®šäº†éšæœºæ•°å°±æ˜¯å›ºå®šäº†encSecKey# è¿™æ ·å°±åªéœ€è¦è·å–paramsäº†_i = &quot;Zrv1r2M2VOINoxIJ&quot;# åŠ å¯†å·¥å…·ï¼šè½¬åŒ–ä¸º16çš„å€æ•°def _to_16(data): pad = 16 - len(data) % 16 data += chr(pad) * pad return data# è·å–åŠ å¯†çš„paramsdef _get_aes(a, b): key = b.encode(&quot;utf-8&quot;) iv = &quot;0102030405060708&quot;.encode(&quot;utf-8&quot;) aes = AES.new(key=key, IV=iv, mode=AES.MODE_CBC) # åˆ›é€ åŠ å¯†å™¨ a = _to_16(a) bs = aes.encrypt(a.encode(&quot;utf-8&quot;)) # åŠ å¯†,åŠ å¯†å†…å®¹é•¿åº¦å¿…é¡»æ˜¯16çš„å€æ•°ï¼Œ return str(b64encode(bs), &quot;utf-8&quot;) # è½¬åŒ–ä¸ºå­—ç¬¦ä¸²è¿”å›ï¼Œ# è·å–encSecKeydef _get_encSecKey(): return &quot;d6b3977cdc2bf7c55093043afcc1037c7c9a52e0ee558aaa9afb4b6af&quot; \\ &quot;0078171aacc26f75e38da3cc754ac9e7c55b835f6a52496f0c7507445&quot; \\ &quot;8de571d3d5fa1c1d4ed2e8e91b95797030da6904e0a0b379fd1722665&quot; \\ &quot;29fab6d9ce2f10ead2880567491406334d7d4a90a39698eae9f886a22&quot; \\ &quot;7cdd18399533760d314d13281d3b&quot;# è·å–åŠ å¯†å‚æ•°def get_data(data): data = json.dumps(data) params = _get_aes(data, _g) params = _get_aes(params, _i) encSecKey = _get_encSecKey() data = &#123; &quot;params&quot;: params, &quot;encSecKey&quot;: encSecKey &#125; return data è·å–æ­Œæ›²åˆ—è¡¨ï¼š 1234567891011121314151617181920212223242526272829303132333435363738import requestsimport GetDatadef _search(content): data = &#123;&quot;hlposttag&quot;: &quot;&lt;/span&gt;&quot;, &quot;hlpretag&quot;: &#x27;&lt;span class=&quot;s-fc7&quot;&gt;&#x27;, &quot;limit&quot;: 30, &quot;offset&quot;: 0, &quot;s&quot;: f&quot;&#123;content&#125;&quot;, &quot;total&quot;: True, &quot;type&quot;: &quot;1&quot;&#125; url = &quot;https://music.163.com/weapi/cloudsearch/get/web?csrf_token=&quot; data = GetData.get_data(data) resp = requests.post(url=url, data=data) return resp.json()def show_list(content): search_list = _search(content) print(&quot;----------------------------------------------------------&quot;) print(&quot;åºå· songId æ­Œæ‰‹ æ­Œæ›² &quot;) index = 1 list = [] for i in search_list[&quot;result&quot;][&quot;songs&quot;]: print(f&quot;&#123;index&#125; &#123;i[&#x27;id&#x27;]&#125; &#123;i[&#x27;ar&#x27;][0][&#x27;name&#x27;]&#125; &#123;i[&#x27;name&#x27;]&#125;&quot;) index += 1 temp = &#123; &quot;id&quot;: i[&quot;id&quot;], &quot;song_name&quot;: i[&quot;name&quot;], &quot;singer&quot;:i[&quot;ar&quot;][0][&quot;name&quot;] &#125; list.append(temp) print(&quot;----------------------------------------------------------&quot;) return list ä¸‹è½½æ­Œæ›²ï¼š 1234567891011121314151617181920212223242526272829import requestsimport GetDatadef _download_song(url, name): song_name = name + &quot;.m4a&quot; resp = requests.get(url=url) f = open(&quot;./&quot; + song_name, &quot;wb&quot;) f.write(resp.content) f.close() print(name + &quot;ä¸‹è½½æˆåŠŸ&quot;)def get_song_url(dic): data = &#123;&quot;csrf_token&quot;: &quot;&quot;, &quot;encodeType&quot;: &quot;aac&quot;, &quot;ids&quot;: f&quot;[&#123;dic[&#x27;id&#x27;]&#125;]&quot;, &quot;level&quot;: &quot;standard&quot; &#125; data = GetData.get_data(data) url = &quot;https://music.163.com/weapi/song/enhance/player/url/v1?csrf_token=&quot; resp = requests.post(url=url, data=data) song_url = resp.json()[&quot;data&quot;][0][&quot;url&quot;] _download_song(song_url, dic[&quot;song_name&quot;] + &quot;_&quot; + dic[&quot;singer&quot;]) ä¸»å‡½æ•°è°ƒç”¨ï¼š 12345678910if __name__ == &#x27;__main__&#x27;: print(&quot;ä»…ä¾›å­¦ä¹ äº¤æµï¼Œä¸¥ç¦ç”¨äºå•†ä¸šç”¨é€”ï¼Œè¯·äº24å°æ—¶å†…åˆ é™¤ï¼&quot;) search = input(&quot;è¯·è¾“å…¥è¦æœç´¢çš„æ­Œæ›²æˆ–æ­Œæ‰‹&quot;) list = GetSongId.show_list(search) index = input(&quot;è¯·é€‰æ‹©ä»¥ä¸Šçš„åºå·(-1å–æ¶ˆ)&quot;) if index != -1: Download.get_song_url(list[int(index)-1]) ç›®å‰2022&#x2F;8&#x2F;6ä¸ºæ­¢ï¼Œä½¿ç”¨æ­£å¸¸","categories":[{"name":"Python","slug":"Python","permalink":"http://example.com/categories/Python/"},{"name":"çˆ¬è™«","slug":"Python/çˆ¬è™«","permalink":"http://example.com/categories/Python/%E7%88%AC%E8%99%AB/"}],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://example.com/tags/%E7%88%AC%E8%99%AB/"},{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"}]},{"title":"(æ¯æ—¥LeetCode)1408. æ•°ç»„ä¸­çš„å­—ç¬¦ä¸²åŒ¹é…","slug":"æ¯æ—¥LeetCode/2022-8/1408 æ•°ç»„ä¸­çš„å­—ç¬¦ä¸²åŒ¹é…","date":"2022-08-06T10:43:00.000Z","updated":"2022-08-06T10:43:21.143Z","comments":true,"path":"2022/08/06/æ¯æ—¥LeetCode/2022-8/1408 æ•°ç»„ä¸­çš„å­—ç¬¦ä¸²åŒ¹é…/","link":"","permalink":"http://example.com/2022/08/06/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1408%20%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ words ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²éƒ½å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå•è¯ã€‚è¯·ä½ æŒ‰ ä»»æ„ é¡ºåºè¿”å› words ä¸­æ˜¯å…¶ä»–å•è¯çš„å­å­—ç¬¦ä¸²çš„æ‰€æœ‰å•è¯ã€‚ å¦‚æœä½ å¯ä»¥åˆ é™¤ words[j] æœ€å·¦ä¾§å’Œ&#x2F;æˆ–æœ€å³ä¾§çš„è‹¥å¹²å­—ç¬¦å¾—åˆ° word[i] ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸² words[i] å°±æ˜¯ words[j] çš„ä¸€ä¸ªå­å­—ç¬¦ä¸²ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šwords &#x3D; [â€œmassâ€,â€asâ€,â€heroâ€,â€superheroâ€]è¾“å‡ºï¼š[â€œasâ€,â€heroâ€]è§£é‡Šï¼šâ€asâ€ æ˜¯ â€œmassâ€ çš„å­å­—ç¬¦ä¸²ï¼Œâ€heroâ€ æ˜¯ â€œsuperheroâ€ çš„å­å­—ç¬¦ä¸²ã€‚[â€œheroâ€,â€asâ€] ä¹Ÿæ˜¯æœ‰æ•ˆçš„ç­”æ¡ˆ æ€è·¯ï¼šæš´åŠ›æšä¸¾ä¸æ¯ä¸ªå­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é… ä»£ç (cpp)ï¼š123456789101112131415class Solution &#123;public: vector&lt;string&gt; stringMatching(vector&lt;string&gt;&amp; words) &#123; vector&lt;string&gt; ans; for(int i = 0; i &lt; words.size(); i++)&#123; for(int j = 0; j &lt; words.size(); j++)&#123; if(i != j &amp;&amp; words[j].find(words[i]) != string::npos)&#123; ans.emplace_back(words[i]); break; &#125; &#125; &#125; return ans; &#125;&#125;; å¤æ‚å¯¹åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2 x L^2)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸²æ•°ç»„çš„é•¿åº¦ï¼ŒL æ˜¯å­—ç¬¦ä¸²æ•°ç»„ä¸­æœ€é•¿å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ä½¿ç”¨ KMP å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•å¯ä»¥å°†æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–åˆ° O(n^2 Ã— T)ï¼Œå…¶ä¸­ T æ˜¯å­—ç¬¦ä¸²æ•°ç»„ä¸­æ‰€æœ‰å­—ç¬¦ä¸²çš„å¹³å‡é•¿åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚è¿”å›å€¼ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚å¦‚æœä½¿ç”¨ KMP å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼Œé‚£ä¹ˆå¯¹åº”çš„ç©ºé—´å¤æ‚åº¦ä¸º O(T)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)623. åœ¨äºŒå‰æ ‘ä¸­å¢åŠ ä¸€è¡Œ","slug":"æ¯æ—¥LeetCode/2022-8/623 åœ¨äºŒå‰æ ‘ä¸­å¢åŠ ä¸€è¡Œ","date":"2022-08-05T02:57:00.000Z","updated":"2022-08-05T03:03:21.698Z","comments":true,"path":"2022/08/05/æ¯æ—¥LeetCode/2022-8/623 åœ¨äºŒå‰æ ‘ä¸­å¢åŠ ä¸€è¡Œ/","link":"","permalink":"http://example.com/2022/08/05/%E6%AF%8F%E6%97%A5LeetCode/2022-8/623%20%E5%9C%A8%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%AD%E5%A2%9E%E5%8A%A0%E4%B8%80%E8%A1%8C/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹ root å’Œä¸¤ä¸ªæ•´æ•° val å’Œ depth ï¼Œåœ¨ç»™å®šçš„æ·±åº¦ depth å¤„æ·»åŠ ä¸€ä¸ªå€¼ä¸º val çš„èŠ‚ç‚¹è¡Œã€‚ æ³¨æ„ï¼Œæ ¹èŠ‚ç‚¹ root ä½äºæ·±åº¦ 1 ã€‚ åŠ æ³•è§„åˆ™å¦‚ä¸‹: ç»™å®šæ•´æ•° depthï¼Œå¯¹äºæ·±åº¦ä¸º depth - 1 çš„æ¯ä¸ªéç©ºæ ‘èŠ‚ç‚¹ cur ï¼Œåˆ›å»ºä¸¤ä¸ªå€¼ä¸º val çš„æ ‘èŠ‚ç‚¹ä½œä¸º cur çš„å·¦å­æ ‘æ ¹å’Œå³å­æ ‘æ ¹ã€‚ cur åŸæ¥çš„å·¦å­æ ‘åº”è¯¥æ˜¯æ–°çš„å·¦å­æ ‘æ ¹çš„å·¦å­æ ‘ã€‚ cur åŸæ¥çš„å³å­æ ‘åº”è¯¥æ˜¯æ–°çš„å³å­æ ‘æ ¹çš„å³å­æ ‘ã€‚ å¦‚æœ depth == 1 æ„å‘³ç€ depth - 1 æ ¹æœ¬æ²¡æœ‰æ·±åº¦ï¼Œé‚£ä¹ˆåˆ›å»ºä¸€ä¸ªæ ‘èŠ‚ç‚¹ï¼Œå€¼ val ä½œä¸ºæ•´ä¸ªåŸå§‹æ ‘çš„æ–°æ ¹ï¼Œè€ŒåŸå§‹æ ‘å°±æ˜¯æ–°æ ¹çš„å·¦å­æ ‘ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: root &#x3D; [4,2,6,3,1,5], val &#x3D; 1, depth &#x3D; 2è¾“å‡º: [4,1,1,2,null,null,6,3,1,5] æˆ‘è‡ªå·±å†™çš„é€’å½’å¾ˆçƒ‚ï¼Œä¸å¦‚å®˜æ–¹çš„çš„è§„èŒƒã€æ•´æ´ï¼ä½†æ˜¯æ•ˆç‡åŸºæœ¬å·®ä¸å¤šï¼ 12345678910111213141516171819202122class Solution &#123;public: TreeNode* def(TreeNode* root, int&amp; val, int curDepth, int&amp; depth, int choice)&#123; if(curDepth == depth - 1) &#123; if(choice == 1) return new TreeNode(val, root, nullptr); else return new TreeNode(val, nullptr, root); &#125; if(root == nullptr) return nullptr; root-&gt;left = def(root-&gt;left, val, curDepth + 1, depth, 1); root-&gt;right = def(root-&gt;right, val, curDepth + 1, depth, 2); return root; &#125; TreeNode* addOneRow(TreeNode* root, int val, int depth) &#123; return def(root, val, 0, depth, 1); &#125;&#125;; ä¸‹é¢æ˜¯å®˜æ–¹çš„é€’å½’æ€è·¯ï¼ æ€è·¯ï¼šé€’å½’ä»¥ç¤ºä¾‹ä¸­å›¾ç‰‡è¾“å‡ºåçš„äºŒå‰æ ‘ä¸ºä¾‹ï¼š[4,1,1,2,null,null,6,3,1,5] å¦‚æœè¦åœ¨æ·±åº¦depthä¸º3çš„ä½ç½®æ’å…¥æ–°å…ƒç´ ï¼š ç¬¬ä¸€æ¬¡é€’å½’ï¼šè¿™å±‚å…ƒç´ ç”±4 å˜æˆäº†å…ƒç´ 4çš„å·¦å³èŠ‚ç‚¹1å’Œ1ï¼Œæ·±åº¦depthå‡ä¸€å˜ä¸º2 å¦‚æœæ·±åº¦depthä¸º2çš„æƒ…å†µä¸‹ï¼Œè¿™å±‚çš„èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å°±æ˜¯è¦æ’å…¥æ–°å…ƒç´ çš„ä½ç½®ï¼Œ ä»¥è¿™å±‚å·¦èŠ‚ç‚¹å…ƒç´ ä¸ºä¾‹ï¼Œå…ƒç´ 1ã€‚åˆ›å»ºæ–°èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹æŒ‡å‘å…ƒç´ 1çš„å·¦èŠ‚ç‚¹ï¼Œå…ƒç´ 1çš„å·¦èŠ‚ç‚¹å˜ä¸ºæ–°èŠ‚ç‚¹ã€‚è¿™å±‚å³èŠ‚ç‚¹åŒç†ã€‚åˆ°è¾¾æ·±åº¦ä¸º2çš„æƒ…å†µï¼Œç›´æ¥è¿”å›ä¸ä¼šåˆ°è¾¾æ·±åº¦ä¸º1çš„æƒ…å†µã€‚ åªæœ‰åœ¨åˆå§‹åŒ–æ·±åº¦depthä¸º1çš„æƒ…å†µä¸‹ï¼Œè¯´æ˜è¦åœ¨æ ¹èŠ‚ç‚¹rootå¤„æ’å…¥æ–°å…ƒç´ ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹rootï¼Œå°†æ ¹èŠ‚ç‚¹rootæŒ‡å‘ä¸ºæ–°èŠ‚ç‚¹ï¼Œå®Œæˆæ’å…¥ã€‚ å¹¶ä¸”æ·±åº¦ä¸ºn(é™¤äº†æ·±åº¦ä¸º1çš„æƒ…å†µ)ï¼Œåªè¦é€’å½’åˆ°æ·±åº¦depthå˜ä¸º2å°±å¯ä»¥æ’å…¥æ–°å…ƒç´ ã€‚ ä»£ç (cpp)ï¼š12345678910111213141516171819202122class Solution &#123;public: TreeNode* addOneRow(TreeNode* root, int val, int depth) &#123; if(root == nullptr) return nullptr; //æ·±åº¦ä¸º1çš„æƒ…å†µï¼Œæ–°èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹å˜ä¸ºæ–°èŠ‚ç‚¹ if(depth == 1) return new TreeNode(val, root, nullptr); if(depth == 2) &#123; //æ·±åº¦ä¸º2çš„æƒ…å†µ //æ–°èŠ‚ç‚¹æŒ‡å‘è¯¥èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ root-&gt;left = new TreeNode(val, root-&gt;left, nullptr); //æ–°èŠ‚ç‚¹æŒ‡å‘è¯¥èŠ‚ç‚¹çš„å³èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹çš„å³èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ root-&gt;right = new TreeNode(val, nullptr, root-&gt;right); &#125; else &#123; //é€’å½’åˆ°è¯¥èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹ï¼Œæ·±åº¦å‡ä¸€ root-&gt;left = addOneRow(root-&gt;left, val, depth - 1); //é€’å½’åˆ°è¯¥èŠ‚ç‚¹çš„å³èŠ‚ç‚¹ï¼Œæ·±åº¦å‡ä¸€ root-&gt;right = addOneRow(root-&gt;right, val, depth - 1); &#125; return root; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºè¾“å…¥çš„æ ‘çš„èŠ‚ç‚¹æ•°ã€‚æœ€åæƒ…å†µä¸‹ï¼Œéœ€è¦éå†æ•´æ£µæ ‘ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œé€’å½’çš„æ·±åº¦æœ€å¤šä¸º O(n)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1403. éé€’å¢é¡ºåºçš„æœ€å°å­åºåˆ—","slug":"æ¯æ—¥LeetCode/2022-8/1403 éé€’å¢é¡ºåºçš„æœ€å°å­åºåˆ—","date":"2022-08-04T04:09:00.000Z","updated":"2022-08-04T04:09:24.395Z","comments":true,"path":"2022/08/04/æ¯æ—¥LeetCode/2022-8/1403 éé€’å¢é¡ºåºçš„æœ€å°å­åºåˆ—/","link":"","permalink":"http://example.com/2022/08/04/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1403%20%E9%9D%9E%E9%80%92%E5%A2%9E%E9%A1%BA%E5%BA%8F%E7%9A%84%E6%9C%80%E5%B0%8F%E5%AD%90%E5%BA%8F%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•°ç»„ numsï¼Œè¯·ä½ ä»ä¸­æŠ½å–ä¸€ä¸ªå­åºåˆ—ï¼Œæ»¡è¶³è¯¥å­åºåˆ—çš„å…ƒç´ ä¹‹å’Œ ä¸¥æ ¼ å¤§äºæœªåŒ…å«åœ¨è¯¥å­åºåˆ—ä¸­çš„å„å…ƒç´ ä¹‹å’Œã€‚ å¦‚æœå­˜åœ¨å¤šä¸ªè§£å†³æ–¹æ¡ˆï¼Œåªéœ€è¿”å› é•¿åº¦æœ€å° çš„å­åºåˆ—ã€‚å¦‚æœä»ç„¶æœ‰å¤šä¸ªè§£å†³æ–¹æ¡ˆï¼Œåˆ™è¿”å› å…ƒç´ ä¹‹å’Œæœ€å¤§ çš„å­åºåˆ—ã€‚ ä¸å­æ•°ç»„ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œã€Œæ•°ç»„çš„å­åºåˆ—ã€ä¸å¼ºè°ƒå…ƒç´ åœ¨åŸæ•°ç»„ä¸­çš„è¿ç»­æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯ä»¥é€šè¿‡ä»æ•°ç»„ä¸­åˆ†ç¦»ä¸€äº›ï¼ˆä¹Ÿå¯èƒ½ä¸åˆ†ç¦»ï¼‰å…ƒç´ å¾—åˆ°ã€‚ æ³¨æ„ï¼Œé¢˜ç›®æ•°æ®ä¿è¯æ»¡è¶³æ‰€æœ‰çº¦æŸæ¡ä»¶çš„è§£å†³æ–¹æ¡ˆæ˜¯ å”¯ä¸€ çš„ã€‚åŒæ—¶ï¼Œè¿”å›çš„ç­”æ¡ˆåº”å½“æŒ‰ éé€’å¢é¡ºåº æ’åˆ—ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [4,4,7,6,7]è¾“å‡ºï¼š[7,7,6]è§£é‡Šï¼šå­åºåˆ— [7,7] çš„å’Œä¸º 14 ï¼Œä¸ä¸¥æ ¼å¤§äºå‰©ä¸‹çš„å…¶ä»–å…ƒç´ ä¹‹å’Œï¼ˆ14 &#x3D; 4 + 4 + 6ï¼‰ã€‚å› æ­¤ï¼Œ[7,6,7] æ˜¯æ»¡è¶³é¢˜æ„çš„æœ€å°å­åºåˆ—ã€‚æ³¨æ„ï¼Œå…ƒç´ æŒ‰éé€’å¢é¡ºåºè¿”å›ã€‚ æˆ‘è‡ªå·±çš„æ€è·¯ï¼šåŒæŒ‡é’ˆ 123456789101112131415161718192021222324class Solution &#123;public: vector&lt;int&gt; minSubsequence(vector&lt;int&gt;&amp; nums) &#123; sort(nums.begin(), nums.end()); int right = nums.size() - 1; vector&lt;int&gt; ans; int left = 0; int ans_sum = 0; int temp = 0; while(left &lt;= right)&#123; ans.push_back(nums[right]); ans_sum += nums[right]; right--; while(temp &lt; ans_sum &amp;&amp; left &lt;= right)&#123; temp += nums[left]; left++; &#125; &#125; if(ans_sum &lt;= temp)&#123; ans.push_back(nums[right]); &#125; return ans; &#125;&#125;; å¯ä»¥é€šè¿‡ä½†æ˜¯æ•ˆç‡å¾ˆä½ï¼ä¸‹é¢æ˜¯å®˜æ–¹æ€è·¯ï¼ æ€è·¯ï¼šè´ªå¿ƒå…ˆè®¡ç®—å‡ºæ•°ç»„ä¸­å„ä¸ªå…ƒç´ åŠ èµ·æ¥çš„æ€»åˆsum å†è¿›è¡Œä»å¤§åˆ°å°çš„éå†å…ƒç´ åŠ èµ·æ¥çš„åˆcurï¼Œç›´åˆ°è¯¥å­åºåˆ—çš„å…ƒç´ ä¹‹å’Œcurå¤§äºæœªåŒ…å«åœ¨è¯¥å­åºåˆ—ä¸­çš„å„å…ƒç´ ä¹‹å’Œsum-curåœæ­¢ã€‚ ä»£ç (cpp)ï¼š1234567891011121314151617181920class Solution &#123;public: vector&lt;int&gt; minSubsequence(vector&lt;int&gt;&amp; nums) &#123; int sum = 0; for(auto num : nums)&#123; //è®¡ç®—æ€»å’Œ sum += num; &#125; sort(nums.begin(), nums.end()); //æ’åº vector&lt;int&gt; ans; int cur = 0; for(int i = nums.size() - 1; i &gt;= 0; i--)&#123; ans.emplace_back(nums[i]); //å°¾éƒ¨æ’å…¥ cur += nums[i]; //è®¡ç®—cur if(sum - cur &lt; cur)&#123; //å¦‚æœè¯¥å­åºåˆ—åˆ å¤§äº æœªåœ¨å­åºåˆ—ä¸­çš„åˆ break; &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n ä¸ºæ•°ç»„çš„é•¿åº¦ã€‚éœ€è¦å¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ O(nlogn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå…¶ä¸­ n ä¸ºæ•°ç»„çš„é•¿åº¦ã€‚æ’åºéœ€è¦çš„æ ˆç©ºé—´ä¸º O(logn)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)899. æœ‰åºé˜Ÿåˆ—","slug":"æ¯æ—¥LeetCode/2022-8/899 æœ‰åºé˜Ÿåˆ—","date":"2022-08-03T01:37:00.000Z","updated":"2022-08-03T01:37:42.753Z","comments":true,"path":"2022/08/03/æ¯æ—¥LeetCode/2022-8/899 æœ‰åºé˜Ÿåˆ—/","link":"","permalink":"http://example.com/2022/08/03/%E6%AF%8F%E6%97%A5LeetCode/2022-8/899%20%E6%9C%89%E5%BA%8F%E9%98%9F%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s å’Œä¸€ä¸ªæ•´æ•° k ã€‚ä½ å¯ä»¥ä» s çš„å‰ k ä¸ªå­—æ¯ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œå¹¶æŠŠå®ƒåŠ åˆ°å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚ è¿”å› åœ¨åº”ç”¨ä¸Šè¿°æ­¥éª¤çš„ä»»æ„æ•°é‡çš„ç§»åŠ¨åï¼Œå­—å…¸ä¸Šæœ€å°çš„å­—ç¬¦ä¸² ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šs &#x3D; â€œcbaâ€, k &#x3D; 1è¾“å‡ºï¼šâ€acbâ€è§£é‡Šï¼šåœ¨ç¬¬ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼ˆâ€œcâ€ï¼‰ç§»åŠ¨åˆ°æœ€åï¼Œè·å¾—å­—ç¬¦ä¸² â€œbacâ€ã€‚åœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œæˆ‘ä»¬å°†ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼ˆâ€œbâ€ï¼‰ç§»åŠ¨åˆ°æœ€åï¼Œè·å¾—æœ€ç»ˆç»“æœ â€œacbâ€ã€‚ æ€è·¯ï¼šè„‘ç­‹æ€¥è½¬å¼¯ä»¥s &#x3D; â€œcbaâ€ä¸ºä¾‹ï¼š å½“k &#x3D; 1æ—¶ï¼Œæ— è®ºç»è¿‡å¤šå°‘æ¬¡ç§»åŠ¨ï¼Œæœ€å°çš„å­—ç¬¦ä¸²ä¸ºâ€acbâ€ï¼Œå¹¶ä¸æ˜¯â€æœ€ç»ˆâ€æœ€å°çš„å­—ç¬¦äº§â€abcâ€ æ‰€ä»¥è¦ä¾æ¬¡éå†æ‰€æœ‰å¯èƒ½ï¼Œæ‰¾å‡ºæœ€å°çš„å­—ç¬¦ä¸² å½“k &gt; 1æ—¶ï¼Œæ— è®ºç»å†å¤šå°‘æ¬¡ç§»åŠ¨ï¼Œæœ€ç»ˆæœ€å°çš„ä¸€å®šæ˜¯â€abcâ€ åªéœ€å¯¹sè¿›è¡Œæ’åº ä»£ç (cpp)ï¼š12345678910111213141516171819202122class Solution &#123;public: string orderlyQueue(string s, int k) &#123; if(k == 1)&#123; //k=1æ—¶ string min_s = s; //åˆå§‹åŒ–æœ€å°çš„å­—ç¬¦ä¸² int size = s.size(); // è·å–å­—ç¬¦ä¸²é•¿åº¦ for(int i = 0; i &lt; size; i++)&#123; char temp = s[0]; //è·å–ç¬¬ä¸€ä¸ªå­—ç¬¦ s = s.substr(1); //æˆªå–é™¤ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå‰©ä¸‹çš„å­—ç¬¦ä¸² s.push_back(temp); //å°†ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼ŒåŠ åˆ°å­—ç¬¦ä¸²çš„åé¢ if(min_s &gt; s)&#123; //è¿›è¡Œæ¯”è¾ƒ min_s = s; &#125; &#125; return min_s; &#125; else&#123; //k&gt;1æ—¶ sort(s.begin(), s.end()); //æ’åº return s; &#125; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸² s çš„é•¿åº¦ã€‚å½“ k &#x3D; 1 æ—¶éœ€è¦éå† n ä¸ªå¯èƒ½çš„å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éœ€è¦ O(n) çš„æ—¶é—´ç”Ÿæˆå’Œåˆ¤æ–­æ˜¯å¦å­—å…¸åºæœ€å°ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ O(n^2)ï¼›å½“ k &gt; 1 æ—¶éœ€è¦å¯¹å­—ç¬¦ä¸²æ’åºï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogn)ã€‚æœ€åæƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦æ˜¯ O(n^2)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n) æˆ– O(logn)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸² s çš„é•¿åº¦ã€‚ç©ºé—´å¤æ‚åº¦å–å†³äºå…·ä½“å®ç°çš„è¯­è¨€ã€‚å¯¹äºå­—ç¬¦ä¸²ä¸å¯å˜çš„è¯­è¨€ï¼Œå½“ k &#x3D; 1 æ—¶ç”Ÿæˆæ¯ä¸ªå­—ç¬¦ä¸²å’Œå½“ k &gt; 1 æ—¶ç”Ÿæˆæ’åºåçš„å­—ç¬¦ä¸²éƒ½éœ€è¦ O(n) çš„ç©ºé—´ï¼›å¯¹äºå­—ç¬¦ä¸²å¯å˜çš„è¯­è¨€ï¼Œå¯ä»¥çœç•¥ O(n) çš„ç©ºé—´ï¼Œåªæœ‰å½“ k &gt; 1 æ—¶æ’åºéœ€è¦ O(logn) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)622. è®¾è®¡å¾ªç¯é˜Ÿåˆ—","slug":"æ¯æ—¥LeetCode/2022-8/622 è®¾è®¡å¾ªç¯é˜Ÿåˆ—","date":"2022-08-02T04:15:00.000Z","updated":"2022-09-27T14:18:46.266Z","comments":true,"path":"2022/08/02/æ¯æ—¥LeetCode/2022-8/622 è®¾è®¡å¾ªç¯é˜Ÿåˆ—/","link":"","permalink":"http://example.com/2022/08/02/%E6%AF%8F%E6%97%A5LeetCode/2022-8/622%20%E8%AE%BE%E8%AE%A1%E5%BE%AA%E7%8E%AF%E9%98%9F%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šè®¾è®¡ä½ çš„å¾ªç¯é˜Ÿåˆ—å®ç°ã€‚ å¾ªç¯é˜Ÿåˆ—æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…¶æ“ä½œè¡¨ç°åŸºäº FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¹¶ä¸”é˜Ÿå°¾è¢«è¿æ¥åœ¨é˜Ÿé¦–ä¹‹åä»¥å½¢æˆä¸€ä¸ªå¾ªç¯ã€‚å®ƒä¹Ÿè¢«ç§°ä¸ºâ€œç¯å½¢ç¼“å†²å™¨â€ã€‚ å¾ªç¯é˜Ÿåˆ—çš„ä¸€ä¸ªå¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªé˜Ÿåˆ—ä¹‹å‰ç”¨è¿‡çš„ç©ºé—´ã€‚åœ¨ä¸€ä¸ªæ™®é€šé˜Ÿåˆ—é‡Œï¼Œä¸€æ—¦ä¸€ä¸ªé˜Ÿåˆ—æ»¡äº†ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æ’å…¥ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå³ä½¿åœ¨é˜Ÿåˆ—å‰é¢ä»æœ‰ç©ºé—´ã€‚ä½†æ˜¯ä½¿ç”¨å¾ªç¯é˜Ÿåˆ—ï¼Œæˆ‘ä»¬èƒ½ä½¿ç”¨è¿™äº›ç©ºé—´å»å­˜å‚¨æ–°çš„å€¼ã€‚ ä½ çš„å®ç°åº”è¯¥æ”¯æŒå¦‚ä¸‹æ“ä½œï¼š MyCircularQueue(k)ï¼šæ„é€ å™¨ï¼Œè®¾ç½®é˜Ÿåˆ—é•¿åº¦ä¸º k ã€‚ Front()ï¼šä»é˜Ÿé¦–è·å–å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚ Rear()ï¼šè·å–é˜Ÿå°¾å…ƒç´ ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å› -1 ã€‚ enQueue(value)ï¼šå‘å¾ªç¯é˜Ÿåˆ—æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæˆåŠŸæ’å…¥åˆ™è¿”å›çœŸã€‚ deQueue()ï¼šä»å¾ªç¯é˜Ÿåˆ—ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæˆåŠŸåˆ é™¤åˆ™è¿”å›çœŸã€‚ isEmpty()ï¼šæ£€æŸ¥å¾ªç¯é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚ isFull()ï¼šæ£€æŸ¥å¾ªç¯é˜Ÿåˆ—æ˜¯å¦å·²æ»¡ã€‚ ç¤ºä¾‹ï¼š MyCircularQueue circularQueue &#x3D; new MyCircularQueue(3); &#x2F;&#x2F; è®¾ç½®é•¿åº¦ä¸º 3circularQueue.enQueue(1); &#x2F;&#x2F; è¿”å› truecircularQueue.enQueue(2); &#x2F;&#x2F; è¿”å› truecircularQueue.enQueue(3); &#x2F;&#x2F; è¿”å› truecircularQueue.enQueue(4); &#x2F;&#x2F; è¿”å› falseï¼Œé˜Ÿåˆ—å·²æ»¡circularQueue.Rear(); &#x2F;&#x2F; è¿”å› 3circularQueue.isFull(); &#x2F;&#x2F; è¿”å› truecircularQueue.deQueue(); &#x2F;&#x2F; è¿”å› truecircularQueue.enQueue(4); &#x2F;&#x2F; è¿”å› truecircularQueue.Rear(); &#x2F;&#x2F; è¿”å› 4 æ€è·¯ï¼šæ•°ç»„åˆå§‹åŒ–(ç©ºæ ˆ)ï¼š ä»¥ç¤ºä¾‹ä¸ºä¾‹ï¼Œè®¾ç½®é•¿åº¦kä¸º3ï¼Œä½†æ˜¯åˆå§‹åŒ–çš„å®é™…å®¹é‡capacityåº”è¯¥ä¸ºk+1å³ä¸º4 åˆå§‹åŒ–å¤´èŠ‚ç‚¹frontä»¥åŠå°¾èŠ‚ç‚¹rearä¸º0å·ä½ç½® æ³¨æ„ï¼šrearæŒ‡å‘çš„ä½ç½®ä¸æ˜¯æœ«å°¾çš„å…ƒç´ ï¼Œè€Œæ˜¯æœ«å°¾çš„å…ƒç´ çš„ä¸‹ä¸€ä½ç½® æ˜¯å¦ä¸ºç©ºåˆ¤æ–­ï¼šfrontä¸rearæ˜¯å¦å†åŒä¸€ä¸ªä½ç½®ï¼Œå³front == rear front$\\Downarrow$ 0 1 2 3 ç©º ç©º ç©º ç©º $\\Uparrow$rear å¦‚ä½•å¾ªç¯ï¼Ÿï¼š å°†rearæŒ‡é’ˆæ‰€åœ¨çš„3å·ä½ç½®èµ‹å€¼ä¸º4åï¼Œéœ€è¦å°†rearæŒ‡é’ˆåç§»ï¼Œä½†æ˜¯rear+1åä¼šå¯¼è‡´è¶Šç•Œ æˆ‘ä»¬å¸Œæœ›rearæŒ‡é’ˆåº”è¯¥ç§»åŠ¨åˆ°0å·ä½ç½®ï¼Œå¯ä»¥è¿›è¡Œå–ä½™æ“ä½œï¼š(rear + 1) % capacity rearæŒ‡é’ˆå½“å‰çš„ä½ç½®ä¸º3ï¼Œå®¹é‡capacityä¸º4ï¼Œå¸¦å…¥å…¬å¼ï¼š(3 + 1) % 4 = 0 rearæŒ‡é’ˆç§»åŠ¨æˆ‘ä»¬æ‰€æƒ³è¦çš„åˆ°è¾¾çš„0å·ä½ç½® front$\\Downarrow$ 0 1 2 3 ç©º ç©º 3 ç©º $\\Uparrow$rear front$\\Downarrow$ 0 1 2 3 ç©º ç©º 3 4 $\\Uparrow$rear æ»¡åˆ—çš„æƒ…å†µï¼š å½“å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ä¸º3æ—¶ï¼Œå°±è¾¾åˆ°æ»¡åˆ—çš„æƒ…å†µ åˆ¤æ–­æ˜¯å¦ä¸ºæ»¡åˆ—ï¼šrearæŒ‡é’ˆåç§»ï¼Œå¦‚æœfrontä¸rearåœ¨åŒä¸€ä½ç½®ï¼Œåˆ™è¯´æ˜æ»¡åˆ— å³(rear + 1) % capacity == front front$\\Downarrow$ 0 1 2 3 1 2 3 ç©º $\\Uparrow$rear æ³¨æ„ï¼šä¹Ÿå¯ä»¥ä½¿ç”¨é“¾è¡¨å®ç°é˜Ÿåˆ—è§£å†³è¯¥é—®é¢˜ï¼ï¼ç”¨é“¾è¡¨å®ç°é˜Ÿåˆ—æ›´ç®€å• ä»£ç (cpp)ï¼šä»¥ä¸‹ä¸ºæ•°ç»„å®ç°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859class MyCircularQueue &#123;private: vector&lt;int&gt; queue; // é˜Ÿåˆ— int capacity; //å®¹é‡ int front; //å¤´èŠ‚ç‚¹ int rear; //å°¾èŠ‚ç‚¹public: MyCircularQueue(int k) &#123; this-&gt;capacity = k + 1; this-&gt;queue = vector&lt;int&gt;(this-&gt;capacity); //åˆå§‹åŒ–å®¹é‡ä¸ºk+1 this-&gt;front = 0; //åˆå§‹åŒ–å¤´èŠ‚ç‚¹ this-&gt;rear = 0; //åˆå§‹åŒ–å°¾èŠ‚ç‚¹ &#125; //å…¥åˆ— bool enQueue(int value) &#123; //åˆ¤æ–­æ˜¯å¦ä¸ºæ»¡åˆ— if(this-&gt;isFull()) return false; //æ’å…¥é˜Ÿåˆ— queue[this-&gt;rear] = value; //rearæŒ‡é’ˆåç§» this-&gt;rear = (this-&gt;rear + 1) % this-&gt;capacity; return true; &#125; //å‡ºåˆ— bool deQueue() &#123; //åˆ¤æ–­æ˜¯å¦ä¸ºç©º if(this-&gt;isEmpty()) return false; //frontæŒ‡é’ˆåç§» this-&gt;front = (this-&gt;front + 1) % this-&gt;capacity; return true; &#125; int Front() &#123; //åˆ¤æ–­æ˜¯å¦ä¸ºç©º if(this-&gt;isEmpty()) return -1; //è¿”å›å¤´èŠ‚ç‚¹çš„å…ƒç´  return queue[this-&gt;front]; &#125; int Rear() &#123; // åˆ¤æ–­æ˜¯å¦ä¸ºç©º if(this-&gt;isEmpty()) return -1; //rearæŒ‡é’ˆä¸ºæœ«å°¾å…ƒç´ çš„ä¸‹ä¸€ä½ï¼Œè¦å›åˆ°ä¸Šä¸€ä½ç½® //å¦‚æœrear=0ï¼Œä»£å…¥å…¬å¼ï¼š(0 - 1 + 4) % 4 = 3ï¼›3ä¸ºä¸Šä¸€ä¸ªä½ç½® int temp = (this-&gt;rear - 1 + this-&gt;capacity) % this-&gt;capacity; //è¿”å›è¯¥ä½ç½®çš„å…ƒç´  return queue[temp]; &#125; bool isEmpty() &#123; //åˆ¤æ–­å¤´èŠ‚ç‚¹ä¸å°¾èŠ‚ç‚¹æ˜¯å¦åœ¨åŒä¸€ä½ç½® return this-&gt;front == this-&gt;rear; &#125; bool isFull() &#123; //åˆ¤æ–­å°¾èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªä½ç½®æ˜¯å¦ä¸å¤´èŠ‚ç‚¹åœ¨åŒä¸€ä½ç½® return (this-&gt;rear + 1) % this-&gt;capacity == this-&gt;front; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šåˆå§‹åŒ–å’Œæ¯é¡¹æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‡ä¸º O(1)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(k)ï¼Œå…¶ä¸­ k ä¸ºç»™å®šçš„é˜Ÿåˆ—å…ƒç´ æ•°ç›®ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1374. ç”Ÿæˆæ¯ç§å­—ç¬¦éƒ½æ˜¯å¥‡æ•°ä¸ªçš„å­—ç¬¦ä¸²","slug":"æ¯æ—¥LeetCode/2022-8/1374 ç”Ÿæˆæ¯ç§å­—ç¬¦éƒ½æ˜¯å¥‡æ•°ä¸ªçš„å­—ç¬¦ä¸²","date":"2022-08-01T03:00:00.000Z","updated":"2022-08-01T03:00:51.761Z","comments":true,"path":"2022/08/01/æ¯æ—¥LeetCode/2022-8/1374 ç”Ÿæˆæ¯ç§å­—ç¬¦éƒ½æ˜¯å¥‡æ•°ä¸ªçš„å­—ç¬¦ä¸²/","link":"","permalink":"http://example.com/2022/08/01/%E6%AF%8F%E6%97%A5LeetCode/2022-8/1374%20%E7%94%9F%E6%88%90%E6%AF%8F%E7%A7%8D%E5%AD%97%E7%AC%A6%E9%83%BD%E6%98%AF%E5%A5%87%E6%95%B0%E4%B8%AA%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•° nï¼Œè¯·ä½ è¿”å›ä¸€ä¸ªå« n ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­æ¯ç§å­—ç¬¦åœ¨è¯¥å­—ç¬¦ä¸²ä¸­éƒ½æ°å¥½å‡ºç° å¥‡æ•°æ¬¡ ã€‚ è¿”å›çš„å­—ç¬¦ä¸²å¿…é¡»åªå«å°å†™è‹±æ–‡å­—æ¯ã€‚å¦‚æœå­˜åœ¨å¤šä¸ªæ»¡è¶³é¢˜ç›®è¦æ±‚çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å…¶ä¸­ä»»æ„ä¸€ä¸ªå³å¯ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šn &#x3D; 4è¾“å‡ºï¼šâ€pppzâ€è§£é‡Šï¼šâ€pppzâ€ æ˜¯ä¸€ä¸ªæ»¡è¶³é¢˜ç›®è¦æ±‚çš„å­—ç¬¦ä¸²ï¼Œå› ä¸º â€˜pâ€™ å‡ºç° 3 æ¬¡ï¼Œä¸” â€˜zâ€™ å‡ºç° 1 æ¬¡ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–å­—ç¬¦ä¸²ä¹Ÿæ»¡è¶³é¢˜ç›®è¦æ±‚ï¼Œæ¯”å¦‚ï¼šâ€ohhhâ€ å’Œ â€œloveâ€ã€‚ å¤šè¯´æ— ç›Šï¼ ä»£ç (cpp)ï¼š1234567891011class Solution &#123;public: string generateTheString(int n) &#123; if(n%2 == 0)&#123; return string(n-1,&#x27;a&#x27;) + &#x27;b&#x27;; &#125; else&#123; return string(n, &#x27;a&#x27;); &#125; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚è¿™é‡Œä¸è®¡å…¥è¿”å›å€¼éœ€è¦çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1161. æœ€å¤§å±‚å†…å…ƒç´ å’Œ","slug":"æ¯æ—¥LeetCode/2022-7/1161 æœ€å¤§å±‚å†…å…ƒç´ å’Œ","date":"2022-07-31T03:29:00.000Z","updated":"2022-07-31T03:29:48.084Z","comments":true,"path":"2022/07/31/æ¯æ—¥LeetCode/2022-7/1161 æœ€å¤§å±‚å†…å…ƒç´ å’Œ/","link":"","permalink":"http://example.com/2022/07/31/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1161%20%E6%9C%80%E5%A4%A7%E5%B1%82%E5%86%85%E5%85%83%E7%B4%A0%E5%92%8C/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ rootã€‚è®¾æ ¹èŠ‚ç‚¹ä½äºäºŒå‰æ ‘çš„ç¬¬ 1 å±‚ï¼Œè€Œæ ¹èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä½äºç¬¬ 2 å±‚ï¼Œä¾æ­¤ç±»æ¨ã€‚ è¯·è¿”å›å±‚å†…å…ƒç´ ä¹‹å’Œ æœ€å¤§ çš„é‚£å‡ å±‚ï¼ˆå¯èƒ½åªæœ‰ä¸€å±‚ï¼‰çš„å±‚å·ï¼Œå¹¶è¿”å›å…¶ä¸­ æœ€å° çš„é‚£ä¸ªã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [1,7,0,7,-8,null,null]è¾“å‡ºï¼š2è§£é‡Šï¼šç¬¬ 1 å±‚å„å…ƒç´ ä¹‹å’Œä¸º 1ï¼Œç¬¬ 2 å±‚å„å…ƒç´ ä¹‹å’Œä¸º 7 + 0 &#x3D; 7ï¼Œç¬¬ 3 å±‚å„å…ƒç´ ä¹‹å’Œä¸º 7 + -8 &#x3D; -1ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å›ç¬¬ 2 å±‚çš„å±‚å·ï¼Œå®ƒçš„å±‚å†…å…ƒç´ ä¹‹å’Œæœ€å¤§ã€‚ æ€è·¯ï¼šä½¿ç”¨é˜Ÿåˆ—ï¼Œå±‚åºéå†äºŒå‰æ ‘åŒæ—¶è®¡ç®—å‡ºæ¯å±‚çš„å…ƒç´ ä¹‹å’Œï¼Œæ¯”è¾ƒæ¯å±‚çš„æ€»å’Œï¼Œå¾—å‡ºæœ€å¤§æ€»å’Œæ‰€åœ¨çš„å±‚æ•° ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031323334353637class Solution &#123;public: int maxLevelSum(TreeNode* root) &#123; queue&lt;TreeNode*&gt; q; q.push(root); int max_sum = -999999; //è®¾ç½®æœ€å¤§å…ƒç´ ä¹‹å’Œ int max_level_sum = 1; //è®°å½•æœ€å¤§æ€»å’Œçš„æ‰€åœ¨çš„å±‚ int level_sum = 1; //å½“å‰å±‚æ•° while(!q.empty())&#123; //ç¬¬ä¸€ä¸ªå¾ªç¯ï¼Œéå†å±‚ int size = q.size(); //è·å–å½“å‰å±‚çš„èŠ‚ç‚¹æ•° int sum = 0; //åˆå§‹åŒ–è¯¥å±‚çš„å…ƒç´ ä¹‹å’Œ while(size != 0)&#123; //ç¬¬äºŒä¸ªå¾ªç¯ï¼Œéå†æ¯å±‚çš„èŠ‚ç‚¹ TreeNode* p = q.front(); //è·å–è¯¥èŠ‚ç‚¹ q.pop(); //ç§»é™¤åœ¨é˜Ÿåˆ—ä¸­çš„è¯¥èŠ‚ç‚¹ sum += p-&gt;val; //åŠ ä¸Šè¯¥èŠ‚ç‚¹çš„å€¼ï¼Œè®¡ç®—è¯¥å±‚çš„å…ƒç´ ä¹‹å’Œ if(p-&gt;left != nullptr)&#123; q.push(p-&gt;left); //æ’å…¥ä¸‹ä¸€å±‚çš„å·¦èŠ‚ç‚¹ &#125; if(p-&gt;right != nullptr)&#123; q.push(p-&gt;right);//æ’å…¥ä¸‹ä¸€å±‚çš„å³èŠ‚ç‚¹ &#125; size--; //å·²éå†å®Œgaiè¯¥å±‚èŠ‚ç‚¹æ•°å‡ä¸€ &#125; if(max_sum &lt; sum)&#123; //å¦‚æœè¯¥å±‚çš„å…ƒç´ ä¹‹å’Œå¤§äºä¹‹å‰çš„ max_sum = sum; max_level_sum = level_sum; &#125; level_sum++; //å±‚æ•°åŠ ä¸€ï¼Œè¿›å…¥ä¸‹ä¸€å±‚ &#125; return max_level_sum; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1331. æ•°ç»„åºå·è½¬æ¢","slug":"æ¯æ—¥LeetCode/2022-7/1331 æ•°ç»„åºå·è½¬æ¢","date":"2022-07-28T01:26:00.000Z","updated":"2022-07-28T01:24:01.012Z","comments":true,"path":"2022/07/28/æ¯æ—¥LeetCode/2022-7/1331 æ•°ç»„åºå·è½¬æ¢/","link":"","permalink":"http://example.com/2022/07/28/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1331%20%E6%95%B0%E7%BB%84%E5%BA%8F%E5%8F%B7%E8%BD%AC%E6%8D%A2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ arr ï¼Œè¯·ä½ å°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ›¿æ¢ä¸ºå®ƒä»¬æ’åºåçš„åºå·ã€‚ åºå·ä»£è¡¨äº†ä¸€ä¸ªå…ƒç´ æœ‰å¤šå¤§ã€‚åºå·ç¼–å·çš„è§„åˆ™å¦‚ä¸‹ï¼š åºå·ä» 1 å¼€å§‹ç¼–å·ã€‚ä¸€ä¸ªå…ƒç´ è¶Šå¤§ï¼Œé‚£ä¹ˆåºå·è¶Šå¤§ã€‚å¦‚æœä¸¤ä¸ªå…ƒç´ ç›¸ç­‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„åºå·ç›¸åŒã€‚æ¯ä¸ªæ•°å­—çš„åºå·éƒ½åº”è¯¥å°½å¯èƒ½åœ°å°ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šarr &#x3D; [37,12,28,9,100,56,80,5,12]è¾“å‡ºï¼š[5,3,4,2,8,6,7,1,3] æ€è·¯ï¼šå“ˆå¸Œè¡¨ é¦–å…ˆç”¨tempæ•°ç»„æ‹·è´ä¸€ä»½åŸæ•°ç»„arr å°†tempæ•°ç»„è¿›è¡Œæ’åº ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ä¿å­˜tempæ•°ç»„å„å…ƒç´ çš„æ’åˆ—åºå· æœ€åæ ¹æ®åŸæ•°ç»„arrå„ä¸ªå…ƒç´ çš„ä½ç½®è¿”å›æ’åˆ—åºå· ä»£ç (cpp)ï¼š123456789101112131415161718192021222324class Solution &#123;public: vector&lt;int&gt; arrayRankTransform(vector&lt;int&gt;&amp; arr) &#123; vector&lt;int&gt; temp(arr); //æ‹·è´ä¸€ä»½æ•°ç»„ sort(temp.begin(), temp.end()); //å°†tempæ’åº unordered_map&lt;int, int&gt; map; int count = 1; for(int i = 0; i &lt; temp.size(); i++)&#123; //å¦‚æœmapä¸­å·²ç»å­˜åœ¨ï¼Œåˆ™è·³è¿‡ if(!map.count(temp[i]))&#123; map[temp[i]] = count; count++; &#125; &#125; vector&lt;int&gt; ans; for(int j = 0; j &lt; arr.size(); j++)&#123; ans.emplace_back(map[arr[j]]); //æ’å…¥åºå· &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nÃ—logn)ï¼Œå…¶ä¸­ n æ˜¯è¾“å…¥æ•°ç»„ arr çš„é•¿åº¦ï¼Œæ’åºæ¶ˆè€— O(nÃ—logn) æ—¶é—´ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚æœ‰åºæ•°ç»„å’Œå“ˆå¸Œè¡¨å„æ¶ˆè€— O(n) ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)919. å®Œå…¨äºŒå‰æ ‘æ’å…¥å™¨","slug":"æ¯æ—¥LeetCode/2022-7/919 å®Œå…¨äºŒå‰æ ‘æ’å…¥å™¨","date":"2022-07-25T01:51:00.000Z","updated":"2022-07-25T01:58:02.284Z","comments":true,"path":"2022/07/25/æ¯æ—¥LeetCode/2022-7/919 å®Œå…¨äºŒå‰æ ‘æ’å…¥å™¨/","link":"","permalink":"http://example.com/2022/07/25/%E6%AF%8F%E6%97%A5LeetCode/2022-7/919%20%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91%E6%8F%92%E5%85%A5%E5%99%A8/","excerpt":"","text":"é¢˜ç›®ï¼šå®Œå…¨äºŒå‰æ ‘ï¼š æ˜¯æ¯ä¸€å±‚ï¼ˆé™¤æœ€åä¸€å±‚å¤–ï¼‰éƒ½æ˜¯å®Œå…¨å¡«å……ï¼ˆå³ï¼ŒèŠ‚ç‚¹æ•°è¾¾åˆ°æœ€å¤§ï¼‰çš„ï¼Œå¹¶ä¸”æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å°½å¯èƒ½åœ°é›†ä¸­åœ¨å·¦ä¾§ã€‚ è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œå°†ä¸€ä¸ªæ–°èŠ‚ç‚¹æ’å…¥åˆ°ä¸€ä¸ªå®Œæ•´çš„äºŒå‰æ ‘ä¸­ï¼Œå¹¶åœ¨æ’å…¥åä¿æŒå…¶å®Œæ•´ã€‚ å®ç° CBTInserter ç±»ï¼š CBTInserter(TreeNode root) ä½¿ç”¨å¤´èŠ‚ç‚¹ä¸º root çš„ç»™å®šæ ‘åˆå§‹åŒ–è¯¥æ•°æ®ç»“æ„ï¼› CBTInserter.insert(int v) å‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªå€¼ä¸º Node.val &#x3D;&#x3D; valçš„æ–°èŠ‚ç‚¹ TreeNodeã€‚ä½¿æ ‘ä¿æŒå®Œå…¨äºŒå‰æ ‘çš„çŠ¶æ€ï¼Œå¹¶è¿”å›æ’å…¥èŠ‚ç‚¹ TreeNode çš„çˆ¶èŠ‚ç‚¹çš„å€¼ï¼› CBTInserter.get_root() å°†è¿”å›æ ‘çš„å¤´èŠ‚ç‚¹ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼š[â€œCBTInserterâ€, â€œinsertâ€, â€œinsertâ€, â€œget_rootâ€][[[1, 2]], [3], [4], []]è¾“å‡ºï¼š[null, 1, 2, [1, 2, 3, 4]] è§£é‡Šï¼šCBTInserter cBTInserter &#x3D; new CBTInserter([1, 2]);cBTInserter.insert(3); &#x2F;&#x2F; è¿”å›çˆ¶èŠ‚ç‚¹ 1cBTInserter.insert(4); &#x2F;&#x2F; è¿”å›çˆ¶èŠ‚ç‚¹ 2cBTInserter.get_root(); &#x2F;&#x2F; è¿”å›æ ¹èŠ‚ç‚¹ [1, 2, 3, 4] æ€è·¯ï¼šåº”ç”¨é˜Ÿåˆ—å®ç°æ ‘çš„å±‚åºéå†ï¼š é¦–å…ˆå°†äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹è¿›é˜Ÿï¼Œåˆ¤æ–­é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå°±è¾“å‡ºé˜Ÿå¤´çš„å…ƒç´  åˆ¤æ–­èŠ‚ç‚¹å¦‚æœæœ‰å­©å­ï¼Œå°±å°†å­©å­è¿›é˜Ÿ éå†è¿‡çš„èŠ‚ç‚¹å‡ºé˜Ÿ å¾ªç¯ï¼Œç›´åˆ°q.empty() ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758class CBTInserter &#123;public: //å­˜å…¥æœ€åº•å±‚çš„èŠ‚ç‚¹æ–¹ä¾¿ä»¥åæ’å…¥ queue&lt;TreeNode*&gt; node; TreeNode* root; //è·å–åº•å±‚èŠ‚ç‚¹ CBTInserter(TreeNode* root) &#123; this-&gt;root = root; queue&lt;TreeNode*&gt; q; //å‘é˜Ÿå°¾æ’å…¥èŠ‚ç‚¹ q.push(root); while (!q.empty()) &#123; //è¿”å›é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  TreeNode* n = q.front(); //åˆ é™¤é˜Ÿåˆ—ç¬¬ä¸€ä¸ªå…ƒç´  q.pop(); if (n-&gt;left) &#123; q.push(n-&gt;left); &#125; if (n-&gt;right) &#123; q.push(n-&gt;right); &#125; if (!(n-&gt;left &amp;&amp; n-&gt;right)) &#123; //è·å–æœ€åº•å±‚çš„èŠ‚ç‚¹ node.push(n); &#125; &#125; &#125; int insert(int val) &#123; //åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹ TreeNode* new_node = new TreeNode(val); // è·å¾—é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´  TreeNode* n = node.front(); //è·å–è¯¥èŠ‚ç‚¹çš„å€¼ int ret = n-&gt;val; // å¦‚æœä¸å­˜åœ¨ï¼Œå°±æ’å…¥å·¦èŠ‚ç‚¹ if(!(n-&gt;left))&#123; n-&gt;left = new_node; &#125; //å­˜åœ¨ï¼Œå°±æ’å…¥åˆ°å³èŠ‚ç‚¹ else&#123; n-&gt;right = new_node; //åˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œå› ä¸ºå·¦å³èŠ‚ç‚¹éƒ½å·²ç»å­˜åœ¨ node.pop(); &#125; //å°†æ–°èŠ‚ç‚¹æ’å…¥åˆ°é˜Ÿåˆ— node.push(new_node); return ret; &#125; TreeNode* get_root() &#123; return root; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šåˆå§‹åŒ– CBTInserter(root) éœ€è¦çš„æ—¶é—´ä¸º O(n)ï¼Œå…¶ä¸­ n æ˜¯ç»™å®šçš„åˆå§‹å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚insert(v) å’Œ get_root() çš„æ—¶é—´å¤æ‚åº¦å‡ä¸º O(1)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n+q)ï¼Œå…¶ä¸­ q æ˜¯ insert(v) çš„è°ƒç”¨æ¬¡æ•°ã€‚åœ¨è°ƒç”¨äº† q æ¬¡ insert(v) åï¼Œå®Œå…¨äºŒå‰æ ‘ä¸­æœ‰ n+q ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­æœ‰ä¸€åŠçš„èŠ‚ç‚¹åœ¨é˜Ÿåˆ—ä¸­ï¼Œéœ€è¦ O(n+q) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1184. å…¬äº¤ç«™é—´çš„è·ç¦»","slug":"æ¯æ—¥LeetCode/2022-7/1184 å…¬äº¤ç«™é—´çš„è·ç¦»","date":"2022-07-24T00:24:00.000Z","updated":"2022-07-24T00:24:48.039Z","comments":true,"path":"2022/07/24/æ¯æ—¥LeetCode/2022-7/1184 å…¬äº¤ç«™é—´çš„è·ç¦»/","link":"","permalink":"http://example.com/2022/07/24/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1184%20%E5%85%AC%E4%BA%A4%E7%AB%99%E9%97%B4%E7%9A%84%E8%B7%9D%E7%A6%BB/","excerpt":"","text":"é¢˜ç›®ï¼šç¯å½¢å…¬äº¤è·¯çº¿ä¸Šæœ‰ n ä¸ªç«™ï¼ŒæŒ‰æ¬¡åºä» 0 åˆ° n - 1 è¿›è¡Œç¼–å·ã€‚æˆ‘ä»¬å·²çŸ¥æ¯ä¸€å¯¹ç›¸é‚»å…¬äº¤ç«™ä¹‹é—´çš„è·ç¦»ï¼Œdistance[i] è¡¨ç¤ºç¼–å·ä¸º i çš„è½¦ç«™å’Œç¼–å·ä¸º (i + 1) % n çš„è½¦ç«™ä¹‹é—´çš„è·ç¦»ã€‚ ç¯çº¿ä¸Šçš„å…¬äº¤è½¦éƒ½å¯ä»¥æŒ‰é¡ºæ—¶é’ˆå’Œé€†æ—¶é’ˆçš„æ–¹å‘è¡Œé©¶ã€‚ è¿”å›ä¹˜å®¢ä»å‡ºå‘ç‚¹ start åˆ°ç›®çš„åœ° destination ä¹‹é—´çš„æœ€çŸ­è·ç¦»ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šdistance &#x3D; [1,2,3,4], start &#x3D; 0, destination &#x3D; 1è¾“å‡ºï¼š1è§£é‡Šï¼šå…¬äº¤ç«™ 0 å’Œ 1 ä¹‹é—´çš„è·ç¦»é¡ºæ—¶é’ˆæ˜¯ 1 ï¼Œé€†æ—¶é’ˆæ˜¯ 9ï¼Œæ‰€ä»¥æœ€å°å€¼æ˜¯ 1ã€‚ æ€è·¯ï¼šå…ˆè®¡ç®—æ€»çš„è·ç¦»all_sumï¼Œå†è®¡ç®—startåˆ°destinationçš„è·ç¦»ä¸ºpositive_sum è¿”å›é¡ºæ—¶é’ˆçš„è·ç¦»positive_sumä»¥åŠé€†æ—¶é’ˆçš„è·ç¦»all_sum-positive_sumå®ƒä»¬ä¸­çš„æœ€å°è·ç¦» ä»£ç (cpp)ï¼š123456789101112131415161718class Solution &#123;public: int distanceBetweenBusStops(vector&lt;int&gt;&amp; distance, int start, int destination) &#123; int all_sum = 0; for(int i =0; i &lt; distance.size(); i++)&#123; all_sum += distance[i]; &#125; if(start &gt; destination) swap(start, destination); int positive_sum = 0; for(start; start &lt; destination; start++)&#123; positive_sum += distance[start]; &#125; return min(positive_sum, all_sum - positive_sum); &#125;&#125;; ä¼˜åŒ–åï¼šå°†ä¸¤ä¸ªå¾ªç¯åˆå¹¶åœ¨ä¸€èµ· 123456789101112131415161718class Solution &#123;public: int distanceBetweenBusStops(vector&lt;int&gt;&amp; distance, int start, int destination) &#123; int all_sum = 0; int positive_sum = 0; if(start &gt; destination) swap(start, destination); for(int i =0; i &lt; distance.size(); i++)&#123; all_sum += distance[i]; if(i &gt;= start &amp;&amp; i &lt; destination)&#123; positive_sum += distance[i]; &#125; &#125; return min(positive_sum, all_sum - positive_sum); &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)814. äºŒå‰æ ‘å‰ªæ","slug":"æ¯æ—¥LeetCode/2022-7/814 äºŒå‰æ ‘å‰ªæ","date":"2022-07-21T00:36:00.000Z","updated":"2022-07-21T02:13:56.542Z","comments":true,"path":"2022/07/21/æ¯æ—¥LeetCode/2022-7/814 äºŒå‰æ ‘å‰ªæ/","link":"","permalink":"http://example.com/2022/07/21/%E6%AF%8F%E6%97%A5LeetCode/2022-7/814%20%E4%BA%8C%E5%8F%89%E6%A0%91%E5%89%AA%E6%9E%9D/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ äºŒå‰æ ‘çš„æ ¹ç»“ç‚¹ root ï¼Œæ­¤å¤–æ ‘çš„æ¯ä¸ªç»“ç‚¹çš„å€¼è¦ä¹ˆæ˜¯ 0 ï¼Œè¦ä¹ˆæ˜¯ 1 ã€‚ è¿”å›ç§»é™¤äº†æ‰€æœ‰ä¸åŒ…å« 1 çš„å­æ ‘çš„åŸäºŒå‰æ ‘ã€‚ èŠ‚ç‚¹ node çš„å­æ ‘ä¸º node æœ¬èº«åŠ ä¸Šæ‰€æœ‰ node çš„åä»£ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [1,null,0,0,1]è¾“å‡ºï¼š[1,null,0,null,1]è§£é‡Šï¼šåªæœ‰çº¢è‰²èŠ‚ç‚¹æ»¡è¶³æ¡ä»¶â€œæ‰€æœ‰ä¸åŒ…å« 1 çš„å­æ ‘â€ã€‚ å³å›¾ä¸ºè¿”å›çš„ç­”æ¡ˆã€‚ è‡ªåº•å‘ä¸Šè¿›è¡Œå‰ªæï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹ä¸å­˜åœ¨å·¦å³èŠ‚ç‚¹ï¼Œå¹¶ä¸”è¯¥èŠ‚ç‚¹å€¼ä¸º0çš„è¯å°±éœ€è¦å‰ªæ ä»£ç (cpp)ï¼š123456789101112131415class Solution &#123;public: TreeNode* pruneTree(TreeNode* root) &#123; if(root == nullptr) return nullptr; root-&gt;left = pruneTree(root-&gt;left); root-&gt;right = pruneTree(root-&gt;right); if(root-&gt;left == nullptr &amp;&amp; root-&gt;right ==nullptr &amp;&amp; root-&gt;val == 0)&#123; return nullptr; &#125; return root; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦éå†ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚é€’å½’çš„æ·±åº¦æœ€å¤šä¸º O(n)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1252. å¥‡æ•°å€¼å•å…ƒæ ¼çš„æ•°ç›®","slug":"æ¯æ—¥LeetCode/2022-7/1252 å¥‡æ•°å€¼å•å…ƒæ ¼çš„æ•°ç›®","date":"2022-07-12T01:24:00.000Z","updated":"2022-07-12T01:26:30.157Z","comments":true,"path":"2022/07/12/æ¯æ—¥LeetCode/2022-7/1252 å¥‡æ•°å€¼å•å…ƒæ ¼çš„æ•°ç›®/","link":"","permalink":"http://example.com/2022/07/12/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1252%20%E5%A5%87%E6%95%B0%E5%80%BC%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%95%B0%E7%9B%AE/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ª m x n çš„çŸ©é˜µï¼Œæœ€å¼€å§‹çš„æ—¶å€™ï¼Œæ¯ä¸ªå•å…ƒæ ¼ä¸­çš„å€¼éƒ½æ˜¯ 0ã€‚ å¦æœ‰ä¸€ä¸ªäºŒç»´ç´¢å¼•æ•°ç»„ indicesï¼Œindices[i] = [ri, ci] æŒ‡å‘çŸ©é˜µä¸­çš„æŸä¸ªä½ç½®ï¼Œå…¶ä¸­ ri å’Œ ci åˆ†åˆ«è¡¨ç¤ºæŒ‡å®šçš„è¡Œå’Œåˆ—ï¼ˆä» 0 å¼€å§‹ç¼–å·ï¼‰ã€‚ å¯¹ indices[i] æ‰€æŒ‡å‘çš„æ¯ä¸ªä½ç½®ï¼Œåº”åŒæ—¶æ‰§è¡Œä¸‹è¿°å¢é‡æ“ä½œï¼š ri è¡Œä¸Šçš„æ‰€æœ‰å•å…ƒæ ¼ï¼ŒåŠ  1 ã€‚ci åˆ—ä¸Šçš„æ‰€æœ‰å•å…ƒæ ¼ï¼ŒåŠ  1 ã€‚ç»™ä½  mã€n å’Œ indices ã€‚è¯·ä½ åœ¨æ‰§è¡Œå®Œæ‰€æœ‰ indices æŒ‡å®šçš„å¢é‡æ“ä½œåï¼Œè¿”å›çŸ©é˜µä¸­ å¥‡æ•°å€¼å•å…ƒæ ¼ çš„æ•°ç›®ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šm &#x3D; 2, n &#x3D; 3, indices &#x3D; [[0,1],[1,1]]è¾“å‡ºï¼š6è§£é‡Šï¼š [[0,0,0], &#x3D;&#x3D;&gt; [[1,2,1], &#x3D;&#x3D;&gt; [[1,3,1], [0,0,0]] [0,1,0]] [1,3,1]] è¿”å›å¥‡æ•°çš„ä¸ªæ•° ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526class Solution &#123;public: int oddCells(int m, int n, vector&lt;vector&lt;int&gt;&gt;&amp; indices) &#123; vector&lt;int&gt; dp(n); vector&lt;vector&lt;int&gt;&gt; dps(m, dp); for (int i = 0; i &lt; indices.size(); i++) &#123; for (int j = 0; j &lt; n; j++) &#123; dps[indices[i][0]][j] += 1; &#125; for (int k = 0; k &lt; m; k++) &#123; dps[k][indices[i][1]] += 1; &#125; &#125; int count = 0; for (int i = 0; i &lt; m; i++) &#123; for (int j = 0; j &lt; n; j++) &#123; if (dps[i][j] % 2 != 0) &#123; count++; &#125; &#125; &#125; return count; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(qÃ—(m+n)+mÃ—n), å…¶ä¸­ q è¡¨ç¤ºæ•°ç»„ indices çš„é•¿åº¦ï¼Œm,n ä¸ºçŸ©é˜µçš„è¡Œæ•°ä¸åˆ—æ•°ã€‚éå†æ•°ç»„æ—¶ï¼Œæ¯æ¬¡éƒ½éœ€è¦æ›´æ–°çŸ©é˜µä¸­ä¸€è¡ŒåŠ ä¸€åˆ—ï¼Œéœ€è¦çš„æ—¶é—´ä¸º O(qÃ—(m+n))ï¼Œæœ€åè¿˜éœ€è¦éå†çŸ©é˜µï¼Œéœ€è¦çš„æ—¶é—´ä¸º O(mÃ—n)ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º O(qÃ—(m+n)+mÃ—n)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(mÃ—n)ï¼Œå…¶ä¸­ m,n ä¸ºçŸ©é˜µçš„è¡Œæ•°ä¸åˆ—æ•°ã€‚éœ€è¦å­˜å‚¨çŸ©é˜µçš„æ‰€æœ‰å…ƒç´ ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)676. å®ç°ä¸€ä¸ªé­”æ³•å­—å…¸","slug":"æ¯æ—¥LeetCode/2022-7/676 å®ç°ä¸€ä¸ªé­”æ³•å­—å…¸","date":"2022-07-11T00:35:00.000Z","updated":"2022-07-11T04:04:29.012Z","comments":true,"path":"2022/07/11/æ¯æ—¥LeetCode/2022-7/676 å®ç°ä¸€ä¸ªé­”æ³•å­—å…¸/","link":"","permalink":"http://example.com/2022/07/11/%E6%AF%8F%E6%97%A5LeetCode/2022-7/676%20%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E9%AD%94%E6%B3%95%E5%AD%97%E5%85%B8/","excerpt":"","text":"é¢˜ç›®ï¼šè®¾è®¡ä¸€ä¸ªä½¿ç”¨å•è¯åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–çš„æ•°æ®ç»“æ„ï¼Œå•è¯åˆ—è¡¨ä¸­çš„å•è¯ äº’ä¸ç›¸åŒ ã€‚ å¦‚æœç»™å‡ºä¸€ä¸ªå•è¯ï¼Œè¯·åˆ¤å®šèƒ½å¦åªå°†è¿™ä¸ªå•è¯ä¸­ä¸€ä¸ªå­—æ¯æ¢æˆå¦ä¸€ä¸ªå­—æ¯ï¼Œä½¿å¾—æ‰€å½¢æˆçš„æ–°å•è¯å­˜åœ¨äºä½ æ„å»ºçš„å­—å…¸ä¸­ã€‚ å®ç° MagicDictionary ç±»ï¼š MagicDictionary() åˆå§‹åŒ–å¯¹è±¡void buildDict(String[] dictionary) ä½¿ç”¨å­—ç¬¦ä¸²æ•°ç»„ dictionary è®¾å®šè¯¥æ•°æ®ç»“æ„ï¼Œdictionary ä¸­çš„å­—ç¬¦ä¸²äº’ä¸ç›¸åŒbool search(String searchWord) ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² searchWord ï¼Œåˆ¤å®šèƒ½å¦åªå°†å­—ç¬¦ä¸²ä¸­ ä¸€ä¸ª å­—æ¯æ¢æˆå¦ä¸€ä¸ªå­—æ¯ï¼Œä½¿å¾—æ‰€å½¢æˆçš„æ–°å­—ç¬¦ä¸²èƒ½å¤Ÿä¸å­—å…¸ä¸­çš„ä»»ä¸€å­—ç¬¦ä¸²åŒ¹é…ã€‚å¦‚æœå¯ä»¥ï¼Œè¿”å› trueï¼›å¦åˆ™ï¼Œè¿”å› falseã€‚ ç¤ºä¾‹ï¼š è¾“å…¥[â€œMagicDictionaryâ€, â€œbuildDictâ€, â€œsearchâ€, â€œsearchâ€, â€œsearchâ€, â€œsearchâ€][[], [[â€œhelloâ€, â€œleetcodeâ€]], [â€œhelloâ€], [â€œhhlloâ€], [â€œhellâ€], [â€œleetcodedâ€]]è¾“å‡º[null, null, false, true, false, false] è§£é‡ŠMagicDictionary magicDictionary &#x3D; new MagicDictionary();magicDictionary.buildDict([â€œhelloâ€, â€œleetcodeâ€]);magicDictionary.search(â€œhelloâ€); &#x2F;&#x2F; è¿”å› FalsemagicDictionary.search(â€œhhlloâ€); &#x2F;&#x2F; å°†ç¬¬äºŒä¸ª â€˜hâ€™ æ›¿æ¢ä¸º â€˜eâ€™ å¯ä»¥åŒ¹é… â€œhelloâ€ ï¼Œæ‰€ä»¥è¿”å› TruemagicDictionary.search(â€œhellâ€); &#x2F;&#x2F; è¿”å› FalsemagicDictionary.search(â€œleetcodedâ€); &#x2F;&#x2F; è¿”å› False æ€è·¯ï¼šéå†è¯å…¸ï¼Œæ‰¾åˆ°ä¸searchWordå•è¯é•¿åº¦ä¸€æ ·çš„å•è¯ï¼Œå†ä¸ä¹‹å¯¹æ¯”ç›¸åŒçš„ä½ç½®çš„å­—æ¯æ˜¯å¦ç›¸åŒï¼Œè®°å½•ä¸ç›¸åŒå­—æ¯çš„æ¬¡æ•°ï¼Œåªæœ‰ä¸ç›¸åŒçš„å­—æ¯çš„æ¬¡æ•°ä¸º1æ—¶ï¼Œæ‰å¯ä»¥è¿”å›true ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526class MagicDictionary &#123;public: vector&lt;string&gt; dic; MagicDictionary() &#123;&#125; void buildDict(vector&lt;string&gt; dictionary) &#123; this-&gt;dic= dictionary; &#125; bool search(string searchWord) &#123; int n = searchWord.size(); for(int i = 0; i &lt; dic.size(); i++)&#123; if(dic[i].size() == n)&#123; int count = 0; for(int j = 0; j &lt; n; j++)&#123; if(dic[i][j] != searchWord[j])&#123; count++; &#125; &#125; if(count == 1) return 1; &#125; &#125; return 0; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(qnl)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ dictionary çš„é•¿åº¦ï¼Œl æ˜¯æ•°ç»„ dictionary ä¸­å­—ç¬¦ä¸²çš„å¹³å‡é•¿åº¦ï¼Œq æ˜¯å‡½æ•° search(searchWord) çš„è°ƒç”¨æ¬¡æ•°ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(nl)ï¼Œå³ä¸ºæ•°ç»„éœ€è¦ä½¿ç”¨çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)873. æœ€é•¿çš„æ–æ³¢é‚£å¥‘å­åºåˆ—çš„é•¿åº¦","slug":"æ¯æ—¥LeetCode/2022-7/873 æœ€é•¿çš„æ–æ³¢é‚£å¥‘å­åºåˆ—çš„é•¿åº¦","date":"2022-07-09T00:34:00.000Z","updated":"2022-07-09T03:38:53.250Z","comments":true,"path":"2022/07/09/æ¯æ—¥LeetCode/2022-7/873 æœ€é•¿çš„æ–æ³¢é‚£å¥‘å­åºåˆ—çš„é•¿åº¦/","link":"","permalink":"http://example.com/2022/07/09/%E6%AF%8F%E6%97%A5LeetCode/2022-7/873%20%E6%9C%80%E9%95%BF%E7%9A%84%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%AD%90%E5%BA%8F%E5%88%97%E7%9A%84%E9%95%BF%E5%BA%A6/","excerpt":"","text":"é¢˜ç›®ï¼šå¦‚æœåºåˆ— $X_1, X_2, â€¦, X_n$ æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼Œå°±è¯´å®ƒæ˜¯ æ–æ³¢é‚£å¥‘å¼ çš„ï¼š n &gt;&#x3D; 3å¯¹äºæ‰€æœ‰ i + 2 &lt;&#x3D; nï¼Œéƒ½æœ‰ $X_i + X_{i+1} &#x3D; X_{i+2}$ç»™å®šä¸€ä¸ªä¸¥æ ¼é€’å¢çš„æ­£æ•´æ•°æ•°ç»„å½¢æˆåºåˆ— arr ï¼Œæ‰¾åˆ° arr ä¸­æœ€é•¿çš„æ–æ³¢é‚£å¥‘å¼çš„å­åºåˆ—çš„é•¿åº¦ã€‚å¦‚æœä¸€ä¸ªä¸å­˜åœ¨ï¼Œè¿”å› 0 ã€‚ ï¼ˆå›æƒ³ä¸€ä¸‹ï¼Œå­åºåˆ—æ˜¯ä»åŸåºåˆ— arr ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ï¼Œå®ƒä» arr ä¸­åˆ æ‰ä»»æ„æ•°é‡çš„å…ƒç´ ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ ï¼‰ï¼Œè€Œä¸æ”¹å˜å…¶ä½™å…ƒç´ çš„é¡ºåºã€‚ä¾‹å¦‚ï¼Œ [3, 5, 8] æ˜¯ [3, 4, 5, 6, 7, 8] çš„ä¸€ä¸ªå­åºåˆ—ï¼‰ ç¤ºä¾‹ï¼š è¾“å…¥: arr &#x3D; [1,3,7,11,12,14,18]è¾“å‡º: 3è§£é‡Š: æœ€é•¿çš„æ–æ³¢é‚£å¥‘å¼å­åºåˆ—æœ‰ [1,11,12]ã€[3,11,14] ä»¥åŠ [7,11,18] ã€‚ æ€è·¯ï¼šé€’å½’è´¹åŠ²å°½å¿ƒï¼Œæœ€åè¿è¡Œè¶…æ—¶ï¼ï¼ ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728class Solution &#123;public: int def(vector&lt;int&gt;&amp; arr, vector&lt;int&gt; dp, int pos)&#123; int ans = 0; int n = dp.size(); for(int i=pos; i &lt; arr.size(); i++)&#123; if(n &lt; 2)&#123; vector&lt;int&gt; n_dp(dp); n_dp.emplace_back(arr[i]); ans = max(def(arr, n_dp, i+1)+1, ans); &#125; else if(n &gt;= 2 &amp;&amp; dp[n-1] + dp[n-2] == arr[i])&#123; vector&lt;int&gt; n_dp(dp); n_dp.emplace_back(arr[i]); ans = max(def(arr, n_dp, i+1)+1, ans); &#125; &#125; if(ans &lt;= 2 &amp;&amp; pos &lt; 2) return 0; return ans; &#125; int lenLongestFibSubseq(vector&lt;int&gt;&amp; arr) &#123; vector&lt;int&gt; dp; return def(arr, dp, 0); &#125;&#125;; æ€è·¯ï¼šåŠ¨æ€è§„åˆ’æ‘†çƒ‚äº†ï¼ arr[k]+arr[j]=arr[i] å¤§å°ï¼šk&lt;j&lt;i ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930class Solution &#123;public: int lenLongestFibSubseq(vector&lt;int&gt;&amp; arr) &#123; unordered_map&lt;int, int&gt; indices; int n = arr.size(); for (int i = 0; i &lt; n; i++) &#123; indices[arr[i]] = i; &#125; //åˆ›å»ºå…¨æ˜¯0çš„n*näºŒç»´æ•°ç»„ vector&lt;vector&lt;int&gt;&gt; dp(n, vector&lt;int&gt;(n)); int ans = 0; for (int i = 0; i &lt; n; i++) &#123; for (int j = i - 1; j &gt;= 0 &amp;&amp; arr[j] * 2 &gt; arr[i]; j--) &#123; int k = -1; //å¦‚æœindicesä¸­å­˜åœ¨arr[i]-arr[j]è¿™ä¸ªæ•° if (indices.count(arr[i] - arr[j])) &#123; //è·å¾—è·å¾—æ­¤æ•° k = indices[arr[i] - arr[j]]; &#125; //å¦‚æœkä¸ç­‰äº-1 if (k &gt;= 0) &#123; dp[j][i] = max(dp[k][j] + 1, 3); &#125; //è·å¾—åˆ°æœ€å¤§çš„åºåˆ—é•¿åº¦ ans = max(ans, dp[j][i]); &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚åŠ¨æ€è§„åˆ’çš„çŠ¶æ€æ•°æ˜¯ O(n^2)ï¼Œæ¯ä¸ªçŠ¶æ€çš„è®¡ç®—æ—¶é—´éƒ½æ˜¯ O(1) ç©ºé—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚éœ€è¦åˆ›å»ºäºŒç»´æ•°ç»„ dpï¼Œç©ºé—´æ˜¯ O(n^2)","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1846. å‡å°å’Œé‡æ–°æ’åˆ—æ•°ç»„åçš„æœ€å¤§å…ƒç´ ","slug":"æ¯æ—¥LeetCode/2022-7/1846 å‡å°å’Œé‡æ–°æ’åˆ—æ•°ç»„åçš„æœ€å¤§å…ƒç´ ","date":"2022-07-08T00:34:00.000Z","updated":"2022-07-08T00:34:32.816Z","comments":true,"path":"2022/07/08/æ¯æ—¥LeetCode/2022-7/1846 å‡å°å’Œé‡æ–°æ’åˆ—æ•°ç»„åçš„æœ€å¤§å…ƒç´ /","link":"","permalink":"http://example.com/2022/07/08/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1846%20%E5%87%8F%E5%B0%8F%E5%92%8C%E9%87%8D%E6%96%B0%E6%8E%92%E5%88%97%E6%95%B0%E7%BB%84%E5%90%8E%E7%9A%84%E6%9C%80%E5%A4%A7%E5%85%83%E7%B4%A0/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ arr ã€‚è¯·ä½ å¯¹ arr æ‰§è¡Œä¸€äº›æ“ä½œï¼ˆä¹Ÿå¯ä»¥ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼‰ï¼Œä½¿å¾—æ•°ç»„æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š arr ä¸­ ç¬¬ä¸€ä¸ª å…ƒç´ å¿…é¡»ä¸º 1 ã€‚ä»»æ„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ çš„å·®çš„ç»å¯¹å€¼ å°äºç­‰äº 1 ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä»»æ„çš„ 1 &lt;= i &lt; arr.length ï¼ˆæ•°ç»„ä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ï¼Œéƒ½æ»¡è¶³ abs(arr[i] - arr[i - 1]) &lt;= 1 ã€‚abs(x) ä¸º x çš„ç»å¯¹å€¼ã€‚ä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹ 2 ç§æ“ä½œä»»æ„æ¬¡ï¼š å‡å° arr ä¸­ä»»æ„å…ƒç´ çš„å€¼ï¼Œä½¿å…¶å˜ä¸ºä¸€ä¸ª æ›´å°çš„æ­£æ•´æ•° ã€‚é‡æ–°æ’åˆ— arr ä¸­çš„å…ƒç´ ï¼Œä½ å¯ä»¥ä»¥ä»»æ„é¡ºåºé‡æ–°æ’åˆ—ã€‚è¯·ä½ è¿”å›æ‰§è¡Œä»¥ä¸Šæ“ä½œåï¼Œåœ¨æ»¡è¶³å‰æ–‡æ‰€è¿°çš„æ¡ä»¶ä¸‹ï¼Œarr ä¸­å¯èƒ½çš„ æœ€å¤§å€¼ ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šarr &#x3D; [100,1,1000]è¾“å‡ºï¼š3è§£é‡Šï¼šä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆå¦‚ä¸‹ï¼š é‡æ–°æ’åˆ— arr å¾—åˆ° [1,100,1000] ã€‚ å°†ç¬¬äºŒä¸ªå…ƒç´ å‡å°ä¸º 2 ã€‚ å°†ç¬¬ä¸‰ä¸ªå…ƒç´ å‡å°ä¸º 3 ã€‚ç°åœ¨ arr &#x3D; [1,2,3] ï¼Œæ»¡è¶³æ‰€æœ‰æ¡ä»¶ã€‚arr ä¸­æœ€å¤§å…ƒç´ ä¸º 3 ã€‚ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223class Solution &#123;public: int maximumElementAfterDecrementingAndRearranging(vector&lt;int&gt;&amp; arr) &#123; //å°†arræ•°ç»„æ’åº sort(arr.begin(), arr.end()); //å¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ ä¸ä¸º1ï¼Œåˆ™è®¾ç½®ä¸º1 if(arr[0] != 1) arr[0] = 1; å°†æœ€å¤§æ•°è®¾ç½®ä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´  int max = arr[0]; for(int i = 1; i &lt; arr.size(); i++)&#123; //å½“å‰çš„å…ƒç´ å‡å»å‰é¢çš„å…ƒç´ ï¼Œå®ƒä»¬çš„ç»å¯¹å€¼è‚¯å®šæ˜¯å¤§äº0çš„ int temp = arr[i] - arr[i-1]; //å¦‚æœç»å¯¹å€¼å¤§äº1ï¼Œåˆ™è®¾ç½®å½“å‰çš„å…ƒç´ ä¸ºå‰é¢çš„å…ƒç´ +1 if(temp &gt; 1) arr[i] = arr[i-1]+1; //å¦‚æœå½“å‰å…ƒç´ å¤§äºmaxçš„å…ƒç´ ï¼Œå°†å½“å‰å…ƒç´ è®¾ç½®ä¸ºæœ€å¤§æ•° if(arr[i] &gt; max) max = arr[i]; &#125; //è¿”å›æœ€å¤§æ•° return max; &#125; &#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚æ—¶é—´å¤æ‚åº¦å³æ’åºçš„å¤æ‚åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ã€‚ç©ºé—´å¤æ‚åº¦ä¸è€ƒè™‘è¾“å…¥ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºæ’åºæ—¶äº§ç”Ÿçš„ O(logn) çš„æ ˆç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)593. æœ‰æ•ˆçš„æ­£æ–¹å½¢","slug":"æ¯æ—¥LeetCode/2022-7/593 æœ‰æ•ˆçš„æ­£æ–¹å½¢","date":"2022-07-08T00:34:00.000Z","updated":"2022-07-29T03:25:10.784Z","comments":true,"path":"2022/07/08/æ¯æ—¥LeetCode/2022-7/593 æœ‰æ•ˆçš„æ­£æ–¹å½¢/","link":"","permalink":"http://example.com/2022/07/08/%E6%AF%8F%E6%97%A5LeetCode/2022-7/593%20%E6%9C%89%E6%95%88%E7%9A%84%E6%AD%A3%E6%96%B9%E5%BD%A2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®š2Dç©ºé—´ä¸­å››ä¸ªç‚¹çš„åæ ‡ p1, p2, p3 å’Œ p4ï¼Œå¦‚æœè¿™å››ä¸ªç‚¹æ„æˆä¸€ä¸ªæ­£æ–¹å½¢ï¼Œåˆ™è¿”å› true ã€‚ ç‚¹çš„åæ ‡ pi è¡¨ç¤ºä¸º [xi, yi] ã€‚è¾“å…¥ ä¸æ˜¯ æŒ‰ä»»ä½•é¡ºåºç»™å‡ºçš„ã€‚ ä¸€ä¸ª æœ‰æ•ˆçš„æ­£æ–¹å½¢ æœ‰å››æ¡ç­‰è¾¹å’Œå››ä¸ªç­‰è§’(90åº¦è§’)ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šp1 &#x3D; [1,0], p2 &#x3D; [-1,0], p3 &#x3D; [0,1], p4 &#x3D; [0,-1]è¾“å‡ºï¼štrue æ€è·¯ï¼šè‡ªå·±æƒ³å‡ºçš„ä¸€ç§å¾ˆæ— è„‘çš„æ€è·¯ï¼ å…ˆåšä¸€ä¸ªåˆ¤æ–­ï¼ŒæŸä¸€è¡Œæˆ–æŸä¸€åˆ—æ˜¯å¦å­˜åœ¨ä¸‰ä¸ªä»¥ä¸Šçš„ç‚¹ï¼Œå­˜åœ¨åˆ™ä¸å¯èƒ½æ˜¯æ­£æ–¹å½¢ é€‰å–å…¶ä¸­ä¸€ä¸ªæœ€å°çš„ç‚¹ï¼Œè®¡ç®—ä¸å…¶ä½™ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚å¦‚æœæ˜¯æ­£æ–¹å½¢çš„è¯ï¼Œä¸€å®šæœ‰ä¸¤ä¸ªç›¸ç­‰çš„è¾¹é•¿ï¼Œå’Œä¸€ä¸ªè¾ƒé•¿çš„å¯¹è§’çº¿ï¼Œå¹¶ä¸”æ»¡è¶³å‹¾è‚¡å®šç†ã€‚ ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061class Solution &#123;public: bool judge(vector&lt;int&gt;&amp; p1, vector&lt;int&gt;&amp; p2, vector&lt;int&gt;&amp; p3, vector&lt;int&gt;&amp; p4)&#123; int count = 0; if(p1[0] == p2[0]) count++; if(p1[0] == p3[0]) count++; if(p1[0] == p4[0]) count++; //åˆ¤æ–­æŸè¡Œï¼Œæ˜¯å¦å­˜åœ¨ä¸‰ä¸ªç‚¹ if(count &gt;= 2) return false; count = 0; if(p1[1] == p2[1]) count++; if(p1[1] == p3[1]) count++; if(p1[1] == p4[1]) count++; //åˆ¤æ–­æŸåˆ—ï¼Œæ˜¯å¦å­˜åœ¨ä¸‰ä¸ªç‚¹ if(count &gt;= 2) return false; return true; &#125; bool validSquare(vector&lt;int&gt;&amp; p1, vector&lt;int&gt;&amp; p2, vector&lt;int&gt;&amp; p3, vector&lt;int&gt;&amp; p4) &#123; //åˆ¤æ–­æ˜¯å¦å­˜åœ¨æœ‰ä¸‰ä¸ªç‚¹åœ¨ä¸€æ¡çº¿ä¸Š if(!is_duo(p1,p2,p3,p4)) return false; int n1 = p1[0] + p1[1]; int n2 = p2[0] + p2[1]; int n3 = p3[0] + p3[1]; int n4 = p4[0] + p4[1]; //é€‰å–ä¸€ä¸ªæœ€å°çš„ç‚¹ä½œä¸ºè®¡ç®—ä¸å…¶ä½™ç‚¹ä¹‹é—´çš„è·ç¦» int min_num = min(n1, n2); min_num = min(n3, min_num); min_num = min(n4, min_num); //ä¸p1ç‚¹äº¤æ¢ï¼Œä½¿p1ç‚¹å˜ä¸ºæœ€å°ç‚¹ if(min_num == n2) p1.swap(p2); if(min_num == n3) p1.swap(p3); if(min_num == n4) p1.swap(p4); vector&lt;int&gt; nums; //è®¡ç®—p1ç‚¹åˆ°å…¶ä½™ä¸‰ä¸ªç‚¹çš„è·ç¦»ï¼Œæœªå–æ ¹å·å› ä¸ºä¼šäº§ç”Ÿå°æ•° int num1 = pow(p1[0]-p2[0], 2) + pow(p1[1]-p2[1], 2); nums.push_back(num1); int num2 = pow(p1[0]-p3[0], 2) + pow(p1[1]-p3[1], 2); nums.push_back(num2); int num3 = pow(p1[0]-p4[0], 2) + pow(p1[1]-p4[1], 2); nums.push_back(num3); sort(nums.begin(), nums.end()); //æ’åºï¼Œå¯¹è§’çº¿å¤§äºè¾¹é•¿ //å¦‚æœå­˜åœ¨å¯¹è§’çº¿ä¸º0 if(nums[2] == 0) return false; //å¦‚æœä¸¤æ¡è¾¹é•¿ä¸ç›¸ç­‰ if(nums[0] != nums[1]) return false; //å‹¾è‚¡å®šç†ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºç›´è§’ if(nums[0] + nums[1] != nums[2]) return false; return true; &#125;&#125;;","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)729. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I","slug":"æ¯æ—¥LeetCode/2022-7/729 æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I","date":"2022-07-05T04:50:00.000Z","updated":"2022-07-08T00:35:39.494Z","comments":true,"path":"2022/07/05/æ¯æ—¥LeetCode/2022-7/729 æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I/","link":"","permalink":"http://example.com/2022/07/05/%E6%AF%8F%E6%97%A5LeetCode/2022-7/729%20%E6%88%91%E7%9A%84%E6%97%A5%E7%A8%8B%E5%AE%89%E6%8E%92%E8%A1%A8%20I/","excerpt":"","text":"é¢˜ç›®ï¼šå®ç°ä¸€ä¸ª MyCalendar ç±»æ¥å­˜æ”¾ä½ çš„æ—¥ç¨‹å®‰æ’ã€‚å¦‚æœè¦æ·»åŠ çš„æ—¥ç¨‹å®‰æ’ä¸ä¼šé€ æˆ é‡å¤é¢„è®¢ ï¼Œåˆ™å¯ä»¥å­˜å‚¨è¿™ä¸ªæ–°çš„æ—¥ç¨‹å®‰æ’ã€‚ å½“ä¸¤ä¸ªæ—¥ç¨‹å®‰æ’æœ‰ä¸€äº›æ—¶é—´ä¸Šçš„äº¤å‰æ—¶ï¼ˆä¾‹å¦‚ä¸¤ä¸ªæ—¥ç¨‹å®‰æ’éƒ½åœ¨åŒä¸€æ—¶é—´å†…ï¼‰ï¼Œå°±ä¼šäº§ç”Ÿ é‡å¤é¢„è®¢ ã€‚ æ—¥ç¨‹å¯ä»¥ç”¨ä¸€å¯¹æ•´æ•° start å’Œ end è¡¨ç¤ºï¼Œè¿™é‡Œçš„æ—¶é—´æ˜¯åŠå¼€åŒºé—´ï¼Œå³ [start, end), å®æ•° x çš„èŒƒå›´ä¸ºï¼Œ start &lt;= x &lt; end ã€‚ å®ç° MyCalendar ç±»ï¼š MyCalendar() åˆå§‹åŒ–æ—¥å†å¯¹è±¡ã€‚boolean book(int start, int end) å¦‚æœå¯ä»¥å°†æ—¥ç¨‹å®‰æ’æˆåŠŸæ·»åŠ åˆ°æ—¥å†ä¸­è€Œä¸ä¼šå¯¼è‡´é‡å¤é¢„è®¢ï¼Œè¿”å› trueã€‚å¦åˆ™ï¼Œè¿”å› false å¹¶ä¸”ä¸è¦å°†è¯¥æ—¥ç¨‹å®‰æ’æ·»åŠ åˆ°æ—¥å†ä¸­ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼š[â€œMyCalendarâ€, â€œbookâ€, â€œbookâ€, â€œbookâ€][[], [10, 20], [15, 25], [20, 30]]è¾“å‡ºï¼š[null, true, false, true] æ€è·¯ï¼šäºŒåˆ†æŸ¥æ‰¾è®¾å·²ç»æ’å…¥äº†ä¸€äº›æ—¥ç¨‹ï¼š $[[start_1,end_1),[start_2,end_2),[start_3,end_3)]$ æ—¥ç¨‹ä¹‹é—´ä¸äº¤å‰å¹¶ä¸”ä¸€å®šæ˜¯æœ‰è¿™æ ·çš„æ’åºï¼š $start_1 &lt; end_1 \\leq start_2 &lt; end_2 \\leq start_3 &lt; end_3$ å¦‚æœè¦æ’å…¥[start, end) ä¸€å®šæ˜¯åœ¨$end_i \\leq start&lt;end&lt; start_{i+1}$ åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æ°æ¯”endå¤§çš„å…ƒç´ ï¼š$start_{i+1}$ å†å°†$start_{i+1}$å‰é¢çš„å…ƒç´ $end_i$ä¸startæ¯”è¾ƒï¼Œçœ‹æ˜¯å¦äº¤å‰ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718class MyCalendar &#123;public: //seté»˜è®¤çš„æ¯”è¾ƒè§„åˆ™å…ˆæŒ‰ç…§firstæ¯”è¾ƒï¼Œå¦‚æœfirstç›¸åŒï¼Œå†æŒ‰ç…§secondæ¯”è¾ƒ set&lt;pair&lt;int, int&gt;&gt; calendar; bool book(int start, int end) &#123; //è·å–æ¯”endæ°å¥½å¤§çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œæ²¡æœ‰åˆ™è¿”å›è¿­ä»£å™¨end() //å¦‚æœcalendaræ²¡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›è¿­ä»£å™¨begin() auto temp = calendar.lower_bound(&#123;end, 0&#125;); //å¦‚æœtempä¸ºbegin()è¯´æ˜æ²¡æœ‰å…ƒç´ ç›´æ¥æ’å…¥ //å¦‚æœä¸ä¸ºbegin()åˆ™ä¸tempå‰é¢çš„å…ƒç´ çš„å³åŒºé—´æ¯”è¾ƒï¼Œå¦‚æœå°äºç­‰äºstartè¯´æ˜æ²¡æœ‰äº¤å‰ï¼Œæ’å…¥ if(temp == calendar.begin() || (--temp)-&gt;second &lt;= start)&#123; calendar.insert(&#123;start, end&#125;); return true; &#125; return false; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn), å…¶ä¸­ n è¡¨ç¤ºæ—¥ç¨‹å®‰æ’çš„æ•°é‡ã€‚ç”±äºæ¯æ¬¡åœ¨è¿›è¡Œé¢„è®¢æ—¶ï¼Œéƒ½éœ€è¦è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œéœ€è¦çš„æ—¶é—´ä¸º O(logn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n è¡¨ç¤ºæ—¥ç¨‹å®‰æ’çš„æ•°é‡ã€‚éœ€è¦ä¿å­˜æ‰€æœ‰å·²ç»é¢„è®¢çš„è¡Œç¨‹ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"setå®¹å™¨ç”¨æ³•","slug":"C++/setå®¹å™¨","date":"2022-07-04T16:00:00.000Z","updated":"2022-08-15T01:16:14.261Z","comments":true,"path":"2022/07/05/C++/setå®¹å™¨/","link":"","permalink":"http://example.com/2022/07/05/C++/set%E5%AE%B9%E5%99%A8/","excerpt":"","text":"setå®¹å™¨ï¼šæ‰€æœ‰å…ƒç´ éƒ½ä¼šåœ¨æ’å…¥æ—¶è‡ªåŠ¨æ’åºï¼Œåº•å±‚ç»“æ„é‡‡ç”¨äºŒå‰æ ‘å®ç°ã€‚ setå’ŒmultisetåŒºåˆ«ï¼š setä¸å¯ä»¥æ’å…¥é‡å¤æ•°æ®ï¼Œè€Œmultisetå¯ä»¥ setæ’å…¥æ•°æ®çš„åŒæ—¶ä¼šè¿”å›æ’å…¥ç»“æœï¼Œè¡¨ç¤ºæ’å…¥æ˜¯å¦æˆåŠŸ multisetä¸ä¼šæ£€æµ‹æ•°æ®ï¼Œå› æ­¤å¯ä»¥æ’å…¥é‡å¤æ•°æ® setå®¹å™¨çš„ä½¿ç”¨ï¼š å¤´æ–‡ä»¶ï¼š 12#include&lt;set&gt; using namespace std; æ„é€ å‡½æ•°ï¼š æ„é€ å‡½æ•° è§£é‡Š set() é»˜è®¤æ„é€ å‡½æ•° set(const set &amp;st) æ‹·è´æ„é€ å‡½æ•° æˆå‘˜å‡½æ•°ï¼š æˆå‘˜å‡½æ•° è§£é‡Š void insert(T key) æ’å…¥key void emplace(T key) æ’å…¥keyï¼Œæ¯”insert()æ•ˆç‡é«˜ erase() åˆ é™¤ void clear() æ¸…ç©º bool find(T key) æŸ¥æ‰¾ int count(T key) ç»Ÿè®¡ int size() è·å–å¤§å° bool empty() æ˜¯å¦ä¸ºç©º void swap(set &amp;st) äº¤æ¢ iterator lower_bound(T key) å¦‚æœsetå®¹å™¨ä¸­æ²¡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›è¿­ä»£å™¨begin()ï¼›å¦‚æœsetå®¹å™¨ä¸­å­˜åœ¨å…ƒç´ ï¼Œåˆ™è¿”å›æ°å¥½æ¯”keyå¤§çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œä¸å­˜åœ¨åˆ™è¿”å›è¿­ä»£å™¨end() è‡ªå®šä¹‰æ•°æ®ç±»å‹æ’åº set&lt;pair&lt;int,int&gt;&gt; seté»˜è®¤çš„æ¯”è¾ƒè§„åˆ™å…ˆæŒ‰ç…§firstæ¯”è¾ƒï¼Œå¦‚æœfirstç›¸åŒï¼Œå†æŒ‰ç…§second æ¯”è¾ƒã€‚","categories":[{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"}],"tags":[{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"}]},{"title":"(æ¯æ—¥LeetCode)1200. æœ€å°ç»å¯¹å·®","slug":"æ¯æ—¥LeetCode/2022-7/1200 æœ€å°ç»å¯¹å·®","date":"2022-07-03T23:54:00.000Z","updated":"2022-07-08T00:36:23.299Z","comments":true,"path":"2022/07/04/æ¯æ—¥LeetCode/2022-7/1200 æœ€å°ç»å¯¹å·®/","link":"","permalink":"http://example.com/2022/07/04/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1200%20%E6%9C%80%E5%B0%8F%E7%BB%9D%E5%AF%B9%E5%B7%AE/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸ªæ•´æ•°æ•°ç»„ arrï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½ ä¸ç›¸åŒã€‚ è¯·ä½ æ‰¾åˆ°æ‰€æœ‰å…·æœ‰æœ€å°ç»å¯¹å·®çš„å…ƒç´ å¯¹ï¼Œå¹¶ä¸”æŒ‰å‡åºçš„é¡ºåºè¿”å›ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹1ï¼š è¾“å…¥ï¼šarr &#x3D; [4,2,1,3]è¾“å‡ºï¼š[[1,2],[2,3],[3,4]] ç¤ºä¾‹2ï¼š è¾“å…¥ï¼šarr &#x3D; [1,3,6,10,15]è¾“å‡ºï¼š[[1,3]] æ€è·¯ï¼šå…ˆå°†arræ•°ç»„æ’åº å†éå†arræ•°ç»„ï¼Œå¦‚æœæ‰¾åˆ°æœ‰æ¯”minæ›´å°çš„å·®å€¼ï¼Œå°†minæ”¹ä¸ºè¯¥å·®å€¼ï¼Œå°†dpæ•°ç»„ä¹‹å‰è®°å½•çš„æ•°æ®æ¸…ç©º(å› ä¸ºä¹‹å‰è®°å½•çš„éƒ½æ˜¯å·®å€¼å¤§çš„)ï¼Œé‡æ–°æ’å…¥å·®å€¼æ›´å°çš„æ•°æ®ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324class Solution &#123;public: vector&lt;vector&lt;int&gt;&gt; minimumAbsDifference(vector&lt;int&gt;&amp; arr) &#123; //å°†arræ•°ç»„æ’åº sort(arr.begin(),arr.end()); int min = INT_MAX; vector&lt;vector&lt;int&gt;&gt; dp; for(int i = 1; i &lt; arr.size(); i++)&#123; //å½“å‰çš„å·®å€¼ int temp = arr[i]-arr[i-1]; if(temp &lt; min)&#123; min = temp; //å°†dpæ•°ç»„æ¸…ç©º dp.clear(); //é‡æ–°æ’å…¥æ–°çš„å·®å€¼å°çš„æ•°æ® dp.push_back(&#123;arr[i-1],arr[i]&#125;); &#125; else if(temp == min)&#123; dp.push_back(&#123;arr[i-1],arr[i]&#125;); &#125; &#125; return dp; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚æ’åºéœ€è¦çš„æ—¶é—´ä¸º O(nlogn)ï¼Œéå†éœ€è¦çš„æ˜¯æ—¶é—´ä¸º O(n)ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦ä¸º O(nlogn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå³ä¸ºæ’åºéœ€è¦ä½¿ç”¨çš„æ ˆç©ºé—´ã€‚è¿™é‡Œä¸è®¡å…¥è¿”å›å€¼éœ€è¦ä½¿ç”¨çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)556. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III","slug":"æ¯æ—¥LeetCode/2022-7/556 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III","date":"2022-07-03T04:00:00.000Z","updated":"2022-07-08T00:35:35.528Z","comments":true,"path":"2022/07/03/æ¯æ—¥LeetCode/2022-7/556 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III/","link":"","permalink":"http://example.com/2022/07/03/%E6%AF%8F%E6%97%A5LeetCode/2022-7/556%20%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E5%85%83%E7%B4%A0%20III/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° n ï¼Œè¯·ä½ æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„æœ€å°æ•´æ•°ï¼Œå…¶ç”±é‡æ–°æ’åˆ— n ä¸­å­˜åœ¨çš„æ¯ä½æ•°å­—ç»„æˆï¼Œå¹¶ä¸”å…¶å€¼å¤§äº n ã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„æ­£æ•´æ•°ï¼Œåˆ™è¿”å› -1 ã€‚ æ³¨æ„ ï¼Œè¿”å›çš„æ•´æ•°åº”å½“æ˜¯ä¸€ä¸ª 32 ä½æ•´æ•° ï¼Œå¦‚æœå­˜åœ¨æ»¡è¶³é¢˜æ„çš„ç­”æ¡ˆï¼Œä½†ä¸æ˜¯ 32 ä½æ•´æ•° ï¼ŒåŒæ ·è¿”å› -1ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šn &#x3D; 12324321è¾“å‡ºï¼š12331224 ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šn &#x3D; 21è¾“å‡ºï¼š-1 æ€è·¯ï¼šä»¥n = 12324321ä¸ºä¾‹ â‘ .pos1æŒ‡é’ˆä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°ç¬¬pos1ä½ç½®çš„æ•°æ¯”åé¢çš„æ•°å°çš„ä½ç½®ï¼Œpos1è®°å½•ä½ç½® 1 2 3 2 4 3 2 1 $\\leftarrow\\Uparrow$pos1 2ä¸1æ¯”è¾ƒï¼Œ2å¤§ï¼Œpos1å‘å·¦ç§» å¾ªç¯ç›´åˆ°ï¼š 1 2 3 2 4 3 2 1 $\\leftarrow\\Uparrow$pos1 2ä¸4æ¯”è¾ƒï¼Œ2å°ï¼Œè®°å½•pos1çš„ä½ç½® â‘¡.å†å®šä¹‰pos2æŒ‡é’ˆï¼Œä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°æ¯”pos1ä½ç½®åé¢çš„æ•°ä¸­ï¼Œæœ‰æ¯”pos1ä½ç½®çš„æ•°å¤§çš„æ•°ï¼Œç”¨pos2è®°å½•ä½ç½® 1 2 3 2 4 3 2 1 $\\Uparrow$pos1 $\\leftarrow\\Uparrow$pos2 pos1å¤§äºpos2ï¼Œpos2æŒ‡é’ˆå·¦ç§» å¾ªç¯ç›´åˆ°ï¼š 1 2 3 2 4 3 2 1 $\\Uparrow$pos1 $\\leftarrow\\Uparrow$pos2 pos1å°äºpos2ï¼Œè®°å½•æŒ‡é’ˆpos2ä½ç½® â‘¢.äº¤æ¢pos1å’Œpos2çš„ä½ç½® 1 2 3 3 4 2 2 1 â‘£.å°†pos1ä½ç½®åé¢çš„æ•°è¿›è¡Œåè½¬ 1 2 3 3 1 2 2 4 ç»“æœï¼š12331224 ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728class Solution &#123;public: int nextGreaterElement(int n) &#123; //å°†nè½¬æ¢æˆå­—ç¬¦ä¸² string num = to_string(n); int pos1 = num.size()-2; //ä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°å‰é¢çš„æ•°å°äºåé¢çš„æ•°ï¼Œå‰é¢æ•°çš„ä½ç½® while(pos1 &gt;= 0 &amp;&amp; num[pos1] &gt;= num[pos1+1])&#123; pos1--; &#125; //éå†åˆ°å­—ç¬¦ä¸²ç¬¬0ä¸ªä½ç½®ï¼Œè¿˜æ²¡æœ‰å°äºçš„æ•°ï¼Œåˆ™ä¸å­˜åœ¨ if(pos1 &lt; 0) return -1; int pos2 = num.size()-1; //ä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°æœ‰æ¯”pos1ä½ç½®çš„æ•°å°çš„æ•°ï¼Œè¿”å›pos2ä½ç½® while(pos2 &gt; pos1 &amp;&amp; num[pos1] &gt;= num[pos2])&#123; pos2--; &#125; //äº¤æ¢ä¸¤ä¸ªä½ç½®çš„æ•° swap(num[pos1],num[pos2]); //å°†pos1åé¢çš„å­—ç¬¦ä¸²åè½¬ reverse(num.begin() + pos1 + 1, num.end()); //é˜²æ­¢æº¢å‡ºï¼Œå…ˆå°†tempè½¬æ¢æˆlongå‹ long temp = stol(num); //å¦‚æœè¶…å‡ºintçš„èŒƒå›´ï¼Œè¿”å›-1 if(temp &gt; INT_MAX) return -1; return temp; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(logn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)871. æœ€ä½åŠ æ²¹æ¬¡æ•°","slug":"æ¯æ—¥LeetCode/2022-7/871 æœ€ä½åŠ æ²¹æ¬¡æ•°","date":"2022-07-02T07:36:00.000Z","updated":"2022-07-08T00:35:45.486Z","comments":true,"path":"2022/07/02/æ¯æ—¥LeetCode/2022-7/871 æœ€ä½åŠ æ²¹æ¬¡æ•°/","link":"","permalink":"http://example.com/2022/07/02/%E6%AF%8F%E6%97%A5LeetCode/2022-7/871%20%E6%9C%80%E4%BD%8E%E5%8A%A0%E6%B2%B9%E6%AC%A1%E6%95%B0/","excerpt":"","text":"é¢˜ç›®ï¼šæ±½è½¦ä»èµ·ç‚¹å‡ºå‘é©¶å‘ç›®çš„åœ°ï¼Œè¯¥ç›®çš„åœ°ä½äºå‡ºå‘ä½ç½®ä¸œé¢ target è‹±é‡Œå¤„ã€‚ æ²¿é€”æœ‰åŠ æ²¹ç«™ï¼Œæ¯ä¸ª station[i] ä»£è¡¨ä¸€ä¸ªåŠ æ²¹ç«™ï¼Œå®ƒä½äºå‡ºå‘ä½ç½®ä¸œé¢ station[i][0] è‹±é‡Œå¤„ï¼Œå¹¶ä¸”æœ‰ station[i][1]å‡æ±½æ²¹ã€‚ å‡è®¾æ±½è½¦æ²¹ç®±çš„å®¹é‡æ˜¯æ— é™çš„ï¼Œå…¶ä¸­æœ€åˆæœ‰startFuelå‡ç‡ƒæ–™ã€‚å®ƒæ¯è¡Œé©¶ 1 è‹±é‡Œå°±ä¼šç”¨æ‰ 1 å‡æ±½æ²¹ã€‚ å½“æ±½è½¦åˆ°è¾¾åŠ æ²¹ç«™æ—¶ï¼Œå®ƒå¯èƒ½åœä¸‹æ¥åŠ æ²¹ï¼Œå°†æ‰€æœ‰æ±½æ²¹ä»åŠ æ²¹ç«™è½¬ç§»åˆ°æ±½è½¦ä¸­ã€‚ ä¸ºäº†åˆ°è¾¾ç›®çš„åœ°ï¼Œæ±½è½¦æ‰€å¿…è¦çš„æœ€ä½åŠ æ²¹æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿå¦‚æœæ— æ³•åˆ°è¾¾ç›®çš„åœ°ï¼Œåˆ™è¿”å› -1 ã€‚ æ³¨æ„ï¼šå¦‚æœæ±½è½¦åˆ°è¾¾åŠ æ²¹ç«™æ—¶å‰©ä½™ç‡ƒæ–™ä¸º 0ï¼Œå®ƒä»ç„¶å¯ä»¥åœ¨é‚£é‡ŒåŠ æ²¹ã€‚å¦‚æœæ±½è½¦åˆ°è¾¾ç›®çš„åœ°æ—¶å‰©ä½™ç‡ƒæ–™ä¸º 0ï¼Œä»ç„¶è®¤ä¸ºå®ƒå·²ç»åˆ°è¾¾ç›®çš„åœ°ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹1ï¼š è¾“å…¥ï¼štarget &#x3D; 100, startFuel &#x3D; 1, stations &#x3D; [[10,100]]è¾“å‡ºï¼š-1è§£é‡Šï¼šæˆ‘ä»¬æ— æ³•æŠµè¾¾ç›®çš„åœ°ï¼Œç”šè‡³æ— æ³•åˆ°è¾¾ç¬¬ä¸€ä¸ªåŠ æ²¹ç«™ã€‚ ç¤ºä¾‹2ï¼š è¾“å…¥ï¼štarget &#x3D; 100, startFuel &#x3D; 10, stations &#x3D; [[10,60],[20,30],[30,30],[60,40]]è¾“å‡ºï¼š2è§£é‡Šï¼šæˆ‘ä»¬å‡ºå‘æ—¶æœ‰ 10 å‡ç‡ƒæ–™ã€‚æˆ‘ä»¬å¼€è½¦æ¥åˆ°è·èµ·ç‚¹ 10 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™ï¼Œæ¶ˆè€— 10 å‡ç‡ƒæ–™ã€‚å°†æ±½æ²¹ä» 0 å‡åŠ åˆ° 60 å‡ã€‚ç„¶åï¼Œæˆ‘ä»¬ä» 10 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™å¼€åˆ° 60 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™ï¼ˆæ¶ˆè€— 50 å‡ç‡ƒæ–™ï¼‰ï¼Œå¹¶å°†æ±½æ²¹ä» 10 å‡åŠ åˆ° 50 å‡ã€‚ç„¶åæˆ‘ä»¬å¼€è½¦æŠµè¾¾ç›®çš„åœ°ã€‚æˆ‘ä»¬æ²¿é€”åœ¨1ä¸¤ä¸ªåŠ æ²¹ç«™åœé ï¼Œæ‰€ä»¥è¿”å› 2 ã€‚ æ€è·¯ï¼š ä¸€ã€å›æº¯æ³•ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930class Solution &#123;public: int def(vector&lt;vector&lt;int&gt;&gt;&amp; stations,int cur_station, int begin, int&amp; end, int oil)&#123; //åˆ°è¾¾ç›®çš„åœ° if(oil+begin &gt;= end) return 0; //æ²¹é‡ä¸å¤Ÿåˆ°è¾¾ç›®çš„åœ° if(cur_station+1 == stations.size() &amp;&amp; oil+begin &lt; end)&#123; return -1; &#125; //æ²¹é‡ä¸å¤Ÿåˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™ if(cur_station+1 &lt; stations.size() &amp;&amp; oil+begin &lt; stations[cur_station+1][0])&#123; return -1; &#125; int ans = INT_MAX; for(int i = cur_station+1; i &lt; stations.size(); i++)&#123; if(stations[i][0] &lt;= begin+oil)&#123; int temp = def(stations, i, stations[i][0] ,end ,oil+begin-stations[i][0]+stations[i][1]); if(temp != -1 &amp;&amp; ans &gt; temp+1) ans = temp+1; &#125; &#125; if(ans == INT_MAX) ans = -1; return ans; &#125; int minRefuelStops(int target, int startFuel, vector&lt;vector&lt;int&gt;&gt;&amp; stations) &#123; //å‡ºå‘åœ°æ²¡æœ‰åŠ æ²¹ç«™ï¼Œç¬¬ä¸€ä¸ªåŠ æ²¹ç«™ç¼–å·ä¸º0ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸º-1 return def(stations, -1, 0, target, startFuel); &#125;&#125;; è¿è¡Œè¶…æ—¶ äºŒã€è´ªå¿ƒæ€è·¯ï¼šå¦‚æœä¸éœ€è¦åŠ æ²¹å°±å¾€å‰èµ°ï¼Œå½“ä¸å¤Ÿåˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™æˆ–ç›®çš„åœ°ï¼Œå°±ä»ä¹‹å‰èµ°åˆ°è¿‡çš„åŠ æ²¹ç«™ä¹‹ä¸­é€‰æ‹©æ±½æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™è¿›è¡Œè¡¥å……æ±½æ²¹ã€‚ ä»¥æ­¤å¾€å¤ï¼Œåˆ°è¾¾ç›®çš„åœ°ã€‚ å¦‚æœæ‰€æœ‰åŠ æ²¹ç«™çš„æ±½æ²¹éƒ½è¢«åŠ å®Œï¼Œå¹¶ä¸”æ²¡åˆ°è¾¾ç›®çš„åœ°ï¼Œåˆ™ä¸å¯èƒ½åˆ°è¾¾ã€‚ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829303132class Solution &#123;public: int minRefuelStops(int target, int startFuel, vector&lt;vector&lt;int&gt;&gt;&amp; stations) &#123; priority_queue&lt;int&gt; pq; int count = 0; //åˆå§‹åŒ–åŠ æ²¹æ¬¡æ•° int begin = 0; //åˆå§‹åŒ–è·¯ç¨‹ int cur_fuel = startFuel;//åˆå§‹åŒ–è½¦çš„æ±½æ²¹é‡ int cur_distance; //è¡¨ç¤ºå½“å‰çš„è·¯ç¨‹ for (int i = 0; i &lt;= stations.size(); i++) &#123; if(i &lt; stations.size()) cur_distance = stations[i][0]; else cur_distance = target; //(cur_distance - begin)ï¼šè¡¨ç¤ºç¬¬i-1ä¸ªåŠ æ²¹ç«™åˆ°ç¬¬iä¸ªåŠ æ²¹ç«™ä¹‹é—´çš„è·¯ç¨‹ï¼Œcur_fuelä¸ºåˆ°ç¬¬iä¸ªåŠ æ²¹ç«™æ—¶å‰©ä½™çš„æ²¹é‡ cur_fuel -= cur_distance - begin; //å¦‚æœæ²¹é‡ä¸ºè´Ÿæ•°ï¼Œè¯´æ˜éœ€è¦ä»ç¬¬iä¸ªåŠ æ²¹ç«™ï¼Œä¹‹å‰çš„åŠ æ²¹ç«™ä¹‹ä¸­é€‰æ‹©åŠ æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™ï¼Œè¿›è¡Œè¡¥å……æ±½æ²¹ while (cur_fuel &lt; 0 &amp;&amp; !pq.empty()) &#123; cur_fuel += pq.top();//é€‰æ‹©æ±½æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™è¡¥å…… pq.pop(); count++;//åŠ æ²¹æ¬¡æ•°åŠ 1 &#125; //éƒ½å·²ç»æŠŠä¹‹å‰çš„åŠ æ²¹ç«™çš„æ±½æ²¹éƒ½è¡¥å……äº†ï¼Œè¿˜æ˜¯è´Ÿæ•°è¯´æ˜æ— æ³•åˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™æˆ–ç›®çš„åœ° if (cur_fuel &lt; 0) &#123; return -1; &#125; if (i &lt; stations.size()) &#123; //å°†ç¬¬iä¸ªåŠ æ²¹ç«™çš„æ±½æ²¹é‡è®°å½•ï¼Œç°åœ¨ä¸éœ€è¦åŠ æ²¹ï¼Œç­‰ä»¥åç¼ºæ²¹å†åŠ  pq.emplace(stations[i][1]); begin = cur_distance;//æ›´æ–°è·¯ç¨‹ &#125; &#125; return count; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ stations çš„é•¿åº¦ã€‚éœ€è¦éå†æ•°ç»„ stations ä¸€æ¬¡ï¼Œæ¯ä¸ªåŠ æ²¹ç«™çš„æ±½æ²¹é‡æœ€å¤šæ·»åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—å’Œä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­ç§»é™¤å„ä¸€æ¬¡ï¼Œæ¯æ¬¡ä¼˜å…ˆé˜Ÿåˆ—çš„æ“ä½œéœ€è¦ O(logn) çš„æ—¶é—´ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ stations çš„é•¿åº¦ã€‚ä¼˜å…ˆé˜Ÿåˆ—éœ€è¦ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"vectorå®¹å™¨ç”¨æ³•","slug":"C++/vecterå®¹å™¨","date":"2022-06-30T09:00:00.000Z","updated":"2022-07-05T03:52:02.168Z","comments":true,"path":"2022/06/30/C++/vecterå®¹å™¨/","link":"","permalink":"http://example.com/2022/06/30/C++/vecter%E5%AE%B9%E5%99%A8/","excerpt":"","text":"vectoræ˜¯ä»€ä¹ˆï¼Ÿvectoræ˜¯ä¸€ä¸ªèƒ½å¤Ÿå­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„ã€‚ vectorå®ç°åŠ¨æ€å¢é•¿çš„åŸç†ï¼švectorçš„åŸç†å°±æ˜¯åŠ¨æ€æ•°ç»„ã€‚å½“æ’å…¥æ–°å…ƒç´ çš„æ—¶å€™ï¼Œå¦‚æœç©ºé—´ä¸è¶³ï¼Œé‚£ä¹ˆvectorä¼šé‡æ–°ç”³è¯·æ›´å¤§çš„ä¸€å—ç©ºé—´ï¼Œå°†åŸç©ºé—´æ•°æ®æ‹·è´åˆ°æ–°ç©ºé—´ï¼Œé‡Šæ”¾æ—§ç©ºé—´æ•°æ®ï¼Œå†æŠŠæ–°å…ƒç´ æ’å…¥æ–°ç”³è¯·ç©ºé—´ã€‚ éœ€è¦å¯¼å…¥å¤´æ–‡ä»¶ï¼š 12#include&lt;vector&gt;using namespace std; æ„é€ å‡½æ•°ï¼š æ„é€ å‡½æ•° è§£é‡Š vector() åˆ›å»ºä¸€ä¸ªç©ºçš„vector vector(int size) åˆ›å»ºä¸€ä¸ªvector,å…ƒç´ ä¸ªæ•°ä¸ºsizeï¼Œä¸”å€¼å‡ä¸º0(é»˜è®¤ä¸º0) vector(int size, T value) åˆ›å»ºä¸€ä¸ªvectorï¼Œå…ƒç´ ä¸ªæ•°ä¸ºsize,ä¸”å€¼å‡ä¸ºvalue vector(const vector&amp; v) å¦ä¸€ä¸ªvectorå®¹å™¨æ‹·è´åˆ°è¿™ä¸ªvectorä¸­ vector(iterator begin(), iterator end()) å¦ä¸€ä¸ª[begin,end)åŒºé—´å†…çš„æ•°ç»„å…ƒç´ çš„å¤åˆ¶è¿™ä¸ªvectorä¸­ æˆå‘˜å‡½æ•°ï¼š æ’å…¥å‡½æ•° è§£é‡Š void push_back(const T&amp; x) å®¹å™¨å°¾éƒ¨æ’å…¥ä¸€ä¸ªå…ƒç´ X void emplace_back(const T&amp; x) å®¹å™¨å°¾éƒ¨æ’å…¥ä¸€ä¸ªå…ƒç´ Xï¼Œæ¯”push_back()æ•ˆç‡é«˜ iterator insert(iterator it,const T&amp; x) å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥ä¸€ä¸ªå…ƒç´ x iterator insert(iterator it,int n,const T&amp; x) å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥nä¸ªç›¸åŒçš„å…ƒç´ x iterator insert(iterator it,const_iterator first,const_iterator last) å‘é‡ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥å¦ä¸€ä¸ªç›¸åŒç±»å‹çš„vectorå®¹å™¨çš„[first,last)é—´çš„æ•°æ® åˆ é™¤å‡½æ•° è§£é‡Š iterator erase(iterator it) åˆ é™¤å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´  iterator erase(iterator first,iterator last) åˆ é™¤å®¹å™¨ä¸­[first,last)ä¸­çš„å…ƒç´  void pop_back() åˆ é™¤å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´  void clear() æ¸…ç©ºå®¹å™¨ä¸­æ‰€æœ‰å…ƒç´  éå†å‡½æ•° è§£é‡Š T at(int pos) è¿”å›posä½ç½®çš„å…ƒç´ (ç¬¬ä¸€ä¸ªä½ç½®ä¸º0) T front() è¿”å›é¦–å…ƒç´  T back() è¿”å›å°¾å…ƒç´  iterator begin() è¿”å›vectorå®¹å™¨ä¸­æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ iterator end() è¿”å›vectorå®¹å™¨ä¸­æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®çš„è¿­ä»£å™¨ reverse_iterator rbegin() åå‘è¿­ä»£å™¨ï¼ŒæŒ‡å‘å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´  reverse_iterator rend() åå‘è¿­ä»£å™¨ï¼ŒæŒ‡å‘å®¹å™¨ç¬¬ä¸€ä¸ªå…ƒç´ å‰é¢çš„ä½ç½® å¤§å°å‡½æ•° è§£é‡Š int size() è¿”å›vectorå®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•° int capacity() è¿”å›å½“å‰vectorå®¹å™¨æ‰€èƒ½å®¹çº³çš„æœ€å¤§å®¹é‡ int max_size() è¿”å›vectorå®¹å™¨çš„æœ€å¤§å¯å…è®¸çš„å®¹é‡ void resize(int size) æ›´æ”¹vectorå®¹å™¨çš„å…ƒç´ çš„ä¸ªæ•°ä¸ºsize void reserve(int capacity) æ›´æ”¹vectorå®¹å™¨çš„å®¹é‡ä¸ºcapacity èµ‹å€¼å‡½æ•° è§£é‡Š vector&amp; operator&#x3D; å°†å³è¾¹vectorå®¹å™¨çš„å…ƒç´ æ‹·è´åˆ°å·¦è¾¹vectorå®¹å™¨ä¸­ void assign(int n,const T&amp; x) è®¾ç½®å®¹å™¨ä¸­å‰nä¸ªå…ƒç´ çš„å€¼ä¸ºx void assign(const_iterator first,const_iterator last) å°†å¦ä¸€ä¸ªvectorå®¹å™¨ä¸­[first,last)ä¸­å…ƒç´ è®¾ç½®æˆå½“å‰vectorå®¹å™¨çš„å…ƒç´  å…¶ä»–å‡½æ•° è§£é‡Š bool empty() åˆ¤æ–­å‘é‡æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ºç©ºï¼Œåˆ™è¿”å›çœŸ void swap(vector&amp; v) å°†ä¸¤ä¸ªåŒç±»å‹vectorå®¹å™¨çš„å…ƒç´ äº’æ¢ vectorçš„éå†ï¼š123for(int i = 0; i &lt; v.size(); i++)&#123; cout &lt;&lt; v[i] &lt;&lt; endl;&#125; 123for (int i = 0; i &lt; v.size(); i++)&#123; cout &lt;&lt; v1.at(i) &lt;&lt; endl;&#125; 123for (vector&lt;int&gt;::iterator it = v.begin(); it != v.end(); it++)&#123; cout &lt;&lt; *it &lt;&lt; endl;&#125; 123for (auto it = v.begin(); it != v.end(); it++)&#123; cout &lt;&lt; *it &lt;&lt; endl;&#125;","categories":[{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"}],"tags":[{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"}]},{"title":"(æ¯æ—¥LeetCode)1175. è´¨æ•°æ’åˆ—","slug":"æ¯æ—¥LeetCode/2022-6/1175 è´¨æ•°æ’åˆ—","date":"2022-06-30T03:09:00.000Z","updated":"2022-07-08T00:35:49.057Z","comments":true,"path":"2022/06/30/æ¯æ—¥LeetCode/2022-6/1175 è´¨æ•°æ’åˆ—/","link":"","permalink":"http://example.com/2022/06/30/%E6%AF%8F%E6%97%A5LeetCode/2022-6/1175%20%E8%B4%A8%E6%95%B0%E6%8E%92%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šè¯·ä½ å¸®å¿™ç»™ä» 1 åˆ° n çš„æ•°è®¾è®¡æ’åˆ—æ–¹æ¡ˆï¼Œä½¿å¾—æ‰€æœ‰çš„ã€Œè´¨æ•°ã€éƒ½åº”è¯¥è¢«æ”¾åœ¨ã€Œè´¨æ•°ç´¢å¼•ã€ï¼ˆç´¢å¼•ä» 1 å¼€å§‹ï¼‰ä¸Šï¼›ä½ éœ€è¦è¿”å›å¯èƒ½çš„æ–¹æ¡ˆæ€»æ•°ã€‚ç”±äºç­”æ¡ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼Œæ‰€ä»¥è¯·ä½ è¿”å›ç­”æ¡ˆ æ¨¡ mod $10^9$ + 7 ä¹‹åçš„ç»“æœå³å¯ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šn &#x3D; 5è¾“å‡ºï¼š12 è§£é‡Šï¼š å…ˆçœ‹è´¨æ•°å®šä¹‰ï¼šä¸€ä¸ªå¤§äº1çš„è‡ªç„¶æ•°ï¼Œé™¤äº†1å’Œå®ƒè‡ªèº«å¤–ï¼Œä¸èƒ½è¢«å…¶ä»–è‡ªç„¶æ•°æ•´é™¤çš„æ•°å«åšè´¨æ•°ã€‚(1ä¸æ˜¯è´¨æ•°) ç”¨çº¢è‰²æ ‡è®°è´¨æ•°ï¼š 1 2 3 4 5 é¢˜ç›®çš„æ„æ€æ˜¯å°†è´¨æ•°å’Œéè´¨æ•°å„åˆ†ä¸€ç»„ï¼Œè¿›è¡Œæ’åºä¸€å…±æœ‰å¤šå°‘ç§å¯èƒ½ï¼š mä¸ªæ•°æ’åˆ—mä¸ªä½ç½®ï¼Œå…¨æ’åˆ—å…¬å¼ï¼š$A^m_m&#x3D;m!$ $A^3_3$ä¸ºè´¨æ•°çš„æ‰€æœ‰æ’åˆ—æ¬¡æ•° $A^2_2$ä¸ºéè´¨æ•°çš„æ‰€æœ‰æ’åˆ—æ¬¡æ•° å¹¶ä¸”æ¯æœ‰ä¸€ä¸ªè´¨æ•°çš„æ’åˆ—ç»„åˆå°±æœ‰$A^2_2$æ¬¡éè´¨æ•°çš„æ’åˆ—ï¼š æ€»æ•°ï¼š$A^3_3 \\times A^2_2&#x3D;3! \\times 2!&#x3D;12$ æ€è·¯ï¼šéå†æ•°ç»„åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•°ï¼Œè®°å½•è´¨æ•°çš„ä¸ªæ•°pï¼Œéè´¨æ•°ä¸ªæ•°ä¸ºn-p è¿ç”¨å…¬å¼æ±‚å‡ºæ€»æ•°ï¼š$A^p_p \\times A^{n-p}_{n-p}&#x3D;p! \\times (n-p)!$ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930313233343536373839class Solution &#123;public: int mod = pow(10,9)+7; //åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•° bool is_prime(int n)&#123; //ä»2å¼€å§‹ for(int i = 2; i*i &lt;= n;i++)&#123; //æ¨¡è¿ç®—ä¸º0ï¼Œä¸æ˜¯è´¨æ•° if(n%i == 0)&#123; return false; &#125; &#125; return true; &#125; //n!è¿ç®— Longç±»å‹é˜²æ­¢æº¢å‡º long factorial(int n)&#123; long sum = 1; for(int i = 2; i &lt;= n; i++)&#123; sum *=i; sum = sum%mod; &#125; return sum; &#125; int numPrimeArrangements(int n) &#123; int prime_num = 0; //ä»2å¼€å§‹ï¼Œ1ä¸æ˜¯è´¨æ•° for(int i = 2; i &lt;= n; i++)&#123; if(is_prime(i))&#123; prime_num++; &#125; &#125; //n!*(n-p)! long result = (factorial(prime_num)*factorial(n-prime_num))%mod; return (int)result; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO($n^{3&#x2F;2}$)ã€‚æ±‚ n ä¸ªæ•°ä¸­è´¨æ•°ä¸ªæ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º O($n^{3&#x2F;2}$)ï¼Œé˜¶ä¹˜çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º O($n^{3&#x2F;2}$)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)O(1)ï¼Œåªä½¿ç”¨äº†å¸¸æ•°ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)535. TinyURLçš„åŠ å¯†ä¸è§£å¯†","slug":"æ¯æ—¥LeetCode/2022-6/535 TinyURLçš„åŠ å¯†ä¸è§£å¯†","date":"2022-06-28T23:41:00.000Z","updated":"2022-07-02T07:51:52.081Z","comments":true,"path":"2022/06/29/æ¯æ—¥LeetCode/2022-6/535 TinyURLçš„åŠ å¯†ä¸è§£å¯†/","link":"","permalink":"http://example.com/2022/06/29/%E6%AF%8F%E6%97%A5LeetCode/2022-6/535%20TinyURL%E7%9A%84%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/","excerpt":"","text":"é¢˜ç›®ï¼šTinyURL æ˜¯ä¸€ç§ URL ç®€åŒ–æœåŠ¡ï¼Œ æ¯”å¦‚ï¼šå½“ä½ è¾“å…¥ä¸€ä¸ª URL https://leetcode.com/problems/design-tinyurl æ—¶ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªç®€åŒ–çš„URL http://tinyurl.com/4e9iAk ã€‚è¯·ä½ è®¾è®¡ä¸€ä¸ªç±»æ¥åŠ å¯†ä¸è§£å¯† TinyURL ã€‚ åŠ å¯†å’Œè§£å¯†ç®—æ³•å¦‚ä½•è®¾è®¡å’Œè¿ä½œæ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œä½ åªéœ€è¦ä¿è¯ä¸€ä¸ª URL å¯ä»¥è¢«åŠ å¯†æˆä¸€ä¸ª TinyURL ï¼Œå¹¶ä¸”è¿™ä¸ª TinyURL å¯ä»¥ç”¨è§£å¯†æ–¹æ³•æ¢å¤æˆåŸæœ¬çš„ URL ã€‚ å®ç° Solution ç±»ï¼š Solution() åˆå§‹åŒ– TinyURL ç³»ç»Ÿå¯¹è±¡ã€‚String encode(String longUrl) è¿”å› longUrl å¯¹åº”çš„ TinyURL ã€‚String decode(String shortUrl) è¿”å› shortUrl åŸæœ¬çš„ URL ã€‚é¢˜ç›®æ•°æ®ä¿è¯ç»™å®šçš„ shortUrl æ˜¯ç”±åŒä¸€ä¸ªç³»ç»Ÿå¯¹è±¡åŠ å¯†çš„ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šurl &#x3D; â€œhttps://leetcode.com/problems/design-tinyurlâ€œè¾“å‡ºï¼šâ€https://leetcode.com/problems/design-tinyurlâ€œ è§£é‡Šï¼šSolution obj &#x3D; new Solution();string tiny &#x3D; obj.encode(url); &#x2F;&#x2F; è¿”å›åŠ å¯†åå¾—åˆ°çš„ TinyURL ã€‚string ans &#x3D; obj.decode(tiny); &#x2F;&#x2F; è¿”å›è§£å¯†åå¾—åˆ°çš„åŸæœ¬çš„ URL ã€‚ æ€è·¯ï¼šä½¿ç”¨è‡ªå¢idä½œä¸ºlongUrlçš„é”®ï¼Œå­˜å…¥unordered_mapå®¹å™¨ä¸­ æ ¹æ®idæ¥è·å–å¯¹åº”çš„longUrl ä»£ç (cpp)ï¼š1234567891011121314151617181920212223class Solution &#123;private: unordered_map&lt;int, string&gt; map; int id;public: Solution()&#123; id = 0; //åˆå§‹åŒ–id &#125; string encode(string longUrl) &#123; id++; map[id] = longUrl; //http://tinyurl.com/1 return &quot;http://tinyurl.com/&quot;+to_string(id); &#125; string decode(string shortUrl) &#123; //substr(int pos)ï¼šè·å–posä½ç½®èµ·çš„æ‰€æœ‰å­—ç¬¦ä¸² //stoi(string str)ï¼šå°†stringç±»å‹çš„å­—ç¬¦ä¸²è½¬æ¢æˆintç±»å‹çš„æ•´æ•° int t_id = stoi(shortUrl.substr(19)); return map[t_id]; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼š Encode å‡½æ•°ï¼šO(n)O(n)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸² longUrl çš„é•¿åº¦ã€‚ Decode å‡½æ•°ï¼šO(1)O(1)ã€‚æˆ‘ä»¬æŠŠ shortUrl å½“æˆæœ‰é™é•¿åº¦çš„å­—ç¬¦ä¸²çœ‹å¾…ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š Encode å‡½æ•°ï¼šO(n)O(n)ã€‚ä¿å­˜å­—ç¬¦ä¸² longUrl éœ€è¦ O(n)O(n) çš„ç©ºé—´ã€‚ Decode å‡½æ•°ï¼šO(1)O(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)324. æ‘†åŠ¨æ’åº II","slug":"æ¯æ—¥LeetCode/2022-6/324 æ‘†åŠ¨æ’åº II","date":"2022-06-28T02:30:00.000Z","updated":"2022-07-08T00:35:05.704Z","comments":true,"path":"2022/06/28/æ¯æ—¥LeetCode/2022-6/324 æ‘†åŠ¨æ’åº II/","link":"","permalink":"http://example.com/2022/06/28/%E6%AF%8F%E6%97%A5LeetCode/2022-6/324%20%E6%91%86%E5%8A%A8%E6%8E%92%E5%BA%8F%20II/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œå°†å®ƒé‡æ–°æ’åˆ—æˆ nums[0] &lt; nums[1] &gt; nums[2] &lt; nums[3]... çš„é¡ºåºã€‚ ä½ å¯ä»¥å‡è®¾æ‰€æœ‰è¾“å…¥æ•°ç»„éƒ½å¯ä»¥å¾—åˆ°æ»¡è¶³é¢˜ç›®è¦æ±‚çš„ç»“æœã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [1,5,2,4,3,6]è¾“å‡ºï¼š[3,6,2,5,1,4] æ€è·¯ï¼šåŒæŒ‡é’ˆæ³•å°†æ•°ç»„numsæŒ‰ä»å°åˆ°å¤§æ’åˆ—ï¼š 1 2 3 4 5 6 $\\leftarrow\\Uparrow$left $\\leftarrow\\Uparrow$right æŠŠæ’åºå¥½çš„æ•°ç»„åˆ†æˆä¸¤éƒ¨åˆ†ï¼ŒleftæŒ‡é’ˆä½äºæ•°ç»„ä¸­é—´ï¼ŒrightæŒ‡é’ˆä½äºæ•°ç»„æœ«å°¾ï¼Œ å°†leftå’Œrightå½“å‰ä½ç½®çš„å…ƒç´ ä¾æ¬¡æ‰“å°åï¼Œleftå’ŒrightæŒ‡é’ˆå·¦ç§»ï¼Œç›´è‡³ç»“æŸ è¾“å‡ºï¼š[3, 6, 2, 5, 1, 4] ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: void wiggleSort(vector&lt;int&gt;&amp; nums) &#123; int n = nums.size(); //è·å–æ•°ç»„çš„å…ƒç´ ä¸ªæ•° int left = n/2-1; //å®šä¹‰å·¦æŒ‡é’ˆ int right = n-1; //å®šä¹‰å³æŒ‡é’ˆ vector&lt;int&gt; new_nums(nums); sort(new_nums.begin(),new_nums.end()); //å°†æ–°æ•°ç»„æ’åº for(int i=0;i&lt;n;i++)&#123; if(i%2 == 0)&#123; //å¶æ•°ä½ç½®æ’å…¥leftæŒ‡é’ˆçš„å…ƒç´ ï¼Œå¥‡æ•°ä½ç½®æ’å…¥rightæŒ‡é’ˆçš„å…ƒç´  nums[i] = a[left]; left--; &#125; else&#123; nums[i] = a[right]; rigth--; &#125; &#125; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œæ’åºæ‰€éœ€çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(nlogn)ï¼Œæ’å…¥O(n)ï¼Œæ•´ä½“O(nlogn) ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œéœ€è¦é¢å¤–çš„ç©ºé—´å­˜æ”¾æ’åºçš„å…ƒç´ ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)å‰‘æŒ‡ Offer II 091. ç²‰åˆ·æˆ¿å­","slug":"æ¯æ—¥LeetCode/2022-6/å‰‘æŒ‡ Offer II 091 ç²‰åˆ·æˆ¿å­","date":"2022-06-25T02:00:00.000Z","updated":"2022-07-08T00:34:56.580Z","comments":true,"path":"2022/06/25/æ¯æ—¥LeetCode/2022-6/å‰‘æŒ‡ Offer II 091 ç²‰åˆ·æˆ¿å­/","link":"","permalink":"http://example.com/2022/06/25/%E6%AF%8F%E6%97%A5LeetCode/2022-6/%E5%89%91%E6%8C%87%20Offer%20II%20091%20%E7%B2%89%E5%88%B7%E6%88%BF%E5%AD%90/","excerpt":"","text":"é¢˜ç›®ï¼šå‡å¦‚æœ‰ä¸€æ’æˆ¿å­ï¼Œå…± n ä¸ªï¼Œæ¯ä¸ªæˆ¿å­å¯ä»¥è¢«ç²‰åˆ·æˆçº¢è‰²ã€è“è‰²æˆ–è€…ç»¿è‰²è¿™ä¸‰ç§é¢œè‰²ä¸­çš„ä¸€ç§ï¼Œä½ éœ€è¦ç²‰åˆ·æ‰€æœ‰çš„æˆ¿å­å¹¶ä¸”ä½¿å…¶ç›¸é‚»çš„ä¸¤ä¸ªæˆ¿å­é¢œè‰²ä¸èƒ½ç›¸åŒã€‚ å½“ç„¶ï¼Œå› ä¸ºå¸‚åœºä¸Šä¸åŒé¢œè‰²æ²¹æ¼†çš„ä»·æ ¼ä¸åŒï¼Œæ‰€ä»¥æˆ¿å­ç²‰åˆ·æˆä¸åŒé¢œè‰²çš„èŠ±è´¹æˆæœ¬ä¹Ÿæ˜¯ä¸åŒçš„ã€‚æ¯ä¸ªæˆ¿å­ç²‰åˆ·æˆä¸åŒé¢œè‰²çš„èŠ±è´¹æ˜¯ä»¥ä¸€ä¸ª n x 3 çš„æ­£æ•´æ•°çŸ©é˜µ costsæ¥è¡¨ç¤ºçš„ã€‚ ä¾‹å¦‚ï¼Œcosts[0][0] è¡¨ç¤ºç¬¬ 0 å·æˆ¿å­ç²‰åˆ·æˆçº¢è‰²çš„æˆæœ¬èŠ±è´¹ï¼›costs[1][2] è¡¨ç¤ºç¬¬ 1 å·æˆ¿å­ç²‰åˆ·æˆç»¿è‰²çš„èŠ±è´¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¯·è®¡ç®—å‡ºç²‰åˆ·å®Œæ‰€æœ‰æˆ¿å­æœ€å°‘çš„èŠ±è´¹æˆæœ¬ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: costs &#x3D; [[17,2,17],[16,16,5],[14,3,19]]è¾“å‡º: 10è§£é‡Š: å°† 0 å·æˆ¿å­ç²‰åˆ·æˆè“è‰²ï¼Œ1 å·æˆ¿å­ç²‰åˆ·æˆç»¿è‰²ï¼Œ2 å·æˆ¿å­ç²‰åˆ·æˆè“è‰²ã€‚ æœ€å°‘èŠ±è´¹: 2 + 5 + 3 &#x3D; 10ã€‚ 1.é€’å½’ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031class Solution &#123;public: int def(vector&lt;vector&lt;int&gt;&gt;&amp; costs, int pos, int n, vector&lt;vector&lt;int&gt;&gt; flag) &#123; //åˆ°è¾¾æœ€åï¼Œæ²¡æœ‰æˆ¿å­äº†ï¼Œé€€å‡º if (pos == n) return 0; int ans = INT_MAX; //ä¾æ¬¡é€‰æ‹©ä¸‰ç§é¢œè‰² for (int i = 0; i &lt; 3; i++) &#123; int temp = INT_MAX; vector&lt;vector&lt;int&gt;&gt; temp_flag(flag); //ç²‰åˆ·ç¬¬ä¸€ä¸ªæˆ¿å­ï¼Œæ— éœ€çœ‹å‰é¢æˆ¿å­çš„é¢œè‰²ï¼Œå› ä¸ºå‰é¢æ²¡æœ‰æˆ¿å­ã€‚ if (pos == 0) &#123; temp_flag[pos][i] = -1; temp = def(costs, pos + 1, n, temp_flag) + costs[pos][i]; &#125; //ç²‰åˆ·å¢™ï¼Œè¦çœ‹å‰é¢ç”¨äº†ä»€ä¹ˆé¢œè‰² else if (flag[pos - 1][i] != -1) &#123; //å°†è¿™ä¸ªæˆ¿å­çš„é¢œè‰²æ ‡è®° temp_flag[pos][i] = -1; temp = def(costs, pos + 1, n, temp_flag) + costs[pos][i]; &#125; //é€‰æ‹©èŠ±è´¹æœ€å°‘çš„é‡‘é¢ ans = min(ans, temp); &#125; return ans; &#125; int minCost(vector&lt;vector&lt;int&gt;&gt;&amp; costs) &#123; return def(costs, 0, costs.size(), costs); &#125;&#125;; é‡‡ç”¨é€’å½’çš„æ–¹æ³•ï¼Œæäº¤åï¼Œç»“æœæ‰§è¡Œè¶…æ—¶ã€‚ 2.åŠ¨æ€è§„åˆ’$$Red[pos][0]&#x3D;\\begin{cases}cost[0][0] &amp; pos &#x3D; 0; \\min(Green[pos+1][1],Blue[pos+1][2]) + costs[pos][0] &amp; pos&gt;0\\end{cases} \\$$ $$Green[pos][1]&#x3D;\\begin{cases}cost[0][1] &amp; pos &#x3D; 0; \\min(Red[pos+1][0],Blue[pos+1][2]) + costs[pos][1] &amp; pos&gt;0\\end{cases} \\$$ $$Blue[pos][2]&#x3D;\\begin{cases}cost[0][2] &amp; pos &#x3D; 0; \\min(Red[pos+1][0],Green[pos+1][1]) + costs[pos][2] &amp; pos&gt;0\\end{cases}$$ ç”»å‡ºåŠ¨æ€è§„åˆ’å›¾ï¼Œä»¥ç¤ºä¾‹ä¸ºä¾‹ï¼š costs = [[17,2,17],[16,16,5],[14,3,19]] é¢œè‰²\\pos 0 1 2 Red(0) 17 18 21 Green(1) 2 33 10 Blue(2) 17 7 37 $$mincost &#x3D; min(dp[2][0],dp[2][1],dp[2][2])$$ ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: int minCost(vector&lt;vector&lt;int&gt;&gt;&amp; costs) &#123; int n = costs.size(); vector&lt;int&gt; red(n, 0); vector&lt;int&gt; blue(n, 0); vector&lt;int&gt; green(n, 0); // åˆå§‹åŒ– red[0] = costs[0][0]; blue[0] = costs[0][1]; green[0] = costs[0][2]; for (int i = 1; i &lt; n; ++i) &#123; red[i] = min(blue[i - 1], green[i - 1]) + costs[i][0]; blue[i] = min(red[i - 1], green[i - 1]) + costs[i][1]; green[i] = min(red[i - 1], blue[i - 1]) + costs[i][2]; &#125; return min(red[n - 1], min(blue[n - 1], green[n - 1])); &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æˆ¿å­ä¸ªæ•°ã€‚éœ€è¦éå†å…¨éƒ¨æˆ¿å­ä¸€æ¬¡ï¼Œç”±äºé¢œè‰²æ•°é‡å›ºå®šæ˜¯ä¸‰ç§ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªæˆ¿å­è®¡ç®—ç²‰åˆ·æˆ¿å­çš„æœ€å°èŠ±è´¹æˆæœ¬çš„æ—¶é—´æ˜¯ O(1)ï¼Œæ€»æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚ä½¿ç”¨ç©ºé—´ä¼˜åŒ–çš„æ–¹æ³•ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º 3 çš„æ•°ç»„ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯ O(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)515. åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼(ä¸­ç­‰)","slug":"æ¯æ—¥LeetCode/2022-6/515 åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼","date":"2022-06-24T01:04:00.000Z","updated":"2022-07-08T00:35:14.972Z","comments":true,"path":"2022/06/24/æ¯æ—¥LeetCode/2022-6/515 åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼/","link":"","permalink":"http://example.com/2022/06/24/%E6%AF%8F%E6%97%A5LeetCode/2022-6/515%20%E5%9C%A8%E6%AF%8F%E4%B8%AA%E6%A0%91%E8%A1%8C%E4%B8%AD%E6%89%BE%E6%9C%80%E5%A4%A7%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¯·æ‰¾å‡ºè¯¥äºŒå‰æ ‘ä¸­æ¯ä¸€å±‚çš„æœ€å¤§å€¼ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: root &#x3D; [1,3,2,5,3,null,9]è¾“å‡º: [1,3,9] æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢æˆ‘ä»¬é‡‡ç”¨æ ‘çš„å…ˆåºéå†ï¼Œæ¥è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå¹¶ç”¨posæ¥è®°å½•å½“å‰æ ‘çš„é«˜åº¦ï¼Œå°±å¯ä»¥é€šè¿‡posé«˜åº¦æ¥åˆ¤æ–­æ˜¯å¦åœ¨åŒä¸€å±‚ï¼Œå¹¶ä¸”æ˜¯å¦æ›´æ–°æ­¤é«˜åº¦çš„æœ€å¤§å€¼ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627class Solution &#123;public: void dfs(TreeNode* root, vector&lt;int&gt;&amp; result, int pos)&#123; //å¦‚æœè¯¥ç»“ç‚¹ä¸ºç©ºï¼Œåˆ™é€€å‡º if(root == nullptr) return; if(result.size() == pos)&#123; //æ•°ç»„çš„å¤§å°å°äºé«˜åº¦ï¼Œå¤§å°éœ€è¦åŠ 1 result.push_back(root-&gt;val); &#125; else&#123; //åˆ¤æ–­è¯¥å±‚çš„æŸä¸ªç»“ç‚¹ï¼Œä¸ä¹‹å‰è®°å½•çš„æ¯”è¾ƒå¤§å° result[pos] = max(result[pos], root-&gt;val); &#125; //éå†å·¦å­æ ‘ï¼Œé«˜åº¦+1 dfs(root-&gt;left, result, pos+1); //éå†å³å­æ ‘ï¼Œé«˜åº¦+1 dfs(root-&gt;right, result, pos+1); &#125; vector&lt;int&gt; largestValues(TreeNode* root) &#123; vector&lt;int&gt; result; dfs(root, result, 0); return result; &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘èŠ‚ç‚¹ä¸ªæ•°ã€‚äºŒå‰æ ‘çš„éå†ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¼šè¢«è®¿é—®ä¸€æ¬¡ä¸”åªä¼šè¢«è®¿é—®ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(pos)ã€‚å…¶ä¸­ pos è¡¨ç¤ºäºŒå‰æ ‘çš„é«˜åº¦ã€‚é€’å½’å‡½æ•°éœ€è¦æ ˆç©ºé—´ï¼Œè€Œæ ˆç©ºé—´å–å†³äºé€’å½’çš„æ·±åº¦ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ç­‰ä»·äºäºŒå‰æ ‘çš„é«˜åº¦ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²","slug":"æ¯æ—¥LeetCode/2022-6/30 ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²","date":"2022-06-23T03:53:00.000Z","updated":"2022-07-08T00:35:01.595Z","comments":true,"path":"2022/06/23/æ¯æ—¥LeetCode/2022-6/30 ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²/","link":"","permalink":"http://example.com/2022/06/23/%E6%AF%8F%E6%97%A5LeetCode/2022-6/30%20%E4%B8%B2%E8%81%94%E6%89%80%E6%9C%89%E5%8D%95%E8%AF%8D%E7%9A%84%E5%AD%90%E4%B8%B2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²så’Œä¸€äº›é•¿åº¦ç›¸åŒçš„å•è¯wordsã€‚æ‰¾å‡ºsä¸­æ°å¥½å¯ä»¥ç”±wordsä¸­æ‰€æœ‰å•è¯ä¸²è”å½¢æˆçš„å­ä¸²çš„èµ·å§‹ä½ç½®ã€‚ æ³¨æ„å­ä¸²è¦ä¸wordsä¸­çš„å•è¯å®Œå…¨åŒ¹é…ï¼Œä¸­é—´ä¸èƒ½æœ‰å…¶ä»–å­—ç¬¦ï¼Œä½†ä¸éœ€è¦è€ƒè™‘wordsä¸­å•è¯ä¸²è”çš„é¡ºåºã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šs &#x3D; â€œbarfoofoobarthefoobarmanâ€, words &#x3D; [â€œbarâ€,â€fooâ€,â€theâ€]è¾“å‡ºï¼š[6,9,12] è¾“å‡ºè¿”å›å­—ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦åœ¨sä¸­çš„ä½ç½® ç¬¬ä¸€ä¸ªå­—ä¸²ï¼šbarfoofoobarthefoobarman 6 ç¬¬äºŒä¸ªå­—ä¸²ï¼šbarfoofoobarthefoobarman 9 ç¬¬ä¸‰ä¸ªå­—ç¬¦ï¼šbarfoofoobarthefoobarman 12 æ€è·¯ï¼šæ»‘åŠ¨çª—å£ word_lenä¸ºæ¯ä¸ªå•è¯çš„é•¿åº¦ï¼Œå› ä¸ºæ¯ä¸ªå•è¯çš„é•¿åº¦éƒ½ç›¸åŒï¼› word_numä¸ºwordsæ•°ç»„ä¸­å•è¯çš„ä¸ªæ•°ï¼› total_lenä¸ºwordsæ•°ç»„ä¸­æ‰€æœ‰çš„å•è¯çš„æ€»é•¿åº¦ï¼› mapæ¥è®°å½•wordsæ•°ç»„ä¸­æ¯ä¸ªå•è¯çš„ä¸ªæ•°ï¼› t_mapéå†sæ—¶ç”¨æ¥è®°å½•ï¼› å·¦æŒ‡é’ˆleftå’Œå³æŒ‡é’ˆrightç”¨æ¥å½“ä½œå·¦å³è¾¹ç•Œï¼› countç”¨æ¥ç»Ÿè®¡å·²ç»åŒ¹é…å•è¯çš„ä¸ªæ•°ï¼Œå¦‚æœcount == word_numï¼Œå°±è¯æ˜åŒ¹é…æˆåŠŸï¼› éå†sæ—¶æ— éœ€ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„éå†ï¼Œå¯ä»¥ä¸€ä¸ªä¸€ä¸ªå•è¯çš„éå†ï¼Œright += word_lenï¼› å¦‚æœæˆªå–çš„å•è¯mapä¸­ä¸å­˜åœ¨ï¼Œåˆ™ä¹‹å‰è®°å½•çš„å…¨éƒ¨æ— æ•ˆï¼Œæ¸…ç©ºt_mapå’Œcountï¼› å¦‚æœæŸä¸ªå•è¯åœ¨t_mapä¸­çš„ä¸ªæ•°å¤§äºmapä¸­çš„ä¸ªæ•°ï¼Œå°±éœ€è¦åˆ é™¤åŒ¹é…çš„å¤šä½™çš„å•è¯ï¼Œå°±éœ€è¦åˆ é™¤çª—å£ä¸­ç¬¬ä¸€ä¸ªå•è¯ï¼Œç›´åˆ°æŸä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°å°äºmapä¸­çš„ä¸ªæ•° ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364class Solution &#123;public: vector&lt;int&gt; findSubstring(string s, vector&lt;string&gt;&amp; words) &#123; //ç”¨æ¥å­˜æ”¾ç»“æœ vector&lt;int&gt; result; //åˆ¤æ–­så’Œwordsæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ if(s.empty()||words.empty())&#123; return result; &#125; int word_len = words[0].size(); //ä¸€ä¸ªå•è¯çš„é•¿åº¦ï¼ˆæ¯ä¸ªå•è¯é•¿åº¦éƒ½ç›¸åŒï¼‰ int word_num = words.size(); // å•è¯çš„æ€»ä¸ªæ•° int total_len = word_len*word_num; // å…¨éƒ¨å•è¯çš„é•¿åº¦ //å»ºç«‹å•è¯-&gt;å•è¯ä¸ªæ•°çš„æ˜ å°„ unordered_map&lt;string, int&gt; map; //ç»Ÿè®¡æ¯ä¸ªå•è¯çš„ä¸ªæ•° for(auto &amp;word : words)&#123; //map[key]:è¿”å›keyå€¼æ‰€å¯¹åº”çš„valueå€¼ï¼Œå¦‚æœä¸å­˜åœ¨keyå€¼ï¼Œåˆ™ä¼šä½¿ç”¨è¯¥keyå€¼å‘å½“å‰å®¹å™¨ä¸­æ’å…¥ä¸€ä¸ªæ–°valueå€¼ä¸º 0 map[word]++; //ç­‰ä»·äº map[word] += 1 &#125; for(int i = 0; i&lt; word_len; i++)&#123; //leftå’Œrightç”¨æ¥è¡¨ç¤ºçª—å£çš„å·¦å³è¾¹ç•Œ int left = i; int right = i; //countç”¨æ¥ç»Ÿè®¡å·²ç»åŒ¹é…çš„å•è¯ä¸ªæ•° int count = 0; unordered_map&lt;string, int&gt; t_map; //å¼€å§‹æ»‘åŠ¨çª—å£ //rightå³è¾¹ç•Œä¾æ¬¡ç´¯åŠ å•è¯çš„é•¿åº¦ï¼Œç›´åˆ°è¶…è¿‡sçš„é•¿åº¦åœæ­¢å¾ªç¯ while(right + word_len &lt;= s.size())&#123; //substr(pos, n):ä»ç¬¬posçš„ä½ç½®å¼€å§‹æˆªå–nä¸ªå­—ç¬¦è·å–å•è¯ string word = s.substr(right, word_len); right += word_len; //rightè·³åˆ°ä¸‹ä¸€ä¸ªå•è¯ //count(key):åœ¨å®¹å™¨ä¸­æŸ¥æ‰¾ä»¥keyé”®çš„é”®å€¼å¯¹çš„ä¸ªæ•°ã€‚å¦‚æœä¸º0ï¼Œè¯´æ˜æ­¤å•è¯wordåœ¨wordsæ•°ç»„ä¸­ä¸å­˜åœ¨ã€‚ if(map.count(word) == 0)&#123; count = 0; //æ¸…ç©ºä¹‹å‰ç»Ÿè®¡çš„ä¸ªæ•° left = right; //å°†å·¦æŒ‡é’ˆleftç§»åŠ¨åˆ°å³æŒ‡é’ˆrightä½ç½®ä¸Šé‡æ–°å¼€å§‹ t_map.clear(); //ä¹‹å‰åŒ¹é…çš„å•è¯æ²¡ç”¨äº†ï¼Œæ¸…ç©ºt_mapä¸­çš„å…ƒç´  &#125; //å¦‚æœä¸ä¸º0ï¼Œè¯´æ˜æ­¤å•è¯wordåœ¨wordsæ•°ç»„ä¸­å­˜åœ¨ã€‚ else&#123; count++; //ç»Ÿè®¡ä¸ªæ•°åŠ 1 t_map[word]++;// wordæ‰€å¯¹åº”çš„ä¸ªæ•°åŠ 1 //t_mapä¸­çš„wordå¯¹åº”çš„ä¸ªæ•°å¤§äºmapçš„wordå¯¹åº”çš„ä¸ªæ•°ï¼Œè¯´æ˜åŒ¹é…åˆ°å¤šä½™çš„å•è¯äº† while(t_map[word]&gt; map[word])&#123; //è·å–çª—å£çš„ç¬¬ä¸€ä¸ªå•è¯ string t_word = s.substr(left, word_len); //å°†t_wordè¿™ä¸ªå•è¯å¯¹åº”çš„ä¸ªæ•°å‡1 //å¹¶éæ˜¯é‚£ä¸ªå¤§äºmapä¸­ä¸ªæ•°çš„å•è¯ t_map[t_word]--; count--; //ç»Ÿè®¡ä¸ªæ•°å‡1 left += word_len;//å°†å·¦æŒ‡é’ˆè·³åˆ°ä¸‹ä¸€ä¸ª &#125; //å¦‚æœcountç­‰äºå•è¯çš„ä¸ªæ•°è¯´æ˜åŒ¹é…æˆåŠŸï¼Œå°†å·¦æŒ‡é’ˆä½ç½®è®°å½• if(count == word_num)&#123; result.push_back(left); &#125; &#125; &#125; &#125; return result; &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(lsÃ—n)ï¼Œå…¶ä¸­ ls æ˜¯è¾“å…¥ s çš„é•¿åº¦ï¼Œn æ˜¯ words ä¸­æ¯ä¸ªå•è¯çš„é•¿åº¦ã€‚éœ€è¦åš n æ¬¡æ»‘åŠ¨çª—å£ï¼Œæ¯æ¬¡éœ€è¦éå†ä¸€æ¬¡ sã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)513. æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼","slug":"æ¯æ—¥LeetCode/2022-6/513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼","date":"2022-06-22T03:11:00.000Z","updated":"2022-07-08T00:35:09.778Z","comments":true,"path":"2022/06/22/æ¯æ—¥LeetCode/2022-6/513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼/","link":"","permalink":"http://example.com/2022/06/22/%E6%AF%8F%E6%97%A5LeetCode/2022-6/513%20%E6%89%BE%E6%A0%91%E5%B7%A6%E4%B8%8B%E8%A7%92%E7%9A%84%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„ æ ¹èŠ‚ç‚¹ rootï¼Œè¯·æ‰¾å‡ºè¯¥äºŒå‰æ ‘çš„ æœ€åº•å±‚ æœ€å·¦è¾¹ èŠ‚ç‚¹çš„å€¼ã€‚ å‡è®¾äºŒå‰æ ‘ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹: è¾“å…¥: [1,2,3,4,null,5,6,null,null,7]è¾“å‡º: 7 æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)æˆ‘é‡‡ç”¨äº†ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œå†éå†å³èŠ‚ç‚¹ï¼Œå› ä¸ºåªæœ‰ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œæ‰ä¼šä¼˜å…ˆè®°å½•å½“å‰æ·±åº¦å·¦èŠ‚ç‚¹çš„å€¼ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¿…è¦è®°å½•å½“å‰æ·±åº¦å³è¾¹çš„å€¼äº†ã€‚ ä½¿ç”¨depthè®°å½•å½“å‰æ ‘çš„æ·±åº¦ï¼Œcurrent_valä¸ºè®°å½•çš„æ·±åº¦current_depthçš„æœ€å·¦è¾¹çš„å€¼ã€‚ è¿›è¡Œåˆ¤æ–­å¦‚æœdepthçš„æ·±åº¦å¤§äºcurrent_depthçš„æ·±åº¦ï¼Œå°†current_valçš„å€¼è®¾ç½®ä¸ºå½“å‰ç»“ç‚¹çš„å€¼ï¼Œå¹¶å°†current_depthçš„å€¼è®¾ç½®å½“å‰ç»“ç‚¹æ·±åº¦depth ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829class Solution &#123;public: void dfs(TreeNode* root, int depth, int&amp; current_depth, int&amp; current_val) &#123; if (root == nullptr) //å¦‚æœå½“å‰ç»“ç‚¹ä¸ºç©ºï¼Œåˆ™é€€å‡º &#123; return; &#125; //ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œæ·±åº¦åŠ 1 dfs(root-&gt;left, depth+1, current_depth, current_val); //å…¶æ¬¡éå†å³èŠ‚ç‚¹ï¼Œæ·±åº¦åŠ 1 dfs(root-&gt;right, depth+1, current_depth, current_val); //å¦‚æœå½“å‰æ·±åº¦å¤§äºè®°å½•çš„æ·±åº¦ if (depth &gt; current_depth) &#123; current_depth = depth; //å°†å½“å‰æ·±åº¦è®°å½•åˆ°current_depth current_val = root-&gt;val; //å°†å½“å‰ç»“ç‚¹å€¼è®°å½•åˆ°current_val &#125; &#125; int findBottomLeftValue(TreeNode* root) &#123; int current_depth = 0; //åˆå§‹åŒ–current_depth int current_val = 0; //åˆå§‹åŒ–current_val //å› ä¸ºæœ‰æ ¹ç»“ç‚¹å­˜åœ¨ï¼Œå°†depthè®¾ç½®ä¸º1ï¼Œè€Œé0 dfs(root, 1, current_depth, current_val); return current_val; &#125;&#125;; å¤æ‚åº¦åˆ†æ â€‹ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ç›®ã€‚éœ€è¦éå† n ä¸ªèŠ‚ç‚¹ã€‚ â€‹ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚é€’å½’æ ˆéœ€è¦å ç”¨ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]}],"categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"},{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"},{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"},{"name":"è½¯ä»¶å®‰è£…","slug":"è½¯ä»¶å®‰è£…","permalink":"http://example.com/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/"},{"name":"è®¡ç®—æœº4ä»¶å¥—","slug":"è®¡ç®—æœº4ä»¶å¥—","permalink":"http://example.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA4%E4%BB%B6%E5%A5%97/"},{"name":"Python","slug":"Python","permalink":"http://example.com/categories/Python/"},{"name":"çˆ¬è™«","slug":"Python/çˆ¬è™«","permalink":"http://example.com/categories/Python/%E7%88%AC%E8%99%AB/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"Git","slug":"Git","permalink":"http://example.com/tags/Git/"},{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"es","slug":"es","permalink":"http://example.com/tags/es/"},{"name":"kibana","slug":"kibana","permalink":"http://example.com/tags/kibana/"},{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"c++","slug":"c","permalink":"http://example.com/tags/c/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://example.com/tags/%E7%88%AC%E8%99%AB/"},{"name":"Python","slug":"Python","permalink":"http://example.com/tags/Python/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"}]}