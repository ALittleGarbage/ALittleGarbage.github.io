{"meta":{"title":"æ´»ç€å°±æ˜¯ä¸ºäº†æ‘¸é±¼ğŸŸï¼ï¼ï¼","subtitle":"","description":"ä¸€ä¸ªä¸èµ·çœ¼çš„å°åšå®¢","author":"ä¸€ä¸ªå°åƒåœ¾","url":"http://example.com","root":"/"},"pages":[{"title":"å…³äºæˆ‘æ˜¯è°","date":"2022-06-25T09:46:19.000Z","updated":"2022-06-26T00:50:58.784Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"archives","date":"2022-06-25T09:46:11.000Z","updated":"2022-06-25T10:00:28.430Z","comments":true,"path":"archives/index.html","permalink":"http://example.com/archives/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2022-06-25T09:45:03.000Z","updated":"2022-06-25T10:09:55.599Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2022-06-25T09:44:36.000Z","updated":"2022-06-25T10:10:32.117Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"(æ¯æ—¥LeetCode)556. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III","slug":"æ¯æ—¥LeetCode/556 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III","date":"2022-07-03T04:00:00.000Z","updated":"2022-07-03T04:02:09.035Z","comments":true,"path":"2022/07/03/æ¯æ—¥LeetCode/556 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III/","link":"","permalink":"http://example.com/2022/07/03/%E6%AF%8F%E6%97%A5LeetCode/556%20%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E5%85%83%E7%B4%A0%20III/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° n ï¼Œè¯·ä½ æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„æœ€å°æ•´æ•°ï¼Œå…¶ç”±é‡æ–°æ’åˆ— n ä¸­å­˜åœ¨çš„æ¯ä½æ•°å­—ç»„æˆï¼Œå¹¶ä¸”å…¶å€¼å¤§äº n ã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„æ­£æ•´æ•°ï¼Œåˆ™è¿”å› -1 ã€‚ æ³¨æ„ ï¼Œè¿”å›çš„æ•´æ•°åº”å½“æ˜¯ä¸€ä¸ª 32 ä½æ•´æ•° ï¼Œå¦‚æœå­˜åœ¨æ»¡è¶³é¢˜æ„çš„ç­”æ¡ˆï¼Œä½†ä¸æ˜¯ 32 ä½æ•´æ•° ï¼ŒåŒæ ·è¿”å› -1ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šn &#x3D; 12324321è¾“å‡ºï¼š12331224 ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šn &#x3D; 21è¾“å‡ºï¼š-1 æ€è·¯ï¼šä»¥n = 12324321ä¸ºä¾‹ â‘ .pos1æŒ‡é’ˆä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°ç¬¬pos1ä½ç½®çš„æ•°æ¯”åé¢çš„æ•°å°çš„ä½ç½®ï¼Œpos1è®°å½•ä½ç½® 1 2 3 2 4 3 2 1 $\\leftarrow\\Uparrow$pos1 2ä¸1æ¯”è¾ƒï¼Œ2å¤§ï¼Œpos1å‘å·¦ç§» å¾ªç¯ç›´åˆ°ï¼š 1 2 3 2 4 3 2 1 $\\leftarrow\\Uparrow$pos1 2ä¸4æ¯”è¾ƒï¼Œ2å°ï¼Œè®°å½•pos1çš„ä½ç½® â‘¡.å†å®šä¹‰pos2æŒ‡é’ˆï¼Œä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°æ¯”pos1ä½ç½®åé¢çš„æ•°ä¸­ï¼Œæœ‰æ¯”pos1ä½ç½®çš„æ•°å¤§çš„æ•°ï¼Œç”¨pos2è®°å½•ä½ç½® 1 2 3 2 4 3 2 1 $\\Uparrow$pos1 $\\leftarrow\\Uparrow$pos2 pos1å¤§äºpos2ï¼Œpos2æŒ‡é’ˆå·¦ç§» å¾ªç¯ç›´åˆ°ï¼š 1 2 3 2 4 3 2 1 $\\Uparrow$pos1 $\\leftarrow\\Uparrow$pos2 pos1å°äºpos2ï¼Œè®°å½•æŒ‡é’ˆpos2ä½ç½® â‘¢.äº¤æ¢pos1å’Œpos2çš„ä½ç½® 1 2 3 3 4 2 2 1 â‘£.å°†pos1ä½ç½®åé¢çš„æ•°è¿›è¡Œåè½¬ 1 2 3 3 1 2 2 4 ç»“æœï¼š12331224 ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728class Solution &#123;public: int nextGreaterElement(int n) &#123; //å°†nè½¬æ¢æˆå­—ç¬¦ä¸² string num = to_string(n); int pos1 = num.size()-2; //ä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°å‰é¢çš„æ•°å°äºåé¢çš„æ•°ï¼Œå‰é¢æ•°çš„ä½ç½® while(pos1 &gt;= 0 &amp;&amp; num[pos1] &gt;= num[pos1+1])&#123; pos1--; &#125; //éå†åˆ°å­—ç¬¦ä¸²ç¬¬0ä¸ªä½ç½®ï¼Œè¿˜æ²¡æœ‰å°äºçš„æ•°ï¼Œåˆ™ä¸å­˜åœ¨ if(pos1 &lt; 0) return -1; int pos2 = num.size()-1; //ä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°æœ‰æ¯”pos1ä½ç½®çš„æ•°å°çš„æ•°ï¼Œè¿”å›pos2ä½ç½® while(pos2 &gt; pos1 &amp;&amp; num[pos1] &gt;= num[pos2])&#123; pos2--; &#125; //äº¤æ¢ä¸¤ä¸ªä½ç½®çš„æ•° swap(num[pos1],num[pos2]); //å°†pos1åé¢çš„å­—ç¬¦ä¸²åè½¬ reverse(num.begin() + pos1 + 1, num.end()); //é˜²æ­¢æº¢å‡ºï¼Œå…ˆå°†tempè½¬æ¢æˆlongå‹ long temp = stol(num); //å¦‚æœè¶…å‡ºintçš„èŒƒå›´ï¼Œè¿”å›-1 if(temp &gt; INT_MAX) return -1; return temp; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(logn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)871. æœ€ä½åŠ æ²¹æ¬¡æ•°","slug":"æ¯æ—¥LeetCode/871 æœ€ä½åŠ æ²¹æ¬¡æ•°","date":"2022-07-02T07:36:00.000Z","updated":"2022-07-02T07:51:59.126Z","comments":true,"path":"2022/07/02/æ¯æ—¥LeetCode/871 æœ€ä½åŠ æ²¹æ¬¡æ•°/","link":"","permalink":"http://example.com/2022/07/02/%E6%AF%8F%E6%97%A5LeetCode/871%20%E6%9C%80%E4%BD%8E%E5%8A%A0%E6%B2%B9%E6%AC%A1%E6%95%B0/","excerpt":"","text":"é¢˜ç›®ï¼šæ±½è½¦ä»èµ·ç‚¹å‡ºå‘é©¶å‘ç›®çš„åœ°ï¼Œè¯¥ç›®çš„åœ°ä½äºå‡ºå‘ä½ç½®ä¸œé¢ target è‹±é‡Œå¤„ã€‚ æ²¿é€”æœ‰åŠ æ²¹ç«™ï¼Œæ¯ä¸ª station[i] ä»£è¡¨ä¸€ä¸ªåŠ æ²¹ç«™ï¼Œå®ƒä½äºå‡ºå‘ä½ç½®ä¸œé¢ station[i][0] è‹±é‡Œå¤„ï¼Œå¹¶ä¸”æœ‰ station[i][1]å‡æ±½æ²¹ã€‚ å‡è®¾æ±½è½¦æ²¹ç®±çš„å®¹é‡æ˜¯æ— é™çš„ï¼Œå…¶ä¸­æœ€åˆæœ‰startFuelå‡ç‡ƒæ–™ã€‚å®ƒæ¯è¡Œé©¶ 1 è‹±é‡Œå°±ä¼šç”¨æ‰ 1 å‡æ±½æ²¹ã€‚ å½“æ±½è½¦åˆ°è¾¾åŠ æ²¹ç«™æ—¶ï¼Œå®ƒå¯èƒ½åœä¸‹æ¥åŠ æ²¹ï¼Œå°†æ‰€æœ‰æ±½æ²¹ä»åŠ æ²¹ç«™è½¬ç§»åˆ°æ±½è½¦ä¸­ã€‚ ä¸ºäº†åˆ°è¾¾ç›®çš„åœ°ï¼Œæ±½è½¦æ‰€å¿…è¦çš„æœ€ä½åŠ æ²¹æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿå¦‚æœæ— æ³•åˆ°è¾¾ç›®çš„åœ°ï¼Œåˆ™è¿”å› -1 ã€‚ æ³¨æ„ï¼šå¦‚æœæ±½è½¦åˆ°è¾¾åŠ æ²¹ç«™æ—¶å‰©ä½™ç‡ƒæ–™ä¸º 0ï¼Œå®ƒä»ç„¶å¯ä»¥åœ¨é‚£é‡ŒåŠ æ²¹ã€‚å¦‚æœæ±½è½¦åˆ°è¾¾ç›®çš„åœ°æ—¶å‰©ä½™ç‡ƒæ–™ä¸º 0ï¼Œä»ç„¶è®¤ä¸ºå®ƒå·²ç»åˆ°è¾¾ç›®çš„åœ°ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹1ï¼š è¾“å…¥ï¼štarget &#x3D; 100, startFuel &#x3D; 1, stations &#x3D; [[10,100]]è¾“å‡ºï¼š-1è§£é‡Šï¼šæˆ‘ä»¬æ— æ³•æŠµè¾¾ç›®çš„åœ°ï¼Œç”šè‡³æ— æ³•åˆ°è¾¾ç¬¬ä¸€ä¸ªåŠ æ²¹ç«™ã€‚ ç¤ºä¾‹2ï¼š è¾“å…¥ï¼štarget &#x3D; 100, startFuel &#x3D; 10, stations &#x3D; [[10,60],[20,30],[30,30],[60,40]]è¾“å‡ºï¼š2è§£é‡Šï¼šæˆ‘ä»¬å‡ºå‘æ—¶æœ‰ 10 å‡ç‡ƒæ–™ã€‚æˆ‘ä»¬å¼€è½¦æ¥åˆ°è·èµ·ç‚¹ 10 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™ï¼Œæ¶ˆè€— 10 å‡ç‡ƒæ–™ã€‚å°†æ±½æ²¹ä» 0 å‡åŠ åˆ° 60 å‡ã€‚ç„¶åï¼Œæˆ‘ä»¬ä» 10 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™å¼€åˆ° 60 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™ï¼ˆæ¶ˆè€— 50 å‡ç‡ƒæ–™ï¼‰ï¼Œå¹¶å°†æ±½æ²¹ä» 10 å‡åŠ åˆ° 50 å‡ã€‚ç„¶åæˆ‘ä»¬å¼€è½¦æŠµè¾¾ç›®çš„åœ°ã€‚æˆ‘ä»¬æ²¿é€”åœ¨1ä¸¤ä¸ªåŠ æ²¹ç«™åœé ï¼Œæ‰€ä»¥è¿”å› 2 ã€‚ æ€è·¯ï¼š ä¸€ã€å›æº¯æ³•ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930class Solution &#123;public: int def(vector&lt;vector&lt;int&gt;&gt;&amp; stations,int cur_station, int begin, int&amp; end, int oil)&#123; //åˆ°è¾¾ç›®çš„åœ° if(oil+begin &gt;= end) return 0; //æ²¹é‡ä¸å¤Ÿåˆ°è¾¾ç›®çš„åœ° if(cur_station+1 == stations.size() &amp;&amp; oil+begin &lt; end)&#123; return -1; &#125; //æ²¹é‡ä¸å¤Ÿåˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™ if(cur_station+1 &lt; stations.size() &amp;&amp; oil+begin &lt; stations[cur_station+1][0])&#123; return -1; &#125; int ans = INT_MAX; for(int i = cur_station+1; i &lt; stations.size(); i++)&#123; if(stations[i][0] &lt;= begin+oil)&#123; int temp = def(stations, i, stations[i][0] ,end ,oil+begin-stations[i][0]+stations[i][1]); if(temp != -1 &amp;&amp; ans &gt; temp+1) ans = temp+1; &#125; &#125; if(ans == INT_MAX) ans = -1; return ans; &#125; int minRefuelStops(int target, int startFuel, vector&lt;vector&lt;int&gt;&gt;&amp; stations) &#123; //å‡ºå‘åœ°æ²¡æœ‰åŠ æ²¹ç«™ï¼Œç¬¬ä¸€ä¸ªåŠ æ²¹ç«™ç¼–å·ä¸º0ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸º-1 return def(stations, -1, 0, target, startFuel); &#125;&#125;; è¿è¡Œè¶…æ—¶ äºŒã€è´ªå¿ƒæ€è·¯ï¼šå¦‚æœä¸éœ€è¦åŠ æ²¹å°±å¾€å‰èµ°ï¼Œå½“ä¸å¤Ÿåˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™æˆ–ç›®çš„åœ°ï¼Œå°±ä»ä¹‹å‰èµ°åˆ°è¿‡çš„åŠ æ²¹ç«™ä¹‹ä¸­é€‰æ‹©æ±½æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™è¿›è¡Œè¡¥å……æ±½æ²¹ã€‚ ä»¥æ­¤å¾€å¤ï¼Œåˆ°è¾¾ç›®çš„åœ°ã€‚ å¦‚æœæ‰€æœ‰åŠ æ²¹ç«™çš„æ±½æ²¹éƒ½è¢«åŠ å®Œï¼Œå¹¶ä¸”æ²¡åˆ°è¾¾ç›®çš„åœ°ï¼Œåˆ™ä¸å¯èƒ½åˆ°è¾¾ã€‚ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829303132class Solution &#123;public: int minRefuelStops(int target, int startFuel, vector&lt;vector&lt;int&gt;&gt;&amp; stations) &#123; priority_queue&lt;int&gt; pq; int count = 0; //åˆå§‹åŒ–åŠ æ²¹æ¬¡æ•° int begin = 0; //åˆå§‹åŒ–è·¯ç¨‹ int cur_fuel = startFuel;//åˆå§‹åŒ–è½¦çš„æ±½æ²¹é‡ int cur_distance; //è¡¨ç¤ºå½“å‰çš„è·¯ç¨‹ for (int i = 0; i &lt;= stations.size(); i++) &#123; if(i &lt; stations.size()) cur_distance = stations[i][0]; else cur_distance = target; //(cur_distance - begin)ï¼šè¡¨ç¤ºç¬¬i-1ä¸ªåŠ æ²¹ç«™åˆ°ç¬¬iä¸ªåŠ æ²¹ç«™ä¹‹é—´çš„è·¯ç¨‹ï¼Œcur_fuelä¸ºåˆ°ç¬¬iä¸ªåŠ æ²¹ç«™æ—¶å‰©ä½™çš„æ²¹é‡ cur_fuel -= cur_distance - begin; //å¦‚æœæ²¹é‡ä¸ºè´Ÿæ•°ï¼Œè¯´æ˜éœ€è¦ä»ç¬¬iä¸ªåŠ æ²¹ç«™ï¼Œä¹‹å‰çš„åŠ æ²¹ç«™ä¹‹ä¸­é€‰æ‹©åŠ æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™ï¼Œè¿›è¡Œè¡¥å……æ±½æ²¹ while (cur_fuel &lt; 0 &amp;&amp; !pq.empty()) &#123; cur_fuel += pq.top();//é€‰æ‹©æ±½æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™è¡¥å…… pq.pop(); count++;//åŠ æ²¹æ¬¡æ•°åŠ 1 &#125; //éƒ½å·²ç»æŠŠä¹‹å‰çš„åŠ æ²¹ç«™çš„æ±½æ²¹éƒ½è¡¥å……äº†ï¼Œè¿˜æ˜¯è´Ÿæ•°è¯´æ˜æ— æ³•åˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™æˆ–ç›®çš„åœ° if (cur_fuel &lt; 0) &#123; return -1; &#125; if (i &lt; stations.size()) &#123; //å°†ç¬¬iä¸ªåŠ æ²¹ç«™çš„æ±½æ²¹é‡è®°å½•ï¼Œç°åœ¨ä¸éœ€è¦åŠ æ²¹ï¼Œç­‰ä»¥åç¼ºæ²¹å†åŠ  pq.emplace(stations[i][1]); begin = cur_distance;//æ›´æ–°è·¯ç¨‹ &#125; &#125; return count; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ stations çš„é•¿åº¦ã€‚éœ€è¦éå†æ•°ç»„ stations ä¸€æ¬¡ï¼Œæ¯ä¸ªåŠ æ²¹ç«™çš„æ±½æ²¹é‡æœ€å¤šæ·»åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—å’Œä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­ç§»é™¤å„ä¸€æ¬¡ï¼Œæ¯æ¬¡ä¼˜å…ˆé˜Ÿåˆ—çš„æ“ä½œéœ€è¦ O(logn) çš„æ—¶é—´ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ stations çš„é•¿åº¦ã€‚ä¼˜å…ˆé˜Ÿåˆ—éœ€è¦ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"vectorå®¹å™¨ç”¨æ³•","slug":"C++/vecterå®¹å™¨ç”¨æ³•è¯¦è§£","date":"2022-06-30T04:23:10.561Z","updated":"2022-06-30T09:57:01.005Z","comments":true,"path":"2022/06/30/C++/vecterå®¹å™¨ç”¨æ³•è¯¦è§£/","link":"","permalink":"http://example.com/2022/06/30/C++/vecter%E5%AE%B9%E5%99%A8%E7%94%A8%E6%B3%95%E8%AF%A6%E8%A7%A3/","excerpt":"","text":"vectoræ˜¯ä»€ä¹ˆï¼Ÿvectoræ˜¯ä¸€ä¸ªèƒ½å¤Ÿå­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„ã€‚ vectorå®ç°åŠ¨æ€å¢é•¿çš„åŸç†ï¼švectorçš„åŸç†å°±æ˜¯åŠ¨æ€æ•°ç»„ã€‚å½“æ’å…¥æ–°å…ƒç´ çš„æ—¶å€™ï¼Œå¦‚æœç©ºé—´ä¸è¶³ï¼Œé‚£ä¹ˆvectorä¼šé‡æ–°ç”³è¯·æ›´å¤§çš„ä¸€å—ç©ºé—´ï¼Œå°†åŸç©ºé—´æ•°æ®æ‹·è´åˆ°æ–°ç©ºé—´ï¼Œé‡Šæ”¾æ—§ç©ºé—´æ•°æ®ï¼Œå†æŠŠæ–°å…ƒç´ æ’å…¥æ–°ç”³è¯·ç©ºé—´ã€‚ éœ€è¦å¯¼å…¥å¤´æ–‡ä»¶ï¼š 12#include&lt;vector&gt;using namespace std; æ„é€ å‡½æ•°ï¼š æ„é€ å‡½æ•° è§£é‡Š vector() åˆ›å»ºä¸€ä¸ªç©ºçš„vector vector(int size) åˆ›å»ºä¸€ä¸ªvector,å…ƒç´ ä¸ªæ•°ä¸ºsizeï¼Œä¸”å€¼å‡ä¸º0(é»˜è®¤ä¸º0) vector(int size, T value) åˆ›å»ºä¸€ä¸ªvectorï¼Œå…ƒç´ ä¸ªæ•°ä¸ºsize,ä¸”å€¼å‡ä¸ºvalue vector(const vector&amp; v) å¦ä¸€ä¸ªvectorå®¹å™¨æ‹·è´åˆ°è¿™ä¸ªvectorä¸­ vector(iterator begin(), iterator end()) å¦ä¸€ä¸ª[begin,end)åŒºé—´å†…çš„æ•°ç»„å…ƒç´ çš„å¤åˆ¶è¿™ä¸ªvectorä¸­ æˆå‘˜å‡½æ•°ï¼š æ’å…¥å‡½æ•° è§£é‡Š void push_back(const T&amp; x) å®¹å™¨å°¾éƒ¨æ’å…¥ä¸€ä¸ªå…ƒç´ X iterator insert(iterator it,const T&amp; x) å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥ä¸€ä¸ªå…ƒç´ x iterator insert(iterator it,int n,const T&amp; x) å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥nä¸ªç›¸åŒçš„å…ƒç´ x iterator insert(iterator it,const_iterator first,const_iterator last) å‘é‡ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥å¦ä¸€ä¸ªç›¸åŒç±»å‹çš„vectorå®¹å™¨çš„[first,last)é—´çš„æ•°æ® åˆ é™¤å‡½æ•° è§£é‡Š iterator erase(iterator it) åˆ é™¤å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´  iterator erase(iterator first,iterator last) åˆ é™¤å®¹å™¨ä¸­[first,last)ä¸­çš„å…ƒç´  void pop_back() åˆ é™¤å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´  void clear() æ¸…ç©ºå®¹å™¨ä¸­æ‰€æœ‰å…ƒç´  éå†å‡½æ•° è§£é‡Š T at(int pos) è¿”å›posä½ç½®çš„å…ƒç´ (ç¬¬ä¸€ä¸ªä½ç½®ä¸º0) T front() è¿”å›é¦–å…ƒç´  T back() è¿”å›å°¾å…ƒç´  iterator begin() è¿”å›vectorå®¹å™¨ä¸­æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ iterator end() è¿”å›vectorå®¹å™¨ä¸­æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®çš„è¿­ä»£å™¨ reverse_iterator rbegin() åå‘è¿­ä»£å™¨ï¼ŒæŒ‡å‘å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´  reverse_iterator rend() åå‘è¿­ä»£å™¨ï¼ŒæŒ‡å‘å®¹å™¨ç¬¬ä¸€ä¸ªå…ƒç´ å‰é¢çš„ä½ç½® å¤§å°å‡½æ•° è§£é‡Š int size() è¿”å›vectorå®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•° int capacity() è¿”å›å½“å‰vectorå®¹å™¨æ‰€èƒ½å®¹çº³çš„æœ€å¤§å®¹é‡ int max_size() è¿”å›vectorå®¹å™¨çš„æœ€å¤§å¯å…è®¸çš„å®¹é‡ void resize(int size) æ›´æ”¹vectorå®¹å™¨çš„å…ƒç´ çš„ä¸ªæ•°ä¸ºsize void reserve(int capacity) æ›´æ”¹vectorå®¹å™¨çš„å®¹é‡ä¸ºcapacity èµ‹å€¼å‡½æ•° è§£é‡Š vector&amp; operator&#x3D; å°†å³è¾¹vectorå®¹å™¨çš„å…ƒç´ æ‹·è´åˆ°å·¦è¾¹vectorå®¹å™¨ä¸­ void assign(int n,const T&amp; x) è®¾ç½®å®¹å™¨ä¸­å‰nä¸ªå…ƒç´ çš„å€¼ä¸ºx void assign(const_iterator first,const_iterator last) å°†å¦ä¸€ä¸ªvectorå®¹å™¨ä¸­[first,last)ä¸­å…ƒç´ è®¾ç½®æˆå½“å‰vectorå®¹å™¨çš„å…ƒç´  å…¶ä»–å‡½æ•° è§£é‡Š bool empty() åˆ¤æ–­å‘é‡æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ºç©ºï¼Œåˆ™è¿”å›çœŸ void swap(vector&amp; v) å°†ä¸¤ä¸ªåŒç±»å‹vectorå®¹å™¨çš„å…ƒç´ äº’æ¢ vectorçš„éå† 123for(int i = 0; i &lt; v.size(); i++)&#123; cout &lt;&lt; v[i] &lt;&lt; endl;&#125; 123for (int i = 0; i &lt; v.size(); i++)&#123; cout &lt;&lt; v1.at(i) &lt;&lt; endl;&#125; 123for (vector&lt;int&gt;::iterator it = v.begin(); it != v.end(); it++)&#123; cout &lt;&lt; *it &lt;&lt; endl;&#125; 123for (auto it = v.begin(); it != v.end(); it++)&#123; cout &lt;&lt; *it &lt;&lt; endl;&#125;","categories":[{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"}],"tags":[{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"}]},{"title":"(æ¯æ—¥LeetCode)1175. è´¨æ•°æ’åˆ—","slug":"æ¯æ—¥LeetCode/1175 è´¨æ•°æ’åˆ—","date":"2022-06-30T03:09:00.000Z","updated":"2022-07-02T07:52:31.621Z","comments":true,"path":"2022/06/30/æ¯æ—¥LeetCode/1175 è´¨æ•°æ’åˆ—/","link":"","permalink":"http://example.com/2022/06/30/%E6%AF%8F%E6%97%A5LeetCode/1175%20%E8%B4%A8%E6%95%B0%E6%8E%92%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šè¯·ä½ å¸®å¿™ç»™ä» 1 åˆ° n çš„æ•°è®¾è®¡æ’åˆ—æ–¹æ¡ˆï¼Œä½¿å¾—æ‰€æœ‰çš„ã€Œè´¨æ•°ã€éƒ½åº”è¯¥è¢«æ”¾åœ¨ã€Œè´¨æ•°ç´¢å¼•ã€ï¼ˆç´¢å¼•ä» 1 å¼€å§‹ï¼‰ä¸Šï¼›ä½ éœ€è¦è¿”å›å¯èƒ½çš„æ–¹æ¡ˆæ€»æ•°ã€‚ç”±äºç­”æ¡ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼Œæ‰€ä»¥è¯·ä½ è¿”å›ç­”æ¡ˆ æ¨¡ mod $10^9$ + 7 ä¹‹åçš„ç»“æœå³å¯ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šn &#x3D; 5è¾“å‡ºï¼š12 è§£é‡Šï¼š å…ˆçœ‹è´¨æ•°å®šä¹‰ï¼šä¸€ä¸ªå¤§äº1çš„è‡ªç„¶æ•°ï¼Œé™¤äº†1å’Œå®ƒè‡ªèº«å¤–ï¼Œä¸èƒ½è¢«å…¶ä»–è‡ªç„¶æ•°æ•´é™¤çš„æ•°å«åšè´¨æ•°ã€‚(1ä¸æ˜¯è´¨æ•°) ç”¨çº¢è‰²æ ‡è®°è´¨æ•°ï¼š 1 2 3 4 5 é¢˜ç›®çš„æ„æ€æ˜¯å°†è´¨æ•°å’Œéè´¨æ•°å„åˆ†ä¸€ç»„ï¼Œè¿›è¡Œæ’åºä¸€å…±æœ‰å¤šå°‘ç§å¯èƒ½ï¼š mä¸ªæ•°æ’åˆ—mä¸ªä½ç½®ï¼Œå…¨æ’åˆ—å…¬å¼ï¼š$A^m_m&#x3D;m!$ $A^3_3$ä¸ºè´¨æ•°çš„æ‰€æœ‰æ’åˆ—æ¬¡æ•° $A^2_2$ä¸ºéè´¨æ•°çš„æ‰€æœ‰æ’åˆ—æ¬¡æ•° å¹¶ä¸”æ¯æœ‰ä¸€ä¸ªè´¨æ•°çš„æ’åˆ—ç»„åˆå°±æœ‰$A^2_2$æ¬¡éè´¨æ•°çš„æ’åˆ—ï¼š æ€»æ•°ï¼š$A^3_3 \\times A^2_2&#x3D;3! \\times 2!&#x3D;12$ æ€è·¯ï¼šéå†æ•°ç»„åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•°ï¼Œè®°å½•è´¨æ•°çš„ä¸ªæ•°pï¼Œéè´¨æ•°ä¸ªæ•°ä¸ºn-p è¿ç”¨å…¬å¼æ±‚å‡ºæ€»æ•°ï¼š$A^p_p \\times A^{n-p}_{n-p}&#x3D;p! \\times (n-p)!$ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930313233343536373839class Solution &#123;public: int mod = pow(10,9)+7; //åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•° bool is_prime(int n)&#123; //ä»2å¼€å§‹ for(int i = 2; i*i &lt;= n;i++)&#123; //æ¨¡è¿ç®—ä¸º0ï¼Œä¸æ˜¯è´¨æ•° if(n%i == 0)&#123; return false; &#125; &#125; return true; &#125; //n!è¿ç®— Longç±»å‹é˜²æ­¢æº¢å‡º long factorial(int n)&#123; long sum = 1; for(int i = 2; i &lt;= n; i++)&#123; sum *=i; sum = sum%mod; &#125; return sum; &#125; int numPrimeArrangements(int n) &#123; int prime_num = 0; //ä»2å¼€å§‹ï¼Œ1ä¸æ˜¯è´¨æ•° for(int i = 2; i &lt;= n; i++)&#123; if(is_prime(i))&#123; prime_num++; &#125; &#125; //n!*(n-p)! long result = (factorial(prime_num)*factorial(n-prime_num))%mod; return (int)result; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO($n^{3&#x2F;2}$)ã€‚æ±‚ n ä¸ªæ•°ä¸­è´¨æ•°ä¸ªæ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º O($n^{3&#x2F;2}$)ï¼Œé˜¶ä¹˜çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º O($n^{3&#x2F;2}$)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)O(1)ï¼Œåªä½¿ç”¨äº†å¸¸æ•°ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)535. TinyURLçš„åŠ å¯†ä¸è§£å¯†","slug":"æ¯æ—¥LeetCode/535 TinyURLçš„åŠ å¯†ä¸è§£å¯†","date":"2022-06-28T23:41:00.000Z","updated":"2022-07-02T07:51:52.081Z","comments":true,"path":"2022/06/29/æ¯æ—¥LeetCode/535 TinyURLçš„åŠ å¯†ä¸è§£å¯†/","link":"","permalink":"http://example.com/2022/06/29/%E6%AF%8F%E6%97%A5LeetCode/535%20TinyURL%E7%9A%84%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/","excerpt":"","text":"é¢˜ç›®ï¼šTinyURL æ˜¯ä¸€ç§ URL ç®€åŒ–æœåŠ¡ï¼Œ æ¯”å¦‚ï¼šå½“ä½ è¾“å…¥ä¸€ä¸ª URL https://leetcode.com/problems/design-tinyurl æ—¶ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªç®€åŒ–çš„URL http://tinyurl.com/4e9iAk ã€‚è¯·ä½ è®¾è®¡ä¸€ä¸ªç±»æ¥åŠ å¯†ä¸è§£å¯† TinyURL ã€‚ åŠ å¯†å’Œè§£å¯†ç®—æ³•å¦‚ä½•è®¾è®¡å’Œè¿ä½œæ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œä½ åªéœ€è¦ä¿è¯ä¸€ä¸ª URL å¯ä»¥è¢«åŠ å¯†æˆä¸€ä¸ª TinyURL ï¼Œå¹¶ä¸”è¿™ä¸ª TinyURL å¯ä»¥ç”¨è§£å¯†æ–¹æ³•æ¢å¤æˆåŸæœ¬çš„ URL ã€‚ å®ç° Solution ç±»ï¼š Solution() åˆå§‹åŒ– TinyURL ç³»ç»Ÿå¯¹è±¡ã€‚String encode(String longUrl) è¿”å› longUrl å¯¹åº”çš„ TinyURL ã€‚String decode(String shortUrl) è¿”å› shortUrl åŸæœ¬çš„ URL ã€‚é¢˜ç›®æ•°æ®ä¿è¯ç»™å®šçš„ shortUrl æ˜¯ç”±åŒä¸€ä¸ªç³»ç»Ÿå¯¹è±¡åŠ å¯†çš„ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šurl &#x3D; â€œhttps://leetcode.com/problems/design-tinyurlâ€œè¾“å‡ºï¼šâ€https://leetcode.com/problems/design-tinyurlâ€œ è§£é‡Šï¼šSolution obj &#x3D; new Solution();string tiny &#x3D; obj.encode(url); &#x2F;&#x2F; è¿”å›åŠ å¯†åå¾—åˆ°çš„ TinyURL ã€‚string ans &#x3D; obj.decode(tiny); &#x2F;&#x2F; è¿”å›è§£å¯†åå¾—åˆ°çš„åŸæœ¬çš„ URL ã€‚ æ€è·¯ï¼šä½¿ç”¨è‡ªå¢idä½œä¸ºlongUrlçš„é”®ï¼Œå­˜å…¥unordered_mapå®¹å™¨ä¸­ æ ¹æ®idæ¥è·å–å¯¹åº”çš„longUrl ä»£ç (cpp)ï¼š1234567891011121314151617181920212223class Solution &#123;private: unordered_map&lt;int, string&gt; map; int id;public: Solution()&#123; id = 0; //åˆå§‹åŒ–id &#125; string encode(string longUrl) &#123; id++; map[id] = longUrl; //http://tinyurl.com/1 return &quot;http://tinyurl.com/&quot;+to_string(id); &#125; string decode(string shortUrl) &#123; //substr(int pos)ï¼šè·å–posä½ç½®èµ·çš„æ‰€æœ‰å­—ç¬¦ä¸² //stoi(string str)ï¼šå°†stringç±»å‹çš„å­—ç¬¦ä¸²è½¬æ¢æˆintç±»å‹çš„æ•´æ•° int t_id = stoi(shortUrl.substr(19)); return map[t_id]; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼š Encode å‡½æ•°ï¼šO(n)O(n)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸² longUrl çš„é•¿åº¦ã€‚ Decode å‡½æ•°ï¼šO(1)O(1)ã€‚æˆ‘ä»¬æŠŠ shortUrl å½“æˆæœ‰é™é•¿åº¦çš„å­—ç¬¦ä¸²çœ‹å¾…ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š Encode å‡½æ•°ï¼šO(n)O(n)ã€‚ä¿å­˜å­—ç¬¦ä¸² longUrl éœ€è¦ O(n)O(n) çš„ç©ºé—´ã€‚ Decode å‡½æ•°ï¼šO(1)O(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"SpringMVCæ¡†æ¶","slug":"Java/SpringMCVæ¡†æ¶","date":"2022-06-28T14:02:54.299Z","updated":"2022-07-02T13:43:23.123Z","comments":true,"path":"2022/06/28/Java/SpringMCVæ¡†æ¶/","link":"","permalink":"http://example.com/2022/06/28/Java/SpringMCV%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè®¤SpringMVC1.1 SpringMVCç®€ä»‹ SpringMVCæŠ€æœ¯ä¸ServletæŠ€æœ¯åŠŸèƒ½ç­‰åŒï¼Œå‡å±äºwebå±‚å¼€å‘æŠ€æœ¯ SpringMVCæ˜¯ä¸€ç§åŸºäºjavaå®ç°MVCæ¨¡å‹çš„è½»é‡çº§Webæ¡†æ¶ ä¼˜ç‚¹ï¼š ä½¿ç”¨ç®€å•ï¼Œå¼€å‘ä¾¿æ·(ç›¸æ¯”ä¸Servlet) çµæ´»æ€§å¼º é¡¹ç›®ç»“æ„ï¼š 1.2 SpringMVCå…¥é—¨1.ä½¿ç”¨SpringMVCæŠ€æœ¯éœ€è¦å…ˆå¯¼å…¥SpringMVCåæ ‡ä¸Servlet ä¸éœ€è¦å¯¼å…¥spring-contextåŒ…ï¼Œspring-webmvcåŒ…ä¸­åŒ…å«spring-contextåŒ… 2.å¯¼å…¥Tomcatæ’ä»¶ 12345678910111213141516171819202122232425&lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;!-- å’ŒTomcatæœ‰å†²çª --&gt; &lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;!--Tomcatæ’ä»¶--&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.1&lt;/version&gt; &lt;configuration&gt; &lt;port&gt;8888&lt;/port&gt; &lt;!--ç«¯å£å¯ä»»æ„åªè¦æ²¡æœ‰è¢«å ç”¨--&gt; &lt;path&gt;/&lt;/path&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; 3.åˆ›å»ºSpringMVCæ§åˆ¶å™¨ç±»(ç­‰åŒäºServletåŠŸèƒ½) 1234567891011@Controllerpublic class UserController &#123; //è®¾ç½®å½“å‰æ§åˆ¶å™¨æ–¹æ³•çš„è¯·æ±‚è·¯å¾„ @RequestMapping(&quot;/save&quot;) //è®¾ç½®å½“å‰æ§åˆ¶å™¨æ–¹æ³•å“åº”å†…å®¹ä¸ºå½“å‰è¿”å›å€¼ï¼Œæ— éœ€è§£æ @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; 4.åˆå§‹åŒ–SpringMVCç¯å¢ƒ(åŒSpringç¯å¢ƒ)ï¼Œè®¾å®šSpringMVCåŠ è½½å¯¹åº”çš„bean 12345//åˆ›å»ºSpringMVCçš„é…ç½®æ–‡ä»¶ï¼ŒåŠ è½½controllerå¯¹åº”çš„bean@Configuration@ComponentScan(&quot;com.springmvc.controller&quot;)public class SpringMvcConfig &#123;&#125; 5.åˆå§‹åŒ–Servletå®¹å™¨ï¼ŒåŠ è½½SpringMVCç¯å¢ƒï¼Œå¹¶è®¾ç½®SpringMVCæŠ€æœ¯å¤„ç†çš„è¯·æ±‚ 123456789101112131415161718192021//å®šä¹‰ä¸€ä¸ªservletå®¹å™¨å¯åŠ¨çš„é…ç½®ç±»ï¼Œåœ¨é‡Œé¢åŠ è½½Springçš„é…ç½®public class ServletContainerInitConfig extends AbstractDispatcherServletInitializer &#123; //åŠ è½½SpringMVCå®¹å™¨çš„é…ç½® @Override protected WebApplicationContext createServletApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringMvcConfig.class); return acwac; &#125; //è®¾å®šSpringMVCå¯¹åº”çš„è¯·æ±‚çš„æ˜ å°„è·¯å¾„ @Override protected String[] getServletMappings() &#123; //è®¾ç½®ä¸º/è¡¨ç¤ºæ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œä»»æ„è¯·æ±‚éƒ½å°†è½¬å…¥åˆ°SpringMVCä¸­è¿›è¡Œå¤„ç† return new String[]&#123;&quot;/&quot;&#125;; &#125; //åŠ è½½Springå®¹å™¨é…ç½®ï¼Œç°åœ¨ä¸éœ€è¦ @Override protected WebApplicationContext createRootApplicationContext() &#123; return null; &#125;&#125; å³é”®æ‰¾åˆ°Run Mavenå†æ‰¾åˆ°tomcat7:runç‚¹å‡»è¿è¡Œï¼Œæ‰“å¼€æµè§ˆå™¨æ‰“å¼€http://localhost:8888/save é¡µé¢å³å¯å‡ºç°å†…å®¹ï¼š 1&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125; æ­¤æ—¶æ§åˆ¶å°æ‰“å°å‡ºï¼š 1user is saving~~ 1.3 å…¥é—¨æ€»ç»“ SpringMVCå…¥é—¨ç¨‹åºå¼€å‘æ€»ç»“(1+N) ä¸€æ¬¡æ€§å·¥ä½œ åˆ›å»ºå·¥ç¨‹, è®¾ç½®æœåŠ¡å™¨ï¼ŒåŠ è½½å·¥ç¨‹ å¯¼å…¥åæ ‡ åˆ›å»ºwebå®¹å™¨å¯åŠ¨ç±», åŠ è½½SpringMVCé…ç½®ï¼Œ å¹¶è®¾ç½®SpringMVCè¯·æ±‚æ‹¦æˆªè·¯å¾„ SpringMVCæ ¸å¿ƒé…ç½®ç±» (è®¾ç½®é…ç½®ç±»,æ‰«æcontrolleråŒ…, åŠ è½½Controlleræ§åˆ¶å™¨bean) å¤šæ¬¡å·¥ä½œ å®šä¹‰å¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨ç±» å®šä¹‰å¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œ å¹¶é…ç½®æ˜ å°„è·¯å¾„@RequestMappingä¸è¿”å›jsonæ•°æ®@ResponseBody 1.4 å·¥ä½œæµç¨‹å…¥é—¨æ¡ˆä¾‹å·¥ä½œæµç¨‹åˆ†æ å¯åŠ¨æœåŠ¡å™¨åˆå§‹åŒ–è¿‡ç¨‹ æœåŠ¡å™¨å¯åŠ¨, æ‰§è¡ŒServletContainersInitConfigç±»,åˆå§‹åŒ–webå®¹å™¨ æ‰§è¡ŒcreateServletApplicationContextæ–¹æ³•ï¼Œåˆ›å»ºäº†WebApplicationContextå¯¹è±¡ åŠ è½½SpringMvcConfigé…ç½®æ–‡ä»¶ æ‰§è¡Œ@ComponentScanåŠ è½½å¯¹åº”çš„bean åŠ è½½UserController, æ¯ä¸ª@RequestMappingçš„åç§°å¯¹åº”ä¸€ ä¸ªå…·ä½“çš„æ–¹æ³• æ‰§è¡ŒgetServletMappingsæ–¹æ³•, å®šä¹‰æ‰€æœ‰çš„è¯·æ±‚éƒ½é€šè¿‡SpringMVC å•æ¬¡è¯·æ±‚è¿‡ç¨‹ å‘é€è¯·æ±‚http:localhost:8888/save webå®¹å™¨å‘ç°æ‰€æœ‰è¯·æ±‚éƒ½ç»è¿‡SpringMVC, å°†è¯·æ±‚äº¤ç»™SpringMVCå¤„ç† è§£æè¯·æ±‚è·¯å¾„&#x2F;save ç”±&#x2F;saveåŒ¹é…æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•save() æ‰§è¡Œsave() æ£€æµ‹åˆ°æœ‰@ResponseBodyç›´æ¥å°†save()æ–¹æ³•çš„è¿”å›å€¼ä½œä¸ºå“åº”æ±‚ä½“è¿”å›ç»™è¯·æ±‚æ–¹ 1.5 beanåŠ è½½æ§åˆ¶ com springmvc config controller service dao ControlleråŠ è½½æ§åˆ¶ä¸šåŠ¡ä¸ä¸šåŠ¡beanåŠ è½½æ§åˆ¶ SpringMVCç›¸å…³bean è¡¨ç°å±‚bean(Controller) Springæ§åˆ¶çš„bean ä¸šåŠ¡bean(Service) åŠŸèƒ½bean(DataSourseç­‰) SpringMVCç›¸å…³çš„beanåŠ è½½æ§åˆ¶ SpringMVCåŠ è½½çš„beanå¯¹åº”çš„åŒ…å‡åœ¨com.springnvc.controlleråŒ…å†… Springç›¸å…³beanåŠ è½½æ§åˆ¶ SpringåŠ è½½çš„beanè®¾å®šèŒƒå›´ä¸ºcom.springmvcï¼Œæ’é™¤controlleråŒ…å†…çš„bean SpringåŠ è½½çš„beanè®¾å®šèŒƒå›´ä¸ºç²¾å‡†èŒƒå›´ï¼Œå¦‚ï¼šcom.springmvc.daoã€com.springmvc.serviceç­‰(å¸¸ç”¨) ä¸åŒºåˆ†Springä¸SpringMVCçš„ç¯å¢ƒï¼ŒåŠ è½½åˆ°åŒä¸€ä¸ªç¯å¢ƒä¸­ æ–¹å¼ä¸€(å¸¸ç”¨)ï¼š 1234@Configuration@ComponentScan(&#123;&quot;com.springmvc.dao&quot;,&quot;com.springmvc.service&quot;&#125;)public class SpringConfig &#123;&#125; æ–¹å¼äºŒï¼š 123456789@Configuration@ComponentScan(value = &quot;com.springmvc&quot;, excludeFilters = @ComponentScan.Filter( type = FilterType.ANNOTATION, //æŒ‰ç…§æ³¨è§£æ’é™¤ classes = Controller.class //éœ€è¦æ’é™¤çš„æ³¨è§£ç±»å‹ ))public class SpringConfig &#123;&#125; åŠ è½½SpringMVCå’ŒSpringé…ç½® 123456789101112131415161718192021public class ServletContainerInitConfig extends AbstractDispatcherServletInitializer &#123; //åŠ è½½SpringMVCé…ç½® @Override protected WebApplicationContext createServletApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringMvcConfig.class); return acwac; &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;&quot;/&quot;&#125;; &#125; //åŠ è½½SpringMVCé…ç½® @Override protected WebApplicationContext createRootApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringConfig.class); return acwac; &#125;&#125; ç®€åŒ–æ“ä½œ(å¸¸ç”¨)ï¼š 1234567891011121314151617public class ServletContainerInitConfig extends AbstractAnnotationConfigDispatcherServletInitializer &#123; @Override protected Class&lt;?&gt;[] getRootConfigClasses() &#123; return new Class[]&#123;SpringConfig.class&#125;; &#125; @Override protected Class&lt;?&gt;[] getServletConfigClasses() &#123; return new Class[]&#123;SpringMvcConfig.class&#125;; &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;&quot;/&quot;&#125;; &#125;&#125; 2.è¯·æ±‚ä¸å“åº”2.1 3.RESTé£æ ¼4.SSMæ•´åˆ5.æ‹¦æˆªå™¨","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"(æ¯æ—¥LeetCode)324. æ‘†åŠ¨æ’åº II","slug":"æ¯æ—¥LeetCode/324 æ‘†åŠ¨æ’åº II","date":"2022-06-28T02:30:00.000Z","updated":"2022-07-03T04:02:56.589Z","comments":true,"path":"2022/06/28/æ¯æ—¥LeetCode/324 æ‘†åŠ¨æ’åº II/","link":"","permalink":"http://example.com/2022/06/28/%E6%AF%8F%E6%97%A5LeetCode/324%20%E6%91%86%E5%8A%A8%E6%8E%92%E5%BA%8F%20II/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œå°†å®ƒé‡æ–°æ’åˆ—æˆ nums[0] &lt; nums[1] &gt; nums[2] &lt; nums[3]... çš„é¡ºåºã€‚ ä½ å¯ä»¥å‡è®¾æ‰€æœ‰è¾“å…¥æ•°ç»„éƒ½å¯ä»¥å¾—åˆ°æ»¡è¶³é¢˜ç›®è¦æ±‚çš„ç»“æœã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [1,5,2,4,3,6]è¾“å‡ºï¼š[3,6,2,5,1,4] æ€è·¯ï¼šåŒæŒ‡é’ˆæ³•å°†æ•°ç»„numsæŒ‰ä»å°åˆ°å¤§æ’åˆ—ï¼š 1 2 3 4 5 6 $\\leftarrow\\Uparrow$left $\\leftarrow\\Uparrow$right æŠŠæ’åºå¥½çš„æ•°ç»„åˆ†æˆä¸¤éƒ¨åˆ†ï¼ŒleftæŒ‡é’ˆä½äºæ•°ç»„ä¸­é—´ï¼ŒrightæŒ‡é’ˆä½äºæ•°ç»„æœ«å°¾ï¼Œ å°†leftå’Œrightå½“å‰ä½ç½®çš„å…ƒç´ ä¾æ¬¡æ‰“å°åï¼Œleftå’ŒrightæŒ‡é’ˆå·¦ç§»ï¼Œç›´è‡³ç»“æŸ è¾“å‡ºï¼š[3, 6, 2, 5, 1, 4] ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: void wiggleSort(vector&lt;int&gt;&amp; nums) &#123; int n = nums.size(); //è·å–æ•°ç»„çš„å…ƒç´ ä¸ªæ•° int left = n/2-1; //å®šä¹‰å·¦æŒ‡é’ˆ int right = n-1; //å®šä¹‰å³æŒ‡é’ˆ vector&lt;int&gt; new_nums(nums); sort(new_nums.begin(),new_nums.end()); //å°†æ–°æ•°ç»„æ’åº for(int i=0;i&lt;n;i++)&#123; if(i%2 == 0)&#123; //å¶æ•°ä½ç½®æ’å…¥leftæŒ‡é’ˆçš„å…ƒç´ ï¼Œå¥‡æ•°ä½ç½®æ’å…¥rightæŒ‡é’ˆçš„å…ƒç´  nums[i] = a[left]; left--; &#125; else&#123; nums[i] = a[right]; rigth--; &#125; &#125; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œæ’åºæ‰€éœ€çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(nlogn)ï¼Œæ’å…¥O(n)ï¼Œæ•´ä½“O(nlogn) ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œéœ€è¦é¢å¤–çš„ç©ºé—´å­˜æ”¾æ’åºçš„å…ƒç´ ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"Springæ¡†æ¶","slug":"Java/Springæ¡†æ¶","date":"2022-06-25T09:55:58.239Z","updated":"2022-06-30T06:36:33.319Z","comments":true,"path":"2022/06/25/Java/Springæ¡†æ¶/","link":"","permalink":"http://example.com/2022/06/25/Java/Spring%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè¯†Spring å®˜ç½‘ï¼šspringå®˜ç½‘ Springå·²ç»å‘å±•æˆäº†ä¸€ç§å¼€å‘çš„ç”Ÿæ€åœˆï¼ŒSpringæä¾›äº†è‹¥å¹²ä¸ªé¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®ç”¨äºå®Œæˆç‰¹å®šçš„åŠŸèƒ½ Spring Framework Spring Boot Spring Cloud â€¦. ç›®å‰å·²ç»å‘å±•åˆ°Spring 5.0ï¼Œéœ€è¦JDK8ä»¥ä¸Šæ”¯æŒ 2.Spring Frameworkæ¶æ„ Spring Frameworkæ˜¯Springç”Ÿæ€åœˆä¸­æœ€åŸºç¡€çš„é¡¹ç›®ï¼Œæ˜¯å…¶ä»–é¡¹ç›®çš„æ ¹åŸº Data Accessï¼šæ•°æ®è®¿é—® Data Integerationï¼šæ•°æ®é›†æˆ Webï¼šwebå¼€å‘ AOPï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ Aspectsï¼šAOPæ€æƒ³å®ç° Core Containerï¼šæ ¸å¿ƒå®¹å™¨ Testï¼šå•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯• 3.æ ¸å¿ƒæ¦‚å¿µ3.1 é¡¹ç›®ç»“æ„ javaåŒ… comåŒ… springåŒ… daoåŒ… BookDao.java implåŒ… BookDaoImpl.java serviceåŒ… BookSerive.java implåŒ… BookServiceImpl.java App.javaä¸»å‡½æ•° resourcesåŒ… applicationContext.xml jdbc.properties 3.2 åˆè¯†IOCå’ŒDI12345public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;book dao save...&quot;); &#125;&#125; 123456public class BookServiceImpl implements BookService &#123; private BookDao bookDao = new BookDaoImpl; public void save() &#123; bookDao.save(); &#125;&#125; è¿™æ˜¯ä¸€ç§å¾ˆå¸¸è§çš„å†™æ³•ã€‚ä½†æ˜¯è¿™æ ·çš„å†™æ³•è€¦åˆåº¦å¤ªé«˜ï¼Œè€¦åˆåº¦å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šä¸¤ä¸ªç±»ä¹‹é—´çš„å…³è”ç¨‹åº¦ï¼Œè€¦åˆåº¦é«˜å°±ä»£è¡¨ä¸¤ä¸ªç±»ä¹‹é—´å…³è”ç¨‹åº¦å¾ˆé«˜ï¼ŒåŠ¨å…¶ä¸­ä¸€ä¸ªç±»ï¼Œå°±ä¸å¾—ä¸åŠ¨å¦å¤–ä¸€ä¸ªç±»ã€‚ æ‰€ä»¥å°±éœ€è¦è§£è€¦ 123456public class BookServiceImpl implements BookService &#123; private BookDao bookDao;//service:æˆ‘å…è´¹å•¦ï¼ public void save() &#123; bookDao.save(); &#125;&#125; IOC(Inversion of Control) æ§åˆ¶åè½¬ ä½¿ç”¨å¯¹è±¡æ—¶ï¼Œç”±ä»¥å‰ä¸»åŠ¨newä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºç”±å¤–éƒ¨æä¾›å¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒäº¤ç»™äº†å¤–éƒ¨ï¼Œæ­¤æ€æƒ³ä¸ºæ§åˆ¶åè½¬ã€‚ SpringæŠ€æœ¯å¯¹IOCè¿›è¡Œå®ç° Springæä¾›ä¸€ä¸ªå®¹å™¨ï¼Œç§°ä¸ºIOCå®¹å™¨ï¼Œç”¨æ¥å½“ä½œIOCæ€æƒ³ä¸­çš„**â€å¤–éƒ¨â€** IOCå®¹å™¨è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ç­‰å·¥ä½œ åœ¨IOCå®¹å™¨ä¸­è¢«åˆ›å»ºæˆ–è¢«ç®¡ç†çš„å¯¹è±¡ç§°ä¹‹ä¸ºBean DI(Dependency Injection) ä¾èµ–æ³¨å…¥ åœ¨å®¹å™¨ä¸­å»ºç«‹çš„beanä¸beanä¹‹é—´çš„ä¾èµ–å…³ç³»çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç§°ä¹‹ä¸ºä¾èµ–æ³¨å…¥ã€‚ ä¾‹ï¼šserviceå±‚éœ€è¦ä¾èµ–daoå±‚è¿è¡Œï¼Œä½†æ— éœ€è‡ªå·±newä¸€ä¸ªdaoå±‚ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆdaoå±‚ã€‚ ç›®æ ‡ï¼šå……åˆ†è§£è€¦ ä½¿ç”¨IOCå®¹å™¨ç®¡ç†bean(IOCæ€æƒ³) åœ¨ICOå®¹å™¨å†…å°†ä¾èµ–å…³ç³»çš„beanè¿›è¡Œå…³ç³»ç»‘å®š(DIæ€æƒ³) åœ¨ä½¿ç”¨å¯¹è±¡æ—¶ä¸ä»…å¯ä»¥ä»IOCå®¹å™¨ä¸­è·å–ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥è·å–åˆ°beanå·²ç»ç»‘å®šçš„æ‰€æœ‰ä¾èµ–å…³ç³» 4.IOCå…¥é—¨ pom.xmlå¯¼å…¥springçš„åæ ‡ 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.3.18&lt;/version&gt;&lt;/dependency&gt; resourcesç›®å½•åˆ›å»ºSpringé…ç½®æ–‡ä»¶applicationContext.xml é…ç½®bean beanæ ‡ç­¾ï¼šé…ç½®bean idå±æ€§ï¼šç»™beanèµ·åå­— classå±æ€§ï¼šç»™beanå®šä¹‰ç±»å‹ 123&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;/&gt; åˆ›å»ºåä¸ºå¯åŠ¨ç±»App 1234567891011121314151617import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import com.spring.dao.BookDao;public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); BookService bookService = (BookService) ac.getBean(&quot;bookService&quot;); bookService.save(); &#125;&#125; 5.DIå…¥é—¨ åŸºäºIOCç®¡ç†bean ä¸èƒ½ä¿ç•™Serviceå±‚ä¸­ç”¨newåˆ›å»ºçš„å¯¹è±¡ é€šè¿‡springé…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®Serviceä¸Daoçš„å…³ç³» 12345678910111213public class BookServiceImpl implements BookService &#123; //åˆ é™¤ä¸šåŠ¡å±‚ä¸­ç”¨newåˆ›å»ºå¯¹è±¡çš„æ–¹å¼ //private BookDao bookDao = new BookDaoImpl(); private BookDao bookDao; //æä¾›ç›¸åº”çš„setçš„æ–¹æ³• public void setBookDao(BookDao bookDao) &#123; this.bookDao = bookDao; &#125; public void save() &#123; bookDao.save(); &#125;&#125; åœ¨springé…ç½®æ–‡ä»¶applicationContext.xmlä¸­ï¼Œé…ç½®property propertyæ ‡ç­¾ï¼šé…ç½®å½“å‰beançš„å±æ€§ nameå±æ€§ï¼šé…ç½®å“ªä¸ªå…·ä½“çš„å±æ€§ refå±æ€§ï¼šå‚ç…§springé…ç½®æ–‡ä»¶ä¸­çš„å“ªä¸ªbeançš„id 123456&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;!-- é…ç½®serviceä¸daoçš„å…³ç³» --&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; é…ç½®å®Œæˆåï¼ŒBookDaoæ— éœ€ä½¿ç”¨newæ¥æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡springæ¥è‡ªåŠ¨åˆ›å»º 6.beanåŸºç¡€é…ç½®6.1 beanåˆ«åé…ç½® nameå±æ€§ï¼šå¯ä»¥èµ·å¤šä¸ªåˆ«åç”¨;åˆ†å· ç©ºæ ¼,é€—å·åˆ†éš” 123&lt;bean id=&quot;bookDao&quot; name=&quot;dao Dao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; name=&quot;Service service&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;/&gt; åˆ«åå¯ä»¥ç”¨äºgetBean()æ–¹æ³• 1234567891011public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean //BookService bookService=(BookService)ac.getBean(&quot;bookService&quot;); //é€šè¿‡åˆ«åè·å–BookService BookService bookService=(BookService)ac.getBean(&quot;Service&quot;); bookService.save(); &#125;&#125; åˆ«åä¹Ÿå¯ä»¥ç”¨æˆ·refå±æ€§ï¼Œä¸å»ºè®®ç”¨åˆ«åï¼Œå»ºè®®ä½¿ç”¨id 123&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;Dao&quot;/&gt;&lt;/bean&gt; 6.2 beançš„ä½œç”¨èŒƒå›´åˆ›å»ºçš„beanæ˜¯å¦ä¸ºå¤šä¸ªå¯¹è±¡ 123456789101112public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao1 = (BookDao) ac.getBean(&quot;bookDao&quot;); BookDao bookDao2 = (BookDao) ac.getBean(&quot;bookDao&quot;); System.out.println(bookDao1); System.out.println(bookDao2); &#125;&#125; 123è¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@7219ec67com.spring.dao.impl.BookDaoImpl@7219ec67 ç»“è®ºï¼šä¸¤ä¸ªå¯¹è±¡åœ°å€ç›¸åŒï¼Œspringé»˜è®¤åˆ›å»ºçš„beanæ˜¯å•ä¾‹çš„ éœ€è¦åœ¨é…ç½®æ–‡ä»¶çš„beanæ ‡ç­¾é‡Œæ·»åŠ ä¸€ä¸ªscopeå±æ€§ scopeå±æ€§æœ‰singletonå•ä¾‹æ¨¡å¼å’Œprototypeéå•ä¾‹æ¨¡å¼ scopeå±æ€§é»˜è®¤ä¸ºsingletonå•ä¾‹æ¨¡å¼ 1&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; scope=&quot;prtotype&quot;/&gt; 123å†æ¬¡è¿è¡Œåï¼Œè¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@7219ec67com.spring.dao.impl.BookDaoImpl@45018215 ç»“è®ºï¼šä¸¤ä¸ªå¯¹è±¡åœ°å€ä¸åŒï¼Œä¸ºéå•ä¾‹æ¨¡å¼ beanä½œç”¨èŒƒå›´è¯´æ˜ å•ä¾‹beançš„ä¼˜åŠ¿ å‡å°‘äº†æ–°ç”Ÿæˆå®ä¾‹çš„æ¶ˆè€—ï¼Œå¯ä»¥å¿«é€Ÿè·å–åˆ°beanï¼Œæ›´å¤§ç¨‹åº¦çš„å¤ç”¨ é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†çš„bean è¡¨ç°å±‚å¯¹è±¡ï¼Œä¸šåŠ¡å±‚å¯¹è±¡ï¼Œæ•°æ®å±‚å¯¹è±¡ï¼Œå·¥å…·å¯¹è±¡ ä¸é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†çš„bean å°è£…å®ä½“çš„åŸŸå¯¹è±¡(å­˜åœ¨å˜é‡çš„) 7.beanå®ä¾‹åŒ– beançš„æœ¬è´¨å°±æ˜¯å¯¹è±¡ï¼Œåˆ›å»ºbeanéƒ½éœ€è¦ä½¿ç”¨æ„é€ æ–¹æ³•å®Œæˆ 7.1 æ„é€ æ–¹æ³•å®ä¾‹åŒ–bean(å¸¸ç”¨) åœ¨BookDaoImplç±»ä¸­åˆ›å»ºæ„é€ æ–¹æ³•ï¼š 123456789101112public class BookDaoImpl implements BookDao &#123; public BookDaoImpl()&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;); &#125; /*private BookDaoImpl()&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;); &#125;*/ public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125;&#125; AppForInstanceBookç±»è¿›è¡Œæµ‹è¯•ï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ å¹¶ä¸”BookDaoImplä¸­çš„æ„é€ æ–¹æ³•æ— è®ºæ˜¯å¦ç§æœ‰éƒ½å¯ä»¥è¢«è°ƒç”¨ï¼Œè¿™å°±æ˜¯åå°„ã€‚ æ— å‚æ„é€ æ–¹æ³•ä¸å­˜åœ¨ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ åœ¨BookDaoImplç±»ä¸­æ„é€ æ–¹æ³•æ”¹ä¸ºæœ‰å‚æ„é€ ï¼š 123public BookDaoImpl(int i)&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;);&#125; è¿è¡Œåä¼šæŠ¥é”™ï¼ŒåŒæ—¶è¯´æ˜Springåˆ›å»ºbeançš„æ—¶å€™ï¼Œè°ƒç”¨çš„æ˜¯æ— å‚æ„é€ ã€‚ 7.2 é™æ€å·¥å‚å®ä¾‹åŒ–bean(æ—©æœŸå®ä¾‹åŒ–bean äº†è§£) åˆ›å»ºä¸€ä¸ªfactoryè½¯ä»¶åŒ…ï¼Œå¹¶åœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ªBookDaoFactoryç±»ï¼š 123456public class BookDaoFactory &#123; public static BookDao getBookDao()&#123; System.out.println(&quot;factory is running&quot;); return new BookDaoImpl(); &#125;&#125; AppForInstanceBookç±»è¿è¡Œï¼š 1234567public class AppForInstanceBook &#123; public static void main(String[] args) &#123; BookDao bookDao = BookDaoFactory.getBookDao(); bookDao.save(); &#125;&#125;//è¿è¡ŒæˆåŠŸ é€šè¿‡é…ç½®æ–‡ä»¶ä½¿ç”¨é™æ€å·¥å‚å®ä¾‹åŒ–beanï¼š Springé…ç½®æ–‡ä»¶ä¸­ï¼š factory-methodå±æ€§ï¼šé€‰æ‹©å·¥å‚é‡Œçš„beanå®ä¾‹æ–¹æ³• 12&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.factory.BookDaoFactory&quot; factory-method=&quot;getBookDao&quot;/&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is runningBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ 7.3 å®ä¾‹å·¥å‚å®ä¾‹åŒ–bean(éé™æ€å·¥å‚ äº†è§£) BookDaoFactoryç±»ä¸­ï¼Œå°†æ–¹æ³•æ”¹ä¸ºéé™æ€æ–¹æ³• 123456public class BookDaoFactory &#123; public BookDao getBookDao()&#123; System.out.println(&quot;factory is running~~~~~&quot;); return new BookDaoImpl(); &#125;&#125; AppForInstanceBookç±»è¿è¡Œï¼š 1234567public class AppForInstanceBook &#123; public static void main(String[] args) &#123; BookDaoFactory bookDaoFactory = new BookDaoFactory(); BookDao bookDao = bookDaoFactory.getBookDao(); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is running~~~~~BookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ é€šè¿‡é…ç½®æ–‡ä»¶ä½¿ç”¨é™æ€å·¥å‚å®ä¾‹åŒ–beanï¼š Springé…ç½®æ–‡ä»¶ä¸­ï¼š 12345&lt;!-- å…ˆè¦é€ å‡ºå·¥å‚çš„bean --&gt;&lt;bean id=&quot;bookDaoFactory&quot; class=&quot;com.spring.factory.BookDaoFactory&quot;/&gt;&lt;bean id=&quot;bookDao&quot; factory-bean=&quot;bookDaoFactory&quot; factory-method=&quot;getBookDao&quot; /&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is running~~~~~BookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ é…ç½®æ–‡ä»¶ä¸­beanbookDaoFactoryåªæ˜¯ä¸ºäº†é…åˆä½¿ç”¨ï¼Œå®é™…æ²¡æœ‰æ„ä¹‰ã€‚ Springå¯¹è¿™ç§å®ä¾‹åŒ–beanæ–¹æ³•è¿›è¡Œäº†æ”¹è‰¯ï¼š 4.é€šè¿‡FactoryBeanå®ä¾‹åŒ–bean(å®ç”¨) åˆ›å»ºBookDaoFactoryBeanç±»å®ç°æ¥å£FactoryBean&lt;T&gt; 123456789101112public class BookDaoFactoryBean implements FactoryBean&lt;BookDao&gt; &#123; //ä»£æ›¿åŸå§‹å®ä¾‹å·¥å‚ä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹æ³• @Override public BookDao getObject() throws Exception &#123; return new BookDaoImpl(); &#125; @Override public Class&lt;?&gt; getObjectType() &#123; return BookDao.class; &#125;&#125; Springé…ç½®æ–‡ä»¶ä¸­ï¼š 1&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.factory.BookDaoFactoryBean&quot;/&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ å¹¶ä¸”BookDaoFactoryBeanç±»ä¸­å¯ä»¥é‡å†™isSinglentonæ–¹æ³•ï¼š 12345@Overridepublic boolean isSingleton() &#123; //trueï¼šå•ä¾‹ï¼› falseï¼šå¤šä¾‹ï¼›é»˜è®¤å•ä¾‹ return true;&#125; 8.beançš„ç”Ÿå‘½å‘¨æœŸ beanç”Ÿå‘½å‘¨æœŸï¼šbeanä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä½“è¿‡ç¨‹ beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ï¼šåœ¨beanåˆ›å»ºååˆ°é”€æ¯å‰åšä¸€äº›äº‹ åœ¨BookDaoImplç±»ä¸­ï¼Œåˆ›å»ºinitå’Œdestroyæ–¹æ³• 1234567891011121314public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125; public void init()&#123; System.out.println(&quot;init~~~&quot;); &#125; public void destroy()&#123; System.out.println(&quot;destroy~~~&quot;); &#125;&#125; åœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼š init-methodå’Œdestroy-methodå±æ€§ 12&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;/&gt; è°ƒç”¨ä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~ æ§åˆ¶å°å¹¶æ²¡æœ‰è¾“å‡ºdestroy~~~ï¼› å› ä¸ºé”€æ¯å‡½æ•°è¿˜æ²¡æœ‰æ¥å¾—åŠè°ƒç”¨ï¼Œç¨‹åºå°±è¢«æ€æ­»äº†ï¼› æ‰€ä»¥éœ€è¦è¿›è¡Œæ‰‹åŠ¨å…³é—­ï¼› æˆ‘ä»¬è°ƒç”¨ä¸»å‡½æ•°ä¸­çš„acä¸­çš„close()æ–¹æ³•ï¼Œä½†æ˜¯ApplicationContextæ¥å£ä¸­å¹¶æ²¡æœ‰æä¾›close()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ”¹ç”¨ClassPathXmlApplicationContextç±»ã€‚ 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.close(); &#125;&#125; 12345è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~destroy~~~ æˆåŠŸï¼ï¼ï¼ï¼ å®¹å™¨è¿˜æä¾›å¦å¤–ä¸€ç§æ–¹å¼å…³é—­å®¹å™¨ï¼šè®¾ç½®å…³é—­é’©å­ è°ƒç”¨acçš„registerShutdownHook()æ–¹æ³• 1234567891011public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~destroy~~~ close()å’ŒregisterShutdownHook()çš„åŒºåˆ« å°†registerShutdownHook()æ”¾åˆ°ä¸Šé¢ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); ac.registerShutdownHook(); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡ŒæˆåŠŸï¼šinit~~~BookDao~~~~~destroy~~~ å°†close()æ”¾åˆ°ä¸Šé¢ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); ac.close(); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123456è¿è¡Œç»“æœï¼šinit~~~destroy~~~æŠ¥é”™ï¼šBeanFactory not initialized or already closed - call &#x27;refresh&#x27; before accessing beans via the ApplicationContext BeanFactoryæ²¡æœ‰è¢«åˆå§‹åŒ–æˆ–è€…å·²ç»è¢«å…³é—­äº† è¿è¡Œå¤±è´¥ï¼ï¼ æˆ–è€…é€šè¿‡æ¥å£çš„æ–¹å¼å®ç°ï¼š BookServiceImplç±»å®ç°æ¥å£InitializingBeanå’ŒDisposableBeançš„æ–¹æ³• 1234567891011121314151617181920212223public class BookServiceImpl implements BookService, InitializingBean, DisposableBean &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125; public void save() &#123; bookDao.save(); &#125; @Override public void destroy() throws Exception &#123; System.out.println(&quot;service destroy~~~~&quot;); &#125; @Override public void afterPropertiesSet() throws Exception &#123; System.out.println(&quot;service init~~~~&quot;); &#125;&#125; é…ç½®æ–‡ä»¶ï¼š 123456&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt;&lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; ä¸»å‡½æ•°è¿è¡Œï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 1234567è¿è¡Œç»“æœï¼šinit~~~BookDao set~~~service init~~~~BookDao~~~~~service destroy~~~~destroy~~~ BookServiceImplç±»ä¸­destroy()æ–¹æ³•å’ŒafterPropertiesSet()æ–¹æ³•è¢«è°ƒç”¨ å¹¶ä¸”setBookDao()æ–¹æ³•ä¹‹åæ‰è°ƒç”¨çš„afterPropertiesSet()æ–¹æ³• 9.ä¾èµ–æ³¨å…¥æ–¹å¼å‘ä¸€ä¸ªç±»ä¼ é€’æ•°æ®çš„æ–¹å¼æœ‰ï¼šsetæ–¹æ³•ã€æ„é€ æ–¹æ³• 9.1 setteræ³¨å…¥ å¼•ç”¨ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„setæ–¹æ³• BookServiceImplç±»ä¸­ï¼š 1234567public class BookServiceImpl implements BookService &#123; private BookDao bookDao; //æä¾›ç›¸åº”çš„setçš„æ–¹æ³• public void setBookDao(BookDao bookDao) &#123; this.bookDao = bookDao; &#125;&#125; åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨propertyæ ‡ç­¾refå±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ 12345&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; ç®€å•ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„setæ–¹æ³• BookDaoImplç±»ä¸­ï¼š 1234567891011121314public class BookDaoImpl implements BookDao &#123; private String name; private int age; public void setName(String name) &#123; this.name = name; &#125; public void setAge(int age) &#123; this.age = age; &#125; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name+&quot;å¹´é¾„ï¼š&quot;+age); &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨propertyæ ‡ç­¾valueå±æ€§æ³¨å…¥ç®€å•ç±»å‹æ•°æ® 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;DaHuang&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;18&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šDaHuangå¹´é¾„ï¼š18 9.2 æ„é€ å™¨æ³¨å…¥ å¼•ç”¨ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„æ„é€ æ–¹æ³• 12345678public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public BookServiceImpl(BookDao bookDao) &#123; System.out.println(&quot;BookServiceImplæ„é€ å™¨è¿è¡Œ~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨constructor-argæ ‡ç­¾ä¸­çš„refå±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ 12345678&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;DaHuang&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;18&quot;/&gt; &lt;/bean&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;constructor-arg name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookServiceImplæ„é€ å™¨è¿è¡Œ~~~ ç®€å•ç±»å‹ BookDaoImplç±»ä¸­ï¼š 123456789public class BookDaoImpl implements BookDao &#123; private String name; private int age; public BookDaoImpl(String name, int age) &#123; this.name = name; this.age = age; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼š 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;constructor-arg name=&quot;name&quot; value=&quot;DaHei&quot;/&gt; &lt;constructor-arg name=&quot;age&quot; value=&quot;20&quot;/&gt;&lt;/bean&gt; å¦‚æœè¦æ›´æ”¹BookDaoImplç±»ä¸­çš„å½¢å‚åå­—ï¼Œè¿˜è¦æ›´æ”¹é…ç½®æ–‡ä»¶ä¸­çš„nameå±æ€§çš„åå­—ï¼› å­˜åœ¨å½¢å‚ä¸nameå±æ€§åä¸è€¦åˆçš„é—®é¢˜ã€‚ constructor-argæ ‡ç­¾è¿˜æœ‰typeå’Œindexå±æ€§ typeï¼šå½¢å‚çš„æ•°æ®ç±»å‹(å­˜åœ¨å¤šä¸ªåŒæ•°æ®ç±»å‹çš„å½¢å‚ï¼Œæ— æ³•ä½¿ç”¨) indexï¼šå½¢å‚çš„ä½ç½®é¡ºåº åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨indexå±æ€§è®¾ç½®æŒ‰å½¢å‚ä½ç½®é¡ºåºæ³¨å…¥ 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;constructor-arg index=&quot;0&quot; value=&quot;DaHei&quot;/&gt; &lt;constructor-arg index=&quot;1&quot; value=&quot;20&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šDaHeiå¹´é¾„ï¼š20 9.3 ä¾èµ–æ³¨å…¥æ–¹å¼çš„é€‰æ‹© å¼ºåˆ¶ä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥æœ‰æ¦‚ç‡ä¸æ³¨å…¥å¯¼è‡´nullå¯¹è±¡å‡ºç°ã€‚ beanå¿…é¡»è¦çš„ä¸œè¥¿ï¼Œè¦ç”¨æ„é€ å™¨æ³¨å…¥ã€‚å› ä¸ºæ„é€ å™¨å¿…é¡»è¢«æ‰§è¡Œï¼Œå¿…é¡»æ³¨å…¥ï¼Œå¦åˆ™æŠ¥é”™ è€Œsetteræ–¹æ³•å¯ä»¥æ‰§è¡Œä¹Ÿå¯ä»¥ä¸æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œsetteræ³¨å…¥ï¼Œä¼šå¯¼è‡´nullå¯¹è±¡ å¯é€‰ä¾èµ–ä½¿ç”¨setteræ³¨å…¥è¿›è¡Œï¼Œçµæ´»æ€§å¼ºã€‚ setteræ³¨å…¥å¯ä»¥æ‰§è¡Œä¹Ÿå¯ä»¥ä¸æ‰§è¡Œ Springæ¡†æ¶å€¡å¯¼ä½¿ç”¨æ„é€ å™¨ã€‚ ç¬¬ä¸‰æ–¹æ¡†æ¶å¤§å¤šé‡‡ç”¨æ„é€ å™¨æ³¨å…¥çš„å½¢å¼åˆå§‹åŒ–æ•°æ®ï¼Œæ›´åŠ ä¸¥è°¨ setteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥å¯ä»¥åŒæ—¶ä½¿ç”¨ã€‚ ä½¿ç”¨æ„é€ å™¨å®Œæˆå¼ºåˆ¶ä¾èµ–æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥å®Œæˆå¯é€‰ä¾èµ–æ³¨å…¥ è‡ªå·±å¼€å‘çš„æ¨¡å—æ¨èä½¿ç”¨setteræ³¨å…¥ 10.ä¾èµ–è‡ªåŠ¨è£…é…IOCå®¹å™¨æ ¹æ®beanéƒ½ä¾èµ–çš„èµ„æºåœ¨å®¹å™¨ä¸­è‡ªåŠ¨æŸ¥æ‰¾å¹¶æ³¨å…¥åˆ°beanä¸­çš„è¿‡ç¨‹ç§°ä¸ºè‡ªåŠ¨è£…é… è‡ªåŠ¨è£…é…çš„æ–¹å¼ï¼š æŒ‰ç±»å‹(å¸¸ç”¨) æŒ‰åç§° æŒ‰æ„é€ æ–¹æ³•(ä¸æ¨è) ä¸å¯ç”¨è‡ªåŠ¨è£…é… 10.1 æŒ‰ç±»å‹éœ€è¦æä¾›ç›¸åº”çš„setteræ–¹æ³• 123456789public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œè¦æå‰å†™å¥½bookDaoçš„beanå¦åˆ™æ— æ³•è£…é…ï¼Œ autowireå±æ€§è®¾ç½®ä¸ºbyTpye é€šè¿‡ç±»å‹è‡ªåŠ¨è£…é… 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;byType&quot; /&gt; ä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookService bookService = (BookService) ac.getBean(&quot;bookService&quot;); bookService.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao set~~~ å¦‚æœå‡ºç°ä¸€ä¸‹è¿™ç§æƒ…å†µï¼š 12345&lt;bean id=&quot;bookDao1&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookDao2&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;byType&quot; /&gt; å‡ºç°äº†ä¸¤ä¸ªBookDaoçš„beanï¼Œå¯¼è‡´Springæ— æ³•åŒºåˆ†äº†ï¼Œè¿™æ—¶å°±éœ€è¦æŒ‰åç§°è£…é… 10.2 æŒ‰åç§°123456789public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œautowireå±æ€§è®¾ç½®ä¸ºbyName é€šè¿‡åç§°è‡ªåŠ¨è£…é… æ˜¯é€šè¿‡BookServiceImplç±»çš„å˜é‡åbookDaoä¸é…ç½®æ–‡ä»¶çš„beanä¸­idç›¸åŒåç§°çš„è¿›è¡Œç»‘å®š 12345&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookDao2&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;ByName&quot; /&gt; 10.3 æ€»ç»“ è‡ªåŠ¨è£…é…ç”¨äºå¼•ç”¨ç±»å‹ä¾èµ–æ³¨å…¥ï¼Œä¸èƒ½å¯¹ç®€å•ç±»å‹è¿›è¡Œæ“ä½œ ä½¿ç”¨æŒ‰ç±»å‹è£…é…byTypeï¼Œå¿…é¡»ä¿éšœå®¹å™¨ä¸­ç›¸åŒç±»å‹çš„beanå”¯ä¸€ï¼Œæ¨èä½¿ç”¨ ä½¿ç”¨æŒ‰åç§°è£…é…byNameï¼Œå¿…é¡»ä¿éšœå®¹å™¨ä¸­å…·æœ‰æŒ‡å®šåç§°çš„beanï¼Œå˜é‡åè¦ä¸é…ç½®è€¦åˆï¼Œ ä¸æ¨èä½¿ç”¨ è‡ªåŠ¨è£…é…ä¼˜å…ˆçº§ä½äºsetteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥ï¼ŒåŒæ—¶å‡ºç°æ—¶è‡ªåŠ¨è£…é…é…ç½®å¤±æ•ˆ 11.é›†åˆæ³¨å…¥123456789101112131415161718192021222324252627public class BookDaoImpl implements BookDao &#123; private int[] array; private List&lt;String&gt; list; private Set&lt;String&gt; set; private Map&lt;String, String&gt; map; private Properties properties; public void setArray(int[] array) &#123;this.array = array;&#125; public void setList(List&lt;String&gt; list) &#123;this.list = list;&#125; public void setSet(Set&lt;String&gt; set) &#123;this.set = set;&#125; public void setMap(Map&lt;String, String&gt; map) &#123;this.map = map;&#125; public void setProperties(Properties properties) &#123;this.properties = properties;&#125; public void save() &#123; System.out.println(&quot;BookDaoImpl&#123;&quot; + &quot;\\narray=&quot; + Arrays.toString(array) + &quot;, \\nlist=&quot; + list + &quot;, \\nset=&quot; + set + &quot;, \\nmap=&quot; + map + &quot;, \\nproperties=&quot; + properties + &#x27;&#125;&#x27;); &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;array&quot; &gt; &lt;array&gt; &lt;value&gt;100&lt;/value&gt; &lt;value&gt;200&lt;/value&gt; &lt;value&gt;300&lt;/value&gt; &lt;/array&gt; &lt;/property&gt; &lt;property name=&quot;list&quot; &gt; &lt;list&gt; &lt;value&gt;å”±&lt;/value&gt; &lt;value&gt;è·³&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;property name=&quot;set&quot; &gt; &lt;set&gt; &lt;value&gt;å”±&lt;/value&gt; &lt;value&gt;è·³&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;/set&gt; &lt;/property&gt; &lt;property name=&quot;map&quot; &gt; &lt;map&gt; &lt;entry key=&quot;county&quot; value=&quot;china&quot;/&gt; &lt;entry key=&quot;province&quot; value=&quot;tianjin&quot;/&gt; &lt;entry key=&quot;city&quot; value=&quot;baodi&quot;/&gt; &lt;/map&gt; &lt;/property&gt; &lt;property name=&quot;properties&quot;&gt; &lt;props&gt; &lt;prop key=&quot;county&quot;&gt;china&lt;/prop&gt; &lt;prop key=&quot;province&quot;&gt;tianjin&lt;/prop&gt; &lt;prop key=&quot;city&quot;&gt;baodi&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234567è¿è¡Œç»“æœï¼šBookDaoImpl&#123;array=[100, 200, 300], list=[å”±, è·³, Rap], set=[å”±, è·³, Rap], map=&#123;county=china, province=tianjin, city=baodi&#125;, properties=&#123;province=tianjin, city=baodi, county=china&#125;&#125; 12.æ•°æ®æºå¯¹è±¡ç®¡ç†åœ¨pom.xmlå¯¼å…¥druidåæ ‡ 12345678910&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.2.8&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.28&lt;/version&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ä¸­ï¼Œç®¡ç†DruidDataSouurceå¯¹è±¡ 123456&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/demo&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); DataSource dataSource = (DataSource) ac.getBean(&quot;dataSource&quot;); System.out.println(dataSource); &#125;&#125; 123456789101112è¿è¡Œç»“æœï¼š&#123; CreateTime:&quot;2022-06-24 22:27:03&quot;, ActiveCount:0, PoolingCount:0, CreateCount:0, DestroyCount:0, CloseCount:0, ConnectCount:0, Connections:[ ]&#125; 13.åŠ è½½propertiesé…ç½®ä¿¡æ¯åœ¨rescourceèµ„æºåŒ…ä¸­åˆ›å»ºjdbc.propertiesæ–‡ä»¶ï¼š 1234567jdbc.driver=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://localhost:3306/demojdbc.username=rootjdbc.password=123456username=dahuangage=18 é…ç½®æ–‡ä»¶ä¸­: åœ¨beansæ ‡ç­¾ä¸­å¼€å¯contextå‘½åç©ºé—´ ä½¿ç”¨contextç©ºé—´åŠ è½½propertiesæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- 1.å¼€å¯contextå‘½åç©ºé—´ --&gt; &lt;!-- 2.ä½¿ç”¨contextç©ºé—´åŠ è½½propertiesæ–‡ä»¶ --&gt; &lt;context:property-placeholder location=&quot;jdbc.properties&quot; system-properties-mode=&quot;NEVER&quot;/&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;!-- ä½¿ç”¨å ä½ç¬¦$&#123;&#125;è¯»å–propertiesä¸­çš„å±æ€§ --&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;$&#123;username&#125;&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;$&#123;age&#125;&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; åŠ è½½propertiesæ–‡ä»¶æ ¼å¼ï¼š ä¸åŠ è½½ç³»ç»Ÿå±æ€§ï¼š 12&lt;context:property-placeholder location=&quot;jdbc.properties&quot; system-properties-mode=&quot;NEVER&quot;/&gt; åŠ è½½å¤šä¸ªpropertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;jdbc.properties, jdbc2.properties&quot;/&gt; åŠ è½½æ‰€æœ‰propertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;*.properties&quot;/&gt; åŠ è½½propertiesæ–‡ä»¶æ ‡å‡†æ ¼å¼ï¼š 1&lt;context:property-placeholder location=&quot;classpath:*.properties&quot;/&gt; ä»ç±»è·¯å¾„æˆ–jaråŒ…ä¸­æœç´¢åŠ è½½propertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;classpath*:*.properties&quot;/&gt; 14.å®¹å™¨14.1 åˆ›å»ºå®¹å™¨çš„å‡ ç§æ–¹å¼ ç±»è·¯å¾„ä¸‹çš„åŠ è½½é…ç½®æ–‡ä»¶ 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); æ–‡ä»¶ç³»ç»Ÿä¸‹åŠ è½½çš„é…ç½®æ–‡ä»¶ 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;E:\\Java_Web\\Spring\\spring_01_IOC\\src\\main\\resources\\applicationContext.xml&quot;); åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ï¼š 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext1.xml&quot;,&quot;applicationContext2.xml&quot;); 14.2 è·å–beançš„å‡ ç§æ–¹å¼ ä½¿ç”¨beanåç§°è·å– 1BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); ä½¿ç”¨beanåç§°è·å–å¹¶æŒ‡å®šç±»å‹ 1BookDao bookDao = ac.getBean(&quot;bookDao&quot;,BookDao.class); ä½¿ç”¨beanç±»å‹è·å– 1BookDao bookDao = ac.getBean(BookDao.class);//å¯¹åº”çš„å®¹å™¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªè¯¥ç±»å‹ï¼Œå”¯ä¸€ 14.3 å®¹å™¨ç±»å±‚æ¬¡ç»“æ„ä½¿ç”¨ctrl+Hæ‰“å¼€å®¹å™¨ç±»çš„å±‚æ¬¡ç»“æ„å›¾ï¼š BeanFactoryï¼šæ˜¯IOCå®¹å™¨çš„é¡¶å±‚æ¥å£ï¼Œåˆå§‹åŒ–BeanFactoryå¯¹è±¡æ—¶ï¼ŒåŠ è½½çš„beanå»¶è¿ŸåŠ è½½ ApplicationContextï¼šæ˜¯Springå®¹å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œåˆå§‹åŒ–æ—¶beanç«‹å³åŠ è½½ â€‹ æä¾›åŸºç¡€çš„beanæ“ä½œç›¸å…³çš„æ–¹æ³•ï¼Œé€šè¿‡å…¶ä»–æ¥å£æ‰©å±•å…¶åŠŸèƒ½ ConfigurableApplicationContextï¼šæä¾›å…³é—­å®¹å™¨åŠŸèƒ½ ClassPathXmlApplicationContextï¼šå¸¸ç”¨å®ç°ç±» 14.4 BeanFactoryåˆå§‹åŒ–ç±»è·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; Rescoure rescoure = new ClassPathRescoure(&quot;applicationContext.xml&quot;); BeanFactory bf = new XmlBeanFactory(rescoure); BookDao bookDao = bf.getBean(&quot;bookDao&quot;,BookDao.class); bookDao.save(); &#125;&#125; BeanFactoryåˆ›å»ºå®Œæ¯•åï¼Œæ‰€æœ‰beanå‡ä¸ºå»¶è¿ŸåŠ è½½ 15.æ³¨è§£å¼€å‘*15.1 ç”¨æ³¨é‡Šå®šä¹‰bean123456@component(&quot;bookDao&quot;) //ç­‰ä»·äº&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125;&#125; 123456@Component //æ²¡æœ‰å†™beanåï¼Œè¦é€šè¿‡ç±»å‹è·å–beanpublic class BookServiceImpl implements BookService &#123; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); &#125;&#125; ä½†æ˜¯ï¼ŒSpringæ€ä¹ˆæ„ŸçŸ¥åˆ°æ³¨é‡Šå‘¢ï¼Ÿ é…ç½®æ–‡ä»¶ä¸­ï¼Œéœ€è¦æ·»åŠ æ‰«æç»„ä»¶ï¼š 123456789101112&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- æ‰«æ@componentç»„ä»¶ --&gt; &lt;!-- base-packageä¸ºæ‰«æçš„ä½ç½® --&gt; &lt;context:component-scan base-package=&quot;com.spring&quot;/&gt;&lt;/beans&gt; ä¸»å‡½æ•°ï¼š 123456789101112public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); //å› ä¸º@componentï¼Œå¹¶æ²¡æœ‰å†™beanåï¼Œæ‰€ä»¥è¦ç”¨ç±»å‹è·å–bean BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDao~~~~~BookService~~~~ Springæä¾›@componentæ³¨è§£çš„ä¸‰ä¸ªè¡ç”Ÿæ³¨è§£ @Repositoryï¼šç”¨äºæ•°æ®å±‚beanå®šä¹‰(Daoå±‚) â€‹ ä¹Ÿå¯ä»¥åŠ æ‹¬å·æ¥æŒ‡å®šbeanåï¼Œå¦‚ï¼š@Repository(â€œbookDao2â€) @Serviceï¼šç”¨äºä¸šåŠ¡å±‚beanå®šä¹‰(Serviceå±‚) @Controllerï¼šç”¨äºè¡¨ç°å±‚beanå®šä¹‰(Controllerå±‚) @Service,@Repositoryä¸èƒ½å†™åœ¨æ¥å£ä¸Š,éœ€è¦å†™åœ¨æ¥å£çš„å®ç°ç±»ä¸Š 1234@Repositorypublic class BookDaoImpl implements BookDao &#123; &#125; 1234@Servicepublic class BookServiceImpl implements BookService &#123;&#125; 1234@Controllerpublic class BookController &#123;&#125; 15.2 çº¯æ³¨é‡Šå¼€å‘æ–°å»ºä¸€ä¸ªSpringConfigç±»ï¼Œç”¨æ¥æ›¿ä»£é…ç½®æ–‡ä»¶ã€‚ å…¶ä½ç½®ï¼šcom.spring.config.SpringConfig.java comåŒ… springåŒ… configåŒ… SpringConfig.java @Configuration ï¼šç”¨äºè®¾å®šå½“å‰ç±»ä¸ºé…ç½®ç±»@ComponentScan(&quot;com.spring&quot;) ï¼šç”¨ç”¨äºè®¾å®šæ‰«æè·¯å¾„ï¼Œæ­¤æ³¨é‡Šåªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®ç”¨æ•°ç»„æ ¼å¼ 123456//ç”¨æ¥æ›¿ä»£ &lt;context:component-scan base-package=&quot;com.spring&quot;/&gt;@Configuration //ç”¨äºè®¾å®šå½“å‰ç±»ä¸ºé…ç½®ç±»@ComponentScan(&quot;com.spring&quot;) //ç”¨ç”¨äºè®¾å®šæ‰«æè·¯å¾„ï¼Œæ­¤æ³¨é‡Šåªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®ç”¨æ•°ç»„æ ¼å¼public class SpringConfig &#123; &#125; ä¸»å‡½æ•°ï¼š 1234567891011public class AppForAnnotation &#123; public static void main(String[] args) &#123; //æ”¹ç”¨æ³¨é‡Šé…ç½®åˆå§‹åŒ–å®¹å™¨ ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.save(); BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDao~~~~~BookService~~~~ 15.3 beanç®¡ç† ä½œç”¨èŒƒå›´ @Scope(&quot;singleton&quot;)ï¼šå•ä¾‹ï¼Œé»˜è®¤å•ä¾‹ @Scope(&quot;prototype&quot;)ï¼šå¤šä¾‹ beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ @PostConstructæ³¨è§£ï¼šinit @PreDestroyæ³¨è§£ï¼šdestory 123456789101112@Repository@Scope(&quot;prototype&quot;) //å¤šä¾‹public class BookDaoImpl implements BookDao &#123; @PostConstruct public void init()&#123; System.out.println(&quot;init~~~&quot;); &#125; @PreDestroy public void destroy()&#123; System.out.println(&quot;destroy~~~&quot;); &#125;&#125; 15.4 ä¾èµ–æ³¨å…¥1.å¼•ç”¨ç±»å‹ 1234567891011@Servicepublic class BookServiceImpl implements BookService &#123; @Autowired private BookDao bookDao; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); bookDao.save(); &#125;&#125; ä¸»å‡½æ•°ï¼š 12345678public class AppForAnnotation &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookService~~~~ //åœ¨åˆ›å»ºå¥½BookServiceçš„bean,å¹¶æ³¨å…¥BookDaoBookDao~~~~~ //è°ƒç”¨BookDaoçš„æ–¹æ³•save(); å½“æœ‰å¤šä¸ªåŒç±»å‹çš„beanï¼Œä½¿ç”¨@Qualifier(&quot;bookDao2&quot;)æ¥æŒ‡å®šbeanå å¹¶ä¸”éœ€è¦@Autowiredå’Œ@Qualifier(&quot;bookDao2&quot;)ä¸€èµ·ä½¿ç”¨ 1234567891011@Servicepublic class BookServiceImpl implements BookService &#123; @Autowired @Qualifier(&quot;bookDao2&quot;) private BookDao bookDao; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); bookDao.save(); &#125;&#125; æ³¨æ„ï¼š è‡ªåŠ¨è£…é…åŸºäºåå°„è®¾è®¡åˆ›å»ºå¯¹è±¡å¹¶æš´åŠ›åå°„å¯¹åº”å±æ€§ä¸ºç§æœ‰å±æ€§åˆå§‹åŒ–æ•°æ®ï¼Œæ— éœ€æä¾›setteræ–¹æ³• è‡ªåŠ¨è£…é…å»ºè®®ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œå¦‚æœä¸æä¾›å¯¹åº”çš„æ„é€ æ–¹æ³•ï¼Œè¯·æä¾›å”¯ä¸€çš„æ„é€ æ–¹æ³• @Qualifieræ³¨è§£æ— æ³•å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»é…åˆ@Autowiredæ³¨è§£ä½¿ç”¨ 2.ç®€å•ç±»å‹ 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Value(&quot;dahuang&quot;) private String name; public void save()&#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name); &#125;&#125; ä¸»å‡½æ•°ï¼š 1234567public class AppForAnnotation &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šdahaung ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç›´æ¥èµ‹å€¼ï¼Œä¸ºä»€ä¹ˆè¦ç”¨@Valueæ³¨è§£å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥ç”¨propertiesæ–‡ä»¶ï¼Œå‘å…¶ä¼ å€¼ã€‚ 3.è¯»å–propertiesæ–‡ä»¶ é€šè¿‡åˆ›å»ºä¸€ä¸ªjdbc.propertiesæ–‡ä»¶ï¼š 1name=dahei åœ¨é…ç½®ç±»ä¸­æ–°åŠ æ³¨è§£@PropertySource()ï¼Œæ‹¬å·ä¸­æŒ‡å®šæ–‡ä»¶åï¼š å¦‚ï¼š@PropertySource(&quot;jdbc.properties&quot;)æˆ–è€…@PropertySource(&quot;classpath:jdbc.properties&quot;) ä¹Ÿå¯ä»¥æŒ‡å®šå¤šä¸ªæ–‡ä»¶ï¼š å¦‚ï¼š@PropertySource(&#123;&quot;jdbc.properties&quot;,&quot;jdbc1.properties&quot;,&quot;jdbc2.properties&quot;&#125;) 12345@Configuration@ComponentScan(&quot;com.spring&quot;)@PropertySource(&quot;jdbc.properties&quot;)public class SpringConfig &#123;&#125; åœ¨BookDaoImplä¸­å°†æ³¨è§£æ”¹ä¸ºï¼š@Value(&quot;$&#123;&#125;&quot;)ï¼Œåœ¨&#123;&#125;ä¸­å¡«å…¥propertiesæ–‡ä»¶ä¸­çš„å±æ€§ å¦‚ï¼š@Value(&quot;$&#123;name&#125;&quot;) 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Value(&quot;$&#123;name&#125;&quot;) private String name; public void save()&#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name); &#125;&#125; 15.5 ç¬¬ä¸‰æ–¹beanç®¡ç†1.ä½¿ç”¨ç‹¬ç«‹çš„é…ç½®ç®¡ç†ç¬¬ä¸‰æ–¹bean 12345678910111213@Configurationpublic class SpringConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.getUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; ä½†æ˜¯ä¸å»ºè®®å°†ç‹¬ç«‹é…ç½®ç›´æ¥å†™åœ¨æ ¸å¿ƒé…ç½®ç±»ä¸­ï¼š æ–¹æ³•ä¸€ï¼šå¯¼å…¥å¼(å»ºè®®ä½¿ç”¨) åœ¨configåŒ…åˆ›å»ºä¸€ä¸ªJdbcConfig.javaé…ç½®ç±»ï¼š 12345678910111213public class JdbcConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.setUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; åœ¨SpringConfig.javaæ ¸å¿ƒé…ç½®ç±»ä¸­å¯¼å…¥ï¼š ä½¿ç”¨æ³¨è§£@Import()åœ¨æ‹¬å·ä¸­æ·»åŠ è¦å¯¼å…¥çš„é…ç½®ç±»çš„ç±»å‹ å¦‚ï¼š@Import(JdbcConfig.class) æ­¤æ³¨è§£åªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¯¼å…¥å¤šä¸ªé…ç½®ç±»ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ ¼å¼å¯¼å…¥ å¦‚ï¼š@Import(&#123;JdbcConfig.class, XXXConfig.class, XXXConfig.calss&#125;) 12345@Configuration@Import(JdbcConfig.class)public class SpringConfig &#123; &#125; æ–¹å¼äºŒï¼šæ‰«æå¼(ä¸å»ºè®®ä½¿ç”¨) æ³¨æ„ï¼šä½¿ç”¨æ‰«æå¼éœ€è¦åœ¨ç‹¬ç«‹çš„é…ç½®ç±»åŠ å…¥æ³¨è§£@Configuration 1234567891011121314@Configurationpublic class JdbcConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.setUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; åœ¨SpringConfig.javaæ ¸å¿ƒé…ç½®ç±»ä¸­æ‰«æï¼š ä½¿ç”¨æ³¨è§£@ComponentScan()åœ¨æ‹¬å·ä¸­æ·»åŠ è¦æ‰«æçš„è·¯å¾„ å¦‚ï¼š@@ComponentScan(&quot;com.spring.config&quot;) æ‰«æå¤šä¸ªè·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ ¼å¼å¯¼å…¥ å¦‚ï¼š@Import(&#123;&quot;com.spring.config&quot;,&quot;com.spring.dao&quot;&#125;) 12345@Configuration@ComponentScan(&quot;com.spring.config&quot;)public class SpringConfig &#123; &#125; 2.ç¬¬ä¸‰æ–¹beanæ³¨å…¥èµ„æº ç®€å•ç±»å‹ä¾èµ–æ³¨å…¥(æˆå‘˜å˜é‡)ï¼š åˆ©ç”¨æ³¨è§£@PropertySource(&quot;jdbc.properties&quot;)å’Œ@Import(JdbcConfig.class)å¯¼å…¥æ ¸å¿ƒä¸»é…ç½®æ–‡ä»¶ä¸­ 123456@Configuration@ComponentScan(&quot;com.spring&quot;)@PropertySource(&quot;jdbc.properties&quot;)@Import(JdbcConfig.class)public class SpringConfig &#123;&#125; åˆ©ç”¨æ³¨è§£@Value(&quot;$&#123;&#125;&quot;)æ³¨å…¥æ•°æ® 12345678910111213141516171819202122public class JdbcConfig &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String userName; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); ds.setDriverClassName(driver); ds.setUrl(url); ds.setUsername(userName); ds.setPassword(password); return ds; &#125;&#125; å¼•å…¥ç±»å‹ä¾èµ–æ³¨å…¥(æ–¹æ³•å½¢å‚)ï¼š å¼•ç”¨ç±»å‹æ³¨å…¥åªéœ€è¦ä¸ºbeanå®šä¹‰çš„æ–¹æ³•è®¾ç½®å½¢å‚ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…å¯¹è±¡ 123456789//å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource(BookDao bookDao)&#123; System.out.println(&quot;å·²å¼•ç”¨ï¼š&quot;+bookDao); DruidDataSource ds = new DruidDataSource(); //å¯¹dsè¿›è¡Œç›¸å…³è®¾ç½® return ds; &#125; 15.6 æ€»ç»“XMLé…ç½®ä¸æ³¨è§£é…ç½®çš„æ¯”è¾ƒï¼š åŠŸèƒ½ XMLé…ç½® æ³¨è§£ å®šä¹‰bean beanæ ‡ç­¾ï¼š&gt;idå±æ€§&gt;classå±æ€§ @Component &gt;@Controller &gt;@Service &gt;@Repository@ComponentScan è®¾ç½®ä¾èµ–æ³¨å…¥ setteræ³¨å…¥(setæ–¹æ³•)&gt;å¼•ç”¨&#x2F;ç®€å•æ„é€ å™¨æ³¨å…¥(æ„é€ æ–¹æ³•)&gt;è‡ªåŠ¨è£…é… @Autowird&gt;@Qualifier@Value é…ç½®ç¬¬ä¸‰æ–¹bean beanæ ‡ç­¾&gt;é™æ€å·¥å‚&gt;å®ä¾‹å·¥å‚&gt;FactoryBean @Bean ä½œç”¨èŒƒå›´ scopeå±æ€§ @Scope ç”Ÿå‘½å‘¨æœŸ æ ‡å‡†æ¥å£&gt;init-method&gt;destory-method @PostConstructor@PreDestroy 16.AOP16.1 AOPç®€ä»‹ AOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼ŒæŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ç»„ç»‡ç¨‹åºç»“æ„ OOP(Object Oriented Programing)é¢å‘å¯¹è±¡ç¼–ç¨‹ ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºå…¶è¿›è¡ŒåŠŸèƒ½å¢å¼º Springç†å¿µï¼šæ— å…¥ä¾µå¼&#x2F;æ— ä¾µå…¥å¼ æ‰§è¡Œsave()æ–¹æ³• è¿è¡Œç»“æœï¼š æ‰“å°å‡ºä¸€ä¸‡æ¬¡çš„book dao save â€¦ å’Œæ¶ˆè€—çš„æ—¶é—´ æ‰§è¡Œupdate()æ–¹æ³•æ²¡æœ‰å›¾ä¸­è“è‰²åŒºåŸŸçš„ä»£ç ï¼Œ ä½†æ˜¯ï¼Œè¿è¡Œç»“æœï¼š ä»ä¼šæ‰“å°æ‰“å°å‡ºä¸€ä¸‡æ¬¡çš„book dao update â€¦ å’Œæ¶ˆè€—çš„æ—¶é—´ è¿æ¥ç‚¹(JoinPoint)ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»æ„ä½ç½®ï¼Œç²’åº¦ä¸ºæ‰§è¡Œæ–¹æ³•ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè®¾ç½®å˜é‡ç­‰(ä»£è¡¨æ‰€æœ‰çš„æ–¹æ³•) åœ¨SpringAOPä¸­ï¼Œç†è§£æ–¹æ³•çš„æ‰§è¡Œ åˆ‡å…¥ç‚¹(Pointcut)ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­(ä»£è¡¨è¦è¿½åŠ åŠŸèƒ½çš„æ–¹æ³•) åœ¨SpringAOPä¸­ï¼Œä¸€ä¸ªåˆ‡å…¥ç‚¹åªæè¿°ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åŒ¹é…å¤šä¸ªæ–¹æ³• ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼šcom.spring.daoåŒ…ä¸‹çš„BookDaoæ¥å£ä¸­çš„äº”æ˜Ÿå‚æ— è¿”å›å€¼çš„save()æ–¹æ³• åŒ¹é…å¤šä¸ªæ–¹æ³•ï¼šæ‰€æœ‰saveæ–¹æ³•ï¼Œæ‰€æœ‰çš„getå¼€å¤´çš„æ–¹æ³•ï¼Œæ‰€æœ‰ä»¥Daoç»“å°¾çš„æ¥å£ä¸­çš„ä»»æ„æ–¹æ³•ï¼Œæ‰€æœ‰å¸¦æœ‰ä¸€ä¸ªå½¢å‚çš„æ–¹æ³• é€šçŸ¥(Advice)ï¼šåœ¨åˆ‡å…¥ç‚¹æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½(ä»£è¡¨è¿½åŠ çš„åŠŸèƒ½) åœ¨SpringAOPä¸­ï¼ŒåŠŸèƒ½æœ€ç»ˆä»¥æ–¹æ³•çš„å½¢å¼å‘ˆç° é€šçŸ¥ç±»ï¼šå®šä¹‰é€šçŸ¥çš„ç±» åˆ‡é¢(Aspect)ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥çš„å¯¹åº”å…³ç³» 16.2 AOPå…¥é—¨ æ¡ˆä¾‹è®¾å®šï¼šæµ‹è¯•æ¥å£æ‰§è¡Œæ•ˆç‡ ç®€åŒ–è®¾å®šï¼šåœ¨æ¥å£æ‰§è¡Œå½“å‰è¾“å‡ºå½“å‰çš„ç³»ç»Ÿæ—¶é—´ å¼€å‘æ¨¡å¼ï¼šXML or æ³¨è§£(æ­¤å…¥é—¨æ¡ˆä¾‹é‡‡ç”¨æ³¨è§£çš„æ–¹å¼) æ€è·¯åˆ†æï¼š å¯¼å…¥åæ ‡(pom.xml) åˆ¶ä½œè¿æ¥ç‚¹æ–¹æ³•(åŸå§‹æ“ä½œï¼ŒDaoæ¥å£ä¸å®ç°ç±») åˆ¶ä½œå…±æ€§åŠŸèƒ½(é€šçŸ¥ç±»ä¸é€šçŸ¥) å®šä¹‰åˆ‡å…¥ç‚¹ ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»(åˆ‡é¢) pom.xmlï¼š 1234567891011&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.3.18&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.9.9.1&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºä¸€ä¸ªMyAdivice.javaç±» å…¶ä½ç½®ï¼šcom.spring.aop.MyAdivice.java @Componentæ³¨è§£ï¼šå®šä¹‰ä¸ºSpringåŠ è½½çš„bean @Aspectæ³¨è§£ï¼šæŠŠå½“å‰ç±»æ ‡è¯†ä¸ºâ¼€ä¸ªåˆ‡â¾¯ä¾›å®¹å™¨è¯»å– @Pointcut(&quot;execution()&quot;)æ³¨è§£ï¼šå®šä¹‰åˆ‡å…¥ç‚¹ï¼Œâ½…æ³•ç­¾åå¿…é¡»æ˜¯publicåŠvoidå‹ã€‚ @Before(&quot;pt()&quot;)æ³¨è§£ï¼šæ ‡è¯†â¼€ä¸ªå‰ç½®å¢å¼ºâ½…æ³• åˆ‡å…¥ç‚¹pt()çš„å®šä¹‰ä¾æ‰˜ä¸€ä¸ªä¸å…·æœ‰å®é™…æ„ä¹‰çš„æ–¹æ³•è¿›è¡Œï¼Œå³æ— å‚æ•°ã€æ— è¿”å›å€¼ã€æ–¹æ³•æ— å®é™…é€»è¾‘ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(System.currentTimeMillis()); &#125;&#125; @EnableAspectJAutoProxyæ³¨è§£ï¼šå¼€å¯AOPä»£ç†è‡ªåŠ¨é…ç½® 123456@Configuration@ComponentScan(&quot;com.spring&quot;)@EnableAspectJAutoProxypublic class SpringConfig &#123;&#125; ä¸»å‡½æ•°ï¼š 1234567public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.update(); &#125;&#125; 123è¿è¡Œç»“æœï¼š1656341601464book dao update~~~ 16.3 AOPå·¥ä½œæµç¨‹ Springå®¹å™¨å¯åŠ¨ è¯»å–æ‰€æœ‰åˆ‡é¢é…ç½®ä¸­çš„åˆ‡å…¥ç‚¹ åˆå§‹åŒ–beanï¼Œåˆ¤å®šbeanå¯¹åº”çš„ç±»ä¸­çš„æ–¹æ³•æ˜¯å¦åŒ¹é…åˆ°ä»»æ„åˆ‡å…¥ç‚¹ åŒ¹é…å¤±è´¥ï¼Œåˆ›å»ºå¯¹è±¡ è·å–beanï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ åŒ¹é…æˆåŠŸï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ è·å–çš„beanæ˜¯ä»£ç†å¯¹è±¡æ—¶ï¼Œæ ¹æ®ä»£ç†å¯¹è±¡çš„è¿è¡Œæ¨¡å¼è¿è¡ŒåŸå§‹æ–¹æ³•ä¸å¢å¼ºå†…å®¹ï¼Œå®Œæˆæ“ä½œ AOPæ ¸å¿ƒæœ¬è´¨ï¼šä»£ç†æ¨¡å¼ ç›®æ ‡å¯¹è±¡(Target)ï¼šåŸå§‹åŠŸèƒ½å»æ‰å…±æ€§åŠŸèƒ½å¯¹åº”çš„ç±»äº§ç”Ÿçš„å¯¹è±¡ï¼Œè¿™ç§å¯¹è±¡æ˜¯æ— æ³•ç›´æ¥å®Œæˆæœ€ç»ˆå·¥ä½œçš„ ä»£ç†(proxy)ï¼šç›®æ ‡å¯¹è±¡æ— æ³•ç›´æ¥å®Œæˆå·¥ä½œï¼Œéœ€è¦è¿›è¡ŒåŠŸèƒ½å›å¡«ï¼Œé€šè¿‡åŸå§‹å¯¹è±¡çš„ä»£ç†å¯¹è±¡å®ç° ä»£ç ä¾æ—§æ˜¯å…¥é—¨æ¡ˆä¾‹çš„ ä½†æ˜¯å°†ä¸»å‡½æ•°ä¿®æ”¹ï¼Œæ‰“å°bookDaoçš„ç±»å‹ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); System.out.println(bookDao); System.out.println(bookDao.getClass()); &#125;&#125; 123è¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@d23e042class jdk.proxy2.$Proxy20 System.out.println(bookDao)æ‰“å°å‡ºcom.spring.dao.impl.BookDaoImpl@d23e042 æ˜¯å› ä¸ºAOPå¯¹BookDaoçš„toString()æ–¹æ³•è¿›è¡Œäº†é‡å†™ class jdk.proxy2.$Proxy20ï¼šæœ€ç»ˆç”¨çš„æ˜¯ä»£ç†çš„å¯¹è±¡ 16.4 AOPåˆ‡å…¥ç‚¹è¡¨è¾¾å¼åˆ‡å…¥ç‚¹ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³• åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³•çš„æè¿°æ–¹æ³• 1.è¯­æ³•æ ¼å¼ åˆ‡å…¥ç‚¹æ ‡å‡†æ ¼å¼ï¼šåŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.æ¥å£/ç±»å.æ–¹æ³•(å‚æ•°) å¼‚å¸¸å) 12execution(public User com.spring.service.UserService.findById(int))execution(public User com.spring.service.impl.UserServiceImpl.findById(int)) åŠ¨ä½œå…³é”®å­—ï¼šæè¿°åˆ‡å…¥ç‚¹è¡Œä¸ºåŠ¨ä½œï¼Œå¦‚executionè¡¨ç¤ºæ‰§è¡Œåˆ°æŒ‡å®šåˆ‡å…¥ç‚¹ è®¿é—®ä¿®é¥°ç¬¦ï¼špublicï¼Œprivateç­‰ï¼Œå¯ä»¥çœç•¥ è¿”å›å€¼ åŒ…å æ¥å£&#x2F;ç±»åï¼šæ¥å£åæˆ–è€…ç±»åéƒ½å¯ä»¥ æ–¹æ³•å å‚æ•° å¼‚å¸¸åï¼šæ–¹æ³•å®šä¹‰ä¸­æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼Œå¯ä»¥çœç•¥ 2.é€šé…ç¬¦ å¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹ï¼Œå¿«é€Ÿæè¿° *ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‰ç¼€æˆ–è€…åç¼€çš„åŒ¹é…ç¬¦å‡ºç° 1execution(public * com.spring.*.UserService.find*(*)) è§£é‡Šï¼šåŒ¹é…com.springåŒ…ä¸‹çš„ä»»æ„åŒ…ä¸­å«æœ‰UserServiceç±»æˆ–æ¥å£ä¸­æ‰€æœ‰å«æœ‰findå¼€å¤´çš„å¸¦æœ‰ä»»æ„ä¸€ä¸ªå‚æ•°çš„æ–¹æ³• ..ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œå¸¸ç”¨äºç®€åŒ–åŒ…åä¸å‚æ•°çš„ä¹¦å†™ 1execution(public User com..UserService.findById(..)) è§£é‡Šï¼šåŒ¹é…comåŒ…ä¸­çš„ä»»æ„åŒ…ä¸­çš„UserServiceç±»æˆ–æ¥å£ä¸­çš„æ‰€æœ‰åç§°ä¸ºfindByIdçš„æ–¹æ³• +ï¼šä¸“ç”¨äºåŒ¹é…å­ç±»ç±»å‹ 1execution(* *..*Service+.*(..)) è§£é‡Šï¼šåŒ¹é…Â·ä»»æ„åŒ…ä¸‹çš„ä»¥Serviceç»“å°¾çš„ç±»æˆ–æ¥å£çš„å­ç±»ä¸­ä¸šåŠ¡å±‚çš„æ‰€æœ‰æ–¹æ³• å¸¸ç”¨å†™æ³• 1execution(* com.spring.*.*Service.save(..)) è§£é‡Šï¼šåŒ¹é…ä¸šåŠ¡å±‚æ‰€æœ‰çš„åä¸ºsaveçš„æ–¹æ³• 3.ä¹¦å†™æŠ€å·§ æ‰€æœ‰ä»£ç æŒ‰ç…§æ ‡å‡†è§„èŒƒå¼€å‘ï¼Œå¦åˆ™ä¸€ä¸‹æŠ€å·§å…¨éƒ¨å¤±æ•ˆ æè¿°åˆ‡å…¥ç‚¹é€šå¸¸æè¿°æ¥å£ï¼Œè€Œä¸æè¿°å®ç°ç±» è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦é’ˆå¯¹æ¥å£å¼€å‘å‡é‡‡ç”¨publicæè¿°(å¯çœç•¥) è¿”å›å€¼ç±»å‹å¯¹åº”å¢åˆ æ”¹ç±»ä½¿ç”¨ç²¾å‡†ç±»å‹åŠ é€ŸåŒ¹é…ï¼Œå¯¹äºæŸ¥è¯¢ç±»è¿”å›å€¼ä½¿ç”¨*é€šé…ç¬¦å¿«é€Ÿæè¿° åŒ…åä¹¦å†™å°½é‡ä¸ä½¿ç”¨..åŒ¹é…ï¼Œæ•ˆç‡è¿‡ä½ï¼Œå¸¸ç”¨*åšå•ä¸ªåŒ…æè¿°åŒ¹é…ï¼Œæˆ–ç²¾å‡†åŒ¹é… æ¥å£å&#x2F;ç±»åä¹¦å†™åç§°ä¸æ¨¡å—çš„é‡‡ç”¨*åŒ¹é… å¦‚ï¼šUserServiceä¹¦å†™æˆ*Serviceï¼Œç»‘å®šä¸šåŠ¡å±‚æ¥å£å æ–¹æ³•åä¹¦å†™ä»¥åŠ¨è¯è¿›è¡Œç²¾å‡†åŒ¹é…ï¼Œåè¯é‡‡ç”¨*åŒ¹é… å¦‚ï¼šgetByIdä¹¦å†™æˆgetBy*ï¼ŒselectAllä¹¦å†™æˆselectAll å‚æ•°è§„åˆ™è¾ƒä¸ºå¤æ‚ï¼Œæ ¹æ®ä¸šåŠ¡æ–¹æ³•çµæ´»è°ƒæ•´ é€šå¸¸ä¸ä½¿ç”¨å¼‚å¸¸ä½œä¸ºåŒ¹é…è§„åˆ™ 16.5 AOPé€šçŸ¥ç±»å‹AOPé€šçŸ¥æè¿°äº†æŠ½å–çš„å…±æ€§åŠŸèƒ½ï¼Œæ ¹æ®å…±æ€§åŠŸèƒ½æŠ½å–çš„ä½ç½®ä¸åŒï¼Œæœ€ç»ˆè¿è¡Œä»£ç æ—¶è¦å°†å…¶åŠ å…¥åˆ°åˆç†çš„ä½ç½® AOPé€šçŸ¥å…±åˆ†ä¸º5é’Ÿç±»å‹ å‰ç½®é€šçŸ¥ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;before~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbefore~~~book dao update~~~ åç½®é€šçŸ¥ â€‹ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;after~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbook dao update~~~after~~~ ç¯ç»•é€šçŸ¥(é‡ç‚¹) 1.æ— è¿”å›å€¼ 1234567891011121314@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Around(&quot;pt()&quot;) public void method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨ pjp.proceed(); System.out.println(&quot;after~~~&quot;); &#125;&#125; 1234è¿è¡Œç»“æœï¼šbefore~~~book dao update~~~after~~~ 2.æœ‰è¿”å›å€¼ åœ¨BookDaoImplä¸­æ–°å†™ä¸€ä¸ªæœ‰è¿”å›å€¼çš„selectæ–¹æ³• 12345678@Repositorypublic class BookDaoImpl implements BookDao &#123; @Override public int select() &#123; System.out.println(&quot;book dao select~~~&quot;); return 100; &#125;&#125; 123456789101112131415@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨ï¼Œå¹¶è·å¾—è¿”å›å€¼ Object ret = pjp.proceed(); System.out.println(&quot;after~~~&quot;); return ret; &#125;&#125; ä¸»å‡½æ•°ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); int num = bookDao.select(); System.out.println(num); &#125;&#125; 12345è¿è¡Œç»“æœï¼šbefore~~~book dao select~~~after~~~100 å¹¶ä¸”æœ‰æ— è¿”å›å€¼éƒ½å»ºè®®è¿™æ ·çš„å†™æ³•ï¼š 1234567@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); Object ret = pjp.proceed(); System.out.println(&quot;after~~~&quot;); return ret; &#125; @Aroundæ³¨æ„äº‹é¡¹ ç¯ç»•é€šçŸ¥å¿…é¡»ä¾èµ–å½¢å‚ProceedingJoinPointæ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ ,è¿›è€Œå®ç°åŸå§‹æ–¹æ³•è°ƒç”¨å‰ååŒæ—¶æ·»åŠ é€šçŸ¥ é€šçŸ¥ä¸­å¦‚æœæœªä½¿ç”¨ProceedingJoinPointå¯¹åŸå§‹æ–¹æ³•è¿›è¡Œè°ƒç”¨å°†è·³è¿‡åŸå§‹æ–¹æ³•çš„æ‰§è¡Œ å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨å¯ä»¥ä¸æ¥æ”¶è¿”å›å€¼ ,é€šçŸ¥æ–¹æ³•è®¾ç½®æˆvoidå³å¯, å¦‚æœæ¥æ”¶è¿”å›å€¼, å¿…é¡»è®¾å®šä¸ºObjectç±»å‹ åŸå§‹æ–¹æ³•çš„è¿”å›å€¼å¦‚æœ æ˜¯voidç±»å‹,é€šçŸ¥æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å¯ä»¥è®¾ç½®æˆvoid ,ä¹Ÿå¯ä»¥è®¾ç½®æˆObject ç”±äºæ— æ³•é¢„çŸ¥åŸå§‹æ–¹æ³•è¿è¡Œåæ˜¯å¦ä¼šæŠ›å‡ºå¼‚å¸¸ ,å› æ­¤ç¯ç»•é€šçŸ¥æ–¹æ³•å¿…é¡»æŠ›å‡ºThrowableå¯¹è±¡ è¿”å›åé€šçŸ¥(äº†è§£) 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @AfterReturning(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;afterReturn~~~&quot;); &#125;&#125; 1234è¿è¡Œç»“æœï¼šbook dao select~~~afterReturn~~~100 @afterå’Œ@AfterReturningçš„åŒºåˆ«ï¼š åŸå§‹æ–¹æ³•æœ‰å¼‚å¸¸æ—¶ï¼š @afterä¹Ÿä¼šæ‰“å°é€šçŸ¥çš„æ–¹æ³• @AfterReturningä¸ä¼šæ‰“å°é€šçŸ¥çš„æ–¹æ³• æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥(äº†è§£) 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @AfterThrowing(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;afterThrowing~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbook dao select~~~100 @AfterThrowingæ³¨è§£ï¼šåªæœ‰åŸå§‹æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œæ‰ä¼šæ‰§è¡Œé€šçŸ¥çš„æ–¹æ³• 16.6 AOPé€šçŸ¥è·å–æ•°æ® è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•° JoinPointï¼šé€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ProceedJointPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿”å›å€¼ è¿”å›åé€šçŸ¥ ç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ç¯ç»•é€šçŸ¥ 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Override public int select(int id, String name) &#123; System.out.println(&quot;book dao select~~~&quot;); System.out.println(&quot;id:&quot;+id+&quot; name:&quot;+name); return 100; &#125;&#125; AOPé€šçŸ¥è·å–å‚æ•°æ•°æ® joinPointå¯¹è±¡æè¿°äº†è¿æ¥ç‚¹æ–¹æ³•çš„è¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥è·å–åˆ°åŸå§‹æ–¹æ³•çš„è°ƒç”¨å‚æ•° 1234567891011121314@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select(..))&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method(JoinPoint jp)&#123; Object[] args = jp.getArgs(); System.out.println(Arrays.toString(args)); &#125;&#125; ä¸»å‡½æ•°è°ƒç”¨selectæ–¹æ³•ï¼š 1234567public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.select(100, &quot;dahuang&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼š[100, dahuang]book dao select~~~ ProceedingJoinPointæ˜¯JoinPointçš„å­ç±» 12345678@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object[] args = pjp.getArgs(); System.out.println(Arrays.toString(args)); args[0] = 666; Object ret = pjp.proceed(args); return ret; &#125; 1234è¿è¡Œç»“æœï¼š[100, dahuang]book dao select~~~id:666 name:dahuang AOPé€šçŸ¥è·å–è¿”å›æ•°æ® æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡ 1234@AfterReturning(value = &quot;pt()&quot;, returning = &quot;ret&quot;)public void method(JoinPoint jp, int ret)&#123; System.out.println(&quot;afterReturn~~~&quot;+ret);&#125; ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥æ‰‹å·¥ä¹¦å†™å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ï¼Œå¾—åˆ°çš„ç»“æœå³ä¸ºåŸå§‹æ–¹æ³•çš„è¿”å›å€¼ 12345@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object ret = pjp.proceed(); return ret; &#125; AOPé€šçŸ¥è·å–å¼‚å¸¸æ•°æ®(äº†è§£) æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡ 1234@AfterThrowing(value = &quot;pt()&quot;, throwing = &quot;t&quot;)public void method(JoinPoint jp, Throwable t)&#123; System.out.println(&quot;afterThrowing~~~&quot;+t);&#125; æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œçš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶è¿è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ 1234567891011@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object ret = null; try&#123; ret = pjp.proceed(); &#125; catch(Throwable t)&#123; t.printStackTrace(); &#125; return ret; &#125; 16.7 AOPæ€»ç»“1.åŸºæœ¬æ¦‚å¿µï¼š æ¦‚å¿µï¼šAOP(Aspect Oriented Programming) é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºæ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼º æ ¸å¿ƒæ¦‚å¿µ ä»£ç†(Proxy)ï¼šSpringAOPçš„æ ¸å¿ƒæœ¬è´¨æ˜¯é‡‡ç”¨ä»£ç†æ¨¡å¼å®ç°çš„ è¿æ¥ç‚¹(JoinPoint )ï¼šåœ¨SpringAOPä¸­ ,ç†è§£ä¸ºä»»æ„æ–¹æ³•çš„æ‰§è¡Œ åˆ‡å…¥ç‚¹( Pointcut )ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­,ä¹Ÿæ˜¯å…·æœ‰å…±æ€§åŠŸèƒ½çš„æ–¹æ³•æè¿° é€šçŸ¥(Advice)ï¼šè‹¥å¹²ä¸ªæ–¹æ³•çš„å…±æ€§åŠŸèƒ½,åœ¨åˆ‡å…¥ç‚¹å¤„æ‰§è¡Œ,æœ€ç»ˆä½“ç°ä¸º-ä¸€ä¸ªæ–¹æ³• åˆ‡é¢( Aspect )ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³» ç›®æ ‡å¯¹è±¡ ( Target )ï¼šè¢«ä»£ç†çš„åŸå§‹å¯¹è±¡æˆä¸ºç›®æ ‡å¯¹è±¡ 2.åˆ‡å…¥ç‚¹ï¼š åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ ‡å‡†æ ¼å¼ï¼š åŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.ç±»&#x2F;æ¥å£å.æ–¹æ³•å(å‚æ•°) å¼‚å¸¸å) execution(* com.spring.service.*Service.*(..)) åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æè¿°é€šé…ç¬¦ï¼š ä½œç”¨: ç”¨äºå¿«é€Ÿæè¿°,èŒƒå›´æè¿° *ï¼šåŒ¹é…ä»»æ„ç¬¦å·(å¸¸ç”¨) ..ï¼šåŒ¹é…å¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·(å¸¸ç”¨) +ï¼šåŒ¹é…å­ç±»ç±»å‹ åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¹¦å†™æŠ€å·§ æŒ‰æ ‡å‡†è§„èŒƒå¼€å‘ æŸ¥è¯¢æ“ä½œçš„è¿”å›å€¼å»ºè®®ä½¿ç”¨*åŒ¹é… å‡å°‘ä½¿ç”¨..çš„å½¢å¼æè¿°åŒ… å¯¹æ¥å£è¿›è¡Œæè¿°,ä½¿ç”¨*è¡¨ç¤ºæ¨¡å—å,ä¾‹å¦‚UserServiceçš„åŒ¹é…æè¿°ä¸º*Service æ–¹æ³•åä¹¦å†™ä¿ç•™åŠ¨è¯,ä¾‹å¦‚get ,ä½¿ç”¨*è¡¨ç¤ºåè¯,ä¾‹å¦‚getByIdåŒ¹é…æè¿°ä¸ºgetBy* å‚æ•°æ ¹æ®å®é™…æƒ…å†µçµæ´»è°ƒæ•´ 3.é€šçŸ¥ç±»å‹ï¼š å‰ç½®é€šçŸ¥ åç½®é€šçŸ¥ ç¯ç»•é€šçŸ¥(é‡ç‚¹) ç¯ç»•é€šçŸ¥ä¾èµ–å½¢å‚ProceedingJoinPointæ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ ç¯ç»•é€šçŸ¥å¯ä»¥éš”ç¦»åŸå§‹æ–¹æ³•çš„è°ƒç”¨æ‰§è¡Œ ç¯ç»•é€šçŸ¥è¿”å›å€¼è®¾ç½®ä¸º0bjectç±»å‹ ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥å¯¹åŸå§‹æ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸è¿›è¡Œå¤„ç† è¿”å›åé€šçŸ¥ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ 4.é€šçŸ¥è·å–æ•°æ®ï¼š è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•° JoinPointï¼šé€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥,è®¾ç½®ä¸ºæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå½¢å‚ ProceedJointPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿”å›å€¼ è¿”å›åé€šçŸ¥ . ç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ç¯ç»•é€šçŸ¥ 17.Springäº‹åŠ¡17.1 Springäº‹åŠ¡ç®€ä»‹äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ Springäº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚æˆ–ä¸šåŠ¡å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ æ¡ˆä¾‹ï¼šé“¶è¡Œè½¬è´¦ éœ€æ±‚:å®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ éœ€æ±‚å¾®ç¼©: Aè´¦æˆ·å‡é’±, Bè´¦æˆ·åŠ é’± åˆ†æ: â‘ æ•°æ®å±‚æä¾›åŸºç¡€æ“ä½œ, æŒ‡å®šè´¦æˆ·å‡é’±( outMoney ) , æŒ‡å®šè´¦æˆ·åŠ é’±( inMoney ) â‘¡ä¸šåŠ¡å±‚æä¾›è½¬è´¦æ“ä½œ( transfer ) , è°ƒç”¨å‡é’±ä¸åŠ é’±çš„æ“ä½œ â‘¢æä¾›2ä¸ªè´¦å·å’Œæ“ä½œé‡‘é¢æ‰§è¡Œè½¬è´¦æ“ä½œ â‘£åŸºäºSpringæ•´åˆMyBatisç¯å¢ƒæ­å»ºä¸Šè¿°æ“ä½œ JDKç‰ˆæœ¬ï¼š8 é¡¹ç›®ç»“æ„ï¼š pom.xml 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.5.6&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; com.spring.configåŒ…ä¸‹ï¼š JdbcConfig 12345678910111213141516171819202122232425262728public class JdbcConfig &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String userName; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; @Bean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); ds.setDriverClassName(driver); ds.setUrl(url); ds.setUsername(userName); ds.setPassword(password); return ds; &#125; //é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œmybatisä½¿ç”¨çš„æ˜¯jdbcäº‹åŠ¡ @Bean public PlatformTransactionManager transactionManager(DataSource dataSource)&#123; DataSourceTransactionManager transactionManager = new DataSourceTransactionManager(); transactionManager.setDataSource(dataSource); return transactionManager; &#125;&#125; MybatisConfig 1234567891011121314151617public class MybatisConfig &#123; @Bean public SqlSessionFactoryBean sqlSessionFactory(DataSource dataSource)&#123; SqlSessionFactoryBean ssfb = new SqlSessionFactoryBean(); ssfb.setTypeAliasesPackage(&quot;com.itheima.domain&quot;); ssfb.setDataSource(dataSource); return ssfb; &#125; @Bean public MapperScannerConfigurer mapperScannerConfigurer()&#123; MapperScannerConfigurer msc = new MapperScannerConfigurer(); msc.setBasePackage(&quot;com.itheima.dao&quot;); return msc; &#125;&#125; æ ¸å¿ƒé…ç½®ç±»ï¼šSpringConfig 12345678@Configuration@ComponentScan(&quot;com.itheima&quot;)@PropertySource(&quot;classpath:jdbc.properties&quot;)@Import(&#123;JdbcConfig.class,MybatisConfig.class&#125;)//å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨@EnableTransactionManagementpublic class SpringConfig &#123;&#125; Account 123456789101112131415161718192021222324252627282930313233343536373839public class Account implements Serializable &#123; private Integer id; private String name; private Double money; public Integer getId() &#123; return id; &#125; public void setId(Integer id) &#123; this.id = id; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public Double getMoney() &#123; return money; &#125; public void setMoney(Double money) &#123; this.money = money; &#125; @Override public String toString() &#123; return &quot;Account&#123;&quot; + &quot;id=&quot; + id + &quot;, name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, money=&quot; + money + &#x27;&#125;&#x27;; &#125;&#125; com.spring.daoåŒ…ä¸‹ï¼š AccountDao 12345678public interface AccountDao &#123; @Update(&quot;update demo.account set money = money + #&#123;money&#125; where name = #&#123;name&#125;&quot;) void inMoney(@Param(&quot;name&quot;) String name, @Param(&quot;money&quot;) Double money); @Update(&quot;update demo.account set money = money - #&#123;money&#125; where name = #&#123;name&#125;&quot;) void outMoney(@Param(&quot;name&quot;) String name, @Param(&quot;money&quot;) Double money);&#125; AccountService 12345public interface AccountService &#123; //é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡ @Transactional public void transfer(String out,String in ,Double money) ;&#125; AccountServiceImpl 12345678910@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; public void transfer(String out,String in ,Double money) &#123; accountDao.outMoney(out,money); accountDao.inMoney(in,money); &#125;&#125; æµ‹è¯•ç±»ï¼šAccountServiceTest 1234567891011@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(classes = SpringConfig.class)public class AccountServiceTest &#123; @Autowired private AccountService accountService; @Test public void testTransfer() throws IOException &#123; accountService.transfer(&quot;Tom&quot;,&quot;Jerry&quot;,100D); &#125;&#125; 17.2 Springäº‹åŠ¡è§’è‰²äº‹åŠ¡è§’è‰² äº‹åŠ¡ç®¡ç†å‘˜ï¼šå‘èµ·äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸ä»£æŒ‡ä¸šåŠ¡å±‚å¼€å¯äº‹åŠ¡çš„æ–¹æ³• äº‹åŠ¡åè°ƒå‘˜ï¼šåŠ å…¥äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸ä»£æŒ‡æ•°æ®å±‚æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡å±‚çš„æ–¹æ³• 17.3 Springäº‹åŠ¡å±æ€§ å±æ€§ ä½œç”¨ ç¤ºä¾‹ readOnly è®¾ç½®æ˜¯å¦ä¸ºåªè¯»äº‹åŠ¡ readOnly&#x3D;true åªè¯»äº‹åŠ¡ timeout è®¾ç½®äº‹åŠ¡è¶…æ—¶æ—¶é—´ timeout&#x3D;-1 æ°¸ä¸è¶…æ—¶ rollbackFor è®¾ç½®äº‹åŠ¡å›æ»šå¼‚å¸¸(class) rollbackFor&#x3D;{NullPointException.class} rollbackForClassName è®¾ç½®äº‹åŠ¡å›æ»šå¼‚å¸¸(String) åŒä¸Šå­—ç¬¦ä¸²æ ¼å¼ noRollbackFor è®¾ç½®äº‹åŠ¡ä¸å›æ»šå¼‚å¸¸(class) norollbackFor&#x3D;{NullPointException.class} noRollbackForClassName è®¾ç½®äº‹åŠ¡ä¸å›æ»šå¼‚å¸¸(String) åŒä¸Šå­—ç¬¦ä¸²æ ¼å¼ propagation è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸º â€¦.. 12345678910111213@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; @Override public void transfer(String out, String in, Double money) throws IOException &#123; accountDao.outMoney(out,money); //æ·»åŠ IOExceptionç±»å‹é”™è¯¯ if(true) throw new IOException(); accountDao.inMoney(in,money); &#125;&#125; è¿è¡Œåï¼ŒæŠ¥é”™ï¼ŒoutMoneyæ–¹æ³•æ‰§è¡Œäº†ï¼Œä½†inMoneyæ–¹æ³•æ²¡æœ‰æ‰§è¡Œ å¹¶ä¸æ˜¯æ‰€æœ‰é”™è¯¯ç±»å‹éƒ½ä¼šå›æ»š æˆ‘ä»¬å¸Œæœ›transferæ–¹æ³•ï¼Œè°ƒç”¨çš„äº‹åŠ¡åŒå¤±è´¥ åœ¨@Transactionalæ³¨è§£ä¸­çš„å±æ€§rollbackForæ·»åŠ é”™è¯¯çš„ç±»å‹ 12345public interface AccountService &#123; @Transactional(rollbackFor = &#123;IOException.class&#125;) void transfer(String out, String in, Double money) throws IOException;&#125; å†æ¬¡è¿è¡Œåï¼ŒæŠ¥é”™ï¼ŒoutMoneyå’ŒinMoneyæ–¹æ³•éƒ½æ²¡æœ‰æ‰§è¡Œ æ¡ˆä¾‹ï¼šè½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿— éœ€æ±‚:å®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ,å¹¶å¯¹æ¯æ¬¡è½¬è´¦æ“ä½œåœ¨æ•°æ®åº“è¿›è¡Œç•™ç—• éœ€æ±‚å¾®ç¼©: Aè´¦æˆ·å‡é’±, Bè´¦æˆ·åŠ é’±,æ•°æ®åº“è®°å½•æ—¥å¿— åˆ†æ: â‘ :åŸºäºè½¬è´¦æ“ä½œæ¡ˆä¾‹æ·»åŠ æ—¥å¿—æ¨¡å—,å®ç°æ•°æ®åº“ä¸­è®°å½•æ—¥å¿— â‘¡:ä¸šåŠ¡å±‚è½¬è´¦æ“ä½œ( transfer ) ,è°ƒç”¨å‡é’±ã€åŠ é’±ä¸è®°å½•æ—¥å¿—åŠŸèƒ½ å®ç°æ•ˆæœé¢„æœŸï¼š â€‹ æ— è®ºè½¬è´¦æ“ä½œæ˜¯å¦æˆåŠŸ,å‡è¿›è¡Œè½¬è´¦æ“ä½œçš„æ—¥å¿—ç•™ç—• 123456789101112131415161718192021@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; @Autowired private LogService logService; @Override public void transfer(String out, String in, Double money) throws IOException &#123; try&#123; accountDao.outMoney(out,money); int i = 1/0; accountDao.inMoney(in,money); &#125; finally&#123; logService.log(out,in,money); &#125; &#125;&#125; è¿è¡Œåï¼ŒoutMoneyæ–¹æ³•å’ŒinMoneyæ–¹æ³•è¿›è¡Œå›æ»šï¼ŒåŒæ—¶logæ–¹æ³•ä¹Ÿè¿›è¡Œäº†å›æ»šï¼Œæœªå°†æ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ å­˜åœ¨é—®é¢˜ï¼š æ—¥å¿—çš„è®°å½•ä¸è½¬è´¦æ“ä½œéš¶å±åŒä¸€ä¸ªäº‹åŠ¡ï¼ŒåŒæˆåŠŸåŒå¤±è´¥ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šäº‹åŠ¡åè°ƒå‘˜å¯¹äº‹ç‰©ç®¡ç†å‘˜æ‰€æºå¸¦äº‹åŠ¡çš„å¤„ç†æ€åº¦ åœ¨ä¸šåŠ¡å±‚æ¥å£æ·»åŠ Springäº‹åŠ¡ï¼Œ @Transactionalæ³¨è§£ä¸­çš„propagationå±æ€§è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºREQIRES_NEW(éœ€è¦æ–°äº‹åŠ¡) 123456@Servicepublic interface LogService &#123; //è®¾ç½®ä¸ºæ–°äº‹åŠ¡ @Transactional(propagation=Propagation.REQIRES_NEW) public void log(String out, String in, Double money);&#125; è¿è¡Œåï¼ŒoutMoneyæ–¹æ³•å’ŒinMoneyæ–¹æ³•è¿›è¡Œå›æ»šï¼Œäº‹åŠ¡æˆåŠŸã€‚ logæ–¹æ³•æ‰§è¡Œï¼Œå°†æ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ ä¼ æ’­å±æ€§ äº‹åŠ¡ç®¡ç†å‘˜ äº‹åŠ¡åè°ƒå‘˜ REQUIRED(é»˜è®¤) å¼€å¯T åŠ å…¥T æ—  æ–°å»ºT2 REQUIRES_NEW å¼€å¯T æ–°å»ºT2 æ—  æ–°å»ºT2 SUPPORTS å¼€å¯T åŠ å…¥T æ—  æ—  NOT_SUPPORTED å¼€å¯T æ—  æ—  æ—  MANDATORY å¼€å¯T åŠ å…¥T æ—  ERROR NEVER å¼€å¯T ERROR æ—  æ—  NESTED è®¾ç½®savePointï¼Œä¸€æ—¦äº‹åŠ¡å›æ»šï¼Œäº‹åŠ¡å°†å›æ»šåˆ°savePointå¤„ï¼Œäº¤ç”±å®¢æˆ·ç«¯æäº¤/å›æ»š â€‹ 18.ç»“è¯­ä½ ç«Ÿç„¶çœ‹å®Œäº†(ä¸æ•¢ç›¸ä¿¡ï¼ï¼)ï¼ŒçœŸçš„äººä¼šçœ‹å—ï¼çœŸçš„å—ï¼ã‚â—Ğ”â—ãƒ¾ æœ¬äººä¹Ÿæ˜¯åˆå­¦Springï¼Œç¬”è®°ä¸­å¦‚æœæœ‰ä»€ä¹ˆé—æ¼æˆ–é”™è¯¯çš„åœ°æ–¹æ¬¢è¿å¤§ä½¬æŒ‡æ­£ï¼ˆâ‰§âˆ€â‰¦ï¼‰ æœ¬äººQQï¼š2691936018 å¤‡æ³¨ï¼šSpring å¦å¤–å…³äºSpringæ¡†æ¶ï¼Œå¦‚æœæœ‰æ–°çš„å†…å®¹éœ€è¦è¡¥å……ï¼Œæœ¬äººä¹Ÿä¼šè¿›è¡Œæ›´æ–°çš„ æœ¬ç¬”è®°çš„å­¦ä¹ è§†é¢‘ï¼šé»‘é©¬2022æœ€æ–°SSMæ¡†æ¶ æˆ‘ä»¬SpringMVCè§ï¼ï¼(è¿˜æ˜¯ä¸å¤ªç›¸ä¿¡èƒ½æœ‰äººçœ‹â•®(â•¯â–½â•°)â•­)","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"(æ¯æ—¥LeetCode)å‰‘æŒ‡ Offer II 091. ç²‰åˆ·æˆ¿å­","slug":"æ¯æ—¥LeetCode/å‰‘æŒ‡ Offer II 091 ç²‰åˆ·æˆ¿å­","date":"2022-06-25T02:00:00.000Z","updated":"2022-07-02T07:51:12.967Z","comments":true,"path":"2022/06/25/æ¯æ—¥LeetCode/å‰‘æŒ‡ Offer II 091 ç²‰åˆ·æˆ¿å­/","link":"","permalink":"http://example.com/2022/06/25/%E6%AF%8F%E6%97%A5LeetCode/%E5%89%91%E6%8C%87%20Offer%20II%20091%20%E7%B2%89%E5%88%B7%E6%88%BF%E5%AD%90/","excerpt":"","text":"é¢˜ç›®ï¼šå‡å¦‚æœ‰ä¸€æ’æˆ¿å­ï¼Œå…± n ä¸ªï¼Œæ¯ä¸ªæˆ¿å­å¯ä»¥è¢«ç²‰åˆ·æˆçº¢è‰²ã€è“è‰²æˆ–è€…ç»¿è‰²è¿™ä¸‰ç§é¢œè‰²ä¸­çš„ä¸€ç§ï¼Œä½ éœ€è¦ç²‰åˆ·æ‰€æœ‰çš„æˆ¿å­å¹¶ä¸”ä½¿å…¶ç›¸é‚»çš„ä¸¤ä¸ªæˆ¿å­é¢œè‰²ä¸èƒ½ç›¸åŒã€‚ å½“ç„¶ï¼Œå› ä¸ºå¸‚åœºä¸Šä¸åŒé¢œè‰²æ²¹æ¼†çš„ä»·æ ¼ä¸åŒï¼Œæ‰€ä»¥æˆ¿å­ç²‰åˆ·æˆä¸åŒé¢œè‰²çš„èŠ±è´¹æˆæœ¬ä¹Ÿæ˜¯ä¸åŒçš„ã€‚æ¯ä¸ªæˆ¿å­ç²‰åˆ·æˆä¸åŒé¢œè‰²çš„èŠ±è´¹æ˜¯ä»¥ä¸€ä¸ª n x 3 çš„æ­£æ•´æ•°çŸ©é˜µ costsæ¥è¡¨ç¤ºçš„ã€‚ ä¾‹å¦‚ï¼Œcosts[0][0] è¡¨ç¤ºç¬¬ 0 å·æˆ¿å­ç²‰åˆ·æˆçº¢è‰²çš„æˆæœ¬èŠ±è´¹ï¼›costs[1][2] è¡¨ç¤ºç¬¬ 1 å·æˆ¿å­ç²‰åˆ·æˆç»¿è‰²çš„èŠ±è´¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¯·è®¡ç®—å‡ºç²‰åˆ·å®Œæ‰€æœ‰æˆ¿å­æœ€å°‘çš„èŠ±è´¹æˆæœ¬ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: costs &#x3D; [[17,2,17],[16,16,5],[14,3,19]]è¾“å‡º: 10è§£é‡Š: å°† 0 å·æˆ¿å­ç²‰åˆ·æˆè“è‰²ï¼Œ1 å·æˆ¿å­ç²‰åˆ·æˆç»¿è‰²ï¼Œ2 å·æˆ¿å­ç²‰åˆ·æˆè“è‰²ã€‚ æœ€å°‘èŠ±è´¹: 2 + 5 + 3 &#x3D; 10ã€‚ 1.é€’å½’ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031class Solution &#123;public: int def(vector&lt;vector&lt;int&gt;&gt;&amp; costs, int pos, int n, vector&lt;vector&lt;int&gt;&gt; flag) &#123; //åˆ°è¾¾æœ€åï¼Œæ²¡æœ‰æˆ¿å­äº†ï¼Œé€€å‡º if (pos == n) return 0; int ans = INT_MAX; //ä¾æ¬¡é€‰æ‹©ä¸‰ç§é¢œè‰² for (int i = 0; i &lt; 3; i++) &#123; int temp = INT_MAX; vector&lt;vector&lt;int&gt;&gt; temp_flag(flag); //ç²‰åˆ·ç¬¬ä¸€ä¸ªæˆ¿å­ï¼Œæ— éœ€çœ‹å‰é¢æˆ¿å­çš„é¢œè‰²ï¼Œå› ä¸ºå‰é¢æ²¡æœ‰æˆ¿å­ã€‚ if (pos == 0) &#123; temp_flag[pos][i] = -1; temp = def(costs, pos + 1, n, temp_flag) + costs[pos][i]; &#125; //ç²‰åˆ·å¢™ï¼Œè¦çœ‹å‰é¢ç”¨äº†ä»€ä¹ˆé¢œè‰² else if (flag[pos - 1][i] != -1) &#123; //å°†è¿™ä¸ªæˆ¿å­çš„é¢œè‰²æ ‡è®° temp_flag[pos][i] = -1; temp = def(costs, pos + 1, n, temp_flag) + costs[pos][i]; &#125; //é€‰æ‹©èŠ±è´¹æœ€å°‘çš„é‡‘é¢ ans = min(ans, temp); &#125; return ans; &#125; int minCost(vector&lt;vector&lt;int&gt;&gt;&amp; costs) &#123; return def(costs, 0, costs.size(), costs); &#125;&#125;; é‡‡ç”¨é€’å½’çš„æ–¹æ³•ï¼Œæäº¤åï¼Œç»“æœæ‰§è¡Œè¶…æ—¶ã€‚ 2.åŠ¨æ€è§„åˆ’$$Red[pos][0]&#x3D;\\begin{cases}cost[0][0] &amp; pos &#x3D; 0; \\min(Green[pos+1][1],Blue[pos+1][2]) + costs[pos][0] &amp; pos&gt;0\\end{cases} \\$$ $$Green[pos][1]&#x3D;\\begin{cases}cost[0][1] &amp; pos &#x3D; 0; \\min(Red[pos+1][0],Blue[pos+1][2]) + costs[pos][1] &amp; pos&gt;0\\end{cases} \\$$ $$Blue[pos][2]&#x3D;\\begin{cases}cost[0][2] &amp; pos &#x3D; 0; \\min(Red[pos+1][0],Green[pos+1][1]) + costs[pos][2] &amp; pos&gt;0\\end{cases}$$ ç”»å‡ºåŠ¨æ€è§„åˆ’å›¾ï¼Œä»¥ç¤ºä¾‹ä¸ºä¾‹ï¼š costs = [[17,2,17],[16,16,5],[14,3,19]] é¢œè‰²\\pos 0 1 2 Red(0) 17 18 21 Green(1) 2 33 10 Blue(2) 17 7 37 $$mincost &#x3D; min(dp[2][0],dp[2][1],dp[2][2])$$ ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: int minCost(vector&lt;vector&lt;int&gt;&gt;&amp; costs) &#123; int n = costs.size(); vector&lt;int&gt; red(n, 0); vector&lt;int&gt; blue(n, 0); vector&lt;int&gt; green(n, 0); // åˆå§‹åŒ– red[0] = costs[0][0]; blue[0] = costs[0][1]; green[0] = costs[0][2]; for (int i = 1; i &lt; n; ++i) &#123; red[i] = min(blue[i - 1], green[i - 1]) + costs[i][0]; blue[i] = min(red[i - 1], green[i - 1]) + costs[i][1]; green[i] = min(red[i - 1], blue[i - 1]) + costs[i][2]; &#125; return min(red[n - 1], min(blue[n - 1], green[n - 1])); &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æˆ¿å­ä¸ªæ•°ã€‚éœ€è¦éå†å…¨éƒ¨æˆ¿å­ä¸€æ¬¡ï¼Œç”±äºé¢œè‰²æ•°é‡å›ºå®šæ˜¯ä¸‰ç§ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªæˆ¿å­è®¡ç®—ç²‰åˆ·æˆ¿å­çš„æœ€å°èŠ±è´¹æˆæœ¬çš„æ—¶é—´æ˜¯ O(1)ï¼Œæ€»æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚ä½¿ç”¨ç©ºé—´ä¼˜åŒ–çš„æ–¹æ³•ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º 3 çš„æ•°ç»„ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯ O(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)515. åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼(ä¸­ç­‰)","slug":"æ¯æ—¥LeetCode/515 åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼","date":"2022-06-24T01:04:00.000Z","updated":"2022-07-02T07:51:43.654Z","comments":true,"path":"2022/06/24/æ¯æ—¥LeetCode/515 åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼/","link":"","permalink":"http://example.com/2022/06/24/%E6%AF%8F%E6%97%A5LeetCode/515%20%E5%9C%A8%E6%AF%8F%E4%B8%AA%E6%A0%91%E8%A1%8C%E4%B8%AD%E6%89%BE%E6%9C%80%E5%A4%A7%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¯·æ‰¾å‡ºè¯¥äºŒå‰æ ‘ä¸­æ¯ä¸€å±‚çš„æœ€å¤§å€¼ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: root &#x3D; [1,3,2,5,3,null,9]è¾“å‡º: [1,3,9] æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢æˆ‘ä»¬é‡‡ç”¨æ ‘çš„å…ˆåºéå†ï¼Œæ¥è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå¹¶ç”¨posæ¥è®°å½•å½“å‰æ ‘çš„é«˜åº¦ï¼Œå°±å¯ä»¥é€šè¿‡posé«˜åº¦æ¥åˆ¤æ–­æ˜¯å¦åœ¨åŒä¸€å±‚ï¼Œå¹¶ä¸”æ˜¯å¦æ›´æ–°æ­¤é«˜åº¦çš„æœ€å¤§å€¼ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627class Solution &#123;public: void dfs(TreeNode* root, vector&lt;int&gt;&amp; result, int pos)&#123; //å¦‚æœè¯¥ç»“ç‚¹ä¸ºç©ºï¼Œåˆ™é€€å‡º if(root == nullptr) return; if(result.size() == pos)&#123; //æ•°ç»„çš„å¤§å°å°äºé«˜åº¦ï¼Œå¤§å°éœ€è¦åŠ 1 result.push_back(root-&gt;val); &#125; else&#123; //åˆ¤æ–­è¯¥å±‚çš„æŸä¸ªç»“ç‚¹ï¼Œä¸ä¹‹å‰è®°å½•çš„æ¯”è¾ƒå¤§å° result[pos] = max(result[pos], root-&gt;val); &#125; //éå†å·¦å­æ ‘ï¼Œé«˜åº¦+1 dfs(root-&gt;left, result, pos+1); //éå†å³å­æ ‘ï¼Œé«˜åº¦+1 dfs(root-&gt;right, result, pos+1); &#125; vector&lt;int&gt; largestValues(TreeNode* root) &#123; vector&lt;int&gt; result; dfs(root, result, 0); return result; &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘èŠ‚ç‚¹ä¸ªæ•°ã€‚äºŒå‰æ ‘çš„éå†ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¼šè¢«è®¿é—®ä¸€æ¬¡ä¸”åªä¼šè¢«è®¿é—®ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(pos)ã€‚å…¶ä¸­ pos è¡¨ç¤ºäºŒå‰æ ‘çš„é«˜åº¦ã€‚é€’å½’å‡½æ•°éœ€è¦æ ˆç©ºé—´ï¼Œè€Œæ ˆç©ºé—´å–å†³äºé€’å½’çš„æ·±åº¦ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ç­‰ä»·äºäºŒå‰æ ‘çš„é«˜åº¦ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²","slug":"æ¯æ—¥LeetCode/30 ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²","date":"2022-06-23T03:53:00.000Z","updated":"2022-07-02T07:51:20.938Z","comments":true,"path":"2022/06/23/æ¯æ—¥LeetCode/30 ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²/","link":"","permalink":"http://example.com/2022/06/23/%E6%AF%8F%E6%97%A5LeetCode/30%20%E4%B8%B2%E8%81%94%E6%89%80%E6%9C%89%E5%8D%95%E8%AF%8D%E7%9A%84%E5%AD%90%E4%B8%B2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²så’Œä¸€äº›é•¿åº¦ç›¸åŒçš„å•è¯wordsã€‚æ‰¾å‡ºsä¸­æ°å¥½å¯ä»¥ç”±wordsä¸­æ‰€æœ‰å•è¯ä¸²è”å½¢æˆçš„å­ä¸²çš„èµ·å§‹ä½ç½®ã€‚ æ³¨æ„å­ä¸²è¦ä¸wordsä¸­çš„å•è¯å®Œå…¨åŒ¹é…ï¼Œä¸­é—´ä¸èƒ½æœ‰å…¶ä»–å­—ç¬¦ï¼Œä½†ä¸éœ€è¦è€ƒè™‘wordsä¸­å•è¯ä¸²è”çš„é¡ºåºã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šs &#x3D; â€œbarfoofoobarthefoobarmanâ€, words &#x3D; [â€œbarâ€,â€fooâ€,â€theâ€]è¾“å‡ºï¼š[6,9,12] è¾“å‡ºè¿”å›å­—ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦åœ¨sä¸­çš„ä½ç½® ç¬¬ä¸€ä¸ªå­—ä¸²ï¼šbarfoofoobarthefoobarman 6 ç¬¬äºŒä¸ªå­—ä¸²ï¼šbarfoofoobarthefoobarman 9 ç¬¬ä¸‰ä¸ªå­—ç¬¦ï¼šbarfoofoobarthefoobarman 12 æ€è·¯ï¼šæ»‘åŠ¨çª—å£ word_lenä¸ºæ¯ä¸ªå•è¯çš„é•¿åº¦ï¼Œå› ä¸ºæ¯ä¸ªå•è¯çš„é•¿åº¦éƒ½ç›¸åŒï¼› word_numä¸ºwordsæ•°ç»„ä¸­å•è¯çš„ä¸ªæ•°ï¼› total_lenä¸ºwordsæ•°ç»„ä¸­æ‰€æœ‰çš„å•è¯çš„æ€»é•¿åº¦ï¼› mapæ¥è®°å½•wordsæ•°ç»„ä¸­æ¯ä¸ªå•è¯çš„ä¸ªæ•°ï¼› t_mapéå†sæ—¶ç”¨æ¥è®°å½•ï¼› å·¦æŒ‡é’ˆleftå’Œå³æŒ‡é’ˆrightç”¨æ¥å½“ä½œå·¦å³è¾¹ç•Œï¼› countç”¨æ¥ç»Ÿè®¡å·²ç»åŒ¹é…å•è¯çš„ä¸ªæ•°ï¼Œå¦‚æœcount == word_numï¼Œå°±è¯æ˜åŒ¹é…æˆåŠŸï¼› éå†sæ—¶æ— éœ€ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„éå†ï¼Œå¯ä»¥ä¸€ä¸ªä¸€ä¸ªå•è¯çš„éå†ï¼Œright += word_lenï¼› å¦‚æœæˆªå–çš„å•è¯mapä¸­ä¸å­˜åœ¨ï¼Œåˆ™ä¹‹å‰è®°å½•çš„å…¨éƒ¨æ— æ•ˆï¼Œæ¸…ç©ºt_mapå’Œcountï¼› å¦‚æœæŸä¸ªå•è¯åœ¨t_mapä¸­çš„ä¸ªæ•°å¤§äºmapä¸­çš„ä¸ªæ•°ï¼Œå°±éœ€è¦åˆ é™¤åŒ¹é…çš„å¤šä½™çš„å•è¯ï¼Œå°±éœ€è¦åˆ é™¤çª—å£ä¸­ç¬¬ä¸€ä¸ªå•è¯ï¼Œç›´åˆ°æŸä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°å°äºmapä¸­çš„ä¸ªæ•° ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364class Solution &#123;public: vector&lt;int&gt; findSubstring(string s, vector&lt;string&gt;&amp; words) &#123; //ç”¨æ¥å­˜æ”¾ç»“æœ vector&lt;int&gt; result; //åˆ¤æ–­så’Œwordsæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ if(s.empty()||words.empty())&#123; return result; &#125; int word_len = words[0].size(); //ä¸€ä¸ªå•è¯çš„é•¿åº¦ï¼ˆæ¯ä¸ªå•è¯é•¿åº¦éƒ½ç›¸åŒï¼‰ int word_num = words.size(); // å•è¯çš„æ€»ä¸ªæ•° int total_len = word_len*word_num; // å…¨éƒ¨å•è¯çš„é•¿åº¦ //å»ºç«‹å•è¯-&gt;å•è¯ä¸ªæ•°çš„æ˜ å°„ unordered_map&lt;string, int&gt; map; //ç»Ÿè®¡æ¯ä¸ªå•è¯çš„ä¸ªæ•° for(auto &amp;word : words)&#123; //map[key]:è¿”å›keyå€¼æ‰€å¯¹åº”çš„valueå€¼ï¼Œå¦‚æœä¸å­˜åœ¨keyå€¼ï¼Œåˆ™ä¼šä½¿ç”¨è¯¥keyå€¼å‘å½“å‰å®¹å™¨ä¸­æ’å…¥ä¸€ä¸ªæ–°valueå€¼ä¸º 0 map[word]++; //ç­‰ä»·äº map[word] += 1 &#125; for(int i = 0; i&lt; word_len; i++)&#123; //leftå’Œrightç”¨æ¥è¡¨ç¤ºçª—å£çš„å·¦å³è¾¹ç•Œ int left = i; int right = i; //countç”¨æ¥ç»Ÿè®¡å·²ç»åŒ¹é…çš„å•è¯ä¸ªæ•° int count = 0; unordered_map&lt;string, int&gt; t_map; //å¼€å§‹æ»‘åŠ¨çª—å£ //rightå³è¾¹ç•Œä¾æ¬¡ç´¯åŠ å•è¯çš„é•¿åº¦ï¼Œç›´åˆ°è¶…è¿‡sçš„é•¿åº¦åœæ­¢å¾ªç¯ while(right + word_len &lt;= s.size())&#123; //substr(pos, n):ä»ç¬¬posçš„ä½ç½®å¼€å§‹æˆªå–nä¸ªå­—ç¬¦è·å–å•è¯ string word = s.substr(right, word_len); right += word_len; //rightè·³åˆ°ä¸‹ä¸€ä¸ªå•è¯ //count(key):åœ¨å®¹å™¨ä¸­æŸ¥æ‰¾ä»¥keyé”®çš„é”®å€¼å¯¹çš„ä¸ªæ•°ã€‚å¦‚æœä¸º0ï¼Œè¯´æ˜æ­¤å•è¯wordåœ¨wordsæ•°ç»„ä¸­ä¸å­˜åœ¨ã€‚ if(map.count(word) == 0)&#123; count = 0; //æ¸…ç©ºä¹‹å‰ç»Ÿè®¡çš„ä¸ªæ•° left = right; //å°†å·¦æŒ‡é’ˆleftç§»åŠ¨åˆ°å³æŒ‡é’ˆrightä½ç½®ä¸Šé‡æ–°å¼€å§‹ t_map.clear(); //ä¹‹å‰åŒ¹é…çš„å•è¯æ²¡ç”¨äº†ï¼Œæ¸…ç©ºt_mapä¸­çš„å…ƒç´  &#125; //å¦‚æœä¸ä¸º0ï¼Œè¯´æ˜æ­¤å•è¯wordåœ¨wordsæ•°ç»„ä¸­å­˜åœ¨ã€‚ else&#123; count++; //ç»Ÿè®¡ä¸ªæ•°åŠ 1 t_map[word]++;// wordæ‰€å¯¹åº”çš„ä¸ªæ•°åŠ 1 //t_mapä¸­çš„wordå¯¹åº”çš„ä¸ªæ•°å¤§äºmapçš„wordå¯¹åº”çš„ä¸ªæ•°ï¼Œè¯´æ˜åŒ¹é…åˆ°å¤šä½™çš„å•è¯äº† while(t_map[word]&gt; map[word])&#123; //è·å–çª—å£çš„ç¬¬ä¸€ä¸ªå•è¯ string t_word = s.substr(left, word_len); //å°†t_wordè¿™ä¸ªå•è¯å¯¹åº”çš„ä¸ªæ•°å‡1 //å¹¶éæ˜¯é‚£ä¸ªå¤§äºmapä¸­ä¸ªæ•°çš„å•è¯ t_map[t_word]--; count--; //ç»Ÿè®¡ä¸ªæ•°å‡1 left += word_len;//å°†å·¦æŒ‡é’ˆè·³åˆ°ä¸‹ä¸€ä¸ª &#125; //å¦‚æœcountç­‰äºå•è¯çš„ä¸ªæ•°è¯´æ˜åŒ¹é…æˆåŠŸï¼Œå°†å·¦æŒ‡é’ˆä½ç½®è®°å½• if(count == word_num)&#123; result.push_back(left); &#125; &#125; &#125; &#125; return result; &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(lsÃ—n)ï¼Œå…¶ä¸­ ls æ˜¯è¾“å…¥ s çš„é•¿åº¦ï¼Œn æ˜¯ words ä¸­æ¯ä¸ªå•è¯çš„é•¿åº¦ã€‚éœ€è¦åš n æ¬¡æ»‘åŠ¨çª—å£ï¼Œæ¯æ¬¡éœ€è¦éå†ä¸€æ¬¡ sã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)513. æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼","slug":"æ¯æ—¥LeetCode/513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼","date":"2022-06-22T03:11:00.000Z","updated":"2022-07-02T07:51:35.945Z","comments":true,"path":"2022/06/22/æ¯æ—¥LeetCode/513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼/","link":"","permalink":"http://example.com/2022/06/22/%E6%AF%8F%E6%97%A5LeetCode/513%20%E6%89%BE%E6%A0%91%E5%B7%A6%E4%B8%8B%E8%A7%92%E7%9A%84%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„ æ ¹èŠ‚ç‚¹ rootï¼Œè¯·æ‰¾å‡ºè¯¥äºŒå‰æ ‘çš„ æœ€åº•å±‚ æœ€å·¦è¾¹ èŠ‚ç‚¹çš„å€¼ã€‚ å‡è®¾äºŒå‰æ ‘ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹: è¾“å…¥: [1,2,3,4,null,5,6,null,null,7]è¾“å‡º: 7 æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)æˆ‘é‡‡ç”¨äº†ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œå†éå†å³èŠ‚ç‚¹ï¼Œå› ä¸ºåªæœ‰ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œæ‰ä¼šä¼˜å…ˆè®°å½•å½“å‰æ·±åº¦å·¦èŠ‚ç‚¹çš„å€¼ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¿…è¦è®°å½•å½“å‰æ·±åº¦å³è¾¹çš„å€¼äº†ã€‚ ä½¿ç”¨depthè®°å½•å½“å‰æ ‘çš„æ·±åº¦ï¼Œcurrent_valä¸ºè®°å½•çš„æ·±åº¦current_depthçš„æœ€å·¦è¾¹çš„å€¼ã€‚ è¿›è¡Œåˆ¤æ–­å¦‚æœdepthçš„æ·±åº¦å¤§äºcurrent_depthçš„æ·±åº¦ï¼Œå°†current_valçš„å€¼è®¾ç½®ä¸ºå½“å‰ç»“ç‚¹çš„å€¼ï¼Œå¹¶å°†current_depthçš„å€¼è®¾ç½®å½“å‰ç»“ç‚¹æ·±åº¦depth ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829class Solution &#123;public: void dfs(TreeNode* root, int depth, int&amp; current_depth, int&amp; current_val) &#123; if (root == nullptr) //å¦‚æœå½“å‰ç»“ç‚¹ä¸ºç©ºï¼Œåˆ™é€€å‡º &#123; return; &#125; //ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œæ·±åº¦åŠ 1 dfs(root-&gt;left, depth+1, current_depth, current_val); //å…¶æ¬¡éå†å³èŠ‚ç‚¹ï¼Œæ·±åº¦åŠ 1 dfs(root-&gt;right, depth+1, current_depth, current_val); //å¦‚æœå½“å‰æ·±åº¦å¤§äºè®°å½•çš„æ·±åº¦ if (depth &gt; current_depth) &#123; current_depth = depth; //å°†å½“å‰æ·±åº¦è®°å½•åˆ°current_depth current_val = root-&gt;val; //å°†å½“å‰ç»“ç‚¹å€¼è®°å½•åˆ°current_val &#125; &#125; int findBottomLeftValue(TreeNode* root) &#123; int current_depth = 0; //åˆå§‹åŒ–current_depth int current_val = 0; //åˆå§‹åŒ–current_val //å› ä¸ºæœ‰æ ¹ç»“ç‚¹å­˜åœ¨ï¼Œå°†depthè®¾ç½®ä¸º1ï¼Œè€Œé0 dfs(root, 1, current_depth, current_val); return current_val; &#125;&#125;; å¤æ‚åº¦åˆ†æ â€‹ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ç›®ã€‚éœ€è¦éå† n ä¸ªèŠ‚ç‚¹ã€‚ â€‹ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚é€’å½’æ ˆéœ€è¦å ç”¨ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]}],"categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"},{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"},{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"},{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]}