{"meta":{"title":"æ´»ç€å°±æ˜¯ä¸ºäº†æ‘¸é±¼ğŸŸï¼ï¼ï¼","subtitle":"","description":"ä¸€ä¸ªä¸èµ·çœ¼çš„å°åšå®¢","author":"ä¸€ä¸ªå°åƒåœ¾","url":"http://example.com","root":"/"},"pages":[{"title":"archives","date":"2022-06-25T09:46:11.000Z","updated":"2022-06-25T10:00:28.430Z","comments":true,"path":"archives/index.html","permalink":"http://example.com/archives/index.html","excerpt":"","text":""},{"title":"å…³äºæˆ‘æ˜¯è°","date":"2022-06-25T09:46:19.000Z","updated":"2022-06-26T00:50:58.784Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2022-06-25T09:45:03.000Z","updated":"2022-06-25T10:09:55.599Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2022-06-25T09:44:36.000Z","updated":"2022-06-25T10:10:32.117Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"","slug":"å°æŠ€å·§/@Autowiredä¸@Resource","date":"2022-07-21T02:04:47.393Z","updated":"2022-07-21T14:43:05.503Z","comments":true,"path":"2022/07/21/å°æŠ€å·§/@Autowiredä¸@Resource/","link":"","permalink":"http://example.com/2022/07/21/%E5%B0%8F%E6%8A%80%E5%B7%A7/@Autowired%E4%B8%8E@Resource/","excerpt":"","text":"@Autowiredå’Œ@ResourceåŒºåˆ«æä¾›æ–¹ä¸åŒï¼š @Autowiredæ˜¯ç”±Springæä¾›ï¼Œå±äºç¬¬ä¸‰æ–¹ @Resourceæ˜¯ç”±J2EEæä¾›ï¼Œå±äºJavaçš„ è£…é…æ—¶é»˜è®¤ç±»å‹ä¸åŒï¼š @Autowiredé»˜è®¤æŒ‰typeè£…é… é»˜è®¤æƒ…å†µä¸‹å¿…é¡»è¦æ±‚ä¾èµ–å¯¹è±¡å­˜åœ¨ï¼Œå¦‚æœè¦å…è®¸nullå€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalseã€‚ å¦‚æœæƒ³ä½¿ç”¨åç§°è£…é…å¯ä»¥ç»“åˆ@Qualifieræ³¨è§£è¿›è¡Œä½¿ç”¨ã€‚ @Resourceé»˜è®¤æŒ‰nameè£…é… åç§°å¯ä»¥é€šè¿‡nameå±æ€§è¿›è¡ŒæŒ‡å®šï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šnameå±æ€§ï¼Œå½“æ³¨è§£å†™åœ¨å­—æ®µä¸Šæ—¶ï¼Œé»˜è®¤å–å­—æ®µåè¿›è¡Œåç§°æŸ¥æ‰¾ã€‚ å¦‚æœæ³¨è§£å†™åœ¨setteræ–¹æ³•ä¸Šé»˜è®¤å–å±æ€§åè¿›è¡Œè£…é…ã€‚ å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„beanæ—¶æ‰æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…ã€‚ ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœnameå±æ€§ä¸€æ—¦æŒ‡å®šï¼Œå°±åªä¼šæŒ‰ç…§åç§°è¿›è¡Œè£…é…ã€‚ ä½¿ç”¨æ³¨æ„ï¼š @Autowired @Qualifier(â€œuserServiceâ€) æ˜¯ç›´æ¥æŒ‰ç…§åå­—è¿›è¡Œæœç´¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºUserServiceImpl ä¸Šé¢@Serviceæ³¨è§£å¿…é¡»å†™åå­—ï¼Œä¸å†™å°±ä¼šæŠ¥é”™ï¼Œè€Œä¸”åå­—å¿…é¡»æ˜¯@Autowired @Qualifier(â€œuserServiceâ€) ä¿æŒä¸€è‡´ã€‚å¦‚æœ@Serviceä¸Šé¢å†™äº†åå­—ï¼Œè€Œ@Autowired @Qualifier() ï¼Œä¸€æ ·ä¼šæŠ¥é”™ã€‚ @Resource æ ¹æ®è¿™ä¸ªæ³¨è§£çš„åŒ¹é…æ•ˆæœå¯ä»¥çœ‹å‡ºï¼Œå®ƒè¿›è¡Œäº†ä¸¤æ¬¡åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ åœ¨UserServiceè¿™ä¸ªç±»ä¸Šé¢è¿™æ ·å†™æ³¨è§£@Serviceã€‚é¦–å…ˆæ˜¯æ‰¾ç›¸åŒåå­—çš„ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå†æ‰¾ç›¸åŒç±»å‹çš„ï¼Œè€Œè¿™é‡Œçš„@Serviceæ²¡æœ‰å†™åå­—ï¼Œè¿™ä¸ªæ—¶å€™å°±è¿›è¡Œäº†ä¸¤æ¬¡æœç´¢ï¼Œæ˜¾ç„¶ï¼Œé€Ÿåº¦å°±ä¸‹é™äº†è®¸å¤šã€‚ @Resourceæ ¹æ®åå­—æœç´¢æ˜¯è¿™æ ·å†™@Resource(â€œuserServiceâ€)ï¼Œå¦‚æœä½ å†™äº†è¿™ä¸ªåå­—å«userServiceï¼Œé‚£ä¹ˆUserServiceImplçš„@Serviceæ³¨è§£ä¹Ÿå¿…é¡»ä¹Ÿæ˜¯è¿™ä¸ªåå­—ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šæŠ¥é”™ã€‚","categories":[],"tags":[]},{"title":"(æ¯æ—¥LeetCode)814. äºŒå‰æ ‘å‰ªæ","slug":"æ¯æ—¥LeetCode/2022-7/814 äºŒå‰æ ‘å‰ªæ","date":"2022-07-21T00:36:00.000Z","updated":"2022-07-21T02:13:56.542Z","comments":true,"path":"2022/07/21/æ¯æ—¥LeetCode/2022-7/814 äºŒå‰æ ‘å‰ªæ/","link":"","permalink":"http://example.com/2022/07/21/%E6%AF%8F%E6%97%A5LeetCode/2022-7/814%20%E4%BA%8C%E5%8F%89%E6%A0%91%E5%89%AA%E6%9E%9D/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ äºŒå‰æ ‘çš„æ ¹ç»“ç‚¹ root ï¼Œæ­¤å¤–æ ‘çš„æ¯ä¸ªç»“ç‚¹çš„å€¼è¦ä¹ˆæ˜¯ 0 ï¼Œè¦ä¹ˆæ˜¯ 1 ã€‚ è¿”å›ç§»é™¤äº†æ‰€æœ‰ä¸åŒ…å« 1 çš„å­æ ‘çš„åŸäºŒå‰æ ‘ã€‚ èŠ‚ç‚¹ node çš„å­æ ‘ä¸º node æœ¬èº«åŠ ä¸Šæ‰€æœ‰ node çš„åä»£ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šroot &#x3D; [1,null,0,0,1]è¾“å‡ºï¼š[1,null,0,null,1]è§£é‡Šï¼šåªæœ‰çº¢è‰²èŠ‚ç‚¹æ»¡è¶³æ¡ä»¶â€œæ‰€æœ‰ä¸åŒ…å« 1 çš„å­æ ‘â€ã€‚ å³å›¾ä¸ºè¿”å›çš„ç­”æ¡ˆã€‚ è‡ªåº•å‘ä¸Šè¿›è¡Œå‰ªæï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹ä¸å­˜åœ¨å·¦å³èŠ‚ç‚¹ï¼Œå¹¶ä¸”è¯¥èŠ‚ç‚¹å€¼ä¸º0çš„è¯å°±éœ€è¦å‰ªæ ä»£ç (cpp)ï¼š123456789101112131415class Solution &#123;public: TreeNode* pruneTree(TreeNode* root) &#123; if(root == nullptr) return nullptr; root-&gt;left = pruneTree(root-&gt;left); root-&gt;right = pruneTree(root-&gt;right); if(root-&gt;left == nullptr &amp;&amp; root-&gt;right ==nullptr &amp;&amp; root-&gt;val == 0)&#123; return nullptr; &#125; return root; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦éå†ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚é€’å½’çš„æ·±åº¦æœ€å¤šä¸º O(n)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1252. å¥‡æ•°å€¼å•å…ƒæ ¼çš„æ•°ç›®","slug":"æ¯æ—¥LeetCode/2022-7/1252 å¥‡æ•°å€¼å•å…ƒæ ¼çš„æ•°ç›®","date":"2022-07-12T01:24:00.000Z","updated":"2022-07-12T01:26:30.157Z","comments":true,"path":"2022/07/12/æ¯æ—¥LeetCode/2022-7/1252 å¥‡æ•°å€¼å•å…ƒæ ¼çš„æ•°ç›®/","link":"","permalink":"http://example.com/2022/07/12/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1252%20%E5%A5%87%E6%95%B0%E5%80%BC%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%95%B0%E7%9B%AE/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ª m x n çš„çŸ©é˜µï¼Œæœ€å¼€å§‹çš„æ—¶å€™ï¼Œæ¯ä¸ªå•å…ƒæ ¼ä¸­çš„å€¼éƒ½æ˜¯ 0ã€‚ å¦æœ‰ä¸€ä¸ªäºŒç»´ç´¢å¼•æ•°ç»„ indicesï¼Œindices[i] = [ri, ci] æŒ‡å‘çŸ©é˜µä¸­çš„æŸä¸ªä½ç½®ï¼Œå…¶ä¸­ ri å’Œ ci åˆ†åˆ«è¡¨ç¤ºæŒ‡å®šçš„è¡Œå’Œåˆ—ï¼ˆä» 0 å¼€å§‹ç¼–å·ï¼‰ã€‚ å¯¹ indices[i] æ‰€æŒ‡å‘çš„æ¯ä¸ªä½ç½®ï¼Œåº”åŒæ—¶æ‰§è¡Œä¸‹è¿°å¢é‡æ“ä½œï¼š ri è¡Œä¸Šçš„æ‰€æœ‰å•å…ƒæ ¼ï¼ŒåŠ  1 ã€‚ci åˆ—ä¸Šçš„æ‰€æœ‰å•å…ƒæ ¼ï¼ŒåŠ  1 ã€‚ç»™ä½  mã€n å’Œ indices ã€‚è¯·ä½ åœ¨æ‰§è¡Œå®Œæ‰€æœ‰ indices æŒ‡å®šçš„å¢é‡æ“ä½œåï¼Œè¿”å›çŸ©é˜µä¸­ å¥‡æ•°å€¼å•å…ƒæ ¼ çš„æ•°ç›®ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šm &#x3D; 2, n &#x3D; 3, indices &#x3D; [[0,1],[1,1]]è¾“å‡ºï¼š6è§£é‡Šï¼š [[0,0,0], &#x3D;&#x3D;&gt; [[1,2,1], &#x3D;&#x3D;&gt; [[1,3,1], [0,0,0]] [0,1,0]] [1,3,1]] è¿”å›å¥‡æ•°çš„ä¸ªæ•° ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526class Solution &#123;public: int oddCells(int m, int n, vector&lt;vector&lt;int&gt;&gt;&amp; indices) &#123; vector&lt;int&gt; dp(n); vector&lt;vector&lt;int&gt;&gt; dps(m, dp); for (int i = 0; i &lt; indices.size(); i++) &#123; for (int j = 0; j &lt; n; j++) &#123; dps[indices[i][0]][j] += 1; &#125; for (int k = 0; k &lt; m; k++) &#123; dps[k][indices[i][1]] += 1; &#125; &#125; int count = 0; for (int i = 0; i &lt; m; i++) &#123; for (int j = 0; j &lt; n; j++) &#123; if (dps[i][j] % 2 != 0) &#123; count++; &#125; &#125; &#125; return count; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(qÃ—(m+n)+mÃ—n), å…¶ä¸­ q è¡¨ç¤ºæ•°ç»„ indices çš„é•¿åº¦ï¼Œm,n ä¸ºçŸ©é˜µçš„è¡Œæ•°ä¸åˆ—æ•°ã€‚éå†æ•°ç»„æ—¶ï¼Œæ¯æ¬¡éƒ½éœ€è¦æ›´æ–°çŸ©é˜µä¸­ä¸€è¡ŒåŠ ä¸€åˆ—ï¼Œéœ€è¦çš„æ—¶é—´ä¸º O(qÃ—(m+n))ï¼Œæœ€åè¿˜éœ€è¦éå†çŸ©é˜µï¼Œéœ€è¦çš„æ—¶é—´ä¸º O(mÃ—n)ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º O(qÃ—(m+n)+mÃ—n)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(mÃ—n)ï¼Œå…¶ä¸­ m,n ä¸ºçŸ©é˜µçš„è¡Œæ•°ä¸åˆ—æ•°ã€‚éœ€è¦å­˜å‚¨çŸ©é˜µçš„æ‰€æœ‰å…ƒç´ ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)676. å®ç°ä¸€ä¸ªé­”æ³•å­—å…¸","slug":"æ¯æ—¥LeetCode/2022-7/676 å®ç°ä¸€ä¸ªé­”æ³•å­—å…¸","date":"2022-07-11T00:35:00.000Z","updated":"2022-07-11T04:04:29.012Z","comments":true,"path":"2022/07/11/æ¯æ—¥LeetCode/2022-7/676 å®ç°ä¸€ä¸ªé­”æ³•å­—å…¸/","link":"","permalink":"http://example.com/2022/07/11/%E6%AF%8F%E6%97%A5LeetCode/2022-7/676%20%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E9%AD%94%E6%B3%95%E5%AD%97%E5%85%B8/","excerpt":"","text":"é¢˜ç›®ï¼šè®¾è®¡ä¸€ä¸ªä½¿ç”¨å•è¯åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–çš„æ•°æ®ç»“æ„ï¼Œå•è¯åˆ—è¡¨ä¸­çš„å•è¯ äº’ä¸ç›¸åŒ ã€‚ å¦‚æœç»™å‡ºä¸€ä¸ªå•è¯ï¼Œè¯·åˆ¤å®šèƒ½å¦åªå°†è¿™ä¸ªå•è¯ä¸­ä¸€ä¸ªå­—æ¯æ¢æˆå¦ä¸€ä¸ªå­—æ¯ï¼Œä½¿å¾—æ‰€å½¢æˆçš„æ–°å•è¯å­˜åœ¨äºä½ æ„å»ºçš„å­—å…¸ä¸­ã€‚ å®ç° MagicDictionary ç±»ï¼š MagicDictionary() åˆå§‹åŒ–å¯¹è±¡void buildDict(String[] dictionary) ä½¿ç”¨å­—ç¬¦ä¸²æ•°ç»„ dictionary è®¾å®šè¯¥æ•°æ®ç»“æ„ï¼Œdictionary ä¸­çš„å­—ç¬¦ä¸²äº’ä¸ç›¸åŒbool search(String searchWord) ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² searchWord ï¼Œåˆ¤å®šèƒ½å¦åªå°†å­—ç¬¦ä¸²ä¸­ ä¸€ä¸ª å­—æ¯æ¢æˆå¦ä¸€ä¸ªå­—æ¯ï¼Œä½¿å¾—æ‰€å½¢æˆçš„æ–°å­—ç¬¦ä¸²èƒ½å¤Ÿä¸å­—å…¸ä¸­çš„ä»»ä¸€å­—ç¬¦ä¸²åŒ¹é…ã€‚å¦‚æœå¯ä»¥ï¼Œè¿”å› trueï¼›å¦åˆ™ï¼Œè¿”å› falseã€‚ ç¤ºä¾‹ï¼š è¾“å…¥[â€œMagicDictionaryâ€, â€œbuildDictâ€, â€œsearchâ€, â€œsearchâ€, â€œsearchâ€, â€œsearchâ€][[], [[â€œhelloâ€, â€œleetcodeâ€]], [â€œhelloâ€], [â€œhhlloâ€], [â€œhellâ€], [â€œleetcodedâ€]]è¾“å‡º[null, null, false, true, false, false] è§£é‡ŠMagicDictionary magicDictionary &#x3D; new MagicDictionary();magicDictionary.buildDict([â€œhelloâ€, â€œleetcodeâ€]);magicDictionary.search(â€œhelloâ€); &#x2F;&#x2F; è¿”å› FalsemagicDictionary.search(â€œhhlloâ€); &#x2F;&#x2F; å°†ç¬¬äºŒä¸ª â€˜hâ€™ æ›¿æ¢ä¸º â€˜eâ€™ å¯ä»¥åŒ¹é… â€œhelloâ€ ï¼Œæ‰€ä»¥è¿”å› TruemagicDictionary.search(â€œhellâ€); &#x2F;&#x2F; è¿”å› FalsemagicDictionary.search(â€œleetcodedâ€); &#x2F;&#x2F; è¿”å› False æ€è·¯ï¼šéå†è¯å…¸ï¼Œæ‰¾åˆ°ä¸searchWordå•è¯é•¿åº¦ä¸€æ ·çš„å•è¯ï¼Œå†ä¸ä¹‹å¯¹æ¯”ç›¸åŒçš„ä½ç½®çš„å­—æ¯æ˜¯å¦ç›¸åŒï¼Œè®°å½•ä¸ç›¸åŒå­—æ¯çš„æ¬¡æ•°ï¼Œåªæœ‰ä¸ç›¸åŒçš„å­—æ¯çš„æ¬¡æ•°ä¸º1æ—¶ï¼Œæ‰å¯ä»¥è¿”å›true ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526class MagicDictionary &#123;public: vector&lt;string&gt; dic; MagicDictionary() &#123;&#125; void buildDict(vector&lt;string&gt; dictionary) &#123; this-&gt;dic= dictionary; &#125; bool search(string searchWord) &#123; int n = searchWord.size(); for(int i = 0; i &lt; dic.size(); i++)&#123; if(dic[i].size() == n)&#123; int count = 0; for(int j = 0; j &lt; n; j++)&#123; if(dic[i][j] != searchWord[j])&#123; count++; &#125; &#125; if(count == 1) return 1; &#125; &#125; return 0; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(qnl)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ dictionary çš„é•¿åº¦ï¼Œl æ˜¯æ•°ç»„ dictionary ä¸­å­—ç¬¦ä¸²çš„å¹³å‡é•¿åº¦ï¼Œq æ˜¯å‡½æ•° search(searchWord) çš„è°ƒç”¨æ¬¡æ•°ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(nl)ï¼Œå³ä¸ºæ•°ç»„éœ€è¦ä½¿ç”¨çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)873. æœ€é•¿çš„æ–æ³¢é‚£å¥‘å­åºåˆ—çš„é•¿åº¦","slug":"æ¯æ—¥LeetCode/2022-7/873 æœ€é•¿çš„æ–æ³¢é‚£å¥‘å­åºåˆ—çš„é•¿åº¦","date":"2022-07-09T00:34:00.000Z","updated":"2022-07-09T03:38:53.250Z","comments":true,"path":"2022/07/09/æ¯æ—¥LeetCode/2022-7/873 æœ€é•¿çš„æ–æ³¢é‚£å¥‘å­åºåˆ—çš„é•¿åº¦/","link":"","permalink":"http://example.com/2022/07/09/%E6%AF%8F%E6%97%A5LeetCode/2022-7/873%20%E6%9C%80%E9%95%BF%E7%9A%84%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%AD%90%E5%BA%8F%E5%88%97%E7%9A%84%E9%95%BF%E5%BA%A6/","excerpt":"","text":"é¢˜ç›®ï¼šå¦‚æœåºåˆ— $X_1, X_2, â€¦, X_n$ æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼Œå°±è¯´å®ƒæ˜¯ æ–æ³¢é‚£å¥‘å¼ çš„ï¼š n &gt;&#x3D; 3å¯¹äºæ‰€æœ‰ i + 2 &lt;&#x3D; nï¼Œéƒ½æœ‰ $X_i + X_{i+1} &#x3D; X_{i+2}$ç»™å®šä¸€ä¸ªä¸¥æ ¼é€’å¢çš„æ­£æ•´æ•°æ•°ç»„å½¢æˆåºåˆ— arr ï¼Œæ‰¾åˆ° arr ä¸­æœ€é•¿çš„æ–æ³¢é‚£å¥‘å¼çš„å­åºåˆ—çš„é•¿åº¦ã€‚å¦‚æœä¸€ä¸ªä¸å­˜åœ¨ï¼Œè¿”å› 0 ã€‚ ï¼ˆå›æƒ³ä¸€ä¸‹ï¼Œå­åºåˆ—æ˜¯ä»åŸåºåˆ— arr ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ï¼Œå®ƒä» arr ä¸­åˆ æ‰ä»»æ„æ•°é‡çš„å…ƒç´ ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ ï¼‰ï¼Œè€Œä¸æ”¹å˜å…¶ä½™å…ƒç´ çš„é¡ºåºã€‚ä¾‹å¦‚ï¼Œ [3, 5, 8] æ˜¯ [3, 4, 5, 6, 7, 8] çš„ä¸€ä¸ªå­åºåˆ—ï¼‰ ç¤ºä¾‹ï¼š è¾“å…¥: arr &#x3D; [1,3,7,11,12,14,18]è¾“å‡º: 3è§£é‡Š: æœ€é•¿çš„æ–æ³¢é‚£å¥‘å¼å­åºåˆ—æœ‰ [1,11,12]ã€[3,11,14] ä»¥åŠ [7,11,18] ã€‚ æ€è·¯ï¼šé€’å½’è´¹åŠ²å°½å¿ƒï¼Œæœ€åè¿è¡Œè¶…æ—¶ï¼ï¼ ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728class Solution &#123;public: int def(vector&lt;int&gt;&amp; arr, vector&lt;int&gt; dp, int pos)&#123; int ans = 0; int n = dp.size(); for(int i=pos; i &lt; arr.size(); i++)&#123; if(n &lt; 2)&#123; vector&lt;int&gt; n_dp(dp); n_dp.emplace_back(arr[i]); ans = max(def(arr, n_dp, i+1)+1, ans); &#125; else if(n &gt;= 2 &amp;&amp; dp[n-1] + dp[n-2] == arr[i])&#123; vector&lt;int&gt; n_dp(dp); n_dp.emplace_back(arr[i]); ans = max(def(arr, n_dp, i+1)+1, ans); &#125; &#125; if(ans &lt;= 2 &amp;&amp; pos &lt; 2) return 0; return ans; &#125; int lenLongestFibSubseq(vector&lt;int&gt;&amp; arr) &#123; vector&lt;int&gt; dp; return def(arr, dp, 0); &#125;&#125;; æ€è·¯ï¼šåŠ¨æ€è§„åˆ’æ‘†çƒ‚äº†ï¼ arr[k]+arr[j]=arr[i] å¤§å°ï¼šk&lt;j&lt;i ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930class Solution &#123;public: int lenLongestFibSubseq(vector&lt;int&gt;&amp; arr) &#123; unordered_map&lt;int, int&gt; indices; int n = arr.size(); for (int i = 0; i &lt; n; i++) &#123; indices[arr[i]] = i; &#125; //åˆ›å»ºå…¨æ˜¯0çš„n*näºŒç»´æ•°ç»„ vector&lt;vector&lt;int&gt;&gt; dp(n, vector&lt;int&gt;(n)); int ans = 0; for (int i = 0; i &lt; n; i++) &#123; for (int j = i - 1; j &gt;= 0 &amp;&amp; arr[j] * 2 &gt; arr[i]; j--) &#123; int k = -1; //å¦‚æœindicesä¸­å­˜åœ¨arr[i]-arr[j]è¿™ä¸ªæ•° if (indices.count(arr[i] - arr[j])) &#123; //è·å¾—è·å¾—æ­¤æ•° k = indices[arr[i] - arr[j]]; &#125; //å¦‚æœkä¸ç­‰äº-1 if (k &gt;= 0) &#123; dp[j][i] = max(dp[k][j] + 1, 3); &#125; //è·å¾—åˆ°æœ€å¤§çš„åºåˆ—é•¿åº¦ ans = max(ans, dp[j][i]); &#125; &#125; return ans; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚åŠ¨æ€è§„åˆ’çš„çŠ¶æ€æ•°æ˜¯ O(n^2)ï¼Œæ¯ä¸ªçŠ¶æ€çš„è®¡ç®—æ—¶é—´éƒ½æ˜¯ O(1) ç©ºé—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚éœ€è¦åˆ›å»ºäºŒç»´æ•°ç»„ dpï¼Œç©ºé—´æ˜¯ O(n^2)","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)1846. å‡å°å’Œé‡æ–°æ’åˆ—æ•°ç»„åçš„æœ€å¤§å…ƒç´ ","slug":"æ¯æ—¥LeetCode/2022-7/1846 å‡å°å’Œé‡æ–°æ’åˆ—æ•°ç»„åçš„æœ€å¤§å…ƒç´ ","date":"2022-07-08T00:34:00.000Z","updated":"2022-07-08T00:34:32.816Z","comments":true,"path":"2022/07/08/æ¯æ—¥LeetCode/2022-7/1846 å‡å°å’Œé‡æ–°æ’åˆ—æ•°ç»„åçš„æœ€å¤§å…ƒç´ /","link":"","permalink":"http://example.com/2022/07/08/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1846%20%E5%87%8F%E5%B0%8F%E5%92%8C%E9%87%8D%E6%96%B0%E6%8E%92%E5%88%97%E6%95%B0%E7%BB%84%E5%90%8E%E7%9A%84%E6%9C%80%E5%A4%A7%E5%85%83%E7%B4%A0/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ arr ã€‚è¯·ä½ å¯¹ arr æ‰§è¡Œä¸€äº›æ“ä½œï¼ˆä¹Ÿå¯ä»¥ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼‰ï¼Œä½¿å¾—æ•°ç»„æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š arr ä¸­ ç¬¬ä¸€ä¸ª å…ƒç´ å¿…é¡»ä¸º 1 ã€‚ä»»æ„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ çš„å·®çš„ç»å¯¹å€¼ å°äºç­‰äº 1 ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä»»æ„çš„ 1 &lt;= i &lt; arr.length ï¼ˆæ•°ç»„ä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ï¼Œéƒ½æ»¡è¶³ abs(arr[i] - arr[i - 1]) &lt;= 1 ã€‚abs(x) ä¸º x çš„ç»å¯¹å€¼ã€‚ä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹ 2 ç§æ“ä½œä»»æ„æ¬¡ï¼š å‡å° arr ä¸­ä»»æ„å…ƒç´ çš„å€¼ï¼Œä½¿å…¶å˜ä¸ºä¸€ä¸ª æ›´å°çš„æ­£æ•´æ•° ã€‚é‡æ–°æ’åˆ— arr ä¸­çš„å…ƒç´ ï¼Œä½ å¯ä»¥ä»¥ä»»æ„é¡ºåºé‡æ–°æ’åˆ—ã€‚è¯·ä½ è¿”å›æ‰§è¡Œä»¥ä¸Šæ“ä½œåï¼Œåœ¨æ»¡è¶³å‰æ–‡æ‰€è¿°çš„æ¡ä»¶ä¸‹ï¼Œarr ä¸­å¯èƒ½çš„ æœ€å¤§å€¼ ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šarr &#x3D; [100,1,1000]è¾“å‡ºï¼š3è§£é‡Šï¼šä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆå¦‚ä¸‹ï¼š é‡æ–°æ’åˆ— arr å¾—åˆ° [1,100,1000] ã€‚ å°†ç¬¬äºŒä¸ªå…ƒç´ å‡å°ä¸º 2 ã€‚ å°†ç¬¬ä¸‰ä¸ªå…ƒç´ å‡å°ä¸º 3 ã€‚ç°åœ¨ arr &#x3D; [1,2,3] ï¼Œæ»¡è¶³æ‰€æœ‰æ¡ä»¶ã€‚arr ä¸­æœ€å¤§å…ƒç´ ä¸º 3 ã€‚ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223class Solution &#123;public: int maximumElementAfterDecrementingAndRearranging(vector&lt;int&gt;&amp; arr) &#123; //å°†arræ•°ç»„æ’åº sort(arr.begin(), arr.end()); //å¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ ä¸ä¸º1ï¼Œåˆ™è®¾ç½®ä¸º1 if(arr[0] != 1) arr[0] = 1; å°†æœ€å¤§æ•°è®¾ç½®ä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´  int max = arr[0]; for(int i = 1; i &lt; arr.size(); i++)&#123; //å½“å‰çš„å…ƒç´ å‡å»å‰é¢çš„å…ƒç´ ï¼Œå®ƒä»¬çš„ç»å¯¹å€¼è‚¯å®šæ˜¯å¤§äº0çš„ int temp = arr[i] - arr[i-1]; //å¦‚æœç»å¯¹å€¼å¤§äº1ï¼Œåˆ™è®¾ç½®å½“å‰çš„å…ƒç´ ä¸ºå‰é¢çš„å…ƒç´ +1 if(temp &gt; 1) arr[i] = arr[i-1]+1; //å¦‚æœå½“å‰å…ƒç´ å¤§äºmaxçš„å…ƒç´ ï¼Œå°†å½“å‰å…ƒç´ è®¾ç½®ä¸ºæœ€å¤§æ•° if(arr[i] &gt; max) max = arr[i]; &#125; //è¿”å›æœ€å¤§æ•° return max; &#125; &#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚æ—¶é—´å¤æ‚åº¦å³æ’åºçš„å¤æ‚åº¦ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ã€‚ç©ºé—´å¤æ‚åº¦ä¸è€ƒè™‘è¾“å…¥ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºæ’åºæ—¶äº§ç”Ÿçš„ O(logn) çš„æ ˆç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"","slug":"Java/MyBatis-Plusæ¡†æ¶","date":"2022-07-07T06:04:11.246Z","updated":"2022-07-15T01:04:44.519Z","comments":true,"path":"2022/07/07/Java/MyBatis-Plusæ¡†æ¶/","link":"","permalink":"http://example.com/2022/07/07/Java/MyBatis-Plus%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè¯†MyBatis-PlusMyBatis-Plusæ˜¯MyBatisçš„å¢å¼ºå·¥å…·ï¼Œåœ¨MyBatisçš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºäº†ç®€åŒ–å¼€å‘ï¼Œæé«˜æ•ˆç‡è€Œç”Ÿ å®˜ç½‘ï¼šMyBatis-Plus ç‰¹æ€§ï¼š æ— å…¥ä¾µï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¯¼å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ã€‚ æŸè€—å°ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬CRUDï¼Œæ€§èƒ½åŸºæœ¬ä¸æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ å¼ºå¤§çš„CRUDæ“ä½œï¼šå†…ç½®é€šç”¨Mapperã€é€šç”¨Service ,ä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ†CRUDæ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚ æ”¯æŒLambdaå½¢å¼è°ƒç”¨ï¼šé€šè¿‡Lambdaè¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™ æ”¯æŒå¤šç§æ•°æ®åº“ï¼šæ”¯æŒMySQLã€MariaDBã€ Oracleã€ DB2ã€ H2ã€ HSQLã€ SQLiteã€ Postgreã€SQL Serverç­‰å¤šç§æ•°æ®åº“ æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆï¼šæ”¯æŒå¤šè¾¾4ç§ä¸»é”®ç­–ç•¥(å†…å«åˆ†å¸ƒå¼å”¯ä¸€IDç”Ÿæˆå™¨- Sequence)ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜ æ”¯æŒXMLçƒ­åŠ è½½ï¼šMapperå¯¹åº”çš„XMLæ”¯æŒçƒ­åŠ è½½ï¼Œå¯¹äºç®€å•çš„CRUDæ“ä½œï¼Œç”šè‡³å¯ä»¥æ— XMLå¯åŠ¨ æ”¯æŒActiveRecordæ¨¡å¼ï¼šæ”¯æŒActiveRecordå½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿Modelç±»å³å¯è¿›è¡Œå¼ºå¤§çš„CRUDæ“ä½œ æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥(Write onceï¼Œuse anywhere) æ”¯æŒå…³é”®è¯è‡ªåŠ¨è½¬ä¹‰ï¼šæ”¯æŒæ•°æ®åº“å…³é”®è¯( orderã€ keyâ€¦. )è‡ªåŠ¨è½¬ä¹‰ï¼Œè¿˜å¯è‡ªå®šä¹‰å…³é”®è¯ å†…ç½®ä»£ç ç”Ÿæˆå™¨ï¼šé‡‡ç”¨ä»£ç æˆ–è€…Mavenæ’ä»¶å¯å¿«é€Ÿç”ŸæˆMapperã€ Modelã€Serviceã€Controllerå±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨ å†…ç½®åˆ†é¡µæ’ä»¶ï¼šåŸºäºMyBatisç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€šListæŸ¥è¯¢ å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶ï¼šå¯è¾“å‡ºSqlè¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢ å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶ï¼šæä¾›å…¨è¡¨deleteã€update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ å†…ç½®Sqlæ³¨å…¥å‰¥ç¦»å™¨ï¼šæ”¯æŒSqlæ³¨å…¥å‰¥ç¦»ï¼Œæœ‰æ•ˆé¢„é˜²Sqlæ³¨å…¥æ”»å‡» 2.åˆ›å»ºæ•°æ®åº“åˆ›å»ºæ•°æ®åº“ï¼š æ•°æ®åï¼šmp å­—ç¬¦é›†ï¼šutf-8 åˆ›å»ºè¡¨ï¼š 123456789101112131415161718192021-- åˆ›å»ºæµ‹è¯•è¡¨CREATE TABLE `tb_user` (`id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#x27;ä¸»é”®ID&#x27;,`user_name` varchar(20) NOT NULL COMMENT &#x27;ç”¨æˆ·å&#x27;,`password` varchar(20) NOT NULL COMMENT &#x27;å¯†ç &#x27;,`name` varchar(30) DEFAULT NULL COMMENT &#x27;å§“å&#x27;,`age` int(11) DEFAULT NULL COMMENT &#x27;å¹´é¾„&#x27;,`email` varchar(50) DEFAULT NULL COMMENT &#x27;é‚®ç®±&#x27;,PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;-- æ’å…¥æµ‹è¯•æ•°æ®INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;1&#x27;, &#x27;zhangsan&#x27;, &#x27;123456&#x27;, &#x27;å¼ ä¸‰&#x27;, &#x27;18&#x27;, &#x27;test1@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;2&#x27;, &#x27;lisi&#x27;, &#x27;123456&#x27;, &#x27;æå››&#x27;, &#x27;20&#x27;, &#x27;test2@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;3&#x27;, &#x27;wangwu&#x27;, &#x27;123456&#x27;, &#x27;ç‹äº”&#x27;, &#x27;28&#x27;, &#x27;test3@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;4&#x27;, &#x27;zhaoliu&#x27;, &#x27;123456&#x27;, &#x27;èµµå…­&#x27;, &#x27;21&#x27;, &#x27;test4@itcast.cn&#x27;);INSERT INTO `tb_user` (`id`, `user_name`, `password`, `name`, `age`, `email`) VALUES(&#x27;5&#x27;, &#x27;sunqi&#x27;, &#x27;123456&#x27;, &#x27;å­™ä¸ƒ&#x27;, &#x27;24&#x27;, &#x27;test5@itcast.cn&#x27;); 3.Mybatis-Pluså¿«é€Ÿå…¥é—¨å¯¼å…¥æ‰€æœ‰ä¾èµ–ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940&lt;dependencies&gt; &lt;!-- mybatis-plusæ’ä»¶ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus&lt;/artifactId&gt; &lt;version&gt;3.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- mysql --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt; &lt;/dependency&gt; &lt;!-- æ•°æ®åº“è¿æ¥æ±  --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt; &lt;/dependency&gt; &lt;!-- ç®€åŒ–beanä»£ç å·¥å…· --&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;version&gt;1.18.24&lt;/version&gt; &lt;/dependency&gt; &lt;!-- å•å…ƒæµ‹è¯•æ’ä»¶ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- æ—¥å¿—æ’ä»¶ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.36&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; resoursesèµ„æºåŒ…ä¸­ï¼Œæ–°å»ºlog4j.propertiesæ–‡ä»¶ï¼š 1234log4j.rootLogger=DEBUG,A1log4j.appender.A1=org.apache.log4j.ConsoleAppenderlog4j.appender.A1.layout=org.apache.log4j.PatternLayoutlog4j.appender.A1.layout.ConversionPattern=[%t] [%c]-[%p] %m%n åˆ›å»ºUserå®ä½“ç±»ï¼š 1234567891011@Data //ç”Ÿæˆgetterå’Œsetterdæ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; é¡¹ç›®ç»“æ„ï¼š 3.1 Mybatiså®ç°æŸ¥è¯¢åœ¨resourcesèµ„æºåŒ…ä¸­ï¼Œåˆ›å»ºmybatis-config.xmlæ–‡ä»¶ï¼š 12345678910111213141516171819202122&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt; &lt;environments default=&quot;development&quot;&gt; &lt;environment id=&quot;development&quot;&gt; &lt;transactionManager type=&quot;JDBC&quot;/&gt; &lt;dataSource type=&quot;POOLED&quot;&gt; &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mp?useUnicode=true&amp;amp;characterEncoding=utf8&amp;amp;autoReconnect=true&amp;amp;allowMultiQueries=true&amp;amp;useSSL=false&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;mapper resource=&quot;UserMapper.xml&quot;/&gt; &lt;/mappers&gt;&lt;/configuration&gt; åˆ›å»ºUserMapperæ¥å£ï¼š 1234public interface UserMapper &#123; List&lt;User&gt; findAll(); &#125; åœ¨resourcesèµ„æºåŒ…åˆ›å»ºUserMapper.xmlæ–‡ä»¶:ï¼š namespaceä¸ºUserMapperæ¥å£çš„ä½ç½® idä¸ºUserMapperä¸­çš„æ–¹æ³•å resultTypeä¸ºå®ä½“ç±»çš„ä½ç½® 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.mybatisp.mapper.UserMapper&quot;&gt; &lt;select id=&quot;findAll&quot; resultType=&quot;com.mybatisp.pojo.User&quot;&gt; select * from tb_user &lt;/select&gt;&lt;/mapper&gt; å•å…ƒæµ‹è¯•ï¼š 1234567891011@Testpublic void testFindAll() throws IOException &#123; InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is); SqlSession sqlSession = sqlSessionFactory.openSession(); UserMapper userMapper = sqlSession.getMapper(UserMapper.class); System.out.println(userMapper.findAll());&#125; æ§åˆ¶å°æ‰“å°ï¼š 1[User(id=1, userName=null, password=123456, name=å¼ ä¸‰, age=18, email=test1@itcast.cn), User(id=2, userName=null, password=123456, name=æå››, age=20, email=test2@itcast.cn), User(id=3, userName=null, password=123456, name=ç‹äº”, age=28, email=test3@itcast.cn), User(id=4, userName=null, password=123456, name=èµµå…­, age=21, email=test4@itcast.cn), User(id=5, userName=null, password=123456, name=å­™ä¸ƒ, age=24, email=test5@itcast.cn)] 3.2 Mybatis+MPå®ç°æŸ¥è¯¢å°†UserMapperç»§æ‰¿BaseMapperï¼Œå°†æ‹¥æœ‰äº†BaseMapperä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼š 1234public interface UserMapper extends BaseMapper&lt;User&gt; &#123; List&lt;User&gt; findAll();&#125; å•å…ƒæµ‹è¯•ï¼š 123456789101112@Testpublic void testFindAll2() throws IOException &#123; InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;); //è¿™é‡Œä½¿ç”¨çš„æ˜¯MPä¸­çš„MybatisSqlSessionFactoryBuilder SqlSessionFactory sqlSessionFactory = new MybatisSqlSessionFactoryBuilder().build(is); SqlSession sqlSession = sqlSessionFactory.openSession(); UserMapper userMapper = sqlSession.getMapper(UserMapper.class); System.out.println(userMapper.findAll()); &#125; è¿è¡ŒæˆåŠŸï¼ æ”¹ç”¨BaseMapperä¸­å®šä¹‰çš„æ–¹æ³•æŸ¥è¯¢æ‰€æœ‰ï¼š 1234567891011@Testpublic void testFindAll2() throws IOException &#123; InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;); SqlSessionFactory sqlSessionFactory = new MybatisSqlSessionFactoryBuilder().build(is); SqlSession sqlSession = sqlSessionFactory.openSession(); UserMapper userMapper = sqlSession.getMapper(UserMapper.class); //System.out.println(userMapper.findAll()); System.out.println(userMapper.selectList(null));&#125; æŠ¥é”™ï¼š 1Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table &#x27;mp.user&#x27; doesn&#x27;t exist æŠ¥é”™åŸå› æ˜¯æ²¡æœ‰æ‰¾åˆ°userè¡¨ï¼Œå› ä¸ºæ•°æ®åº“ä¸­çš„è¡¨åä¸ºtb_useræ‰€ä»¥å¯¼è‡´æ²¡æœ‰æ‰¾åˆ°è¯¥è¡¨ã€‚éœ€è¦æŒ‡å®šè¡¨ï¼š åœ¨Userå®ä½“ç±»ä¸­ä¸æ•°æ®åº“ä¸­çš„è¡¨è¿›è¡Œæ˜ å°„ï¼š 123456789101112@Data //ç”Ÿæˆgetterå’Œsetteræ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°@TableName(&quot;tb_user&quot;) //æŒ‡å®šä¸ºtb_userè¡¨public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; å†æ¬¡è¿è¡Œï¼ŒæˆåŠŸï¼ 3.3 Spring+Mybatis+MPæ–°å»ºé¡¹ç›®ï¼š å¯¼å…¥ä¾èµ–ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus&lt;/artifactId&gt; &lt;version&gt;3.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;version&gt;1.18.24&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.36&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åœ¨resourcesèµ„æºåŒ…ä¸­åˆ›å»ºlog4j.propertiesæ–‡ä»¶ï¼š 1234log4j.rootLogger=DEBUG,A1log4j.appender.A1=org.apache.log4j.ConsoleAppenderlog4j.appender.A1.layout=org.apache.log4j.PatternLayoutlog4j.appender.A1.layout.ConversionPattern=[%t] [%c]-[%p] %m%n åœ¨resourcesèµ„æºåŒ…ä¸­åˆ›å»ºjdbc.propertiesæ–‡ä»¶ï¼š 1234jdbc.driver=com.mysql.jdbc.driverjdbc.url=jdbc:mysql://localhost:3306/mp?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=falsejdbc.username=rootjdbc.password=123456 åœ¨resourcesèµ„æºåŒ…ä¸­åˆ›å»ºapplicationContext.xmlæ–‡ä»¶ 1234567891011121314151617181920212223242526272829&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans.xsdhttp://www.springframework.org/schema/contexthttp://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;context:property-placeholder location=&quot;classpath*:*.properties&quot;/&gt; &lt;!-- å®šä¹‰æ•°æ®æº --&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot; destroy-method=&quot;close&quot;&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt; &lt;property name=&quot;maxActive&quot; value=&quot;10&quot;/&gt; &lt;property name=&quot;minIdle&quot; value=&quot;5&quot;/&gt; &lt;/bean&gt; &lt;!--è¿™é‡Œä½¿ç”¨MPæä¾›çš„sqlSessionFactoryï¼Œå®Œæˆäº†Springä¸MPçš„æ•´åˆ--&gt; &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--æ‰«æmapperæ¥å£ï¼Œä½¿ç”¨çš„ä¾ç„¶æ˜¯MybatisåŸç”Ÿçš„æ‰«æå™¨--&gt; &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt; &lt;property name=&quot;basePackage&quot; value=&quot;com.mybatisp.mapper&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; åˆ›å»ºUserå®ä½“ç±»ï¼š 123456789101112@Data //ç”Ÿæˆgetterå’Œsetteræ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°@TableName(&quot;tb_user&quot;)public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; åˆ›å»ºUerMapperæ¥å£ï¼š 12public interface UserMapper extends BaseMapper&lt;User&gt; &#123;&#125; å•å…ƒæµ‹è¯•ï¼š 1234567891011@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations = &quot;classpath:applicationContext.xml&quot;)public class MybatisTest &#123; @Autowired private UserMapper userMapper; @Test public void testSelectList()&#123; System.out.println(userMapper.selectList(null)); &#125;&#125; è¿è¡ŒæˆåŠŸï¼ 3.4 SpringBoot+Mybaits+MPxmlç‰ˆ é¡¹ç›®ç»“æ„ï¼š åˆ›å»ºspringbooté¡¹ç›®è‡ªåŠ¨å¯¼å…¥ä¾èµ–ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.4.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.2.11&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt; &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-boot.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.3.7.RELEASE&lt;/version&gt; &lt;configuration&gt; &lt;mainClass&gt;com.mybatisp.SpringbootMpApplication&lt;/mainClass&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;repackage&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;repackage&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; application.ymlï¼š 1234567spring: datasource: druid: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://localhost:3306/mp?serverTimezone=UTC username: root password: 123456 Userå®ä½“ç±»ï¼š 123456789101112@Data //ç”Ÿæˆgetterå’Œsetteræ–¹æ³•@NoArgsConstructor // ç”Ÿæˆæ— å‚æ„é€ å‡½æ•°@AllArgsConstructor // ç”Ÿæˆæœ‰å‚æ„é€ å‡½æ•°@TableName(&quot;tb_user&quot;)public class User &#123; private Long id; private String userName; private String password; private String name; private String age; private String email;&#125; UserMapperæ¥å£ï¼š 123@Mapperpublic interface UserMapper extends BaseMapper&lt;User&gt; &#123;&#125; å•å…ƒæµ‹è¯•ï¼š 12345678910@SpringBootTestpublic class UserMapperTest &#123; @Autowired private UserMapper userMapper; @Test public void findAll() &#123; System.out.println(userMapper.selectList(null)); &#125;&#125; è¿è¡ŒæˆåŠŸï¼ 9.ä»£ç ç”Ÿæˆå™¨åˆ›å»ºSpringbooté¡¹ç›®ï¼š æ·»åŠ ä¸‹é¢çš„ä¾èµ–ï¼š 1234567891011&lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt; &lt;version&gt;3.5.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.freemarker&lt;/groupId&gt; &lt;artifactId&gt;freemarker&lt;/artifactId&gt; &lt;version&gt;2.3.31&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç±»ï¼š 12345678910111213141516171819202122232425public class FastAutoGeneratorTest &#123; public static void main(String[] args) &#123; FastAutoGenerator.create(&quot;jdbc:mysql://localhost:3306/mp?serverTimezone=UTC&quot;, &quot;root&quot;, &quot;123456&quot;) .globalConfig(builder -&gt; &#123; builder.author(&quot;baomidou&quot;) // è®¾ç½®ä½œè€… //.enableSwagger() // å¼€å¯ swagger æ¨¡å¼ .fileOverride() // è¦†ç›–å·²ç”Ÿæˆæ–‡ä»¶ .outputDir(&quot;E:\\\\Java_Web\\\\Mybatis-p\\\\mp_04_generator\\\\src\\\\main\\\\java&quot;); // æŒ‡å®šè¾“å‡ºç›®å½• &#125;) .packageConfig(builder -&gt; &#123; builder.parent(&quot;com&quot;) // è®¾ç½®çˆ¶åŒ…å .moduleName(&quot;mybatisp&quot;) // è®¾ç½®çˆ¶åŒ…æ¨¡å—å .pathInfo(Collections.singletonMap(OutputFile.xml, &quot;E:\\\\Java_Web\\\\Mybatis-p\\\\mp_04_generator\\\\src\\\\main\\\\resources\\\\mapper&quot;)); // è®¾ç½®mapperXmlç”Ÿæˆè·¯å¾„ &#125;) .strategyConfig(builder -&gt; &#123; builder.addInclude(&quot;tb_user&quot;) // è®¾ç½®éœ€è¦ç”Ÿæˆçš„è¡¨å .addTablePrefix(&quot;tb_&quot;, &quot;c_&quot;); // è®¾ç½®è¿‡æ»¤è¡¨å‰ç¼€ &#125;) .templateEngine(new FreemarkerTemplateEngine()) // ä½¿ç”¨Freemarkerå¼•æ“æ¨¡æ¿ï¼Œé»˜è®¤çš„æ˜¯Velocityå¼•æ“æ¨¡æ¿ .execute(); &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12345608:57:51.095 [main] DEBUG com.baomidou.mybatisplus.generator.AutoGenerator - ==========================å‡†å¤‡ç”Ÿæˆæ–‡ä»¶...==========================08:57:51.521 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - æ‰§è¡ŒSQL:show table status WHERE 1=1 AND NAME IN (&#x27;tb_user&#x27;)08:57:51.538 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - è¿”å›è®°å½•æ•°:1,è€—æ—¶(ms):1608:57:51.550 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - æ‰§è¡ŒSQL:show full fields from `tb_user`08:57:51.559 [main] DEBUG com.baomidou.mybatisplus.generator.config.querys.MySqlQuery - è¿”å›è®°å½•æ•°:6,è€—æ—¶(ms):908:57:51.652 [main] DEBUG com.baomidou.mybatisplus.generator.AutoGenerator - ==========================æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼ï¼ï¼========================== ä»¥ä¸‹ä¸ºç”Ÿæˆçš„æ–‡ä»¶ï¼š","categories":[],"tags":[]},{"title":"(æ¯æ—¥LeetCode)729. æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I","slug":"æ¯æ—¥LeetCode/2022-7/729 æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I","date":"2022-07-05T04:50:00.000Z","updated":"2022-07-08T00:35:39.494Z","comments":true,"path":"2022/07/05/æ¯æ—¥LeetCode/2022-7/729 æˆ‘çš„æ—¥ç¨‹å®‰æ’è¡¨ I/","link":"","permalink":"http://example.com/2022/07/05/%E6%AF%8F%E6%97%A5LeetCode/2022-7/729%20%E6%88%91%E7%9A%84%E6%97%A5%E7%A8%8B%E5%AE%89%E6%8E%92%E8%A1%A8%20I/","excerpt":"","text":"é¢˜ç›®ï¼šå®ç°ä¸€ä¸ª MyCalendar ç±»æ¥å­˜æ”¾ä½ çš„æ—¥ç¨‹å®‰æ’ã€‚å¦‚æœè¦æ·»åŠ çš„æ—¥ç¨‹å®‰æ’ä¸ä¼šé€ æˆ é‡å¤é¢„è®¢ ï¼Œåˆ™å¯ä»¥å­˜å‚¨è¿™ä¸ªæ–°çš„æ—¥ç¨‹å®‰æ’ã€‚ å½“ä¸¤ä¸ªæ—¥ç¨‹å®‰æ’æœ‰ä¸€äº›æ—¶é—´ä¸Šçš„äº¤å‰æ—¶ï¼ˆä¾‹å¦‚ä¸¤ä¸ªæ—¥ç¨‹å®‰æ’éƒ½åœ¨åŒä¸€æ—¶é—´å†…ï¼‰ï¼Œå°±ä¼šäº§ç”Ÿ é‡å¤é¢„è®¢ ã€‚ æ—¥ç¨‹å¯ä»¥ç”¨ä¸€å¯¹æ•´æ•° start å’Œ end è¡¨ç¤ºï¼Œè¿™é‡Œçš„æ—¶é—´æ˜¯åŠå¼€åŒºé—´ï¼Œå³ [start, end), å®æ•° x çš„èŒƒå›´ä¸ºï¼Œ start &lt;= x &lt; end ã€‚ å®ç° MyCalendar ç±»ï¼š MyCalendar() åˆå§‹åŒ–æ—¥å†å¯¹è±¡ã€‚boolean book(int start, int end) å¦‚æœå¯ä»¥å°†æ—¥ç¨‹å®‰æ’æˆåŠŸæ·»åŠ åˆ°æ—¥å†ä¸­è€Œä¸ä¼šå¯¼è‡´é‡å¤é¢„è®¢ï¼Œè¿”å› trueã€‚å¦åˆ™ï¼Œè¿”å› false å¹¶ä¸”ä¸è¦å°†è¯¥æ—¥ç¨‹å®‰æ’æ·»åŠ åˆ°æ—¥å†ä¸­ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼š[â€œMyCalendarâ€, â€œbookâ€, â€œbookâ€, â€œbookâ€][[], [10, 20], [15, 25], [20, 30]]è¾“å‡ºï¼š[null, true, false, true] æ€è·¯ï¼šäºŒåˆ†æŸ¥æ‰¾è®¾å·²ç»æ’å…¥äº†ä¸€äº›æ—¥ç¨‹ï¼š $[[start_1,end_1),[start_2,end_2),[start_3,end_3)]$ æ—¥ç¨‹ä¹‹é—´ä¸äº¤å‰å¹¶ä¸”ä¸€å®šæ˜¯æœ‰è¿™æ ·çš„æ’åºï¼š $start_1 &lt; end_1 \\leq start_2 &lt; end_2 \\leq start_3 &lt; end_3$ å¦‚æœè¦æ’å…¥[start, end) ä¸€å®šæ˜¯åœ¨$end_i \\leq start&lt;end&lt; start_{i+1}$ åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æ°æ¯”endå¤§çš„å…ƒç´ ï¼š$start_{i+1}$ å†å°†$start_{i+1}$å‰é¢çš„å…ƒç´ $end_i$ä¸startæ¯”è¾ƒï¼Œçœ‹æ˜¯å¦äº¤å‰ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718class MyCalendar &#123;public: //seté»˜è®¤çš„æ¯”è¾ƒè§„åˆ™å…ˆæŒ‰ç…§firstæ¯”è¾ƒï¼Œå¦‚æœfirstç›¸åŒï¼Œå†æŒ‰ç…§secondæ¯”è¾ƒ set&lt;pair&lt;int, int&gt;&gt; calendar; bool book(int start, int end) &#123; //è·å–æ¯”endæ°å¥½å¤§çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œæ²¡æœ‰åˆ™è¿”å›è¿­ä»£å™¨end() //å¦‚æœcalendaræ²¡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›è¿­ä»£å™¨begin() auto temp = calendar.lower_bound(&#123;end, 0&#125;); //å¦‚æœtempä¸ºbegin()è¯´æ˜æ²¡æœ‰å…ƒç´ ç›´æ¥æ’å…¥ //å¦‚æœä¸ä¸ºbegin()åˆ™ä¸tempå‰é¢çš„å…ƒç´ çš„å³åŒºé—´æ¯”è¾ƒï¼Œå¦‚æœå°äºç­‰äºstartè¯´æ˜æ²¡æœ‰äº¤å‰ï¼Œæ’å…¥ if(temp == calendar.begin() || (--temp)-&gt;second &lt;= start)&#123; calendar.insert(&#123;start, end&#125;); return true; &#125; return false; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn), å…¶ä¸­ n è¡¨ç¤ºæ—¥ç¨‹å®‰æ’çš„æ•°é‡ã€‚ç”±äºæ¯æ¬¡åœ¨è¿›è¡Œé¢„è®¢æ—¶ï¼Œéƒ½éœ€è¦è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œéœ€è¦çš„æ—¶é—´ä¸º O(logn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n è¡¨ç¤ºæ—¥ç¨‹å®‰æ’çš„æ•°é‡ã€‚éœ€è¦ä¿å­˜æ‰€æœ‰å·²ç»é¢„è®¢çš„è¡Œç¨‹ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"setå®¹å™¨ç”¨æ³•","slug":"C++/setå®¹å™¨","date":"2022-07-04T16:00:00.000Z","updated":"2022-07-07T06:52:27.242Z","comments":true,"path":"2022/07/05/C++/setå®¹å™¨/","link":"","permalink":"http://example.com/2022/07/05/C++/set%E5%AE%B9%E5%99%A8/","excerpt":"","text":"setå®¹å™¨ï¼šæ‰€æœ‰å…ƒç´ éƒ½ä¼šåœ¨æ’å…¥æ—¶è‡ªåŠ¨æ’åºï¼Œåº•å±‚ç»“æ„é‡‡ç”¨äºŒå‰æ ‘å®ç°ã€‚ setå’ŒmultisetåŒºåˆ«ï¼š setä¸å¯ä»¥æ’å…¥é‡å¤æ•°æ®ï¼Œè€Œmultisetå¯ä»¥ setæ’å…¥æ•°æ®çš„åŒæ—¶ä¼šè¿”å›æ’å…¥ç»“æœï¼Œè¡¨ç¤ºæ’å…¥æ˜¯å¦æˆåŠŸ multisetä¸ä¼šæ£€æµ‹æ•°æ®ï¼Œå› æ­¤å¯ä»¥æ’å…¥é‡å¤æ•°æ® setå®¹å™¨çš„ä½¿ç”¨ï¼š å¤´æ–‡ä»¶ï¼š 12#include&lt;set&gt; using namespace std; æ„é€ å‡½æ•°ï¼š æ„é€ å‡½æ•° è§£é‡Š set() é»˜è®¤æ„é€ å‡½æ•° set(const set &amp;st) æ‹·è´æ„é€ å‡½æ•° æˆå‘˜å‡½æ•°ï¼š æˆå‘˜å‡½æ•° è§£é‡Š void insert(T key) æ’å…¥key void emplace(T key) æ’å…¥keyï¼Œæ¯”insert()æ•ˆç‡é«˜ erase() åˆ é™¤ void clear() æ¸…ç©º bool find(T key) æŸ¥æ‰¾ int count(T key) ç»Ÿè®¡ int size() è·å–å¤§å° bool empty() æ˜¯å¦ä¸ºç©º void swap(set &amp;st) äº¤æ¢ iterator lower_bound(T key) å¦‚æœsetå®¹å™¨ä¸­æ²¡æœ‰å…ƒç´ ï¼Œåˆ™è¿”å›è¿­ä»£å™¨begin()ï¼›å¦‚æœsetå®¹å™¨ä¸­å­˜åœ¨å…ƒç´ ï¼Œåˆ™è¿”å›æ°å¥½æ¯”keyå¤§çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œä¸å­˜åœ¨åˆ™è¿”å›è¿­ä»£å™¨end() è‡ªå®šä¹‰æ•°æ®ç±»å‹æ’åº set&lt;pair&lt;int,int&gt;&gt; seté»˜è®¤çš„æ¯”è¾ƒè§„åˆ™å…ˆæŒ‰ç…§firstæ¯”è¾ƒï¼Œå¦‚æœfirstç›¸åŒï¼Œå†æŒ‰ç…§second æ¯”è¾ƒã€‚","categories":[{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"}],"tags":[{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"}]},{"title":"(æ¯æ—¥LeetCode)1200. æœ€å°ç»å¯¹å·®","slug":"æ¯æ—¥LeetCode/2022-7/1200 æœ€å°ç»å¯¹å·®","date":"2022-07-03T23:54:00.000Z","updated":"2022-07-08T00:36:23.299Z","comments":true,"path":"2022/07/04/æ¯æ—¥LeetCode/2022-7/1200 æœ€å°ç»å¯¹å·®/","link":"","permalink":"http://example.com/2022/07/04/%E6%AF%8F%E6%97%A5LeetCode/2022-7/1200%20%E6%9C%80%E5%B0%8F%E7%BB%9D%E5%AF%B9%E5%B7%AE/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸ªæ•´æ•°æ•°ç»„ arrï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½ ä¸ç›¸åŒã€‚ è¯·ä½ æ‰¾åˆ°æ‰€æœ‰å…·æœ‰æœ€å°ç»å¯¹å·®çš„å…ƒç´ å¯¹ï¼Œå¹¶ä¸”æŒ‰å‡åºçš„é¡ºåºè¿”å›ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹1ï¼š è¾“å…¥ï¼šarr &#x3D; [4,2,1,3]è¾“å‡ºï¼š[[1,2],[2,3],[3,4]] ç¤ºä¾‹2ï¼š è¾“å…¥ï¼šarr &#x3D; [1,3,6,10,15]è¾“å‡ºï¼š[[1,3]] æ€è·¯ï¼šå…ˆå°†arræ•°ç»„æ’åº å†éå†arræ•°ç»„ï¼Œå¦‚æœæ‰¾åˆ°æœ‰æ¯”minæ›´å°çš„å·®å€¼ï¼Œå°†minæ”¹ä¸ºè¯¥å·®å€¼ï¼Œå°†dpæ•°ç»„ä¹‹å‰è®°å½•çš„æ•°æ®æ¸…ç©º(å› ä¸ºä¹‹å‰è®°å½•çš„éƒ½æ˜¯å·®å€¼å¤§çš„)ï¼Œé‡æ–°æ’å…¥å·®å€¼æ›´å°çš„æ•°æ®ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324class Solution &#123;public: vector&lt;vector&lt;int&gt;&gt; minimumAbsDifference(vector&lt;int&gt;&amp; arr) &#123; //å°†arræ•°ç»„æ’åº sort(arr.begin(),arr.end()); int min = INT_MAX; vector&lt;vector&lt;int&gt;&gt; dp; for(int i = 1; i &lt; arr.size(); i++)&#123; //å½“å‰çš„å·®å€¼ int temp = arr[i]-arr[i-1]; if(temp &lt; min)&#123; min = temp; //å°†dpæ•°ç»„æ¸…ç©º dp.clear(); //é‡æ–°æ’å…¥æ–°çš„å·®å€¼å°çš„æ•°æ® dp.push_back(&#123;arr[i-1],arr[i]&#125;); &#125; else if(temp == min)&#123; dp.push_back(&#123;arr[i-1],arr[i]&#125;); &#125; &#125; return dp; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ arr çš„é•¿åº¦ã€‚æ’åºéœ€è¦çš„æ—¶é—´ä¸º O(nlogn)ï¼Œéå†éœ€è¦çš„æ˜¯æ—¶é—´ä¸º O(n)ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦ä¸º O(nlogn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå³ä¸ºæ’åºéœ€è¦ä½¿ç”¨çš„æ ˆç©ºé—´ã€‚è¿™é‡Œä¸è®¡å…¥è¿”å›å€¼éœ€è¦ä½¿ç”¨çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"æ“ä½œç³»ç»Ÿ","slug":"è®¡ç®—æœº4ä»¶å¥—/æ“ä½œç³»ç»Ÿ","date":"2022-07-03T15:07:28.465Z","updated":"2022-07-13T07:19:59.048Z","comments":true,"path":"2022/07/03/è®¡ç®—æœº4ä»¶å¥—/æ“ä½œç³»ç»Ÿ/","link":"","permalink":"http://example.com/2022/07/03/%E8%AE%A1%E7%AE%97%E6%9C%BA4%E4%BB%B6%E5%A5%97/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","excerpt":"","text":"ä¸€ã€æ“ä½œç³»ç»Ÿæ¦‚è¿°äºŒã€è¿›ç¨‹ä¸‰ã€å†…å­˜å››ã€æ–‡ä»¶äº”ã€I-Oè®¾å¤‡","categories":[],"tags":[]},{"title":"Redisæ¡†æ¶çš„å­¦ä¹ ç¬”è®°","slug":"Java/Redisæ¡†æ¶","date":"2022-07-03T14:50:31.983Z","updated":"2022-07-21T16:34:06.674Z","comments":true,"path":"2022/07/03/Java/Redisæ¡†æ¶/","link":"","permalink":"http://example.com/2022/07/03/Java/Redis%E6%A1%86%E6%9E%B6/","excerpt":"","text":"åŸºç¡€ç¯‡1.åˆè¯†Redis1.1 è®¤è¯†NoSqlé”®å€¼æ•°æ®åº“æ˜¯ä¸€ç§NoSqlæ•°æ®åº“ key value 1001 { â€œidâ€:1001, â€œnameâ€:â€å¼ ä¸‰â€, â€œageâ€:20,} SQLï¼šå…³ç³»å‹æ•°æ®åº“ NoSQLï¼šéå…³ç³»å‹æ•°æ®åº“ SQLä¸NoSQlçš„æ¯”è¾ƒï¼š SQL NoSQL æ•°æ®ç»“æ„ ç»“æ„åŒ– éç»“æ„åŒ–ï¼š1.é”®å€¼ç±»å‹(Redis)2.æ–‡æ¡£ç±»å‹(MongoDB)3.åˆ—ç±»å‹(HBase)4.Graphç±»å‹(Neo4j) æ•°æ®å…³è” å…³è”çš„(æ•°æ®æœ‰å…³è”) æ— å…³è”çš„ æŸ¥è¯¢æ–¹å¼ SQLæŸ¥è¯¢(SQLè¯­æ³•é€šç”¨) éSQL(è¯­æ³•ä¸ç»Ÿä¸€) äº‹åŠ¡ç‰¹æ€§ ACID BASE å­˜å‚¨æ–¹å¼ ç£ç›˜ å†…å­˜ æ‰©å±•æ€§ å‚ç›´ æ°´å¹³ ä½¿ç”¨åœºæ™¯ 1.æ•°æ®ç»“æ„å›ºå®š2.ç›¸å…³ä¸šåŠ¡æ•°æ®å®‰å…¨æ€§ã€ä¸€è‡´æ€§è¦æ±‚è¾ƒé«˜ 1.æ•°æ®ç»“æ„ä¸å›ºå®š2.ç›¸å…³ä¸šåŠ¡æ•°æ®å®‰å…¨æ€§ã€ä¸€è‡´æ€§è¦æ±‚ä¸é«˜3.å¯¹æ€§èƒ½è¦æ±‚ 1.2 è®¤è¯†RedisRedisè¯ç”Ÿäº2009å¹´å…¨ç§°æ—¶Remote Dictionary Serverï¼Œè¿œç¨‹è¯å…¸æœåŠ¡å™¨ï¼Œæ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„é”®å€¼å‹NoSQLæ•°æ®åº“ã€‚ ç‰¹å¾ï¼š é”®å€¼(key-value)å‹ï¼švalueæ”¯æŒå¤šç§ä¸åŒæ•°æ®ç»“æ„ï¼ŒåŠŸèƒ½ä¸°å¯Œ å•çº¿ç¨‹ï¼šæ¯ä¸ªå‘½ä»¤å…·å¤‡åŸå­æ€§ ä½å»¶è¿Ÿã€é€Ÿåº¦å¿«ï¼šåŸºäºå†…å­˜ã€IOå¤šè·¯å¤ç”¨ã€è‰¯å¥½çš„ç¼–ç (Cè¯­è¨€å¼€å‘) æ”¯æŒæ•°æ®æŒä¹…åŒ– æ”¯æŒä¸»ä»é›†ç¾¤ã€åˆ†ç‰‡é›†ç¾¤ æ”¯æŒå¤šè¯­è¨€å®¢æˆ·ç«¯ 1.3 Redisçš„å®‰è£…åŠå…¶é…ç½®(ä¸è¦çœ‹è¿™ä¸ªæ•™ç¨‹å®‰è£…ï¼Œæœ‰é—®é¢˜æˆ‘è¿˜è¦æ”¹)â€‹ å¤§å¤šä¼ä¸šéƒ½æ˜¯åŸºäºLinuxæœåŠ¡å™¨æ¥éƒ¨ç½²é¡¹ç›®ï¼Œè€Œä¸”Rediså®˜æ–¹ä¹Ÿæ²¡æœ‰æä¾›Windowsç‰ˆæœ¬çš„å®‰è£…åŒ…ã€‚å› æ­¤ä¼šä½¿ç”¨åŸºäºLinuxç³»ç»Ÿæ¥å®‰è£…Redisã€‚ Rediså®˜ç½‘ï¼šRedis Linuxç‰ˆæœ¬ä¸ºï¼šCentOS7 æ³¨æ„ï¼šä¸‹é¢çš„å®‰è£…Redisæ–¹æ³•ä¸é€‚ç”¨äºUbuntu æ‰“å¼€å‘½ä»¤è¡Œï¼Œä¾æ¬¡è¾“å…¥ä¸€ä¸‹å†…å®¹ï¼š 123456789101112131415#è½¬æ¢æˆrootæƒé™su - #è¾“å…¥å¯†ç #å®‰è£…gccä¾èµ–yum install -y gcc tcl#è¿›å…¥åˆ°srcç›®å½•cd /usr/local/src#ä¸‹è½½redis-6.2.6.tar.gzwget https://download.redis.io/releases/redis-6.2.6.tar.gz#è§£å‹redis-6.2.6.tar.gztar -zxvf redis-6.2.6.tar.gz#è¿›å…¥redis-6.2.6cd redis-6.2.6#è¿è¡Œç¼–è¯‘å‘½ä»¤make &amp;&amp; make install é»˜è®¤å®‰è£…è·¯å¾„ä¸º/usr/local/binç›®å½•ä¸‹ï¼š 1ll /usr/local/bin çœ‹åˆ°è¿™ä¸ªæ ·å­å®‰è£…åŸºæœ¬æˆåŠŸäº† Redisçš„é…ç½®æ–‡ä»¶ï¼š é‡æ–°æ‰“å¼€å‘½ä»¤è¡Œï¼š 12345678su -#è¾“å…¥å¯†ç #è¿›å…¥åˆ°redis-6.2.6ç›®å½•cd /usr/local/src/redis-6.2.6#å¤‡ä»½redis.confcp redis.conf redis.conf.bck#æ‰“å¼€redis.confé…ç½®æ–‡ä»¶vi redis.conf ä¿®æ”¹redis.confæ–‡ä»¶çš„ä¸€äº›é…ç½®ï¼š 123456#bind 127.0.0.1 -::ä¼šå¯¼è‡´åªèƒ½åœ¨æœ¬åœ°è®¿é—®ï¼Œä¿®æ”¹ä¸º0.0.0.0å°±å¯ä»¥åœ¨ä»»æ„ipè®¿é—®ï¼Œç”Ÿäº§ç¯å¢ƒä¸è¦è®¾ç½®ä¸º0.0.0.0bind 0.0.0.0#å®ˆæŠ¤è¿›ç¨‹ï¼Œä¿®æ”¹ä¸ºyeså³å¯åå°è¿è¡Œdaemonize yes#è®¾ç½®å¯†ç ä¸º123456requirepass 123456 æŸ¥æ‰¾ï¼š/+æ‰€è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ï¼›æŒ‰nå‘ä¸‹æŸ¥æ‰¾ï¼ŒæŒ‰Nå‘ä¸ŠæŸ¥æ‰¾ è¾“å…¥iå³å¯ä¿®æ”¹æ•°æ®ï¼Œä¿®æ”¹å®ŒæˆåæŒ‰ESCé€€å‡ºç¼–è¾‘ :wqä¸ºä¿å­˜å¹¶é€€å‡º é€€å‡ºåï¼š 12345redis-server redis.conf#æŸ¥çœ‹redisè¿›ç¨‹ps -ef|grep redis #æ€æ­»è¿›ç¨‹kill -9 ç«¯å£å· æ¥ç€è®¾ç½®å¼€æœºè‡ªå¯ï¼š 12#æ–°å»ºä¸€ä¸ªç³»ç»ŸæœåŠ¡æ–‡ä»¶vi /etc/systemd/system/redis.service å°†ä¸‹é¢å†…å®¹å…¨éƒ¨å¤åˆ¶åˆ°redis.serviceæ–‡ä»¶ä¸­ï¼š 1234567891011[Unit]Description=redis-serverAfter=network.target[Service]Type=forkingExecStart=/usr/local/bin/redis-server /usr/local/src/redis-6.2.6/redis.confPrivateTmp=true[Install]WantedBy=multi-user.target ä¿å­˜é€€å‡ºåï¼Œ æ¥ç€: 12345678910#é‡è½½ç³»ç»ŸæœåŠ¡systemctl daemon-reload#å¯åŠ¨redissystemctl start redis#æŸ¥çœ‹redisçŠ¶æ€systemctl status redis#åœæ­¢redissystemctl stop redis#rediså¼€æœºè‡ªå¯systemctl enable redis 2.Rediså‘½ä»¤2.1 Redisæ•°æ®ç»“æ„ä»‹ç»Redisæ˜¯ä¸€ä¸ªkey-valueçš„æ•°æ®åº“ï¼Œkeyä¸€èˆ¬æ˜¯Stringç±»å‹ï¼Œä¸è¿‡valueçš„ç±»å‹å¤šç§å¤šæ ·ï¼š æ•°æ®ç±»å‹ æ ¼å¼ String hello Redis Hash {name: â€œjackâ€, age: 21} List [A -&gt; B -&gt; C -&gt; D] Set {A, B, C} SortSet {A: 1, B: 2, C: 3} GEO(åœ°ç†åæ ‡) {A: (120.3, 30.5)} BitMap 0101001001100101011001000110100101110011 HyperLog 0101001001100101011001000110100101110011 åŸºæœ¬ç±»å‹ï¼šStringã€Hashã€Listã€Setã€SortSet ç‰¹æ®Šç±»å‹ï¼šGEOã€BitMapã€HyperLog 2.2 Redisé€šç”¨å‘½ä»¤ å‘½ä»¤ è§£é‡Š ä¸¾ä¾‹ KEYS æŸ¥çœ‹ç¬¦åˆæ¨¡æ¿çš„æ‰€æœ‰keyï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒè®¾å¤‡ä¸Šä½¿ç”¨(æ•ˆç‡ä½) KEYS *ï¼šæŸ¥çœ‹æ‰€æœ‰keyKEYS n*ï¼šæŸ¥çœ‹æ‰€æœ‰nå¼€å¤´çš„key DEL åˆ é™¤ä¸€ä¸ªæŒ‡å®škey DEL nameï¼šåˆ é™¤name EXISTS åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ EXISTS nameï¼šå­˜åœ¨è¿”å›1ï¼Œå¦åˆ™è¿”å›0 EXPIRE ç»™ä¸€ä¸ªkeyè®¾ç½®æœ‰æ•ˆæœŸï¼Œæœ‰æ•ˆæœŸåˆ°æœŸkeyä¼šè¢«è‡ªåŠ¨åˆ é™¤ EXPIRE name 20ï¼šè®¾ç½®nameçš„æœ‰æ•ˆæœŸä¸º20ç§’ TTL æŸ¥çœ‹ä¸€ä¸ªkeyçš„å‰©ä½™æœ‰æ•ˆæœŸ TTL nameï¼šæŸ¥çœ‹nameçš„æœ‰æ•ˆæœŸï¼Œå¦‚æœè¿”å›-2ï¼Œåˆ™è¯´æ˜åˆ°æœŸäº†å¦‚æœè¿”å›-1ï¼Œåˆ™è¯´æ˜æ°¸ä¹…æœ‰æ•ˆ 2.3 Stringç±»å‹Stringç±»å‹ã€ä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ˜¯Redisä¸­æœ€ç®€å•çš„å­˜å‚¨ç±»å‹ å…¶valueæ˜¯å­—ç¬¦ä¸²ï¼Œä¸è¿‡æ ¹æ®å­—ç¬¦ä¸²çš„æ ¼å¼ä¸åŒï¼Œåˆå¯ä»¥åˆ†ç±»ä¸º3ç±»ï¼š stringï¼šæ™®é€šå­—ç¬¦ä¸² intï¼šæ•´æ•°ç±»å‹ï¼Œå¯ä»¥åšè‡ªå¢ã€è‡ªå‡æ“ä½œ floatï¼šæµ®ç‚¹ç±»å‹ï¼Œå¯ä»¥åšè‡ªå¢ã€è‡ªå‡æ“ä½œ ä¸ç®¡æ˜¯å“ªç§æ ¼å¼ï¼Œåº•å±‚éƒ½æ˜¯å­—èŠ‚æ•°ç»„å½¢å¼å­˜å‚¨ï¼Œå­—ç¬¦ä¸²ç±»å‹çš„æœ€å¤§ç©ºé—´ä¸èƒ½è¶…è¿‡512m Key Value msg hello Redis num 10 score 98.5 Stringç±»å‹å¸¸è§å‘½ä»¤ï¼š å‘½ä»¤ SET key value æ·»åŠ æˆ–ä¿®æ”¹å·²ç»å­˜åœ¨çš„ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ SET name Jerryï¼šæŠŠnameçš„valueè®¾ç½®ä¸ºJerry GET key æ ¹æ®keyè·å–Stringç±»å‹çš„value GET nameï¼šè·å–åˆ°valueä¸ºâ€Jerryâ€ MSET æ‰¹é‡æ·»åŠ å¤šä¸ªStringç±»å‹çš„é”®å€¼å¯¹ MSET score 12.5 age 18ï¼šæ·»åŠ å¤šä¸ªé”®å€¼å¯¹ MGET æ ¹æ®å¤šä¸ªkeyè·å–å¤šä¸ªStringç±»å‹çš„value MGET name score ageï¼šå¾—åˆ°å¤šä¸ªvalueä¸ºâ€Jreeyâ€ â€œ12.5â€ â€œ18â€ INCR è®©ä¸€ä¸ªæ•´å‹çš„keyè‡ªå¢1 INCR ageï¼šageçš„valueåŠ 1ï¼Œç”±18å˜ä¸º19 INCRBY è®©ä¸€ä¸ªæ•´å‹çš„keyè‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿ INCRBY age 2ï¼šageçš„valueåŠ 2ï¼Œç”±19å˜ä¸º21 INCRBYFLOAT è®©ä¸€ä¸ªæµ®ç‚¹ç±»å‹çš„æ•°å­—è‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿ INCRBYFLOAT score 0.5ï¼šscoreçš„valueåŠ 0.5ï¼Œç”±12.5å˜ä¸º13.0 SETNX æ·»åŠ ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ï¼Œå‰ææ˜¯è¿™ä¸ªkeyä¸å­˜åœ¨ï¼Œå¦åˆ™ä¸æ‰§è¡Œ(æ–°å¢æ•ˆæœ) SETNX name Tomï¼šä¸æ‰§è¡Œï¼Œè¿”å›0SETNX k1 v1ï¼šæ‰§è¡Œï¼Œè¿”å›1 SETEX æ·»åŠ ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ï¼Œå¹¶ä¸”æŒ‡å®šæœ‰æ•ˆæœŸ SETEX name 10 jerry ï¼šæ·»åŠ é”®å€¼å¯¹ï¼Œå¹¶å°†æœ‰æ•ˆæœŸè®¾ç½®ä¸º10ç§’ 2.4 Keyçš„å±‚çº§æ ¼å¼Redisæ²¡æœ‰ç±»ä¼¼äºMySQLä¸­çš„Tableè¡¨çš„æ¦‚å¿µ Redisçš„Keyå…è®¸æœ‰å¤šä¸ªå•è¯å½¢æˆå±‚çº§ç»“æ„ï¼Œå¤šä¸ªå•è¯ä¹‹é—´ç”¨:éš”å¼€ï¼Œæ ¼å¼(ä¸å›ºå®š)å¦‚ä¸‹ï¼š é¡¹ç›®å:ä¸šåŠ¡å:ç±»å‹:id ä¾‹å¦‚é¡¹ç›®åå«demoï¼Œæœ‰userå’Œbookä¸¤ç§ä¸åŒç±»å‹çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰Keyï¼š userç›¸å…³çš„Keyï¼šdemo:user:1 bookç›¸å…³çš„Keyï¼šdemo:book:1 å¦‚æœValueæ˜¯ä¸€ä¸ªjavaå¯¹è±¡ï¼Œä¾‹å¦‚ä¸€ä¸ªUserå¯¹è±¡ï¼Œåˆ™å¯ä»¥å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºjsonå­—ç¬¦ä¸²åå­˜å‚¨ï¼š Key Value demo:user:1 {â€œidâ€: 1, â€œnameâ€: â€œJerryâ€, â€œageâ€: 18} demo:book:1 {â€œidâ€: 1, â€œnameâ€: â€œBOOKâ€, â€œpriceâ€: 15} æ’å…¥æ“ä½œ(æ³¨æ„ï¼šValueå€¼è¦åŠ &#39;&#39;)ï¼š set demo:user:1 &#39;&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;Jerry&quot;, &quot;age&quot;: 18&#125;&#39; set demo:book:1 &#39;&#123;&quot;id&quot;: 1, &quot;name&quot;: &quot;BOOK&quot;, &quot;price&quot;: 15&#125;&#39; æ‰“å¼€å›¾å½¢ç•Œé¢å®¢æˆ·ç«¯æŸ¥çœ‹ï¼š 2.5 Hashç±»å‹Hashç±»å‹ï¼Œä¹Ÿå«æ•£åˆ—ï¼Œå…¶valueæ˜¯ä¸€ä¸ªæ— åºå­—å…¸ï¼Œç±»ä¼¼äºjavaä¸­çš„HashMapç»“æ„ Stringç»“æ„æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºjsonå­—ç¬¦ä¸²åå­˜å‚¨ï¼Œå½“éœ€è¦ä¿®æ”¹å¯¹è±¡æŸä¸ªå­—æ®µæ—¶å¾ˆä¸æ–¹ä¾¿(éœ€è¦ä¿®æ”¹æ•´ä¸ªå­—ç¬¦ä¸²)ï¼š Key Value demo:user:1 {â€œidâ€: 1, â€œnameâ€: â€œJerryâ€, â€œageâ€: 18} demo:user:2 {â€œidâ€: 2, â€œnameâ€: â€œTomâ€, â€œpriceâ€: 20} è€ŒHashç»“æ„å¯ä»¥å°†å¯¹è±¡ä¸­æ¯ä¸ªå­—æ®µç‹¬ç«‹å­˜å‚¨ï¼Œå¯ä»¥é’ˆå¯¹å•ä¸ªå­—æ®µåšCRUDï¼š Key Value field value demo:user:1 name Jerry age 18 demo:user:2 name Tom age 20 Hashç±»å‹å¸¸è§å‘½ä»¤ï¼š å‘½ä»¤ HSET key field value æ·»åŠ æˆ–ä¿®æ”¹hashç±»å‹keyçš„fieldçš„å€¼ HSET demo:user:2 name LiHuaï¼šæŠŠnameçš„valueè®¾ç½®ä¸ºLihua HGET key field è·å–ä¸€ä¸ªhashç±»å‹keyçš„fieldçš„å€¼ HGET demo:user:2 nameï¼šè·å–åˆ°valueä¸ºâ€LiHuaâ€ HMSET æ‰¹é‡æ·»åŠ å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼ HMSET demo:user:3 name LiLei age 22ï¼šæ·»åŠ å¤šä¸ªfieldçš„å€¼ HMGET æ‰¹é‡è·å–æ ¹æ®å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼ HMGET demo:user:3 name ageï¼šå¾—åˆ°å¤šä¸ªfieldçš„å€¼ä¸ºâ€LiLeiâ€ â€œ22â€ HGETALL è·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„fieldå’Œvalue HGETALL demo:user:3ï¼šè·å–åˆ°keyä¸­æ‰€æœ‰çš„fieldå’Œvalue HKEYS è·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„field HKEYS demo:user:3ï¼šè·å–keyä¸­æ‰€æœ‰çš„field HVALS è·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„value HVALS demo:user:3ï¼šè·å–keyä¸­æ‰€æœ‰çš„value HINCRBY è®©ä¸€ä¸ªhashç±»å‹çš„keyçš„å­—æ®µè‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿ HINCRBY demo:user:3 age 2ï¼šageçš„valueåŠ 2ï¼Œç”±22å˜ä¸º24 HSETNX æ·»åŠ ä¸€ä¸ªhashç±»å‹çš„keyçš„fieldå€¼ï¼Œå‰ææ˜¯è¿™ä¸ªfieldä¸å­˜åœ¨ï¼Œå¦åˆ™ä¸æ‰§è¡Œ(æ–°å¢æ•ˆæœ) HSETNX demo:user:3 name XXXï¼šå­˜åœ¨fieldå€¼ä¸æ‰§è¡Œï¼Œè¿”å›0HSETNX demo:user:3 sex manï¼šä¸å­˜åœ¨fieldå€¼æ‰§è¡Œï¼Œè¿”å›1 2.6 Listç±»å‹Redisä¸­çš„Listç±»å‹ä¸javaä¸­çš„LinkListç±»ä¼¼ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ç»“æ„ï¼Œæ—¢å¯ä»¥æ”¯æŒæ­£å‘æ£€ç´¢ä¹Ÿå¯ä»¥æ”¯æŒåå‘æ£€ç´¢ã€‚ ç‰¹å¾ä¸LinkListä¹Ÿç±»ä¼¼ï¼š æœ‰åº å…ƒç´ å¯ä»¥é‡å¤ æ’å…¥å’Œåˆ é™¤å¿« æŸ¥è¯¢é€Ÿåº¦ä¸€èˆ¬ å¸¸ç”¨æ¥å­˜å‚¨ä¸€ä¸ªæœ‰åºæ•°æ®ï¼Œå¦‚ï¼šè¯„è®ºåˆ—è¡¨ã€ç‚¹èµåˆ—è¡¨ç­‰ Listç±»å‹çš„å¸¸è§å‘½ä»¤ï¼š LPUSH key element å‘åˆ—è¡¨å·¦ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  LPUSH user 1 2 3ï¼šè¡¨ä¸­ä»ç¬¬ä¸€ä½ä¾æ¬¡ä¸º â€œ3â€ â€œ2â€ â€œ1â€ LPOP key ç§»é™¤å¹¶è¿”å›åˆ—è¡¨å·¦ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›nil LPOP user 1 RPUSH key element å‘åˆ—è¡¨å³ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  RPUSH user 4 5 6ï¼šè¡¨ä¸­ä»ç¬¬ä¸€ä½ä¾æ¬¡ä¸º â€œ4â€ â€œ5â€ â€œ6â€ RPOP key ç§»é™¤å¹¶è¿”å›åˆ—è¡¨å³ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´  LRANGE key star end è¿”å›ä¸€æ®µè§’æ ‡èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´  LRANGE 1 star 2ï¼šä»0å¼€å§‹ï¼Œè·å–åˆ°1~2ä¹‹é—´çš„å…ƒç´  BLPOP ä¸LPOPç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨æ²¡æœ‰å…ƒç´ æ—¶ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›nil BLPOP user2 1 100ï¼šç§»é™¤å¹¶è¿”å›åˆ°å·¦ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰åˆ™ç­‰å¾…100ç§’ï¼Œè¶…æ—¶è¿”å›nil BRPOP ä¸RPOPç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨æ²¡æœ‰å…ƒç´ æ—¶ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›nil Listç»“æ„æ¨¡æ‹Ÿä¸€ä¸ªæ ˆ å…¥å£å’Œå‡ºå£åœ¨åŒä¸€è¾¹ å¦‚ï¼šLPUSHå’ŒLPOPæˆ–è€… RPUSHå’ŒRPOP Listç»“æ„æ¨¡æ‹Ÿä¸€ä¸ªé˜Ÿåˆ— å…¥å£å’Œå‡ºå£ä¸åœ¨åŒä¸€è¾¹ å¦‚ï¼šLPUSHå’ŒRPOP æˆ–è€… RPUSHå’ŒLPOP Listç»“æ„æ¨¡æ‹Ÿä¸€ä¸ªé˜»å¡é˜Ÿåˆ— å…¥å£å’Œå‡ºå£ä¸åœ¨åŒä¸€è¾¹ å‡ºé˜Ÿé‡‡ç”¨BLPOPæˆ–è€…BRPOP å¦‚ï¼šLPUSHå’ŒBRPOP æˆ–è€… RPUSHå’ŒBLPOP 2.7 Setç±»å‹Redisçš„Setç»“æ„ä¸Javaä¸­çš„Hashsetç±»ä¼¼ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªvalueä¸ºnullçš„HashMapã€‚å› ä¸ºä¹Ÿæ˜¯ä¸€ä¸ªhashè¡¨ï¼Œå› æ­¤å…·å¤‡ä¸Hashsetç±»ä¼¼çš„ç‰¹å¾ï¼š æ— åº å…ƒç´ ä¸å¯é‡å¤ æŸ¥æ‰¾å¿« æ”¯æŒäº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰åŠŸèƒ½ Setç±»å‹çš„å¸¸è§å‘½ä»¤ï¼š SADD key member å‘setä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  SADD s1 a b c SREM key member ç§»é™¤setä¸­çš„æŒ‡å®šå…ƒç´  SREM s1 a SCARD key è¿”å›setä¸­å…ƒç´ çš„ä¸ªæ•° SCARD s1 SISMEMBER key member åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºsetä¸­ SISMEMBER s1 a SMEMBERS è·å–setä¸­çš„æ‰€æœ‰å…ƒç´  SMEMBERS SINTER key1 key2 æ±‚key1ä¸key2çš„äº¤é›† SDIFF key1 key2 æ±‚key1ä¸key2çš„å·®é›† SUNION key1 key2 æ±‚key1ä¸key2çš„å¹¶é›† 2.8 SortedSetç±»å‹Redisçš„SortedSetæ˜¯ä¸€ä¸ªå¯æ’åºçš„seté›†åˆï¼Œä¸javaä¸­çš„TreeSetæœ‰äº›ç±»ä¼¼ï¼Œä½†åº•å±‚æ•°æ®ç»“æ„å´å·®åˆ«å¾ˆå¤§Sortedsetä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¸¦æœ‰ä¸€ä¸ªscoreå±æ€§ï¼Œå¯ä»¥åŸºäºscoreå±æ€§å¯¹å…ƒç´ æ’åºï¼Œåº•å±‚çš„å®ç°æ˜¯ä¸€ä¸ªè·³è¡¨(SkipList)åŠ hashè¡¨ã€‚SortedSetå…·å¤‡ä¸‹åˆ—ç‰¹æ€§ï¼š å¯æ’åº å…ƒç´ ä¸é‡å¤ æŸ¥è¯¢é€Ÿåº¦å¿« å› ä¸ºSortedsetçš„å¯æ’åºç‰¹æ€§ï¼Œç»å¸¸è¢«ç”¨æ¥å®ç°æ’è¡Œæ¦œè¿™æ ·çš„åŠŸèƒ½ã€‚ SortedSetç±»å‹çš„å¸¸è§å‘½ä»¤ï¼š ZADD key score member æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åˆ°sorted setï¼Œå¦‚æœå·²ç»å­˜åœ¨åˆ™æ›´æ–°å…¶scoreå€¼ ZADD SSet 85 Tom 98 Jerry 77 Rose 78 Jackï¼šå‘SSetä¸­æ·»åŠ å…ƒç´ ï¼Œå¹¶æŒ‰ç…§å‡åºæ’åˆ— ZREM key member åˆ é™¤sorted setä¸­çš„ä¸€ä¸ªæŒ‡å®šå…ƒç´  ZREM SSet Tomï¼šåˆ é™¤Tom ZSCORE key member è·å–sorted setä¸­çš„æŒ‡å®šå…ƒç´ çš„scoreå€¼ ZRANK key member è·å–sorted set ä¸­çš„æŒ‡å®šå…ƒç´ å‡åºçš„æ’å ZRANK SSet Roseï¼šæŒ‰ç…§å‡åºçš„åºåˆ—ï¼Œä»0å¼€å§‹ï¼Œè¿”å›Roseçš„æ’å ZREVRANK key member è·å–sorted set ä¸­çš„æŒ‡å®šå…ƒç´ é™åºçš„æ’å ZRANK SSet Roseï¼šæŒ‰ç…§é™åºçš„åºåˆ—ï¼Œä»0å¼€å§‹ï¼Œè¿”å›Roseçš„æ’å ZCARD key è·å–sorted setä¸­çš„å…ƒç´ ä¸ªæ•° ZCOUNT key min max ç»Ÿè®¡scoreå€¼åœ¨ç»™å®šèŒƒå›½å†…çš„æ‰€æœ‰å…ƒç´ çš„ä¸ªæ•° ZINCRBY key increment member è®©sorted setä¸­çš„æŒ‡å®šå…ƒç´ è‡ªå¢ï¼Œæ­¥é•¿ä¸ºæŒ‡å®šçš„incrementå€¼ ZRANGE key min max æŒ‰ç…§scoreå‡åºæ’åºåï¼Œè·å–æŒ‡å®šæ’åèŒƒå›´å†…çš„å…ƒç´  ZCOUNT SSet 0 2ï¼šæŒ‰ç…§å‡åºçš„æƒ…å†µï¼Œè·å–0~2èŒƒå›´çš„å…ƒç´  ZREVRANGE key min max æŒ‰ç…§scoreçš„é™åºæ’åºåï¼Œè·å–æŒ‡å®šæ’åèŒƒå›´å†…çš„å…ƒç´  ZCOUNT SSet 0 2ï¼šæŒ‰ç…§é™åºçš„æƒ…å†µï¼Œè·å–0~2èŒƒå›´çš„å…ƒç´  ZRANGEBYSCORE key min max æŒ‰ç…§scoreæ’åºåï¼Œè·å–æŒ‡å®šscoreèŒƒå›½å†…çš„å…ƒç´  ZRANGEBYSCORE SSet 0 80ï¼šè¿”å›0~80åˆ†æ•°çš„å…ƒç´  ZDIFFã€ZINTERã€ZUNION æ±‚å·®é›†ã€äº¤é›†ã€å¹¶é›† æ³¨æ„ï¼šæ‰€æœ‰æ’åé»˜è®¤éƒ½æ˜¯å‡åºï¼Œå¦‚æœé™åºåˆ™åœ¨å‘½ä»¤çš„Zåé¢æ·»åŠ REVå³å¯ ä¾‹å¦‚ï¼šZREVRANK 3.Redisçš„javaå®¢æˆ·ç«¯Rediså®˜ç½‘ä¸­æä¾›äº†å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ Javaï¼š Jedisï¼šä»¥Rediså‘½ä»¤ä½œä¸ºæ–¹æ³•åç§°ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼Œç®€å•å®ç”¨ä½†æ˜¯Jediså®ä¾‹æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦åŸºäºè¿æ¥æ± æ¥ä½¿ç”¨ Lettuceï¼šåŸºäºNettyå®ç°çš„ï¼Œæ”¯æŒåŒæ­¥ã€å¼‚æ­¥å’Œå“åº”å¼ç¼–ç¨‹æ–¹å¼ï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ”¯æŒRedisçš„å“¨å…µæ¨¡å¼ã€é›†ç¾¤æ¨¡å¼å’Œç®¡é“æ¨¡å¼ Redissonï¼šæ˜¯ä¸€ä¸ªåŸºäºRediså®ç°çš„åˆ†å¸ƒå¼ã€å¯ä¼¸ç¼©çš„Javaæ•°æ®ç»“æ„é›†åˆã€‚åŒ…å«äº†è¯¸å¦‚Mapã€Queueã€LockSemaphoreã€Atomiclongç­‰å¼ºå¤§åŠŸèƒ½ å…¶ä¸­Springæ•´åˆäº†Jediså’ŒLettuceï¼Œåªéœ€å¯¼å…¥åæ ‡Spring Data Redis 3.1 Jediså¿«é€Ÿå…¥é—¨Jedisï¼šJediså®˜ç½‘ å¼•å…¥jedisä¾èµ–ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;version&gt;3.7.0&lt;/version&gt;&lt;/dependency&gt; å®Œæ•´ä¾èµ–ï¼š 123456789101112131415&lt;dependencies&gt; &lt;!-- jedisä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;version&gt;3.7.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- æµ‹è¯•ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt; &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt; &lt;version&gt;5.7.0&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; ä»¥ä¸‹åœ¨Testä¸­è¿›è¡Œï¼š å»ºç«‹è¿æ¥ 123456789@BeforeEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„æ–¹æ³• void setUp() &#123; //å»ºç«‹è¿æ¥ jedis = new Jedis(&quot;127.0.0.1&quot;,6379); //è®¾ç½®å¯†ç  jedis.auth(&quot;123456&quot;); //é€‰æ‹©åº“ jedis.select(0); &#125; æµ‹è¯•Stringç±»å‹ 12345@Testvoid testString() &#123; jedis.set(&quot;name&quot;,&quot;Tom&quot;); System.out.println(jedis.get(&quot;name&quot;));&#125; é‡Šæ”¾èµ„æº 123456@AfterEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„æ–¹æ³•void tearDown() &#123; if (jedis != null)&#123; jedis.close(); &#125;&#125; å®Œæ•´æµ‹è¯•ï¼š 12345678910111213141516171819202122232425262728293031323334public class JedisTest &#123; private Jedis jedis; @BeforeEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„æ–¹æ³• void setUp() &#123; //å»ºç«‹è¿æ¥ jedis = new Jedis(&quot;127.0.0.1&quot;,6379); //è®¾ç½®å¯†ç  jedis.auth(&quot;123456&quot;); //é€‰æ‹©åº“ jedis.select(0); &#125; @Test void testString() &#123; jedis.set(&quot;name&quot;,&quot;Tom&quot;); System.out.println(jedis.get(&quot;name&quot;)); &#125; @Test void testHash() &#123; jedis.hset(&quot;demo:user:2&quot;,&quot;name&quot;,&quot;Jerry&quot;); jedis.hset(&quot;demo:user:2&quot;,&quot;age&quot;,&quot;18&quot;); Map&lt;String, String&gt; map = jedis.hgetAll(&quot;demo:user:2&quot;); System.out.println(map); &#125; @AfterEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„æ–¹æ³• void tearDown() &#123; if (jedis != null)&#123; jedis.close(); &#125; &#125;&#125; jedisä½¿ç”¨çš„åŸºæœ¬æ­¥éª¤ï¼š å¼•å…¥ä¾èµ– åˆ›å»ºjediså¯¹è±¡ï¼Œå»ºç«‹è¿æ¥ ä½¿ç”¨jedisçš„æ–¹æ³•åä¸Rediså‘½ä»¤ä¸€è‡´ é‡Šæ”¾èµ„æº 3.2 Jedisçš„è¿æ¥æ± Jedisæœ¬èº«çº¿ç¨‹æ˜¯ä¸å®‰å…¨çš„ï¼Œå¹¶ä¸”é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯è¿æ¥ä¼šæœ‰æ€§èƒ½æŸè€—ï¼Œå› æ­¤æ¨èä½¿ç”¨Jedisè¿æ¥æ± æ›¿ä»£Jedisçš„ç›´è¿æ–¹æ³• åˆ›å»ºJedisConnectionFactoryå·¥å…·ç±»ï¼š 12345678910111213141516171819202122232425262728public class JedisConnectionFactory &#123; private static final JedisPool jedisPool; static &#123; //é…ç½®è¿æ¥æ±  JedisPoolConfig jedisPoolConfig = new JedisPoolConfig(); //æœ€å¤§è¿æ¥æ•° jedisPoolConfig.setMaxTotal(8); //æœ€å¤§ç©ºé—²è¿æ¥ jedisPoolConfig.setMaxIdle(8); //æœ€å°ç©ºé—²è¿æ¥ jedisPoolConfig.setMinIdle(0); //ç­‰å¾…æ—¶é•¿ jedisPoolConfig.setMaxWaitMillis(1000); //åˆ›å»ºè¿æ¥æ± å¯¹è±¡ jedisPool = new JedisPool(jedisPoolConfig, &quot;127.0.0.1&quot;, 6379, 1000, &quot;123456&quot;); &#125; public static Jedis getJedis()&#123; return jedisPool.getResource(); &#125;&#125; æµ‹è¯•ç±»ä¸­ï¼š 123456789101112131415161718192021222324252627public class JedisTest &#123; private Jedis jedis; @BeforeEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„æ–¹æ³• void setUp() &#123; //å»ºç«‹è¿æ¥ jedis = JedisConnectionFactory.getJedis(); //é€‰æ‹©åº“ jedis.select(0); &#125; @Test void testHash() &#123; jedis.hset(&quot;demo:user:2&quot;,&quot;name&quot;,&quot;Jerry&quot;); jedis.hset(&quot;demo:user:2&quot;,&quot;age&quot;,&quot;18&quot;); Map&lt;String, String&gt; map = jedis.hgetAll(&quot;demo:user:2&quot;); System.out.println(map); &#125; @AfterEach //åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„æ–¹æ³• void tearDown() &#123; if (jedis != null)&#123; //closeæ–¹æ³•å½“æ£€æµ‹åˆ°æ˜¯è¿æ¥æ± æ—¶ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„å…³é—­è¿æ¥ï¼Œè€Œæ˜¯å°†å¯¹è±¡å½’è¿˜ç»™è¿æ¥æ±  jedis.close(); &#125; &#125;&#125; 3.3 åˆè¯†SpringDataRedisSpringDataæ˜¯Springä¸­æ•°æ®æ“ä½œçš„æ¨¡å—ï¼ŒåŒ…å«å¯¹å„ç§æ•°æ®åº“çš„é›†æˆï¼Œå…¶ä¸­å¯¹Redisçš„é›†æˆæ¨¡å—å°±å«åšSpringDataRedis æä¾›äº†å¯¹ä¸åŒRediså®¢æˆ·ç«¯çš„æ•´åˆ ï¼ˆLettuceå’ŒJedisï¼‰ æä¾›äº†RedisTemplateç»Ÿä¸€APIæ¥æ“ä½œRedis æ”¯æŒRedisçš„å‘å¸ƒè®¢é˜…æ¨¡å‹ æ”¯æŒRediså“¨å…µå’ŒRedisé›†ç¾¤ æ”¯æŒåŸºäºLettuceçš„å“åº”å¼ç¼–ç¨‹ æ”¯æŒåŸºäºJDKã€JSONã€å­—ç¬¦ä¸²ã€Springå¯¹è±¡çš„æ•°æ®åºåˆ—åŒ–åŠååºåˆ—åŒ– æ”¯æŒåŸºäºRedisçš„JDKCollectionå®ç° SpringDataRedisä¸­æä¾›äº†RedisTemplateå·¥å…·ç±»ï¼Œå…¶ä¸­å°è£…äº†å„ç§å¯¹Redisçš„æ“ä½œã€‚å¹¶ä¸”å°†ä¸åŒæ•°æ®ç±»å‹çš„æ“ä½œAPIå°è£…åˆ°äº†ä¸åŒçš„ç±»å‹ä¸­ï¼š API è¿”å›å€¼ç±»å‹ è§£é‡Š redisTemplate.opsForValue() ValueOperations æ“ä½œStringç±»å‹æ•°æ® redisTemplate.opsForHash() HashOperations æ“ä½œHashç±»å‹æ•°æ® redisTemplate.opsForList() ListOperations æ“ä½œListç±»å‹æ•°æ® redisTemplate.opsForSet() SetOperations æ“ä½œSetç±»å‹æ•°æ® redisTemplate.opsForZSet() ZSetOperations æ“ä½œSortedSetç±»å‹æ•°æ® redisTemplate é€šç”¨å‘½ä»¤ 3.4 SpringDataRediså¿«é€Ÿå…¥é—¨SpringBootå·²ç»æä¾›äº†å¯¹SpringDataRedisçš„æ”¯æŒï¼Œå…¶ä¸­Springé»˜è®¤æ”¯æŒLettuceï¼Œå¦‚éœ€ä½¿ç”¨Jediséœ€è¦é¢å¤–å¯¼å…¥ä¾èµ– å¯¼å…¥ä¾èµ– 12345678910&lt;!-- Redisä¾èµ– --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- è¿æ¥æ± ä¾èµ– --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ 1234567891011spring: redis: host: 127.0.0.1 port: 6379 password: 123456 lettuce: pool: max-active: 8 # æœ€å¤§è¿æ¥æ•° max-idle: 8 #æœ€å¤§ç©ºé—²è¿æ¥æ•° min-idle: 0 #æœ€å°ç©ºé—²è¿æ¥æ•° max-wait: 100ms # è¿æ¥ç­‰å¾…æ—¶é—´ æ³¨å…¥RedisTemplateï¼Œè¿›è¡Œæµ‹è¯•ï¼š 12345678910111213@SpringBootTestpublic class RedisTemplateTest &#123; @Autowired private RedisTemplate redisTemplate; @Test void testString() &#123; //æ’å…¥ä¸€æ¡Stringç±»å‹çš„æ•°æ® redisTemplate.opsForValue().set(&quot;name&quot;,&quot;dahuang&quot;); //è·å–Stringç±»å‹çš„æ•°æ® System.out.println(redisTemplate.opsForValue().get(&quot;name&quot;)); &#125;&#125; SpringDataRedisçš„ä½¿ç”¨æ­¥éª¤ï¼š å¼•å…¥spring-boot-starter-data-redisä¾èµ– åœ¨application.ymlé…ç½®Redisä»¥åŠè¿æ¥æ± ä¿¡æ¯ æ³¨å…¥RedisTemplate 3.5 SpringDataRedisçš„åºåˆ—åŒ–æ–¹å¼RedisTemplateå¯ä»¥æ¥æ”¶ä»»æ„Objectä½œä¸ºå€¼å†™å…¥Redisï¼Œåªä¸è¿‡å†™å…¥å‰ä¼šæŠŠObjectåºåˆ—åŒ–ä¸ºå­—èŠ‚å½¢å¼ï¼Œé»˜è®¤é‡‡ç”¨JDKåºåˆ—åŒ–ï¼Œåˆšæ‰å­˜å…¥çš„æ•°æ®çš„ç»“æœæ˜¯è¿™æ ·ï¼š ç¼ºç‚¹ï¼š å¯è¯»æ€§å·® å†…å­˜å ç”¨è¾ƒå¤§ éœ€è¦å¯¼å…¥jacksonä¾èµ–ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;&lt;/dependency&gt; å¯ä»¥è‡ªå®šä¹‰RedisTemplateçš„åºåˆ—åŒ–æ–¹å¼ï¼š 123456789101112131415161718192021@Configurationpublic class RedisConfig &#123; @Bean public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory redisConnectionFactory)&#123; //åˆ›å»ºRedisTemplate RedisTemplate&lt;String,Object&gt; redisTemplate = new RedisTemplate&lt;&gt;(); //è®¾ç½®è¿æ¥å·¥å‚ redisTemplate.setConnectionFactory(redisConnectionFactory); //è®¾ç½®jsonåºåˆ—åŒ– GenericJackson2JsonRedisSerializer gjjrs = new GenericJackson2JsonRedisSerializer(); //è®¾ç½®keyçš„åºåˆ—åŒ– redisTemplate.setKeySerializer(RedisSerializer.string()); redisTemplate.setHashKeySerializer(RedisSerializer.string()); //è®¾ç½®valueçš„åºåˆ—åŒ– redisTemplate.setValueSerializer(gjjrs); redisTemplate.setHashValueSerializer(gjjrs); return redisTemplate; &#125;&#125; åˆ›å»ºä¸€ä¸ªå®ä½“ç±»ï¼š 123456789101112@Datapublic class User &#123; private String name; public Integer age; public User()&#123;&#125; public User(String name, Integer age) &#123; this.name = name; this.age = age; &#125;&#125; è¿›è¡Œæµ‹è¯•ï¼š 123456@Testvoid testString() &#123; redisTemplate.opsForValue().set(&quot;demo:user:3&quot;,new User(&quot;dahuang&quot;,18)); User u = (User) redisTemplate.opsForValue().get(&quot;demo:user:3&quot;); System.out.println(&quot;u = &quot; + u);&#125; æ§åˆ¶å°æ‰“å°ï¼š 1u = User(name=dahuang, age=18) Redisä¸­çš„æ•°æ®ï¼š 12345&#123; &quot;@class&quot;: &quot;com.redis.pojo.User&quot;, &quot;name&quot;: &quot;dahuang&quot;, &quot;age&quot;: 18&#125; 3.6 StringRedisTemplate å°½ç®¡jsonçš„åºåˆ—åŒ–æ–¹å¼å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ ä¸ºäº†åœ¨ååºåˆ—åŒ–æ—¶çŸ¥é“å¯¹è±¡çš„ç±»å‹ï¼Œjsonåºåˆ—åŒ–å™¨ä¼šå°†ç±»çš„classç±»å‹å†™å…¥jsonç»“æœä¸­ï¼Œå­˜å…¥Redisï¼Œä¼šå¸¦æ¥é¢å¤–çš„å†…å­˜å¼€é”€ ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå¹¶ä¸ä¼šä½¿ç”¨jsonåºåˆ—åŒ–å™¨æ¥å¤„ç†valueï¼Œè€Œæ˜¯ç»Ÿä¸€ä½¿ç”¨Stringåºåˆ—åŒ–å™¨ï¼Œè¦æ±‚åªèƒ½å­˜å‚¨Stringç±»å‹çš„keyå’Œvalue å½“å­˜å‚¨javaå¯¹è±¡æ—¶ï¼Œæ‰‹åŠ¨å®Œæˆå¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ– graph LR; å®ä½“ç±» --> |æ‰‹åŠ¨åºåˆ—åŒ–|jsonå­—ç¬¦ä¸² --> |æ’å…¥|Redis Redis -->|è·å–| jsonå­—ç¬¦ä¸² --> |æ‰‹åŠ¨ååºåˆ—åŒ–|å®ä½“ç±» Springé»˜è®¤æä¾›äº†ä¸€ä¸ªSpringRedisTemplateç±»ï¼Œå®ƒçš„keyå’Œvalueçš„åºåˆ—åŒ–æ–¹å¼é»˜è®¤å°±æ˜¯Stringæ–¹å¼ã€‚çœå»äº†è‡ªå®šä¹‰RedisTemplateçš„è¿‡ç¨‹ï¼š 12345678910111213141516171819202122@SpringBootTestpublic class StringRedisTemplateTest &#123; @Autowired private StringRedisTemplate stringRedisTemplate; //jsonå·¥å…· private static final ObjectMapper mapper = new ObjectMapper(); @Test void testStringTemplate() throws JsonProcessingException &#123; User user = new User(&quot;dahei&quot;, 22); //æ‰‹åŠ¨åºåˆ—åŒ– String json = mapper.writeValueAsString(user); //æ’å…¥æ•°æ® stringRedisTemplate.opsForValue().set(&quot;demo:user:5&quot;,json); //è·å–æ•°æ® String val = stringRedisTemplate.opsForValue().get(&quot;demo:user:5&quot;); //æ‰‹åŠ¨ååºåˆ—åŒ– User u = mapper.readValue(val, User.class); //æ‰“å°user System.out.println(&quot;u = &quot; + u); &#125;&#125; RedisTemplateçš„ä¸¤ç§åºåˆ—åŒ–å®è·µæ–¹æ¡ˆï¼š æ–¹æ¡ˆä¸€ï¼š è‡ªå®šä¹‰RedisTemplate ä¿®æ”¹RedisTemplateçš„åºåˆ—åŒ–å™¨ä¸ºGenericJackson2JsonRedisSerializer æ–¹æ¡ˆäºŒï¼š ä½¿ç”¨StringRedisTemplate å†™å…¥Redisæ—¶ï¼Œéœ€æ‰‹åŠ¨æŠŠå¯¹è±¡åºåˆ—åŒ–ä¸ºjson è¯»å–Redisæ—¶ï¼Œæ‰‹åŠ¨æŠŠè¯»å–åˆ°çš„jsonååºåˆ—åŒ–ä¸ºå¯¹è±¡ 3.7 RedisTemplateæ“ä½œHashç±»å‹12345678@Testvoid testHash() &#123; stringRedisTemplate.opsForHash().put(&quot;user:6&quot;,&quot;name&quot;,&quot;dahei&quot;); stringRedisTemplate.opsForHash().put(&quot;user:6&quot;,&quot;age&quot;,&quot;22&quot;); Map&lt;Object, Object&gt; entries = stringRedisTemplate.opsForHash().entries(&quot;user:6&quot;); System.out.println(&quot;entries = &quot; + entries);&#125; å®æˆ˜ç¯‡ æ­¤é¡¹ç›®ä¸ºé»‘é©¬ç‚¹è¯„ï¼Œå¦‚éœ€è¯·åˆ°vxæœç´¢é»‘é©¬ç¨‹åºå‘˜è·å–èµ„æº é¡¹ç›®ç»“æ„ï¼š application.yamlçš„é…ç½®ï¼š 123456789101112131415161718192021222324252627server: port: 8081spring: application: name: hmdp datasource: driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://localhost:3306/hmdp?useSSL=false&amp;serverTimezone=UTC username: root password: 123456 redis: host: 127.0.0.1 port: 6379 password: 123456 lettuce: pool: max-active: 10 max-idle: 10 min-idle: 1 time-between-eviction-runs: 10s jackson: default-property-inclusion: non_null # JSONå¤„ç†æ—¶å¿½ç•¥éç©ºå­—æ®µmybatis-plus: type-aliases-package: com.hmdp.entity # åˆ«åæ‰«æåŒ…logging: level: com.hmdp: debug 1.çŸ­ä¿¡ç™»å½•1.1 åŸºäºSessionå®ç°çŸ­ä¿¡ç™»å½•æµç¨‹å‘é€çŸ­ä¿¡éªŒè¯ç ï¼š çŸ­ä¿¡éªŒè¯ç ç™»å½•ã€æ³¨å†Œï¼š æ ¡éªŒç™»å½•çŠ¶æ€ï¼š 1.2 å®ç°å‘é€çŸ­ä¿¡éªŒè¯ç IUserServiceï¼š 1234public interface IUserService extends IService&lt;User&gt; &#123; Result sendCode(String phone, HttpSession session);&#125; UserServiceImplä¸­å®ç°sendCodeæ–¹æ³•ï¼š 12345678910111213141516@Overridepublic Result sendCode(String phone, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(phone)) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //ç¬¦åˆï¼Œç”ŸæˆéªŒè¯ç  String code = RandomUtil.randomNumbers(6); //ä¿å­˜éªŒè¯ç åˆ°Session session.setAttribute(&quot;code&quot;,code); //å‘é€éªŒè¯ç ï¼Œæ¨¡æ‹Ÿä¸€ä¸‹ log.debug(&quot;å‘é€éªŒè¯ç æˆåŠŸï¼ŒéªŒè¯ç ä¸ºï¼š&quot;+code); //è¿”å›OK return Result.ok();&#125; UserControllerï¼š 12345@PostMapping(&quot;code&quot;)public Result sendCode(@RequestParam(&quot;phone&quot;) String phone, HttpSession session) &#123; //å‘é€çŸ­ä¿¡éªŒè¯ç å¹¶ä¿å­˜éªŒè¯ç  return userService.sendCode(phone, session);&#125; æ—¥å¿—æ‰“å°ï¼š 1å‘é€éªŒè¯ç æˆåŠŸï¼ŒéªŒè¯ç ä¸ºï¼š608824 1.3 å®ç°çŸ­ä¿¡éªŒè¯ç™»å½•ä¸æ³¨å†Œ1234public interface IUserService extends IService&lt;User&gt; &#123; Result sendCode(String phone, HttpSession session); Result login(LoginFormDTO loginForm, HttpSession session);&#125; 1234567891011121314151617181920212223242526272829303132@Overridepublic Result login(LoginFormDTO loginForm, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(loginForm.getPhone())) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //æ ¡éªŒéªŒè¯ç  String code = (String) session.getAttribute(&quot;code&quot;); if (code == null || !code.equals(loginForm.getCode())) &#123; //ä¸ä¸€è‡´ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;éªŒè¯ç é”™è¯¯&quot;); &#125; //ä¸€è‡´ï¼ŒæŸ¥è¯¢æ‰‹æœºå·æ˜¯å¦å­˜åœ¨ User user = query().eq(&quot;phone&quot;, loginForm.getPhone()).one(); if (user == null) &#123; //ä¸å­˜åœ¨ï¼Œæ’å…¥åˆ°æ•°æ®åº“ï¼Œå®Œæˆæ³¨å†Œ user = createUserByPhone(loginForm.getPhone()); &#125; //ä¿å­˜ç”¨æˆ·åˆ°Session session.setAttribute(&quot;user&quot;,user); //æ¯ä¸ªsessionéƒ½æœ‰å”¯ä¸€çš„idï¼Œä¸éœ€è¦ç™»é™†å‡­è¯ return Result.ok();&#125;private User createUserByPhone(String phone) &#123; User user = new User(); user.setPhone(phone); user.setNickName(USER_NICK_NAME_PREFIX + RandomUtil.randomNumbers(10)); save(user); return user;&#125; 12345@PostMapping(&quot;/login&quot;)public Result login(@RequestBody LoginFormDTO loginForm, HttpSession session)&#123; //å®ç°ç™»å½•åŠŸèƒ½ return userService.login(loginForm,session);&#125; 1.4 å®ç°ç™»å½•æ ¡éªŒæ‹¦æˆªå™¨è°ƒç”¨/user/meæ¥å£è·å–ç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œå“åº”ä¸­åŒ…å«äº†æ‰‹æœºå·ã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œå¹¶ä¸”å‘é€çš„å¤šä½™ä¿¡æ¯å¢åŠ äº†æœåŠ¡å™¨çš„å‹åŠ›ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç”¨æˆ·æ˜µç§°ã€å¤´åƒå’Œidç­‰çš„éƒ¨åˆ†ä¿¡æ¯ã€‚ å®šä¹‰ä¸€ä¸ªUserDtoï¼š 123456@Datapublic class UserDTO &#123; private Long id; //id private String nickName;//æ˜µç§° private String icon;//å¤´åƒ&#125; å°†UserServiceImplçš„loginæ–¹æ³•ä¸­å­˜å…¥sessionçš„Userè½¬æ¢æˆUserDtoç±»å‹ï¼š 1session.setAttribute(&quot;user&quot;, BeanUtil.copyProperties(user, UserDTO.class)); æ–°å»ºLoginInterceptoræ‹¦æˆªå™¨ï¼š 12345678910111213141516171819202122232425public class LoginInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //è·å–session HttpSession session = request.getSession(); //è·å–ç”¨æˆ·ä¿¡æ¯ UserDTO user = (UserDTO) session.getAttribute(&quot;user&quot;); //ä¸å­˜åœ¨ï¼Œæ‹¦æˆª if (user == null)&#123; //è¿”å›çŠ¶æ€ç 401ï¼Œæœªæˆæƒ response.setStatus(401); return false; &#125; //å­˜åœ¨ï¼Œä¿å­˜åˆ°TheadLocal UserHolder.saveUser(user); //æ”¾è¡Œ return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; //ç§»é™¤ç”¨æˆ· UserHolder.removeUser(); &#125;&#125; æ–°å»ºMvcConfigé…ç½®ç±»ï¼Œæ·»åŠ æ‹¦æˆªå™¨å¹¶æ·»åŠ æ’åºè·¯å¾„ï¼š 12345678910111213141516@Configurationpublic class MvcConfig implements WebMvcConfigurer &#123; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(new LoginInterceptor()) .excludePathPatterns( //æ’é™¤è·¯å¾„ &quot;/user/login&quot;, &quot;/user/code&quot;, &quot;/shop/**&quot;, &quot;/shop-type/**&quot;, &quot;/blog/hot&quot;, &quot;/upload/**&quot;, &quot;/voucher/**&quot; ); &#125;&#125; UserControllerä¸­å®ç°è·å–ç”¨æˆ·ä¿¡æ¯ï¼š 123456@GetMapping(&quot;/me&quot;)public Result me()&#123; //è·å–å½“å‰ç™»å½•çš„ç”¨æˆ·å¹¶è¿”å› UserDTO user = UserHolder.getUser(); return Result.ok(user);&#125; 1.5 Sessionå…±äº«é—®é¢˜åˆ†æsessionå…±äº«é—®é¢˜ï¼šå¤šå°Tomcatä¸èƒ½å…±äº«sessionå­˜å‚¨ç©ºé—´ï¼Œå½“è¯·æ±‚åˆ‡æ¢åˆ°ä¸åŒçš„TomcatæœåŠ¡å™¨æ—¶å¯¼è‡´æ•°æ®å¯¹æ˜¯é—®é¢˜ sessionçš„æ›¿ä»£æ–¹æ¡ˆåº”è¯¥æ»¡è¶³ï¼š æ•°æ®å…±äº« å†…å­˜å­˜å‚¨ keyã€valueç»“æ„ Rediséƒ½èƒ½è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œå¹¶ä¸”å»¶æ—¶ä½ 1.6 åŸºäºRediså®ç°å…±äº«Sessionç™»å½•æµç¨‹å‘é€çŸ­ä¿¡éªŒè¯ç ï¼š å¯ä»¥é‡‡ç”¨Stringæ•°æ®ç±»å‹å­˜å‚¨ï¼š key value æ‰‹æœºå· éªŒè¯ç  çŸ­ä¿¡éªŒè¯ç™»å½•ã€æ³¨å†Œï¼š ä¿å­˜ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨Stringç»“æ„ï¼Œä»¥jsonå­—ç¬¦ä¸²æ¥ä¿å­˜ï¼Œæ¯”è¾ƒç›´è§‚ Hashç»“æ„å¯ä»¥å°†å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå­—æ®µç‹¬ç«‹å­˜å‚¨ï¼Œå¯ä»¥é’ˆå¯¹å•ä¸ªå­—æ®µåšCRUDï¼Œå¹¶ä¸”å†…å­˜å ç”¨å°‘(æ¨è) ä¿å­˜ç”¨æˆ·åˆ°Redisï¼š key value éšæœºtokenä¸ºkeyå­˜å‚¨ç”¨æˆ·æ•°æ® {name:Tom} æ ¡éªŒç™»å½•çŠ¶æ€ï¼š 1.7 åŸºäºRediså®ç°çŸ­ä¿¡ç™»å½•*ä¿®æ”¹UserServiceImplä¸­çš„sendCodeæ–¹æ³•ï¼š 12345678910111213141516171819202122@Resourceprivate StringRedisTemplate stringRedisTemplate;@Overridepublic Result sendCode(String phone, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(phone)) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //ç¬¦åˆï¼Œç”ŸæˆéªŒè¯ç  String code = RandomUtil.randomNumbers(6); //ä¿å­˜éªŒè¯ç åˆ°Redisï¼Œè®¾ç½®æœ‰æ•ˆæœŸ stringRedisTemplate.opsForValue().set(RedisConstants.LOGIN_CODE_KEY +phone, //key code, //value RedisConstants.LOGIN_CODE_TTL, // 2 TimeUnit.MINUTES);//æŒ‡å®šå•ä½ä¸ºåˆ†é’Ÿ //å‘é€éªŒè¯ç ï¼Œæ¨¡æ‹Ÿä¸€ä¸‹ log.debug(&quot;å‘é€éªŒè¯ç æˆåŠŸï¼ŒéªŒè¯ç ä¸ºï¼š&quot;+code); //è¿”å›OK return Result.ok();&#125; ä¿®æ”¹UserServiceImplä¸­çš„loginæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041@Resourceprivate StringRedisTemplate stringRedisTemplate;@Overridepublic Result login(LoginFormDTO loginForm, HttpSession session) &#123; //æ ¡éªŒæ‰‹æœºå· if (RegexUtils.isPhoneInvalid(loginForm.getPhone())) &#123; //ä¸ç¬¦åˆï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;æ‰‹æœºå·æ ¼å¼é”™è¯¯&quot;); &#125; //æ ¡éªŒéªŒè¯ç  String code = stringRedisTemplate.opsForValue().get(RedisConstants.LOGIN_CODE_KEY + loginForm.getPhone()); if (code == null || !code.equals(loginForm.getCode())) &#123; //ä¸ä¸€è‡´ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ return Result.fail(&quot;éªŒè¯ç é”™è¯¯&quot;); &#125; //ä¸€è‡´ï¼ŒæŸ¥è¯¢æ‰‹æœºå·æ˜¯å¦å­˜åœ¨ User user = query().eq(&quot;phone&quot;, loginForm.getPhone()).one(); if (user == null) &#123; //ä¸å­˜åœ¨ï¼Œæ’å…¥åˆ°æ•°æ®åº“ï¼Œå®Œæˆæ³¨å†Œ user = createUserByPhone(loginForm.getPhone()); &#125; //éšæœºç”Ÿæˆç™»å½•ä»¤ç‰Œtokenï¼Œ String token = UUID.randomUUID().toString(true); //å°†Userå¯¹è±¡è½¬æˆUserDtoåœ¨è½¬æ¢æˆMapæ•°æ®ç±»å‹ UserDTO userDTO = BeanUtil.copyProperties(user, UserDTO.class); //mapæ•°æ®ç±»å‹çš„é”®å€¼å¯¹éƒ½éœ€è¦æ˜¯Stringç±»å‹çš„ Map&lt;String, Object&gt; userMap = BeanUtil.beanToMap(userDTO, new HashMap&lt;&gt;(), CopyOptions.create().setIgnoreNullValue(true) //å¿½ç•¥ç©ºçš„å€¼ .setFieldValueEditor((fieldName, fieldValue) -&gt; fieldValue.toString()));//æ‰€æœ‰valueå€¼è½¬æ¢ä¸ºString //ä¿å­˜ç”¨æˆ·åˆ°Redis String key = RedisConstants.LOGIN_USER_KEY + token; stringRedisTemplate.opsForHash().putAll(key, userMap); //è®¾ç½®æœ‰æ•ˆæœŸ30åˆ†é’Ÿ stringRedisTemplate.expire(key, //key RedisConstants.LOGIN_USER_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //è¿”å›token return Result.ok(token); &#125; MVcConfigé…ç½®ç±»ä¸­æ³¨å…¥StringRedisTemplateï¼š 12345678910111213141516171819@Configurationpublic class MvcConfig implements WebMvcConfigurer &#123; @Resource private StringRedisTemplate stringRedisTemplate; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(new LoginInterceptor(stringRedisTemplate)) .excludePathPatterns( //æ’é™¤è·¯å¾„ &quot;/user/login&quot;, &quot;/user/code&quot;, &quot;/shop/**&quot;, &quot;/shop-type/**&quot;, &quot;/blog/hot&quot;, &quot;/upload/**&quot;, &quot;/voucher/**&quot; ); &#125;&#125; LoginInterceptorä¸­è·å–Redisä¸­çš„æ•°æ®ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public class LoginInterceptor implements HandlerInterceptor &#123; private StringRedisTemplate stringRedisTemplate; public LoginInterceptor(StringRedisTemplate stringRedisTemplate) &#123; this.stringRedisTemplate = stringRedisTemplate; &#125; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //è·å–tokenï¼Œå‰ç«¯ä¼šå°†tokenæ”¾å…¥åˆ°è¯·æ±‚å¤´ä¸­ String token = request.getHeader(&quot;authorization&quot;); if (StrUtil.isBlank(token)) &#123; //è¿”å›çŠ¶æ€ç 401ï¼Œæœªæˆæƒ response.setStatus(401); return false; &#125; //è·å–ç”¨æˆ·ä¿¡æ¯ Map&lt;Object, Object&gt; userMap = stringRedisTemplate.opsForHash().entries(RedisConstants.LOGIN_USER_KEY + token); //ä¸å­˜åœ¨ï¼Œæ‹¦æˆª if (userMap.isEmpty())&#123; //è¿”å›çŠ¶æ€ç 401ï¼Œæœªæˆæƒ response.setStatus(401); return false; &#125; //å°†mapè½¬æ¢æˆUserDto UserDTO user = BeanUtil.fillBeanWithMap(userMap,new UserDTO(),false); //å­˜åœ¨ï¼Œä¿å­˜åˆ°TheadLocal UserHolder.saveUser(user); //åˆ·æ–°æœ‰æ•ˆæœŸ stringRedisTemplate.expire(RedisConstants.LOGIN_USER_KEY + token, //key RedisConstants.LOGIN_USER_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //æ”¾è¡Œ return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; //ç§»é™¤ç”¨æˆ· UserHolder.removeUser(); &#125;&#125; 1.8 è§£å†³çŠ¶æ€ç™»å½•åˆ·æ–°é—®é¢˜æ‹¦æˆªå™¨ è·å–token æŸ¥è¯¢Redisçš„ç”¨æˆ·ä¿¡æ¯ ä¸å­˜åœ¨ï¼Œåˆ™æ‹¦æˆª å­˜åœ¨ï¼Œåˆ™ç»§ç»­ ä¿å­˜åˆ°ThreadLocal åˆ·æ–°tokençš„æœ‰æ•ˆæœŸ æ”¾è¡Œ æ‹¦æˆªå™¨åªä¼šæ‹¦æˆªç™»å½•çš„è·¯å¾„ï¼Œä»è€Œåˆ·æ–°tokenæœ‰æ•ˆæœŸã€‚ ä½†æ˜¯å…¶ä»–çš„ä¸€äº›ä¸éœ€è¦ç™»å½•ä¹Ÿå¯ä»¥æŸ¥çœ‹çš„é¡µé¢ï¼Œæ¯”å¦‚é¦–é¡µï¼Œåˆ™ä¸ä¼šåˆ·æ–°tokenæœ‰æ•ˆæœŸã€‚ æœ‰å¯èƒ½é•¿æ—¶é—´æŸ¥çœ‹å…¶ä»–é¡µé¢ï¼Œå¯¼è‡´åœ¨æŸ¥çœ‹éœ€è¦ç™»å½•çš„è·¯å¾„ï¼Œtokenè¿‡äº†æœ‰æ•ˆæœŸï¼Œéœ€è¦é‡æ–°ç™»å½•çš„é—®é¢˜ sequenceDiagram ç”¨æˆ·-->>æ‹¦æˆªå™¨1:å‘é€è¯·æ±‚ note over æ‹¦æˆªå™¨1:æ‹¦æˆªä¸€åˆ‡è·¯å¾„1. è·å–token2. æŸ¥è¯¢Redisçš„ç”¨æˆ·3. ä¿å­˜åˆ°ThreadLocal4. åˆ·æ–°tokençš„æœ‰æ•ˆæœŸ5. æ”¾è¡Œ æ‹¦æˆªå™¨1->>æ‹¦æˆªå™¨2:è¿›å…¥ note over æ‹¦æˆªå™¨2:æ‹¦æˆªéœ€è¦ç™»å½•çš„è·¯å¾„æŸ¥çœ‹tokenå­˜åœ¨ï¼Œåˆ™æ‹¦æˆªä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­ æ‹¦æˆªå™¨2->>UserController:è¿›å…¥ RefreshTokenInterceptorä¸­ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public class RefreshTokenInterceptor implements HandlerInterceptor &#123; private StringRedisTemplate stringRedisTemplate; public RefreshTokenInterceptor(StringRedisTemplate stringRedisTemplate) &#123; this.stringRedisTemplate = stringRedisTemplate; &#125; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //è·å–token String token = request.getHeader(&quot;authorization&quot;); //tokenä¸å­˜åœ¨ï¼Œç›´æ¥æ”¾è¡Œï¼Œä¸æ·»åŠ åˆ°ThreadLocal if (StrUtil.isBlank(token)) &#123; return true; &#125; //è·å–ç”¨æˆ·ä¿¡æ¯ Map&lt;Object, Object&gt; userMap = stringRedisTemplate.opsForHash().entries(RedisConstants.LOGIN_USER_KEY + token); //ç”¨æˆ·ä¿¡æ¯ä¸å­˜åœ¨ï¼Œç›´æ¥æ”¾è¡Œï¼Œä¸æ·»åŠ åˆ°ThreadLocal if (userMap.isEmpty())&#123; return true; &#125; //å°†mapè½¬æ¢æˆUserDto UserDTO user = BeanUtil.fillBeanWithMap(userMap,new UserDTO(),false); //ä¿å­˜åˆ°TheadLocal UserHolder.saveUser(user); //åˆ·æ–°æœ‰æ•ˆæœŸ stringRedisTemplate.expire(RedisConstants.LOGIN_USER_KEY + token, //key RedisConstants.LOGIN_USER_TTL, // 30 TimeUnit.MINUTES); //åˆ†é’Ÿ //æ”¾è¡Œ return true; &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; //ç§»é™¤ç”¨æˆ· UserHolder.removeUser(); &#125;&#125; LoginInterceptorä¸­ï¼š 1234567891011121314public class LoginInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; //åˆ¤æ–­ThreadLocalæ˜¯å¦å­˜åœ¨ç”¨æˆ· if (UserHolder.getUser() == null)&#123; //æ²¡æœ‰ï¼Œæ‹¦æˆªï¼Œè®¾ç½®çŠ¶æ€ç  response.setStatus(401); return false; &#125; //æœ‰ç”¨æˆ·æ”¾è¡Œ return true; &#125;&#125; MvcConfigé…ç½®ç±»ä¸­ï¼š 123456789101112131415161718192021222324@Configurationpublic class MvcConfig implements WebMvcConfigurer &#123; @Resource private StringRedisTemplate stringRedisTemplate; @Override public void addInterceptors(InterceptorRegistry registry) &#123; //tokenåˆ·æ–°æ‹¦æˆªå™¨ registry.addInterceptor(new RefreshTokenInterceptor(stringRedisTemplate)) .addPathPatterns(&quot;/**&quot;) //æ‹¦æˆªæ‰€æœ‰è·¯å¾„ .order(0); // æ³¨å†Œé¡ºåºä¸º0 //ç™»å½•æ‹¦æˆªå™¨ registry.addInterceptor(new LoginInterceptor()) .excludePathPatterns( //æ’é™¤è·¯å¾„ &quot;/user/login&quot;, &quot;/user/code&quot;, &quot;/shop/**&quot;, &quot;/shop-type/**&quot;, &quot;/blog/hot&quot;, &quot;/upload/**&quot;, &quot;/voucher/**&quot; ).order(1); //æ³¨å†Œé¡ºåºä¸º1 &#125;&#125; 2.å•†æˆ·æŸ¥è¯¢ç¼“å­˜3.è¾¾äººæ¢åº—4.ä¼˜æƒ åˆ¸ç§’æ€5.å¥½å‹å…³æ³¨6.é™„è¿‘çš„å•†æˆ·7.ç”¨æˆ·ç­¾åˆ°8.UVç»Ÿè®¡é«˜çº§ç¯‡åŸç†ç¯‡st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå· cond=>condition: æ ¡éªŒæ‰‹æœºå· code=>operation: ç”ŸæˆéªŒè¯ç  save=>operation: éªŒè¯ç ä¿å­˜åˆ°Session send=>operation: å‘é€éªŒè¯ç  e=>end: ç»“æŸ st->op->cond(yes)->code->save->send->e cond(no)->op{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-0-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-0-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-0\", options);st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå·å’ŒéªŒè¯ç  cond1=>condition: æ ¡éªŒéªŒè¯ç  code=>operation: æ ¹æ®æ‰‹æœºå·æŸ¥è¯¢ç”¨æˆ· cond2=>condition: ç”¨æˆ·æ˜¯å¦å­˜åœ¨ login=>operation: ç™»å½• register=>operation: åˆ›å»ºæ–°ç”¨æˆ· save1=>operation: ä¿å­˜ç”¨æˆ·åˆ°Session save2=>operation: ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“ e=>end: ç»“æŸ st->op->cond1(yes)->code->cond2(yes)->login->save1->e cond1(no)->op cond2(no)->register->save2->save1{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-1-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-1-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-1\", options);st=>start: å¼€å§‹ op=>operation: è¯·æ±‚å¹¶æºå¸¦cookie get=>operation: ä»Sessionè·å–ç”¨æˆ· cond=>condition: åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ save=>operation: ä¿å­˜ç”¨æˆ·åˆ°TreadLocal pass=>operation: æ”¾è¡Œ intercept=>operation: æ‹¦æˆª e=>end: ç»“æŸ st->op->get->cond(yes)->save->pass->e cond(no)->intercept->e{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-2-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-2-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-2\", options);st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå· cond=>condition: æ ¡éªŒæ‰‹æœºå· code=>operation: ç”ŸæˆéªŒè¯ç  save=>operation: éªŒè¯ç ä¿å­˜åˆ°Redis send=>operation: å‘é€éªŒè¯ç  e=>end: ç»“æŸ st->op->cond(yes)->code->save->send->e cond(no)->op{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-3-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-3-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-3\", options);st=>start: å¼€å§‹ op=>operation: æäº¤æ‰‹æœºå·å’ŒéªŒè¯ç  cond1=>condition: æ ¡éªŒéªŒè¯ç  code=>operation: æ ¹æ®æ‰‹æœºå·æŸ¥è¯¢ç”¨æˆ· cond2=>condition: ç”¨æˆ·æ˜¯å¦å­˜åœ¨ login=>operation: ç™»å½• register=>operation: åˆ›å»ºæ–°ç”¨æˆ· save1=>operation: ä¿å­˜ç”¨æˆ·åˆ°Redis save2=>operation: ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“ back=>operation: è¿”å›tokenç»™å®¢æˆ·ç«¯ e=>end: ç»“æŸ st->op->cond1(yes)->code->cond2(yes)->login->save1->back->e cond1(no)->op cond2(no)->register->save2->save1{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-4-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-4-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-4\", options);st=>start: å¼€å§‹ op=>operation: è¯·æ±‚å¹¶æºå¸¦token get=>operation: ä»Redisè·å–ç”¨æˆ· cond=>condition: åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ save=>operation: ä¿å­˜ç”¨æˆ·åˆ°TreadLocal pass=>operation: æ”¾è¡Œ intercept=>operation: æ‹¦æˆª e=>end: ç»“æŸ st->op->get->cond(yes)->save->pass->e cond(no)->intercept->e{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12} var code = document.getElementById(\"flowchart-5-code\").value; var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-5-options\").value)); var diagram = flowchart.parse(code); diagram.drawSVG(\"flowchart-5\", options);","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"(æ¯æ—¥LeetCode)556. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III","slug":"æ¯æ—¥LeetCode/2022-7/556 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III","date":"2022-07-03T04:00:00.000Z","updated":"2022-07-08T00:35:35.528Z","comments":true,"path":"2022/07/03/æ¯æ—¥LeetCode/2022-7/556 ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  III/","link":"","permalink":"http://example.com/2022/07/03/%E6%AF%8F%E6%97%A5LeetCode/2022-7/556%20%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E5%85%83%E7%B4%A0%20III/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ­£æ•´æ•° n ï¼Œè¯·ä½ æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„æœ€å°æ•´æ•°ï¼Œå…¶ç”±é‡æ–°æ’åˆ— n ä¸­å­˜åœ¨çš„æ¯ä½æ•°å­—ç»„æˆï¼Œå¹¶ä¸”å…¶å€¼å¤§äº n ã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„æ­£æ•´æ•°ï¼Œåˆ™è¿”å› -1 ã€‚ æ³¨æ„ ï¼Œè¿”å›çš„æ•´æ•°åº”å½“æ˜¯ä¸€ä¸ª 32 ä½æ•´æ•° ï¼Œå¦‚æœå­˜åœ¨æ»¡è¶³é¢˜æ„çš„ç­”æ¡ˆï¼Œä½†ä¸æ˜¯ 32 ä½æ•´æ•° ï¼ŒåŒæ ·è¿”å› -1ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šn &#x3D; 12324321è¾“å‡ºï¼š12331224 ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šn &#x3D; 21è¾“å‡ºï¼š-1 æ€è·¯ï¼šä»¥n = 12324321ä¸ºä¾‹ â‘ .pos1æŒ‡é’ˆä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°ç¬¬pos1ä½ç½®çš„æ•°æ¯”åé¢çš„æ•°å°çš„ä½ç½®ï¼Œpos1è®°å½•ä½ç½® 1 2 3 2 4 3 2 1 $\\leftarrow\\Uparrow$pos1 2ä¸1æ¯”è¾ƒï¼Œ2å¤§ï¼Œpos1å‘å·¦ç§» å¾ªç¯ç›´åˆ°ï¼š 1 2 3 2 4 3 2 1 $\\leftarrow\\Uparrow$pos1 2ä¸4æ¯”è¾ƒï¼Œ2å°ï¼Œè®°å½•pos1çš„ä½ç½® â‘¡.å†å®šä¹‰pos2æŒ‡é’ˆï¼Œä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°æ¯”pos1ä½ç½®åé¢çš„æ•°ä¸­ï¼Œæœ‰æ¯”pos1ä½ç½®çš„æ•°å¤§çš„æ•°ï¼Œç”¨pos2è®°å½•ä½ç½® 1 2 3 2 4 3 2 1 $\\Uparrow$pos1 $\\leftarrow\\Uparrow$pos2 pos1å¤§äºpos2ï¼Œpos2æŒ‡é’ˆå·¦ç§» å¾ªç¯ç›´åˆ°ï¼š 1 2 3 2 4 3 2 1 $\\Uparrow$pos1 $\\leftarrow\\Uparrow$pos2 pos1å°äºpos2ï¼Œè®°å½•æŒ‡é’ˆpos2ä½ç½® â‘¢.äº¤æ¢pos1å’Œpos2çš„ä½ç½® 1 2 3 3 4 2 2 1 â‘£.å°†pos1ä½ç½®åé¢çš„æ•°è¿›è¡Œåè½¬ 1 2 3 3 1 2 2 4 ç»“æœï¼š12331224 ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728class Solution &#123;public: int nextGreaterElement(int n) &#123; //å°†nè½¬æ¢æˆå­—ç¬¦ä¸² string num = to_string(n); int pos1 = num.size()-2; //ä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°å‰é¢çš„æ•°å°äºåé¢çš„æ•°ï¼Œå‰é¢æ•°çš„ä½ç½® while(pos1 &gt;= 0 &amp;&amp; num[pos1] &gt;= num[pos1+1])&#123; pos1--; &#125; //éå†åˆ°å­—ç¬¦ä¸²ç¬¬0ä¸ªä½ç½®ï¼Œè¿˜æ²¡æœ‰å°äºçš„æ•°ï¼Œåˆ™ä¸å­˜åœ¨ if(pos1 &lt; 0) return -1; int pos2 = num.size()-1; //ä»åå¾€å‰éå†ï¼Œæ‰¾åˆ°æœ‰æ¯”pos1ä½ç½®çš„æ•°å°çš„æ•°ï¼Œè¿”å›pos2ä½ç½® while(pos2 &gt; pos1 &amp;&amp; num[pos1] &gt;= num[pos2])&#123; pos2--; &#125; //äº¤æ¢ä¸¤ä¸ªä½ç½®çš„æ•° swap(num[pos1],num[pos2]); //å°†pos1åé¢çš„å­—ç¬¦ä¸²åè½¬ reverse(num.begin() + pos1 + 1, num.end()); //é˜²æ­¢æº¢å‡ºï¼Œå…ˆå°†tempè½¬æ¢æˆlongå‹ long temp = stol(num); //å¦‚æœè¶…å‡ºintçš„èŒƒå›´ï¼Œè¿”å›-1 if(temp &gt; INT_MAX) return -1; return temp; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(logn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)871. æœ€ä½åŠ æ²¹æ¬¡æ•°","slug":"æ¯æ—¥LeetCode/2022-7/871 æœ€ä½åŠ æ²¹æ¬¡æ•°","date":"2022-07-02T07:36:00.000Z","updated":"2022-07-08T00:35:45.486Z","comments":true,"path":"2022/07/02/æ¯æ—¥LeetCode/2022-7/871 æœ€ä½åŠ æ²¹æ¬¡æ•°/","link":"","permalink":"http://example.com/2022/07/02/%E6%AF%8F%E6%97%A5LeetCode/2022-7/871%20%E6%9C%80%E4%BD%8E%E5%8A%A0%E6%B2%B9%E6%AC%A1%E6%95%B0/","excerpt":"","text":"é¢˜ç›®ï¼šæ±½è½¦ä»èµ·ç‚¹å‡ºå‘é©¶å‘ç›®çš„åœ°ï¼Œè¯¥ç›®çš„åœ°ä½äºå‡ºå‘ä½ç½®ä¸œé¢ target è‹±é‡Œå¤„ã€‚ æ²¿é€”æœ‰åŠ æ²¹ç«™ï¼Œæ¯ä¸ª station[i] ä»£è¡¨ä¸€ä¸ªåŠ æ²¹ç«™ï¼Œå®ƒä½äºå‡ºå‘ä½ç½®ä¸œé¢ station[i][0] è‹±é‡Œå¤„ï¼Œå¹¶ä¸”æœ‰ station[i][1]å‡æ±½æ²¹ã€‚ å‡è®¾æ±½è½¦æ²¹ç®±çš„å®¹é‡æ˜¯æ— é™çš„ï¼Œå…¶ä¸­æœ€åˆæœ‰startFuelå‡ç‡ƒæ–™ã€‚å®ƒæ¯è¡Œé©¶ 1 è‹±é‡Œå°±ä¼šç”¨æ‰ 1 å‡æ±½æ²¹ã€‚ å½“æ±½è½¦åˆ°è¾¾åŠ æ²¹ç«™æ—¶ï¼Œå®ƒå¯èƒ½åœä¸‹æ¥åŠ æ²¹ï¼Œå°†æ‰€æœ‰æ±½æ²¹ä»åŠ æ²¹ç«™è½¬ç§»åˆ°æ±½è½¦ä¸­ã€‚ ä¸ºäº†åˆ°è¾¾ç›®çš„åœ°ï¼Œæ±½è½¦æ‰€å¿…è¦çš„æœ€ä½åŠ æ²¹æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿå¦‚æœæ— æ³•åˆ°è¾¾ç›®çš„åœ°ï¼Œåˆ™è¿”å› -1 ã€‚ æ³¨æ„ï¼šå¦‚æœæ±½è½¦åˆ°è¾¾åŠ æ²¹ç«™æ—¶å‰©ä½™ç‡ƒæ–™ä¸º 0ï¼Œå®ƒä»ç„¶å¯ä»¥åœ¨é‚£é‡ŒåŠ æ²¹ã€‚å¦‚æœæ±½è½¦åˆ°è¾¾ç›®çš„åœ°æ—¶å‰©ä½™ç‡ƒæ–™ä¸º 0ï¼Œä»ç„¶è®¤ä¸ºå®ƒå·²ç»åˆ°è¾¾ç›®çš„åœ°ã€‚ ç¤ºä¾‹ï¼šç¤ºä¾‹1ï¼š è¾“å…¥ï¼štarget &#x3D; 100, startFuel &#x3D; 1, stations &#x3D; [[10,100]]è¾“å‡ºï¼š-1è§£é‡Šï¼šæˆ‘ä»¬æ— æ³•æŠµè¾¾ç›®çš„åœ°ï¼Œç”šè‡³æ— æ³•åˆ°è¾¾ç¬¬ä¸€ä¸ªåŠ æ²¹ç«™ã€‚ ç¤ºä¾‹2ï¼š è¾“å…¥ï¼štarget &#x3D; 100, startFuel &#x3D; 10, stations &#x3D; [[10,60],[20,30],[30,30],[60,40]]è¾“å‡ºï¼š2è§£é‡Šï¼šæˆ‘ä»¬å‡ºå‘æ—¶æœ‰ 10 å‡ç‡ƒæ–™ã€‚æˆ‘ä»¬å¼€è½¦æ¥åˆ°è·èµ·ç‚¹ 10 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™ï¼Œæ¶ˆè€— 10 å‡ç‡ƒæ–™ã€‚å°†æ±½æ²¹ä» 0 å‡åŠ åˆ° 60 å‡ã€‚ç„¶åï¼Œæˆ‘ä»¬ä» 10 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™å¼€åˆ° 60 è‹±é‡Œå¤„çš„åŠ æ²¹ç«™ï¼ˆæ¶ˆè€— 50 å‡ç‡ƒæ–™ï¼‰ï¼Œå¹¶å°†æ±½æ²¹ä» 10 å‡åŠ åˆ° 50 å‡ã€‚ç„¶åæˆ‘ä»¬å¼€è½¦æŠµè¾¾ç›®çš„åœ°ã€‚æˆ‘ä»¬æ²¿é€”åœ¨1ä¸¤ä¸ªåŠ æ²¹ç«™åœé ï¼Œæ‰€ä»¥è¿”å› 2 ã€‚ æ€è·¯ï¼š ä¸€ã€å›æº¯æ³•ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930class Solution &#123;public: int def(vector&lt;vector&lt;int&gt;&gt;&amp; stations,int cur_station, int begin, int&amp; end, int oil)&#123; //åˆ°è¾¾ç›®çš„åœ° if(oil+begin &gt;= end) return 0; //æ²¹é‡ä¸å¤Ÿåˆ°è¾¾ç›®çš„åœ° if(cur_station+1 == stations.size() &amp;&amp; oil+begin &lt; end)&#123; return -1; &#125; //æ²¹é‡ä¸å¤Ÿåˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™ if(cur_station+1 &lt; stations.size() &amp;&amp; oil+begin &lt; stations[cur_station+1][0])&#123; return -1; &#125; int ans = INT_MAX; for(int i = cur_station+1; i &lt; stations.size(); i++)&#123; if(stations[i][0] &lt;= begin+oil)&#123; int temp = def(stations, i, stations[i][0] ,end ,oil+begin-stations[i][0]+stations[i][1]); if(temp != -1 &amp;&amp; ans &gt; temp+1) ans = temp+1; &#125; &#125; if(ans == INT_MAX) ans = -1; return ans; &#125; int minRefuelStops(int target, int startFuel, vector&lt;vector&lt;int&gt;&gt;&amp; stations) &#123; //å‡ºå‘åœ°æ²¡æœ‰åŠ æ²¹ç«™ï¼Œç¬¬ä¸€ä¸ªåŠ æ²¹ç«™ç¼–å·ä¸º0ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸º-1 return def(stations, -1, 0, target, startFuel); &#125;&#125;; è¿è¡Œè¶…æ—¶ äºŒã€è´ªå¿ƒæ€è·¯ï¼šå¦‚æœä¸éœ€è¦åŠ æ²¹å°±å¾€å‰èµ°ï¼Œå½“ä¸å¤Ÿåˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™æˆ–ç›®çš„åœ°ï¼Œå°±ä»ä¹‹å‰èµ°åˆ°è¿‡çš„åŠ æ²¹ç«™ä¹‹ä¸­é€‰æ‹©æ±½æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™è¿›è¡Œè¡¥å……æ±½æ²¹ã€‚ ä»¥æ­¤å¾€å¤ï¼Œåˆ°è¾¾ç›®çš„åœ°ã€‚ å¦‚æœæ‰€æœ‰åŠ æ²¹ç«™çš„æ±½æ²¹éƒ½è¢«åŠ å®Œï¼Œå¹¶ä¸”æ²¡åˆ°è¾¾ç›®çš„åœ°ï¼Œåˆ™ä¸å¯èƒ½åˆ°è¾¾ã€‚ ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829303132class Solution &#123;public: int minRefuelStops(int target, int startFuel, vector&lt;vector&lt;int&gt;&gt;&amp; stations) &#123; priority_queue&lt;int&gt; pq; int count = 0; //åˆå§‹åŒ–åŠ æ²¹æ¬¡æ•° int begin = 0; //åˆå§‹åŒ–è·¯ç¨‹ int cur_fuel = startFuel;//åˆå§‹åŒ–è½¦çš„æ±½æ²¹é‡ int cur_distance; //è¡¨ç¤ºå½“å‰çš„è·¯ç¨‹ for (int i = 0; i &lt;= stations.size(); i++) &#123; if(i &lt; stations.size()) cur_distance = stations[i][0]; else cur_distance = target; //(cur_distance - begin)ï¼šè¡¨ç¤ºç¬¬i-1ä¸ªåŠ æ²¹ç«™åˆ°ç¬¬iä¸ªåŠ æ²¹ç«™ä¹‹é—´çš„è·¯ç¨‹ï¼Œcur_fuelä¸ºåˆ°ç¬¬iä¸ªåŠ æ²¹ç«™æ—¶å‰©ä½™çš„æ²¹é‡ cur_fuel -= cur_distance - begin; //å¦‚æœæ²¹é‡ä¸ºè´Ÿæ•°ï¼Œè¯´æ˜éœ€è¦ä»ç¬¬iä¸ªåŠ æ²¹ç«™ï¼Œä¹‹å‰çš„åŠ æ²¹ç«™ä¹‹ä¸­é€‰æ‹©åŠ æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™ï¼Œè¿›è¡Œè¡¥å……æ±½æ²¹ while (cur_fuel &lt; 0 &amp;&amp; !pq.empty()) &#123; cur_fuel += pq.top();//é€‰æ‹©æ±½æ²¹é‡æœ€å¤šçš„åŠ æ²¹ç«™è¡¥å…… pq.pop(); count++;//åŠ æ²¹æ¬¡æ•°åŠ 1 &#125; //éƒ½å·²ç»æŠŠä¹‹å‰çš„åŠ æ²¹ç«™çš„æ±½æ²¹éƒ½è¡¥å……äº†ï¼Œè¿˜æ˜¯è´Ÿæ•°è¯´æ˜æ— æ³•åˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ æ²¹ç«™æˆ–ç›®çš„åœ° if (cur_fuel &lt; 0) &#123; return -1; &#125; if (i &lt; stations.size()) &#123; //å°†ç¬¬iä¸ªåŠ æ²¹ç«™çš„æ±½æ²¹é‡è®°å½•ï¼Œç°åœ¨ä¸éœ€è¦åŠ æ²¹ï¼Œç­‰ä»¥åç¼ºæ²¹å†åŠ  pq.emplace(stations[i][1]); begin = cur_distance;//æ›´æ–°è·¯ç¨‹ &#125; &#125; return count; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ stations çš„é•¿åº¦ã€‚éœ€è¦éå†æ•°ç»„ stations ä¸€æ¬¡ï¼Œæ¯ä¸ªåŠ æ²¹ç«™çš„æ±½æ²¹é‡æœ€å¤šæ·»åŠ åˆ°ä¼˜å…ˆé˜Ÿåˆ—å’Œä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­ç§»é™¤å„ä¸€æ¬¡ï¼Œæ¯æ¬¡ä¼˜å…ˆé˜Ÿåˆ—çš„æ“ä½œéœ€è¦ O(logn) çš„æ—¶é—´ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogn)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„ stations çš„é•¿åº¦ã€‚ä¼˜å…ˆé˜Ÿåˆ—éœ€è¦ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"vectorå®¹å™¨ç”¨æ³•","slug":"C++/vecterå®¹å™¨","date":"2022-06-30T09:00:00.000Z","updated":"2022-07-05T03:52:02.168Z","comments":true,"path":"2022/06/30/C++/vecterå®¹å™¨/","link":"","permalink":"http://example.com/2022/06/30/C++/vecter%E5%AE%B9%E5%99%A8/","excerpt":"","text":"vectoræ˜¯ä»€ä¹ˆï¼Ÿvectoræ˜¯ä¸€ä¸ªèƒ½å¤Ÿå­˜æ”¾ä»»æ„ç±»å‹çš„åŠ¨æ€æ•°ç»„ã€‚ vectorå®ç°åŠ¨æ€å¢é•¿çš„åŸç†ï¼švectorçš„åŸç†å°±æ˜¯åŠ¨æ€æ•°ç»„ã€‚å½“æ’å…¥æ–°å…ƒç´ çš„æ—¶å€™ï¼Œå¦‚æœç©ºé—´ä¸è¶³ï¼Œé‚£ä¹ˆvectorä¼šé‡æ–°ç”³è¯·æ›´å¤§çš„ä¸€å—ç©ºé—´ï¼Œå°†åŸç©ºé—´æ•°æ®æ‹·è´åˆ°æ–°ç©ºé—´ï¼Œé‡Šæ”¾æ—§ç©ºé—´æ•°æ®ï¼Œå†æŠŠæ–°å…ƒç´ æ’å…¥æ–°ç”³è¯·ç©ºé—´ã€‚ éœ€è¦å¯¼å…¥å¤´æ–‡ä»¶ï¼š 12#include&lt;vector&gt;using namespace std; æ„é€ å‡½æ•°ï¼š æ„é€ å‡½æ•° è§£é‡Š vector() åˆ›å»ºä¸€ä¸ªç©ºçš„vector vector(int size) åˆ›å»ºä¸€ä¸ªvector,å…ƒç´ ä¸ªæ•°ä¸ºsizeï¼Œä¸”å€¼å‡ä¸º0(é»˜è®¤ä¸º0) vector(int size, T value) åˆ›å»ºä¸€ä¸ªvectorï¼Œå…ƒç´ ä¸ªæ•°ä¸ºsize,ä¸”å€¼å‡ä¸ºvalue vector(const vector&amp; v) å¦ä¸€ä¸ªvectorå®¹å™¨æ‹·è´åˆ°è¿™ä¸ªvectorä¸­ vector(iterator begin(), iterator end()) å¦ä¸€ä¸ª[begin,end)åŒºé—´å†…çš„æ•°ç»„å…ƒç´ çš„å¤åˆ¶è¿™ä¸ªvectorä¸­ æˆå‘˜å‡½æ•°ï¼š æ’å…¥å‡½æ•° è§£é‡Š void push_back(const T&amp; x) å®¹å™¨å°¾éƒ¨æ’å…¥ä¸€ä¸ªå…ƒç´ X void emplace_back(const T&amp; x) å®¹å™¨å°¾éƒ¨æ’å…¥ä¸€ä¸ªå…ƒç´ Xï¼Œæ¯”push_back()æ•ˆç‡é«˜ iterator insert(iterator it,const T&amp; x) å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥ä¸€ä¸ªå…ƒç´ x iterator insert(iterator it,int n,const T&amp; x) å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥nä¸ªç›¸åŒçš„å…ƒç´ x iterator insert(iterator it,const_iterator first,const_iterator last) å‘é‡ä¸­è¿­ä»£å™¨æŒ‡å‘å…ƒç´ çš„å‰é¢æ’å…¥å¦ä¸€ä¸ªç›¸åŒç±»å‹çš„vectorå®¹å™¨çš„[first,last)é—´çš„æ•°æ® åˆ é™¤å‡½æ•° è§£é‡Š iterator erase(iterator it) åˆ é™¤å®¹å™¨ä¸­è¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´  iterator erase(iterator first,iterator last) åˆ é™¤å®¹å™¨ä¸­[first,last)ä¸­çš„å…ƒç´  void pop_back() åˆ é™¤å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´  void clear() æ¸…ç©ºå®¹å™¨ä¸­æ‰€æœ‰å…ƒç´  éå†å‡½æ•° è§£é‡Š T at(int pos) è¿”å›posä½ç½®çš„å…ƒç´ (ç¬¬ä¸€ä¸ªä½ç½®ä¸º0) T front() è¿”å›é¦–å…ƒç´  T back() è¿”å›å°¾å…ƒç´  iterator begin() è¿”å›vectorå®¹å™¨ä¸­æŒ‡å‘çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ iterator end() è¿”å›vectorå®¹å™¨ä¸­æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®çš„è¿­ä»£å™¨ reverse_iterator rbegin() åå‘è¿­ä»£å™¨ï¼ŒæŒ‡å‘å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´  reverse_iterator rend() åå‘è¿­ä»£å™¨ï¼ŒæŒ‡å‘å®¹å™¨ç¬¬ä¸€ä¸ªå…ƒç´ å‰é¢çš„ä½ç½® å¤§å°å‡½æ•° è§£é‡Š int size() è¿”å›vectorå®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•° int capacity() è¿”å›å½“å‰vectorå®¹å™¨æ‰€èƒ½å®¹çº³çš„æœ€å¤§å®¹é‡ int max_size() è¿”å›vectorå®¹å™¨çš„æœ€å¤§å¯å…è®¸çš„å®¹é‡ void resize(int size) æ›´æ”¹vectorå®¹å™¨çš„å…ƒç´ çš„ä¸ªæ•°ä¸ºsize void reserve(int capacity) æ›´æ”¹vectorå®¹å™¨çš„å®¹é‡ä¸ºcapacity èµ‹å€¼å‡½æ•° è§£é‡Š vector&amp; operator&#x3D; å°†å³è¾¹vectorå®¹å™¨çš„å…ƒç´ æ‹·è´åˆ°å·¦è¾¹vectorå®¹å™¨ä¸­ void assign(int n,const T&amp; x) è®¾ç½®å®¹å™¨ä¸­å‰nä¸ªå…ƒç´ çš„å€¼ä¸ºx void assign(const_iterator first,const_iterator last) å°†å¦ä¸€ä¸ªvectorå®¹å™¨ä¸­[first,last)ä¸­å…ƒç´ è®¾ç½®æˆå½“å‰vectorå®¹å™¨çš„å…ƒç´  å…¶ä»–å‡½æ•° è§£é‡Š bool empty() åˆ¤æ–­å‘é‡æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ºç©ºï¼Œåˆ™è¿”å›çœŸ void swap(vector&amp; v) å°†ä¸¤ä¸ªåŒç±»å‹vectorå®¹å™¨çš„å…ƒç´ äº’æ¢ vectorçš„éå†ï¼š123for(int i = 0; i &lt; v.size(); i++)&#123; cout &lt;&lt; v[i] &lt;&lt; endl;&#125; 123for (int i = 0; i &lt; v.size(); i++)&#123; cout &lt;&lt; v1.at(i) &lt;&lt; endl;&#125; 123for (vector&lt;int&gt;::iterator it = v.begin(); it != v.end(); it++)&#123; cout &lt;&lt; *it &lt;&lt; endl;&#125; 123for (auto it = v.begin(); it != v.end(); it++)&#123; cout &lt;&lt; *it &lt;&lt; endl;&#125;","categories":[{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"}],"tags":[{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"}]},{"title":"(æ¯æ—¥LeetCode)1175. è´¨æ•°æ’åˆ—","slug":"æ¯æ—¥LeetCode/2022-6/1175 è´¨æ•°æ’åˆ—","date":"2022-06-30T03:09:00.000Z","updated":"2022-07-08T00:35:49.057Z","comments":true,"path":"2022/06/30/æ¯æ—¥LeetCode/2022-6/1175 è´¨æ•°æ’åˆ—/","link":"","permalink":"http://example.com/2022/06/30/%E6%AF%8F%E6%97%A5LeetCode/2022-6/1175%20%E8%B4%A8%E6%95%B0%E6%8E%92%E5%88%97/","excerpt":"","text":"é¢˜ç›®ï¼šè¯·ä½ å¸®å¿™ç»™ä» 1 åˆ° n çš„æ•°è®¾è®¡æ’åˆ—æ–¹æ¡ˆï¼Œä½¿å¾—æ‰€æœ‰çš„ã€Œè´¨æ•°ã€éƒ½åº”è¯¥è¢«æ”¾åœ¨ã€Œè´¨æ•°ç´¢å¼•ã€ï¼ˆç´¢å¼•ä» 1 å¼€å§‹ï¼‰ä¸Šï¼›ä½ éœ€è¦è¿”å›å¯èƒ½çš„æ–¹æ¡ˆæ€»æ•°ã€‚ç”±äºç­”æ¡ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼Œæ‰€ä»¥è¯·ä½ è¿”å›ç­”æ¡ˆ æ¨¡ mod $10^9$ + 7 ä¹‹åçš„ç»“æœå³å¯ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šn &#x3D; 5è¾“å‡ºï¼š12 è§£é‡Šï¼š å…ˆçœ‹è´¨æ•°å®šä¹‰ï¼šä¸€ä¸ªå¤§äº1çš„è‡ªç„¶æ•°ï¼Œé™¤äº†1å’Œå®ƒè‡ªèº«å¤–ï¼Œä¸èƒ½è¢«å…¶ä»–è‡ªç„¶æ•°æ•´é™¤çš„æ•°å«åšè´¨æ•°ã€‚(1ä¸æ˜¯è´¨æ•°) ç”¨çº¢è‰²æ ‡è®°è´¨æ•°ï¼š 1 2 3 4 5 é¢˜ç›®çš„æ„æ€æ˜¯å°†è´¨æ•°å’Œéè´¨æ•°å„åˆ†ä¸€ç»„ï¼Œè¿›è¡Œæ’åºä¸€å…±æœ‰å¤šå°‘ç§å¯èƒ½ï¼š mä¸ªæ•°æ’åˆ—mä¸ªä½ç½®ï¼Œå…¨æ’åˆ—å…¬å¼ï¼š$A^m_m&#x3D;m!$ $A^3_3$ä¸ºè´¨æ•°çš„æ‰€æœ‰æ’åˆ—æ¬¡æ•° $A^2_2$ä¸ºéè´¨æ•°çš„æ‰€æœ‰æ’åˆ—æ¬¡æ•° å¹¶ä¸”æ¯æœ‰ä¸€ä¸ªè´¨æ•°çš„æ’åˆ—ç»„åˆå°±æœ‰$A^2_2$æ¬¡éè´¨æ•°çš„æ’åˆ—ï¼š æ€»æ•°ï¼š$A^3_3 \\times A^2_2&#x3D;3! \\times 2!&#x3D;12$ æ€è·¯ï¼šéå†æ•°ç»„åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•°ï¼Œè®°å½•è´¨æ•°çš„ä¸ªæ•°pï¼Œéè´¨æ•°ä¸ªæ•°ä¸ºn-p è¿ç”¨å…¬å¼æ±‚å‡ºæ€»æ•°ï¼š$A^p_p \\times A^{n-p}_{n-p}&#x3D;p! \\times (n-p)!$ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627282930313233343536373839class Solution &#123;public: int mod = pow(10,9)+7; //åˆ¤æ–­æ˜¯å¦ä¸ºè´¨æ•° bool is_prime(int n)&#123; //ä»2å¼€å§‹ for(int i = 2; i*i &lt;= n;i++)&#123; //æ¨¡è¿ç®—ä¸º0ï¼Œä¸æ˜¯è´¨æ•° if(n%i == 0)&#123; return false; &#125; &#125; return true; &#125; //n!è¿ç®— Longç±»å‹é˜²æ­¢æº¢å‡º long factorial(int n)&#123; long sum = 1; for(int i = 2; i &lt;= n; i++)&#123; sum *=i; sum = sum%mod; &#125; return sum; &#125; int numPrimeArrangements(int n) &#123; int prime_num = 0; //ä»2å¼€å§‹ï¼Œ1ä¸æ˜¯è´¨æ•° for(int i = 2; i &lt;= n; i++)&#123; if(is_prime(i))&#123; prime_num++; &#125; &#125; //n!*(n-p)! long result = (factorial(prime_num)*factorial(n-prime_num))%mod; return (int)result; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO($n^{3&#x2F;2}$)ã€‚æ±‚ n ä¸ªæ•°ä¸­è´¨æ•°ä¸ªæ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º O($n^{3&#x2F;2}$)ï¼Œé˜¶ä¹˜çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º O($n^{3&#x2F;2}$)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)O(1)ï¼Œåªä½¿ç”¨äº†å¸¸æ•°ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)535. TinyURLçš„åŠ å¯†ä¸è§£å¯†","slug":"æ¯æ—¥LeetCode/2022-6/535 TinyURLçš„åŠ å¯†ä¸è§£å¯†","date":"2022-06-28T23:41:00.000Z","updated":"2022-07-02T07:51:52.081Z","comments":true,"path":"2022/06/29/æ¯æ—¥LeetCode/2022-6/535 TinyURLçš„åŠ å¯†ä¸è§£å¯†/","link":"","permalink":"http://example.com/2022/06/29/%E6%AF%8F%E6%97%A5LeetCode/2022-6/535%20TinyURL%E7%9A%84%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86/","excerpt":"","text":"é¢˜ç›®ï¼šTinyURL æ˜¯ä¸€ç§ URL ç®€åŒ–æœåŠ¡ï¼Œ æ¯”å¦‚ï¼šå½“ä½ è¾“å…¥ä¸€ä¸ª URL https://leetcode.com/problems/design-tinyurl æ—¶ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªç®€åŒ–çš„URL http://tinyurl.com/4e9iAk ã€‚è¯·ä½ è®¾è®¡ä¸€ä¸ªç±»æ¥åŠ å¯†ä¸è§£å¯† TinyURL ã€‚ åŠ å¯†å’Œè§£å¯†ç®—æ³•å¦‚ä½•è®¾è®¡å’Œè¿ä½œæ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œä½ åªéœ€è¦ä¿è¯ä¸€ä¸ª URL å¯ä»¥è¢«åŠ å¯†æˆä¸€ä¸ª TinyURL ï¼Œå¹¶ä¸”è¿™ä¸ª TinyURL å¯ä»¥ç”¨è§£å¯†æ–¹æ³•æ¢å¤æˆåŸæœ¬çš„ URL ã€‚ å®ç° Solution ç±»ï¼š Solution() åˆå§‹åŒ– TinyURL ç³»ç»Ÿå¯¹è±¡ã€‚String encode(String longUrl) è¿”å› longUrl å¯¹åº”çš„ TinyURL ã€‚String decode(String shortUrl) è¿”å› shortUrl åŸæœ¬çš„ URL ã€‚é¢˜ç›®æ•°æ®ä¿è¯ç»™å®šçš„ shortUrl æ˜¯ç”±åŒä¸€ä¸ªç³»ç»Ÿå¯¹è±¡åŠ å¯†çš„ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šurl &#x3D; â€œhttps://leetcode.com/problems/design-tinyurlâ€œè¾“å‡ºï¼šâ€https://leetcode.com/problems/design-tinyurlâ€œ è§£é‡Šï¼šSolution obj &#x3D; new Solution();string tiny &#x3D; obj.encode(url); &#x2F;&#x2F; è¿”å›åŠ å¯†åå¾—åˆ°çš„ TinyURL ã€‚string ans &#x3D; obj.decode(tiny); &#x2F;&#x2F; è¿”å›è§£å¯†åå¾—åˆ°çš„åŸæœ¬çš„ URL ã€‚ æ€è·¯ï¼šä½¿ç”¨è‡ªå¢idä½œä¸ºlongUrlçš„é”®ï¼Œå­˜å…¥unordered_mapå®¹å™¨ä¸­ æ ¹æ®idæ¥è·å–å¯¹åº”çš„longUrl ä»£ç (cpp)ï¼š1234567891011121314151617181920212223class Solution &#123;private: unordered_map&lt;int, string&gt; map; int id;public: Solution()&#123; id = 0; //åˆå§‹åŒ–id &#125; string encode(string longUrl) &#123; id++; map[id] = longUrl; //http://tinyurl.com/1 return &quot;http://tinyurl.com/&quot;+to_string(id); &#125; string decode(string shortUrl) &#123; //substr(int pos)ï¼šè·å–posä½ç½®èµ·çš„æ‰€æœ‰å­—ç¬¦ä¸² //stoi(string str)ï¼šå°†stringç±»å‹çš„å­—ç¬¦ä¸²è½¬æ¢æˆintç±»å‹çš„æ•´æ•° int t_id = stoi(shortUrl.substr(19)); return map[t_id]; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼š Encode å‡½æ•°ï¼šO(n)O(n)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸² longUrl çš„é•¿åº¦ã€‚ Decode å‡½æ•°ï¼šO(1)O(1)ã€‚æˆ‘ä»¬æŠŠ shortUrl å½“æˆæœ‰é™é•¿åº¦çš„å­—ç¬¦ä¸²çœ‹å¾…ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š Encode å‡½æ•°ï¼šO(n)O(n)ã€‚ä¿å­˜å­—ç¬¦ä¸² longUrl éœ€è¦ O(n)O(n) çš„ç©ºé—´ã€‚ Decode å‡½æ•°ï¼šO(1)O(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"SpringMVCæ¡†æ¶çš„å­¦ä¹ ç¬”è®°","slug":"Java/SpringMCVæ¡†æ¶","date":"2022-06-28T14:02:54.299Z","updated":"2022-07-07T06:25:56.557Z","comments":true,"path":"2022/06/28/Java/SpringMCVæ¡†æ¶/","link":"","permalink":"http://example.com/2022/06/28/Java/SpringMCV%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè®¤SpringMVC1.1 SpringMVCç®€ä»‹ SpringMVCæŠ€æœ¯ä¸ServletæŠ€æœ¯åŠŸèƒ½ç­‰åŒï¼Œå‡å±äºwebå±‚å¼€å‘æŠ€æœ¯ SpringMVCæ˜¯ä¸€ç§åŸºäºjavaå®ç°MVCæ¨¡å‹çš„è½»é‡çº§Webæ¡†æ¶ ä¼˜ç‚¹ï¼š ä½¿ç”¨ç®€å•ï¼Œå¼€å‘ä¾¿æ·(ç›¸æ¯”ä¸Servlet) çµæ´»æ€§å¼º é¡¹ç›®ç»“æ„ï¼š 1.2 SpringMVCå…¥é—¨1.ä½¿ç”¨SpringMVCæŠ€æœ¯éœ€è¦å…ˆå¯¼å…¥SpringMVCåæ ‡ä¸Servlet ä¸éœ€è¦å¯¼å…¥spring-contextåŒ…ï¼Œspring-webmvcåŒ…ä¸­åŒ…å«spring-contextåŒ… 2.å¯¼å…¥Tomcatæ’ä»¶ 12345678910111213141516171819202122232425&lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;!-- å’ŒTomcatæœ‰å†²çª --&gt; &lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;!--Tomcatæ’ä»¶--&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.1&lt;/version&gt; &lt;configuration&gt; &lt;port&gt;8888&lt;/port&gt; &lt;!--ç«¯å£å¯ä»»æ„åªè¦æ²¡æœ‰è¢«å ç”¨--&gt; &lt;path&gt;/&lt;/path&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; 3.åˆ›å»ºSpringMVCæ§åˆ¶å™¨ç±»(ç­‰åŒäºServletåŠŸèƒ½) 1234567891011@Controllerpublic class UserController &#123; //è®¾ç½®å½“å‰æ§åˆ¶å™¨æ–¹æ³•çš„è¯·æ±‚è·¯å¾„ @RequestMapping(&quot;/save&quot;) //è®¾ç½®å½“å‰æ§åˆ¶å™¨æ–¹æ³•å“åº”å†…å®¹ä¸ºå½“å‰è¿”å›å€¼ï¼Œæ— éœ€è§£æ @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; 4.åˆå§‹åŒ–SpringMVCç¯å¢ƒ(åŒSpringç¯å¢ƒ)ï¼Œè®¾å®šSpringMVCåŠ è½½å¯¹åº”çš„bean 12345//åˆ›å»ºSpringMVCçš„é…ç½®æ–‡ä»¶ï¼ŒåŠ è½½controllerå¯¹åº”çš„bean@Configuration@ComponentScan(&quot;com.springmvc.controller&quot;)public class SpringMvcConfig &#123;&#125; 5.åˆå§‹åŒ–Servletå®¹å™¨ï¼ŒåŠ è½½SpringMVCç¯å¢ƒï¼Œå¹¶è®¾ç½®SpringMVCæŠ€æœ¯å¤„ç†çš„è¯·æ±‚ 123456789101112131415161718192021//å®šä¹‰ä¸€ä¸ªservletå®¹å™¨å¯åŠ¨çš„é…ç½®ç±»ï¼Œåœ¨é‡Œé¢åŠ è½½Springçš„é…ç½®public class ServletContainerInitConfig extends AbstractDispatcherServletInitializer &#123; //åŠ è½½SpringMVCå®¹å™¨çš„é…ç½® @Override protected WebApplicationContext createServletApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringMvcConfig.class); return acwac; &#125; //è®¾å®šSpringMVCå¯¹åº”çš„è¯·æ±‚çš„æ˜ å°„è·¯å¾„ @Override protected String[] getServletMappings() &#123; //è®¾ç½®ä¸º/è¡¨ç¤ºæ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œä»»æ„è¯·æ±‚éƒ½å°†è½¬å…¥åˆ°SpringMVCä¸­è¿›è¡Œå¤„ç† return new String[]&#123;&quot;/&quot;&#125;; &#125; //åŠ è½½Springå®¹å™¨é…ç½®ï¼Œç°åœ¨ä¸éœ€è¦ @Override protected WebApplicationContext createRootApplicationContext() &#123; return null; &#125;&#125; å³é”®æ‰¾åˆ°Run Mavenå†æ‰¾åˆ°tomcat7:runç‚¹å‡»è¿è¡Œï¼Œæ‰“å¼€æµè§ˆå™¨æ‰“å¼€http://localhost:8888/save é¡µé¢å³å¯å‡ºç°å†…å®¹ï¼š 1&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125; æ­¤æ—¶æ§åˆ¶å°æ‰“å°å‡ºï¼š 1user is saving~~ 1.3 å…¥é—¨æ€»ç»“ SpringMVCå…¥é—¨ç¨‹åºå¼€å‘æ€»ç»“(1+N) ä¸€æ¬¡æ€§å·¥ä½œ åˆ›å»ºå·¥ç¨‹, è®¾ç½®æœåŠ¡å™¨ï¼ŒåŠ è½½å·¥ç¨‹ å¯¼å…¥åæ ‡ åˆ›å»ºwebå®¹å™¨å¯åŠ¨ç±», åŠ è½½SpringMVCé…ç½®ï¼Œ å¹¶è®¾ç½®SpringMVCè¯·æ±‚æ‹¦æˆªè·¯å¾„ SpringMVCæ ¸å¿ƒé…ç½®ç±» (è®¾ç½®é…ç½®ç±»,æ‰«æcontrolleråŒ…, åŠ è½½Controlleræ§åˆ¶å™¨bean) å¤šæ¬¡å·¥ä½œ å®šä¹‰å¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨ç±» å®šä¹‰å¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œ å¹¶é…ç½®æ˜ å°„è·¯å¾„@RequestMappingä¸è¿”å›jsonæ•°æ®@ResponseBody 1.4 å·¥ä½œæµç¨‹å…¥é—¨æ¡ˆä¾‹å·¥ä½œæµç¨‹åˆ†æ å¯åŠ¨æœåŠ¡å™¨åˆå§‹åŒ–è¿‡ç¨‹ æœåŠ¡å™¨å¯åŠ¨, æ‰§è¡ŒServletContainersInitConfigç±»,åˆå§‹åŒ–webå®¹å™¨ æ‰§è¡ŒcreateServletApplicationContextæ–¹æ³•ï¼Œåˆ›å»ºäº†WebApplicationContextå¯¹è±¡ åŠ è½½SpringMvcConfigé…ç½®æ–‡ä»¶ æ‰§è¡Œ@ComponentScanåŠ è½½å¯¹åº”çš„bean åŠ è½½UserController, æ¯ä¸ª@RequestMappingçš„åç§°å¯¹åº”ä¸€ ä¸ªå…·ä½“çš„æ–¹æ³• æ‰§è¡ŒgetServletMappingsæ–¹æ³•, å®šä¹‰æ‰€æœ‰çš„è¯·æ±‚éƒ½é€šè¿‡SpringMVC å•æ¬¡è¯·æ±‚è¿‡ç¨‹ å‘é€è¯·æ±‚http:localhost:8888/save webå®¹å™¨å‘ç°æ‰€æœ‰è¯·æ±‚éƒ½ç»è¿‡SpringMVC, å°†è¯·æ±‚äº¤ç»™SpringMVCå¤„ç† è§£æè¯·æ±‚è·¯å¾„&#x2F;save ç”±&#x2F;saveåŒ¹é…æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•save() æ‰§è¡Œsave() æ£€æµ‹åˆ°æœ‰@ResponseBodyç›´æ¥å°†save()æ–¹æ³•çš„è¿”å›å€¼ä½œä¸ºå“åº”æ±‚ä½“è¿”å›ç»™è¯·æ±‚æ–¹ 1.5 beanåŠ è½½æ§åˆ¶ com springmvc config controller service dao ControlleråŠ è½½æ§åˆ¶ä¸šåŠ¡ä¸ä¸šåŠ¡beanåŠ è½½æ§åˆ¶ SpringMVCç›¸å…³bean è¡¨ç°å±‚bean(Controller) Springæ§åˆ¶çš„bean ä¸šåŠ¡bean(Service) åŠŸèƒ½bean(DataSourseç­‰) SpringMVCç›¸å…³çš„beanåŠ è½½æ§åˆ¶ SpringMVCåŠ è½½çš„beanå¯¹åº”çš„åŒ…å‡åœ¨com.springnvc.controlleråŒ…å†… Springç›¸å…³beanåŠ è½½æ§åˆ¶ SpringåŠ è½½çš„beanè®¾å®šèŒƒå›´ä¸ºcom.springmvcï¼Œæ’é™¤controlleråŒ…å†…çš„bean SpringåŠ è½½çš„beanè®¾å®šèŒƒå›´ä¸ºç²¾å‡†èŒƒå›´ï¼Œå¦‚ï¼šcom.springmvc.daoã€com.springmvc.serviceç­‰(å¸¸ç”¨) ä¸åŒºåˆ†Springä¸SpringMVCçš„ç¯å¢ƒï¼ŒåŠ è½½åˆ°åŒä¸€ä¸ªç¯å¢ƒä¸­ æ–¹å¼ä¸€(å¸¸ç”¨)ï¼š 1234@Configuration@ComponentScan(&#123;&quot;com.springmvc.dao&quot;,&quot;com.springmvc.service&quot;&#125;)public class SpringConfig &#123;&#125; æ–¹å¼äºŒï¼š 123456789@Configuration@ComponentScan(value = &quot;com.springmvc&quot;, excludeFilters = @ComponentScan.Filter( type = FilterType.ANNOTATION, //æŒ‰ç…§æ³¨è§£æ’é™¤ classes = Controller.class //éœ€è¦æ’é™¤çš„æ³¨è§£ç±»å‹ ))public class SpringConfig &#123;&#125; åŠ è½½SpringMVCå’ŒSpringé…ç½® 123456789101112131415161718192021public class ServletContainerInitConfig extends AbstractDispatcherServletInitializer &#123; //åŠ è½½SpringMVCé…ç½® @Override protected WebApplicationContext createServletApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringMvcConfig.class); return acwac; &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;&quot;/&quot;&#125;; &#125; //åŠ è½½SpringMVCé…ç½® @Override protected WebApplicationContext createRootApplicationContext() &#123; AnnotationConfigWebApplicationContext acwac = new AnnotationConfigWebApplicationContext(); acwac.register(SpringConfig.class); return acwac; &#125;&#125; ç®€åŒ–æ“ä½œ(å¸¸ç”¨)ï¼š 1234567891011121314151617public class ServletContainerInitConfig extends AbstractAnnotationConfigDispatcherServletInitializer &#123; @Override protected Class&lt;?&gt;[] getRootConfigClasses() &#123; return new Class[]&#123;SpringConfig.class&#125;; &#125; @Override protected Class&lt;?&gt;[] getServletConfigClasses() &#123; return new Class[]&#123;SpringMvcConfig.class&#125;; &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;&quot;/&quot;&#125;; &#125;&#125; 2.è¯·æ±‚ä¸å“åº”2.1 è¯·æ±‚æ˜ å°„è·¯å¾„é¡¹ç›®ç»“æ„ï¼š BookControllerï¼š 123456789@Controllerpublic class BookController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;book is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; UserControllerï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; è¿è¡Œç¨‹åºåæŠ¥é”™ï¼Œæ— æ³•å¯åŠ¨ã€‚ å› ä¸ºè·¯å¾„éƒ½ä¸º/saveçš„è¯ï¼Œåœ¨ç½‘é¡µè¯·æ±‚/saveï¼Œç¨‹åºä¼šä¸çŸ¥é“è°ƒç”¨å“ªä¸ªæ§åˆ¶å™¨æ–¹æ³• æ”¹è¿›ï¼š BookControllerï¼š 123456789@Controllerpublic class BookController &#123; @RequestMapping(&quot;/book/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;book is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; UserControllerï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/user/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; è¿˜å¯ä»¥æ›´åŠ ç²¾ç®€ï¼Œå¢åŠ æ¨¡å—çš„è¯·æ±‚è·¯å¾„å‰ç¼€ï¼š @RequestMappingæ³¨è§£ï¼š è®¾ç½®åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸Šï¼šè¯·æ±‚è®¿é—®è·¯å¾„ è®¾ç½®åœ¨ç±»ä¸Šï¼šç»Ÿä¸€è®¾ç½®å½“å‰ç±»ä¸­æ§åˆ¶å™¨æ–¹æ³•è¯·æ±‚è·¯å¾„å‰ç¼€ BookControllerï¼š 12345678910@Controller@RequestMapping(&quot;/book&quot;)public class BookController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;book is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; UserControllerï¼š 12345678910@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save()&#123; System.out.println(&quot;user is saving~~&quot;); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; 2.2 è¯·æ±‚æ–¹å¼ Getè¯·æ±‚ Postè¯·æ±‚ æ‰€è¦è®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(String name, int age)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(&quot;name=&quot;+name+&quot; age=&quot;+age); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ä¼ å‚ï¼Œåœ°å€å‚æ•°è¦ä¸å½¢å‚å˜é‡åç›¸åŒï¼Œå®šä¹‰å½¢å‚å‡ ä¸ªæ¥æ”¶å‚æ•° è®¿é—®é“¾æ¥ï¼šhttp://localhost:8888/user/save?name=dahuang&amp;age=18 æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~name=dahuang age=18 postè¯·æ±‚ï¼š formè¡¨å•postè¯·æ±‚ä¼ å‚ï¼Œè¡¨å•å‚æ•°åè¦ä¸å½¢å‚å˜é‡åç›¸åŒï¼Œå®šä¹‰å½¢å‚å‡ ä¸ªæ¥æ”¶å‚æ•° è®¿é—®é“¾æ¥ï¼šhttp://localhost:8888/user/save æäº¤æ•°æ®å½¢å¼ï¼šx-www-form-urlencoded æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~name=dahei age=20 å¦‚æœå‚æ•°ä¸ºä¸­æ–‡å‘¢ï¼Ÿ æ§åˆ¶å°æ‰“å°ï¼Œä¼šä¹±ç ï¼š 12user is saving~~name=Ã¥Â¤Â§Ã©Â»Â„ age=20 Postè¯·æ±‚ä¸­æ–‡ä¹±ç å¤„ç†ï¼š åœ¨ServletContainerInitConfigé…ç½®æ–‡ä»¶ä¸­é‡å†™getServletFilters()æ–¹æ³• ä¸ºwebå®¹å™¨æ·»åŠ è¿‡æ»¤å™¨å¹¶æŒ‡å®šå­—ç¬¦é›†ï¼ŒSpring-webåŒ…ä¸­æä¾›äº†ä¸“ç”¨çš„å­—ç¬¦è¿‡æ»¤å™¨ 123456@Overrideprotected Filter[] getServletFilters() &#123; CharacterEncodingFilter aef = new CharacterEncodingFilter(); aef.setEncoding(&quot;UTF-8&quot;); return new Filter[]&#123;aef&#125;;&#125; å†æ¬¡è¿è¡Œåï¼Œæ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~name=å¤§é»„ age=20 2.3 5ç§ç±»å‹å‚æ•°ä¼ é€’ å‚æ•°ç§ç±» æ™®é€šå‚æ•° POJOå‚æ•° åµŒå¥—POJOå‚æ•° æ•°ç»„ç±»å‹å‚æ•° é›†åˆç±»å‹å‚æ•° æ™®é€šå‚æ•°ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚å˜é‡åä¸åŒï¼Œä½¿ç”¨@RequestParamæ³¨è§£ç»‘å®šå‚æ•°å…³ç³» 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestParam(&quot;name&quot;) String userName, int age)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(&quot;name=&quot;+userName+&quot; age=&quot;+age); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; POJOå‚æ•°ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚å¯¹è±¡åç›¸åŒï¼Œå®šä¹‰POJOç±»å‹å½¢å‚å³å¯æ¥æ”¶å‚æ•° åˆ›å»ºä¸€ä¸ªå®ä½“ç±»User 1234567891011121314151617public class User &#123; private String name; private int age; public String getName() &#123;return name;&#125; public void setName(String name) &#123;this.name = name;&#125; public int getAge() &#123;return age;&#125; public void setAge(int age) &#123;this.age = age;&#125; @Override public String toString() &#123; return &quot;User&#123;&quot; + &quot;name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, age=&quot; + age + &#x27;&#125;&#x27;; &#125;&#125; UserControllerä¸­ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(User user)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(user.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?name=dahei&amp;age=16 æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~User&#123;name=&#x27;dahei&#x27;, age=16&#125; åµŒå¥—POJOå‚æ•°ï¼šPOJOå¯¹è±¡ä¸­åŒ…å«POJOå¯¹è±¡ åˆ›å»ºä¸€ä¸ªæ–°å®ä½“ç±»Addressï¼š 1234567891011121314151617public class Address &#123; private String province; private String city; public String getProvince() &#123;return province;&#125; public void setProvince(String province) &#123;this.province = province;&#125; public String getCity() &#123;return city;&#125; public void setCity(String city) &#123;this.city = city;&#125; @Override public String toString() &#123; return &quot;Address&#123;&quot; + &quot;province=&#x27;&quot; + province + &#x27;\\&#x27;&#x27; + &quot;, city=&#x27;&quot; + city + &#x27;\\&#x27;&#x27; + &#x27;&#125;&#x27;; &#125;&#125; å°†Addresså¯¹è±¡åŠ å…¥åˆ°Userå¯¹è±¡ä¸­ï¼š 123456789101112131415161718192021public class User &#123; private String name; private int age; private Address address; public Address getAddress() &#123;return address;&#125; public void setAddress(Address address) &#123;this.address = address;&#125; public String getName() &#123;return name;&#125; public void setName(String name) &#123;this.name = name;&#125; public int getAge() &#123;return age;&#125; public void setAge(int age) &#123;this.age = age;&#125; @Override public String toString() &#123; return &quot;User&#123;&quot; + &quot;name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, age=&quot; + age + &quot;, address=&quot; + address + &#x27;&#125;&#x27;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?name=dahuang&amp;age=20&amp;address.province=tianjin&amp;address.city=baodi æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~User&#123;name=&#x27;dahuang&#x27;, age=20, address=Address&#123;province=&#x27;tianjin&#x27;, city=&#x27;baodi&#x27;&#125;&#125; æ•°ç»„å‚æ•°ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(String[] hobbies)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(Arrays.toString(hobbies)); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?hobbies=TV&amp;hobbies=game&amp;hobbies=food æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[TV, game, food] é›†åˆå‚æ•°ï¼š 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestParam List&lt;String&gt; hobbies)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(hobbies.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; getè¯·æ±‚ï¼š urlåœ°å€ï¼šhttp://localhost:8888/user/save?hobbies=TV&amp;hobbies=game&amp;hobbies=food æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[TV, game, food] 2.4 ä¼ é€’jsonæ•°æ®*å¯¼å…¥jacksonåæ ‡ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt; &lt;version&gt;2.9.0&lt;/version&gt;&lt;/dependency&gt; jsonæœ‰ä¸¤ç§æ ¼å¼ï¼š å¯¹è±¡æ ¼å¼ï¼š&#123;&quot;key1&quot;:obj,&quot;key2&quot;:obj,&quot;key3&quot;:obj...&#125; æ•°ç»„&#x2F;é›†åˆæ ¼å¼ï¼š[obj,obj,obj...] åœ¨SpringMvcConfigé…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ æ³¨è§£@EnableWebMvcï¼š @EnableWebMvcæ³¨è§£ï¼šå¼€å¯jsonæ•°æ®è½¬æ¢æˆå¯¹è±¡çš„åŠŸèƒ½ 12345@Configuration@ComponentScan(&quot;com.springmvc.controller&quot;)@EnableWebMvcpublic class SpringMvcConfig &#123;&#125; é›†åˆå‚æ•°ï¼šjsonæ ¼å¼ @RequestBodyæ³¨è§£ï¼šå°†è¯·æ±‚ä¸­è¯·æ±‚ä½“æ‰€åŒ…å«çš„æ•°æ®ä¼ é€’ç»™è¯·æ±‚å‚æ•°ï¼Œæ­¤æ³¨è§£ä¸€ä¸ªå¤„ç†å™¨æ–¹æ³•åªèƒ½ä½¿ç”¨ä¸€æ¬¡ 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestBody List&lt;String&gt; hobbies)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(hobbies.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[TV, game, food] POJOå‚æ•°ï¼šjsonæ ¼å¼ 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestBody User user)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(user.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~User&#123;name=&#x27;dahuang&#x27;, age=20, address=Address&#123;province=&#x27;tianjin&#x27;, city=&#x27;baodi&#x27;&#125;&#125; é›†åˆå¯¹è±¡å‚æ•°ï¼šjsonæ ¼å¼ 1234567891011@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/save&quot;) @ResponseBody public String save(@RequestBody List&lt;User&gt; list)&#123; System.out.println(&quot;user is saving~~&quot;); System.out.println(list.toString()); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 12user is saving~~[User&#123;name=&#x27;dahei&#x27;, age=20, address=Address&#123;province=&#x27;tianjin&#x27;, city=&#x27;baodi&#x27;&#125;&#125;, User&#123;name=&#x27;dahuang&#x27;, age=20, address=Address&#123;province=&#x27;guizhou&#x27;, city=&#x27;zunyi&#x27;&#125;&#125;] @RequestBodyä¸@RequestParamçš„åŒºåˆ«ï¼š åŒºåˆ« @RequestParamç”¨äºurlåœ°å€ä¼ å‚ï¼Œè¡¨å•ä¼ å‚ application/x-www-form-urlencoded @RequestBodyç”¨äºæ¥æ”¶jsonæ•°æ® application/json åº”ç”¨ åæœŸå¼€å‘ï¼Œå‘é€jsonæ ¼å¼æ•°æ®ä¸ºä¸»ï¼Œ@RequestBodyæ‹¥æœ‰è¾ƒå¹¿ å¦‚æœå‘é€éjsonæ ¼å¼æ•°æ®ï¼Œé€‰ç”¨@RequestParamæ¥æ”¶è¯·æ±‚å‚æ•° 2.5 æ—¥æœŸç±»å‹å‚æ•°ä¼ é€’æ—¥æœŸç±»å‹æ•°æ®åŸºäºç³»ç»Ÿä¸åŒæ ¼å¼ä¹Ÿä¸å°½ç›¸åŒ 2022-07-04 2022&#x2F;07&#x2F;04 07&#x2F;04&#x2F;2022 æ¥æ”¶å½¢å‚æ—¶ï¼Œæ ¹æ®ä¸åŒçš„æ—¥æœŸæ ¼å¼è®¾ç½®ä¸åŒçš„æ¥æ”¶æ–¹å¼ @DataTimeFormatæ³¨è§£ä¸­çš„patternå±æ€§æ¥è‡ªå®šä¹‰æ—¥æœŸæ—¶é—´å‹æ•°æ®æ ¼å¼ 1234567891011121314@Controller@RequestMapping(&quot;/user&quot;)public class UserController &#123; @RequestMapping(&quot;/date&quot;) @ResponseBody public String save(Date date1, @DateTimeFormat(pattern = &quot;yyyy-mm-dd&quot;) Date date2, @DateTimeFormat(pattern = &quot;yyyy/mm/dd HH:mm:ss&quot;) Date date3)&#123; System.out.println(&quot;date1==&gt;&quot;+date1); System.out.println(&quot;date2==&gt;&quot;+date2); System.out.println(&quot;date3==&gt;&quot;+date3); return &quot;&#123;&#x27;info&#x27;:&#x27;springmvc&#x27;&#125;&quot;; &#125;&#125; æ§åˆ¶å°æ‰“å°ï¼š 123date1==&gt;Mon Jul 04 00:00:00 CST 2022date2==&gt;Tue Jan 04 00:07:00 CST 2022date3==&gt;Tue Jan 04 23:10:00 CST 2022 ç±»å‹è½¬æ¢å™¨ï¼š Converteræ¥å£ 1234public interface Converter&lt;S, T&gt; &#123; @Nullable T convert(S val);&#125; è¯·æ±‚å‚æ•°å¹´é¾„æ•°æ®(String&#x3D;&#x3D;&gt;Integer) æ—¥æœŸæ ¼å¼è½¬æ¢(String&#x3D;&#x3D;&gt;Date) @EnableWebMvcæ³¨è§£ä½œç”¨ä¹‹ä¸€ï¼šæ ¹æ®ç±»å‹åŒ¹é…å¯¹åº”çš„ç±»å‹è½¬æ¢å™¨ 2.6 å“åº”æ•°æ® å“åº”é¡µé¢ å“åº”æ•°æ® æ–‡æœ¬æ•°æ® jsonæ•°æ® å“åº”é¡µé¢ï¼š åœ¨webappèµ„æºåŒ…ä¸­æ–°å»ºæ–‡ä»¶ï¼špage.jsp 12345&lt;html&gt;&lt;body&gt;&lt;h2&gt;Hello SpringMVC!&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt; é¡µé¢è·³è½¬ï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/jumpPage&quot;) public String jumpPage()&#123; System.out.println(&quot;é¡µé¢è·³è½¬&quot;); return &quot;page.jsp&quot;; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/jumpPage ä¼šè‡ªåŠ¨è·³è½¬åˆ°page.jspé¡µé¢ å“åº”æ–‡æœ¬æ•°æ®ï¼š 123456789@Controllerpublic class UserController &#123; @RequestMapping(&quot;/toText&quot;) @ResponseBody public String toText()&#123; System.out.println(&quot;è¿”å›çº¯æ–‡æœ¬æ•°æ®&quot;); return &quot;hello SpringMVC&quot;; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/toText é¡µé¢æ•°æ®ï¼š 1hello SpringMVC å“åº”POJOå¯¹è±¡ï¼š 123456789101112@Controllerpublic class UserController &#123; @RequestMapping(&quot;/toPojo&quot;) @ResponseBody public User toPojo()&#123; System.out.println(&quot;è¿”å›POJOæ•°æ®&quot;); User user = new User(); user.setName(&quot;å¤§é»„&quot;); user.setAge(18); return user; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/toPojo é¡µé¢æ•°æ®ï¼š 12345&#123; &quot;name&quot;: &quot;å¤§é»„&quot;, &quot;age&quot;: 18, &quot;address&quot;: null&#125; å…¶ä¸­æ˜¯jacksonè‡ªåŠ¨å°†å¯¹è±¡è½¬æ¢æˆjsonæ•°æ® æ‰€ä»¥ä¸€å®šè¦å¯¼å…¥jacksonåæ ‡ å“åº”POJOé›†åˆå¯¹è±¡ï¼š 123456789101112131415161718@Controllerpublic class UserController &#123; @RequestMapping(&quot;/toPojoList&quot;) @ResponseBody public List&lt;User&gt; toPojoList()&#123; System.out.println(&quot;è¿”å›POJOé›†åˆå¯¹è±¡æ•°æ®&quot;); User user1 = new User(); user1.setName(&quot;å¤§é»„&quot;); user1.setAge(18); User user2 = new User(); user2.setName(&quot;å¤§é»‘&quot;); user2.setAge(20); List&lt;User&gt; list = new ArrayList&lt;&gt;(); list.add(user1); list.add(user2); return list; &#125;&#125; urlåœ°å€ï¼šhttp://localhost:8888/toPojoList é¡µé¢æ•°æ®ï¼š 123456789101112[ &#123; &quot;name&quot;: &quot;å¤§é»„&quot;, &quot;age&quot;: 18, &quot;address&quot;: null &#125;, &#123; &quot;name&quot;: &quot;å¤§é»‘&quot;, &quot;age&quot;: 20, &quot;address&quot;: null &#125;] @ResponseBodyæ³¨è§£ï¼š è®¾ç½®å½“å‰æ§åˆ¶å™¨è¿”å›å€¼ä½œä¸ºå“åº”ä½“ æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼æ•°æ®ç±»å‹ä¸ºStringï¼Œåˆ™è¿”å›æ–‡æœ¬æ•°æ® æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼æ•°æ®ç±»å‹ä¸ºå¯¹è±¡ï¼Œåˆ™è‡ªåŠ¨å°†å¯¹è±¡è½¬æ¢æˆjsonæ•°æ® ç±»å‹è½¬æ¢å™¨ï¼š webè¯·æ±‚ä¸“ç”¨ç±»å‹è½¬æ¢å™¨ï¼šHttpMessageConverteræ¥å£ 3.RESTé£æ ¼3.1 RESTç®€ä»‹ REST(Representational State Transfer)ï¼šè¡¨ç°å½¢å¼çŠ¶æ€è½¬æ¢ ä¼ ç»Ÿé£æ ¼èµ„æºæè¿°å½¢å¼ http://localhost:8888/user/getById?id=1 http://localhost:8888/user/saveUser RESTé£æ ¼æè¿°å½¢å¼ http://localhost:8888/user/1 http://localhost:8888/user ä¼˜ç‚¹ï¼š éšè—èµ„æºçš„è®¿é—®è¡Œä¸ºï¼Œæ— æ³•é€šè¿‡åœ°å€å¾—çŸ¥å¯¹èµ„æºæ˜¯å¦‚ä½•æ“ä½œ ä¹¦å†™ç®€åŒ– æŒ‰ç…§RESTé£æ ¼è®¿é—®èµ„æºæ—¶ä½¿ç”¨è¡Œä¸ºåŠ¨ä½œåŒºåˆ†å¯¹èµ„æºè¿›è¡Œäº†ä½•ç§æ“ä½œ http://localhost:8888/users æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·ä¿¡æ¯(get) http://localhost:8888/users/1 æŸ¥è¯¢æŒ‡å®šç”¨æˆ·ä¿¡æ¯(post) http://localhost:8888/users æ·»åŠ ç”¨æˆ·ä¿¡æ¯(post) http://localhost:8888/users ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯(put) http://localhost:8888/users/1 åˆ é™¤ç”¨æˆ·ä¿¡æ¯(delete) æè¿°æ¨¡å—çš„åç§°é€šå¸¸ä½¿ç”¨å¤æ•°ï¼Œä¹Ÿå°±æ˜¯åŠ sçš„æ ¼å¼æè¿°ï¼Œè¡¨ç¤ºæ­¤ç±»èµ„æºï¼Œè€Œéå•ä¸ªèµ„æºã€‚ ä¾‹å¦‚ï¼šusersã€booksâ€¦. æ ¹æ®RESTé£æ ¼å¯¹èµ„æºè¿›è¡Œè®¿é—®ç§°ä¸ºRESTFul 3.2 RESTå…¥é—¨@RequestMappingæ³¨è§£ä¸­methodå±æ€§å¯ä»¥è®¾å®šhttpè¯·æ±‚åœ°å€ï¼Œä¾‹å¦‚ï¼šGETã€POSTã€PUTã€DELETEâ€¦ @PathVariableæ³¨è§£ï¼šç»‘å®šè·¯å¾„å‚æ•°ä¸å¤„ç†å™¨æ–¹æ³•å½¢å‚é—´çš„å…³ç³»ï¼Œè¦æ±‚è·¯å¾„å‚æ•°åä¸å½¢å‚åä¸€ä¸€å¯¹åº” 12345678910111213141516171819202122232425262728293031323334353637@Controllerpublic class UserController &#123; @RequestMapping(value = &quot;/users&quot;, method = RequestMethod.POST) @ResponseBody public String save()&#123; System.out.println(&quot;save~~&quot;); return &quot;save success&quot;; &#125; @RequestMapping(value = &quot;/users&quot;, method = RequestMethod.PUT) @ResponseBody public String update()&#123; System.out.println(&quot;update~~&quot;); return &quot;update success&quot;; &#125; @RequestMapping(value = &quot;/users/&#123;id&#125;&quot;, method = RequestMethod.DELETE) @ResponseBody public String delete(@PathVariable Integer id)&#123; //è·¯å¾„å˜é‡ System.out.println(&quot;delete~~&quot;); return &quot;delete success&quot;; &#125; @RequestMapping(value = &quot;/users&quot;, method = RequestMethod.GET) @ResponseBody public String getAll()&#123; System.out.println(&quot;getAll~~&quot;); return &quot;getAll success&quot;; &#125; @RequestMapping(value = &quot;/users/&#123;id&#125;&quot;, method = RequestMethod.POST) @ResponseBody public String getById(@PathVariable Integer id)&#123; System.out.println(&quot;getById~~&quot;); return &quot;getById success&quot;; &#125;&#125; @RequestBody @RequestParam @PathVariable åŒºåˆ« @RequestParamç”¨äºæ¥æ”¶urlåœ°å€ä¼ å‚æˆ–è¡¨å•ä¼ å‚ @RequestBodyç”¨äºæ¥æ”¶jsonæ•°æ® @PathVariab1eç”¨äºæ¥æ”¶è·¯å¾„å‚æ•°, ä½¿ç”¨{å‚æ•°åç§°}æè¿°è·¯å¾„å‚æ•° åº”ç”¨ åæœŸå¼€å‘ä¸­ï¼Œå‘é€è¯·æ±‚å‚æ•°è¶…è¿‡1ä¸ªæ—¶ï¼Œä»¥jsonæ ¼å¼ä¸ºä¸», @RequestBodyåº”ç”¨è¾ƒå¹¿ å¦‚æœå‘é€éjsonæ ¼å¼æ•°æ® ,é€‰ç”¨@RequestParamæ¥æ”¶è¯·æ±‚å‚æ•° é‡‡ç”¨RESTfulè¿›è¡Œå¼€å‘ï¼Œå½“å‚æ•°æ•°é‡è¾ƒå°‘æ—¶ï¼Œä¾‹å¦‚1ä¸ªï¼Œ å¯ä»¥é‡‡ç”¨@PathVariableæ¥æ”¶è¯·æ±‚è·¯å¾„å˜é‡ï¼Œé€šå¸¸ç”¨äºä¼ é€’idå€¼ 3.3 RESTå¿«é€Ÿå¼€å‘@ResponseBodyï¼š è®¾ç½®å½“å‰æ§åˆ¶å™¨ç±»ä¸ºRESTfulé£æ ¼ï¼Œç­‰åŒäº@Controllerä¸@ResponseBodyä¸¤ä¸ªæ³¨è§£ç»„åˆåŠŸèƒ½ æ ‡å‡†è¯·æ±‚åŠ¨ä½œæ˜ å°„ï¼š @GetMappingï¼šå¯¹åº”GETè¯·æ±‚ @PostMappingï¼šå¯¹åº”POSTè¯·æ±‚ @PutMappingï¼šå¯¹åº”PUTè¯·æ±‚ @DeleteMappingï¼šå¯¹åº”DELETEè¯·æ±‚ 12345678910111213141516171819202122232425262728293031323334//@ResponseBody + @Controller ==&gt; @RestController@RestController@RequestMapping(&quot;/users&quot;)public class UserController &#123; @PostMapping public String save()&#123; System.out.println(&quot;save~~&quot;); return &quot;save success&quot;; &#125; @PutMapping public String update()&#123; System.out.println(&quot;update~~&quot;); return &quot;update success&quot;; &#125; @DeleteMapping(&quot;/&#123;id&#125;&quot;) public String delete(@PathVariable Integer id)&#123; //è·¯å¾„å˜é‡ System.out.println(&quot;delete~~&quot;); return &quot;delete success&quot;; &#125; @GetMapping public String getAll()&#123; System.out.println(&quot;getAll~~&quot;); return &quot;getAll success&quot;; &#125; @PostMapping(&quot;/&#123;id&#125;&quot;) public String getById(@PathVariable Integer id)&#123; System.out.println(&quot;getById~~&quot;); return &quot;getById success&quot;; &#125;&#125; 4.SSMæ•´åˆ5.æ‹¦æˆªå™¨5.1 æ‹¦æˆªå™¨çš„æ¦‚å¿µ æ‹¦æˆªå™¨(Interceptor)æ˜¯ä¸€ç§åŠ¨æ€æ‹¦æˆªæ–¹æ³•è°ƒç”¨çš„æœºåˆ¶ï¼Œå†SpringMVCä¸­åŠ¨æ€æ‹¦æˆªæ§åˆ¶å™¨æ–¹æ³•çš„æ‰§è¡Œ ä½œç”¨ï¼š åœ¨æŒ‡å®šçš„æ–¹æ³•è°ƒç”¨å‰åæ‰§è¡Œé¢„å…ˆè®¾å®šçš„ä»£ç  é˜»æ­¢åŸå§‹æ–¹æ³•çš„æ‰§è¡Œ æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨çš„åŒºåˆ«ï¼š å½’å±ä¸åŒï¼šFilterå±äºServletæŠ€æœ¯ï¼ŒInterceptorå±äºSpringMVCæŠ€æœ¯ æ‹¦æˆªå†…å®¹ä¸åŒï¼šFilterå¯¹æ‰€æœ‰è®¿é—®è¿›è¡Œæ•°æ®å¢å¼ºï¼ŒInterceptorä»…é’ˆå¯¹SpringMVCçš„è®¿é—®è¿›è¡Œå¢å¼º 5.2 æ‹¦æˆªå™¨å…¥é—¨ åˆ¶ä½œæ‹¦æˆªå™¨åŠŸèƒ½ç±» é…ç½®æ‹¦æˆªå™¨çš„æ‰§è¡Œä½ç½® é¡¹ç›®ç»“æ„ï¼š ProjectInterceptorï¼š æ­¤æ—¶preHandleæ–¹æ³•çš„è¿”å›å€¼ä¸ºtrueï¼šæ‰§è¡Œè¯·æ±‚çš„æ–¹æ³• 123456789101112131415161718@Componentpublic class ProjectInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;preHandle~~~&quot;); return true; &#125; @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;postHandle~~~&quot;); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;afterCompletion~~~&quot;); &#125;&#125; SpringMvcSupportï¼š 12345678910@Configurationpublic class SpringMvcSupport extends WebMvcConfigurationSupport &#123; @Autowired private ProjectInterceptor projectInterceptor; @Override protected void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(projectInterceptor).addPathPatterns(&quot;/users&quot;); &#125;&#125; SpringMvcConfigä¸­æ·»åŠ æ‰«æè·¯å¾„â€com.springmvc.configâ€ 12345@Configuration@ComponentScan(&#123;&quot;com.springmvc.controller&quot;,&quot;com.springmvc.config&quot;&#125;)@EnableWebMvcpublic class SpringMvcConfig &#123;&#125; UserControllerï¼š 123456789101112131415161718192021222324252627282930313233@RestController@RequestMapping(&quot;/users&quot;)public class UserController &#123; @PostMapping public String save()&#123; System.out.println(&quot;save~~&quot;); return &quot;save success&quot;; &#125; @PutMapping public String update()&#123; System.out.println(&quot;update~~&quot;); return &quot;update success&quot;; &#125; @DeleteMapping(&quot;/&#123;id&#125;&quot;) public String delete(@PathVariable Integer id)&#123; //è·¯å¾„å˜é‡ System.out.println(&quot;delete~~&quot;); return &quot;delete success&quot;; &#125; @GetMapping public String getAll()&#123; System.out.println(&quot;getAll~~&quot;); return &quot;getAll success&quot;; &#125; @PostMapping(&quot;/&#123;id&#125;&quot;) public String getById(@PathVariable Integer id)&#123; System.out.println(&quot;getById~~&quot;); return &quot;getById success&quot;; &#125;&#125; é¡µé¢å±•ç¤ºï¼š 1getAll success æ§åˆ¶å°æ‰“å°ï¼š 1234preHandle~~~getAll~~postHandle~~~afterCompletion~~~ å¦‚æœpreHandleæ–¹æ³•çš„è¿”å›å€¼ä¸ºfalseï¼šä¸ä¼šæ‰§è¡Œè¯·æ±‚çš„æ–¹æ³• 123456789101112131415161718@Componentpublic class ProjectInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;preHandle~~~&quot;); return false; &#125; @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;postHandle~~~&quot;); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;afterCompletion~~~&quot;); &#125;&#125; é¡µé¢æ— å†…å®¹ï¼Œè¢«æ‹¦æˆª æ§åˆ¶å°æ‰“å°ï¼š 1preHandle~~~ æ‰€ä»¥å¯ä»¥é€šè¿‡ifè¯­å¥è¿›è¡ŒæŸç§åˆ¤æ–­ï¼Œè¿”å›trueæˆ–falseï¼Œæ¥æ˜¯å¦æ‰§è¡Œè¯·æ±‚çš„æ–¹æ³• 5.3 æ‹¦æˆªå™¨å‚æ•°å‰ç½®å¤„ç†ï¼š 1234567@Overridepublic boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; System.out.println(&quot;preHandle~~~&quot;); return true;&#125; å‚æ•°ï¼š requestï¼šè¯·æ±‚å¯¹è±¡ responseï¼šå“åº”å¯¹è±¡ handleï¼šè¢«è°ƒç”¨çš„å¤„ç†å™¨å¯¹è±¡ï¼Œæœ¬è´¨ä¸ºä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œå¯¹åå°„æŠ€æœ¯ä¸­çš„Methodå¯¹è±¡è¿›è¡Œäº†å†åŒ…è£… è¿”å›å€¼ï¼š è¿”å›å€¼ä¸ºfalseï¼Œè¢«æ‹¦æˆªçš„å¤„ç†å°†ä¸æ‰§è¡Œ è¿”å›å€¼ä¸ºtrueï¼Œè¢«æ‹¦æˆªçš„å¤„ç†å°†ä¼šæ‰§è¡Œ åç½®å¤„ç†ï¼š 1234567@Overridepublic void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception &#123; System.out.println(&quot;postHandle~~~&quot;);&#125; å‚æ•°ï¼š modelAndViewï¼šå¦‚æœå¤„ç†å™¨æ‰§è¡Œå®Œæˆå…·æœ‰è¿”å›ç»“æœï¼Œå¯ä»¥è¯»å–åˆ°å¯¹åº”æ•°æ®ä¸é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œè°ƒæ•´(äº†è§£å³å¯) å®Œæˆåå¤„ç†ï¼š 1234567@Overridepublic void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; System.out.println(&quot;afterCompletion~~~&quot;);&#125; å‚æ•°ï¼š exï¼šå¦‚æœå¤„ç†æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸å¯¹è±¡ï¼Œå¯ä»¥é’ˆå¯¹å¼‚å¸¸æƒ…å†µè¿›è¡Œå•ç‹¬å¤„ç†(äº†è§£å³å¯) 5.4 æ‹¦æˆªå™¨é“¾é…ç½®(äº†è§£) å½“é…ç½®å¤šä¸ªæ‹¦æˆªå™¨æ—¶ï¼Œå½¢æˆæ‹¦æˆªé“¾ æ‹¦æˆªå™¨é“¾çš„è¿è¡Œé¡ºåºï¼š preHandleï¼šä¸é…ç½®é¡ºåºç›¸åŒï¼Œå¿…å®šè¿è¡Œ postHandleï¼šä¸é…ç½®é¡ºåºç›¸åï¼Œå¯èƒ½ä¸è¿è¡Œ afterCompletionï¼šä¸é…ç½®é¡ºåºç›¸åï¼Œå¯èƒ½ä¸è¿è¡Œ ä½†æ‹¦æˆªå™¨å‡ºç°å¯¹åŸå§‹å¤„ç†å™¨çš„æ‹¦æˆªï¼Œåé¢çš„æ‹¦æˆªå™¨å‡ç»ˆæ­¢è¿è¡Œ å½“æ‹¦æˆªå™¨è¿è¡Œä¸­æ–­ï¼Œä»…è¿è¡Œé…ç½®å†å‰é¢çš„æ‹¦æˆªå™¨çš„afterCompletionæ“ä½œ é€šå¸¸å¼€å‘é¡¹ç›®æ—¶ï¼Œå¾ˆå°‘ä¼šç”¨åˆ°æ‹¦æˆªå™¨é“¾ï¼Œä¸€èˆ¬ä¸€ä¸ªæ‹¦æˆªå™¨å°±å¯ä»¥è§£å†³é—®é¢˜ æŒ‰ç…§1ã€2ã€3çš„é¡ºåºé…ç½® 12345678910111213141516@Configurationpublic class SpringMvcSupport extends WebMvcConfigurationSupport &#123; @Autowired private ProjectInterceptor1 projectInterceptor1; @Autowired private ProjectInterceptor2 projectInterceptor2; @Autowired private ProjectInterceptor3 projectInterceptor3; @Override protected void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(projectInterceptor1).addPathPatterns(&quot;/users&quot;); registry.addInterceptor(projectInterceptor2).addPathPatterns(&quot;/users&quot;); registry.addInterceptor(projectInterceptor3).addPathPatterns(&quot;/users&quot;); &#125;&#125; å…¨éƒ¨çš„preHandleæ–¹æ³•è¿”å›å€¼éƒ½ä¸ºtrueï¼š graph LR; pre1-->pre2-->pre3-->c(controller)-->post3-->post2-->post1-->after3-->after2-->after1; 3çš„preHandleæ–¹æ³•è¿”å›å€¼ä¸ºfalseï¼š graph LR; pre1-->pre2-->pre3-->after2-->after1; 2çš„preHandleæ–¹æ³•è¿”å›å€¼ä¸ºfalseï¼š graph LR; pre1-->pre2-->after1; 1çš„preHandleæ–¹æ³•è¿”å›å€¼ä¸ºfalseï¼š graph LR; pre1;","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"(æ¯æ—¥LeetCode)324. æ‘†åŠ¨æ’åº II","slug":"æ¯æ—¥LeetCode/2022-6/324 æ‘†åŠ¨æ’åº II","date":"2022-06-28T02:30:00.000Z","updated":"2022-07-08T00:35:05.704Z","comments":true,"path":"2022/06/28/æ¯æ—¥LeetCode/2022-6/324 æ‘†åŠ¨æ’åº II/","link":"","permalink":"http://example.com/2022/06/28/%E6%AF%8F%E6%97%A5LeetCode/2022-6/324%20%E6%91%86%E5%8A%A8%E6%8E%92%E5%BA%8F%20II/","excerpt":"","text":"é¢˜ç›®ï¼šç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œå°†å®ƒé‡æ–°æ’åˆ—æˆ nums[0] &lt; nums[1] &gt; nums[2] &lt; nums[3]... çš„é¡ºåºã€‚ ä½ å¯ä»¥å‡è®¾æ‰€æœ‰è¾“å…¥æ•°ç»„éƒ½å¯ä»¥å¾—åˆ°æ»¡è¶³é¢˜ç›®è¦æ±‚çš„ç»“æœã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šnums &#x3D; [1,5,2,4,3,6]è¾“å‡ºï¼š[3,6,2,5,1,4] æ€è·¯ï¼šåŒæŒ‡é’ˆæ³•å°†æ•°ç»„numsæŒ‰ä»å°åˆ°å¤§æ’åˆ—ï¼š 1 2 3 4 5 6 $\\leftarrow\\Uparrow$left $\\leftarrow\\Uparrow$right æŠŠæ’åºå¥½çš„æ•°ç»„åˆ†æˆä¸¤éƒ¨åˆ†ï¼ŒleftæŒ‡é’ˆä½äºæ•°ç»„ä¸­é—´ï¼ŒrightæŒ‡é’ˆä½äºæ•°ç»„æœ«å°¾ï¼Œ å°†leftå’Œrightå½“å‰ä½ç½®çš„å…ƒç´ ä¾æ¬¡æ‰“å°åï¼Œleftå’ŒrightæŒ‡é’ˆå·¦ç§»ï¼Œç›´è‡³ç»“æŸ è¾“å‡ºï¼š[3, 6, 2, 5, 1, 4] ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: void wiggleSort(vector&lt;int&gt;&amp; nums) &#123; int n = nums.size(); //è·å–æ•°ç»„çš„å…ƒç´ ä¸ªæ•° int left = n/2-1; //å®šä¹‰å·¦æŒ‡é’ˆ int right = n-1; //å®šä¹‰å³æŒ‡é’ˆ vector&lt;int&gt; new_nums(nums); sort(new_nums.begin(),new_nums.end()); //å°†æ–°æ•°ç»„æ’åº for(int i=0;i&lt;n;i++)&#123; if(i%2 == 0)&#123; //å¶æ•°ä½ç½®æ’å…¥leftæŒ‡é’ˆçš„å…ƒç´ ï¼Œå¥‡æ•°ä½ç½®æ’å…¥rightæŒ‡é’ˆçš„å…ƒç´  nums[i] = a[left]; left--; &#125; else&#123; nums[i] = a[right]; rigth--; &#125; &#125; &#125;&#125;; å¤æ‚åº¦åˆ†æï¼š æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ï¼Œæ’åºæ‰€éœ€çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(nlogn)ï¼Œæ’å…¥O(n)ï¼Œæ•´ä½“O(nlogn) ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œéœ€è¦é¢å¤–çš„ç©ºé—´å­˜æ”¾æ’åºçš„å…ƒç´ ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"Springæ¡†æ¶çš„å­¦ä¹ ç¬”è®°","slug":"Java/Springæ¡†æ¶","date":"2022-06-25T09:55:58.239Z","updated":"2022-07-21T02:45:13.465Z","comments":true,"path":"2022/06/25/Java/Springæ¡†æ¶/","link":"","permalink":"http://example.com/2022/06/25/Java/Spring%E6%A1%86%E6%9E%B6/","excerpt":"","text":"1.åˆè¯†Spring å®˜ç½‘ï¼šspringå®˜ç½‘ Springå·²ç»å‘å±•æˆäº†ä¸€ç§å¼€å‘çš„ç”Ÿæ€åœˆï¼ŒSpringæä¾›äº†è‹¥å¹²ä¸ªé¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®ç”¨äºå®Œæˆç‰¹å®šçš„åŠŸèƒ½ Spring Framework Spring Boot Spring Cloud â€¦. ç›®å‰å·²ç»å‘å±•åˆ°Spring 5.0ï¼Œéœ€è¦JDK8ä»¥ä¸Šæ”¯æŒ 2.Spring Frameworkæ¶æ„ Spring Frameworkæ˜¯Springç”Ÿæ€åœˆä¸­æœ€åŸºç¡€çš„é¡¹ç›®ï¼Œæ˜¯å…¶ä»–é¡¹ç›®çš„æ ¹åŸº Data Accessï¼šæ•°æ®è®¿é—® Data Integerationï¼šæ•°æ®é›†æˆ Webï¼šwebå¼€å‘ AOPï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ Aspectsï¼šAOPæ€æƒ³å®ç° Core Containerï¼šæ ¸å¿ƒå®¹å™¨ Testï¼šå•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯• 3.æ ¸å¿ƒæ¦‚å¿µ3.1 é¡¹ç›®ç»“æ„ javaåŒ… comåŒ… springåŒ… daoåŒ… BookDao.java implåŒ… BookDaoImpl.java serviceåŒ… BookSerive.java implåŒ… BookServiceImpl.java App.javaä¸»å‡½æ•° resourcesåŒ… applicationContext.xml jdbc.properties 3.2 åˆè¯†IOCå’ŒDI12345public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;book dao save...&quot;); &#125;&#125; 123456public class BookServiceImpl implements BookService &#123; private BookDao bookDao = new BookDaoImpl; public void save() &#123; bookDao.save(); &#125;&#125; è¿™æ˜¯ä¸€ç§å¾ˆå¸¸è§çš„å†™æ³•ã€‚ä½†æ˜¯è¿™æ ·çš„å†™æ³•è€¦åˆåº¦å¤ªé«˜ï¼Œè€¦åˆåº¦å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šä¸¤ä¸ªç±»ä¹‹é—´çš„å…³è”ç¨‹åº¦ï¼Œè€¦åˆåº¦é«˜å°±ä»£è¡¨ä¸¤ä¸ªç±»ä¹‹é—´å…³è”ç¨‹åº¦å¾ˆé«˜ï¼ŒåŠ¨å…¶ä¸­ä¸€ä¸ªç±»ï¼Œå°±ä¸å¾—ä¸åŠ¨å¦å¤–ä¸€ä¸ªç±»ã€‚ æ‰€ä»¥å°±éœ€è¦è§£è€¦ 123456public class BookServiceImpl implements BookService &#123; private BookDao bookDao;//service:æˆ‘å…è´¹å•¦ï¼ public void save() &#123; bookDao.save(); &#125;&#125; IOC(Inversion of Control) æ§åˆ¶åè½¬ ä½¿ç”¨å¯¹è±¡æ—¶ï¼Œç”±ä»¥å‰ä¸»åŠ¨newä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºç”±å¤–éƒ¨æä¾›å¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡çš„æ§åˆ¶æƒäº¤ç»™äº†å¤–éƒ¨ï¼Œæ­¤æ€æƒ³ä¸ºæ§åˆ¶åè½¬ã€‚ SpringæŠ€æœ¯å¯¹IOCè¿›è¡Œå®ç° Springæä¾›ä¸€ä¸ªå®¹å™¨ï¼Œç§°ä¸ºIOCå®¹å™¨ï¼Œç”¨æ¥å½“ä½œIOCæ€æƒ³ä¸­çš„**â€å¤–éƒ¨â€** IOCå®¹å™¨è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ç­‰å·¥ä½œ åœ¨IOCå®¹å™¨ä¸­è¢«åˆ›å»ºæˆ–è¢«ç®¡ç†çš„å¯¹è±¡ç§°ä¹‹ä¸ºBean DI(Dependency Injection) ä¾èµ–æ³¨å…¥ åœ¨å®¹å™¨ä¸­å»ºç«‹çš„beanä¸beanä¹‹é—´çš„ä¾èµ–å…³ç³»çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç§°ä¹‹ä¸ºä¾èµ–æ³¨å…¥ã€‚ ä¾‹ï¼šserviceå±‚éœ€è¦ä¾èµ–daoå±‚è¿è¡Œï¼Œä½†æ— éœ€è‡ªå·±newä¸€ä¸ªdaoå±‚ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆdaoå±‚ã€‚ ç›®æ ‡ï¼šå……åˆ†è§£è€¦ ä½¿ç”¨IOCå®¹å™¨ç®¡ç†bean(IOCæ€æƒ³) åœ¨ICOå®¹å™¨å†…å°†ä¾èµ–å…³ç³»çš„beanè¿›è¡Œå…³ç³»ç»‘å®š(DIæ€æƒ³) åœ¨ä½¿ç”¨å¯¹è±¡æ—¶ä¸ä»…å¯ä»¥ä»IOCå®¹å™¨ä¸­è·å–ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥è·å–åˆ°beanå·²ç»ç»‘å®šçš„æ‰€æœ‰ä¾èµ–å…³ç³» 4.IOCå…¥é—¨ pom.xmlå¯¼å…¥springçš„åæ ‡ 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.3.18&lt;/version&gt;&lt;/dependency&gt; resourcesç›®å½•åˆ›å»ºSpringé…ç½®æ–‡ä»¶applicationContext.xml é…ç½®bean beanæ ‡ç­¾ï¼šé…ç½®bean idå±æ€§ï¼šç»™beanèµ·åå­— classå±æ€§ï¼šç»™beanå®šä¹‰ç±»å‹ 123&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;/&gt; åˆ›å»ºåä¸ºå¯åŠ¨ç±»App 1234567891011121314151617import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import com.spring.dao.BookDao;public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); BookService bookService = (BookService) ac.getBean(&quot;bookService&quot;); bookService.save(); &#125;&#125; 5.DIå…¥é—¨ åŸºäºIOCç®¡ç†bean ä¸èƒ½ä¿ç•™Serviceå±‚ä¸­ç”¨newåˆ›å»ºçš„å¯¹è±¡ é€šè¿‡springé…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®Serviceä¸Daoçš„å…³ç³» 12345678910111213public class BookServiceImpl implements BookService &#123; //åˆ é™¤ä¸šåŠ¡å±‚ä¸­ç”¨newåˆ›å»ºå¯¹è±¡çš„æ–¹å¼ //private BookDao bookDao = new BookDaoImpl(); private BookDao bookDao; //æä¾›ç›¸åº”çš„setçš„æ–¹æ³• public void setBookDao(BookDao bookDao) &#123; this.bookDao = bookDao; &#125; public void save() &#123; bookDao.save(); &#125;&#125; åœ¨springé…ç½®æ–‡ä»¶applicationContext.xmlä¸­ï¼Œé…ç½®property propertyæ ‡ç­¾ï¼šé…ç½®å½“å‰beançš„å±æ€§ nameå±æ€§ï¼šé…ç½®å“ªä¸ªå…·ä½“çš„å±æ€§ refå±æ€§ï¼šå‚ç…§springé…ç½®æ–‡ä»¶ä¸­çš„å“ªä¸ªbeançš„id 123456&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;!-- é…ç½®serviceä¸daoçš„å…³ç³» --&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; é…ç½®å®Œæˆåï¼ŒBookDaoæ— éœ€ä½¿ç”¨newæ¥æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡springæ¥è‡ªåŠ¨åˆ›å»º 6.beanåŸºç¡€é…ç½®6.1 beanåˆ«åé…ç½® nameå±æ€§ï¼šå¯ä»¥èµ·å¤šä¸ªåˆ«åç”¨;åˆ†å· ç©ºæ ¼,é€—å·åˆ†éš” 123&lt;bean id=&quot;bookDao&quot; name=&quot;dao Dao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; name=&quot;Service service&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;/&gt; åˆ«åå¯ä»¥ç”¨äºgetBean()æ–¹æ³• 1234567891011public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean //BookService bookService=(BookService)ac.getBean(&quot;bookService&quot;); //é€šè¿‡åˆ«åè·å–BookService BookService bookService=(BookService)ac.getBean(&quot;Service&quot;); bookService.save(); &#125;&#125; åˆ«åä¹Ÿå¯ä»¥ç”¨æˆ·refå±æ€§ï¼Œä¸å»ºè®®ç”¨åˆ«åï¼Œå»ºè®®ä½¿ç”¨id 123&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;Dao&quot;/&gt;&lt;/bean&gt; 6.2 beançš„ä½œç”¨èŒƒå›´åˆ›å»ºçš„beanæ˜¯å¦ä¸ºå¤šä¸ªå¯¹è±¡ 123456789101112public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao1 = (BookDao) ac.getBean(&quot;bookDao&quot;); BookDao bookDao2 = (BookDao) ac.getBean(&quot;bookDao&quot;); System.out.println(bookDao1); System.out.println(bookDao2); &#125;&#125; 123è¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@7219ec67com.spring.dao.impl.BookDaoImpl@7219ec67 ç»“è®ºï¼šä¸¤ä¸ªå¯¹è±¡åœ°å€ç›¸åŒï¼Œspringé»˜è®¤åˆ›å»ºçš„beanæ˜¯å•ä¾‹çš„ éœ€è¦åœ¨é…ç½®æ–‡ä»¶çš„beanæ ‡ç­¾é‡Œæ·»åŠ ä¸€ä¸ªscopeå±æ€§ scopeå±æ€§æœ‰singletonå•ä¾‹æ¨¡å¼å’Œprototypeéå•ä¾‹æ¨¡å¼ scopeå±æ€§é»˜è®¤ä¸ºsingletonå•ä¾‹æ¨¡å¼ 1&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; scope=&quot;prtotype&quot;/&gt; 123å†æ¬¡è¿è¡Œåï¼Œè¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@7219ec67com.spring.dao.impl.BookDaoImpl@45018215 ç»“è®ºï¼šä¸¤ä¸ªå¯¹è±¡åœ°å€ä¸åŒï¼Œä¸ºéå•ä¾‹æ¨¡å¼ beanä½œç”¨èŒƒå›´è¯´æ˜ å•ä¾‹beançš„ä¼˜åŠ¿ å‡å°‘äº†æ–°ç”Ÿæˆå®ä¾‹çš„æ¶ˆè€—ï¼Œå¯ä»¥å¿«é€Ÿè·å–åˆ°beanï¼Œæ›´å¤§ç¨‹åº¦çš„å¤ç”¨ é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†çš„bean è¡¨ç°å±‚å¯¹è±¡ï¼Œä¸šåŠ¡å±‚å¯¹è±¡ï¼Œæ•°æ®å±‚å¯¹è±¡ï¼Œå·¥å…·å¯¹è±¡ ä¸é€‚åˆäº¤ç»™å®¹å™¨è¿›è¡Œç®¡ç†çš„bean å°è£…å®ä½“çš„åŸŸå¯¹è±¡(å­˜åœ¨å˜é‡çš„) 7.beanå®ä¾‹åŒ– beançš„æœ¬è´¨å°±æ˜¯å¯¹è±¡ï¼Œåˆ›å»ºbeanéƒ½éœ€è¦ä½¿ç”¨æ„é€ æ–¹æ³•å®Œæˆ 7.1 æ„é€ æ–¹æ³•å®ä¾‹åŒ–bean(å¸¸ç”¨) åœ¨BookDaoImplç±»ä¸­åˆ›å»ºæ„é€ æ–¹æ³•ï¼š 123456789101112public class BookDaoImpl implements BookDao &#123; public BookDaoImpl()&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;); &#125; /*private BookDaoImpl()&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;); &#125;*/ public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125;&#125; AppForInstanceBookç±»è¿›è¡Œæµ‹è¯•ï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ å¹¶ä¸”BookDaoImplä¸­çš„æ„é€ æ–¹æ³•æ— è®ºæ˜¯å¦ç§æœ‰éƒ½å¯ä»¥è¢«è°ƒç”¨ï¼Œè¿™å°±æ˜¯åå°„ã€‚ æ— å‚æ„é€ æ–¹æ³•ä¸å­˜åœ¨ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ åœ¨BookDaoImplç±»ä¸­æ„é€ æ–¹æ³•æ”¹ä¸ºæœ‰å‚æ„é€ ï¼š 123public BookDaoImpl(int i)&#123; System.out.println(&quot;BookDaoImplæ„é€ å‡½æ•°&quot;);&#125; è¿è¡Œåä¼šæŠ¥é”™ï¼ŒåŒæ—¶è¯´æ˜Springåˆ›å»ºbeançš„æ—¶å€™ï¼Œè°ƒç”¨çš„æ˜¯æ— å‚æ„é€ ã€‚ 7.2 é™æ€å·¥å‚å®ä¾‹åŒ–bean(æ—©æœŸå®ä¾‹åŒ–bean äº†è§£) åˆ›å»ºä¸€ä¸ªfactoryè½¯ä»¶åŒ…ï¼Œå¹¶åœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ªBookDaoFactoryç±»ï¼š 123456public class BookDaoFactory &#123; public static BookDao getBookDao()&#123; System.out.println(&quot;factory is running&quot;); return new BookDaoImpl(); &#125;&#125; AppForInstanceBookç±»è¿è¡Œï¼š 1234567public class AppForInstanceBook &#123; public static void main(String[] args) &#123; BookDao bookDao = BookDaoFactory.getBookDao(); bookDao.save(); &#125;&#125;//è¿è¡ŒæˆåŠŸ é€šè¿‡é…ç½®æ–‡ä»¶ä½¿ç”¨é™æ€å·¥å‚å®ä¾‹åŒ–beanï¼š Springé…ç½®æ–‡ä»¶ä¸­ï¼š factory-methodå±æ€§ï¼šé€‰æ‹©å·¥å‚é‡Œçš„beanå®ä¾‹æ–¹æ³• 12&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.factory.BookDaoFactory&quot; factory-method=&quot;getBookDao&quot;/&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is runningBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ 7.3 å®ä¾‹å·¥å‚å®ä¾‹åŒ–bean(éé™æ€å·¥å‚ äº†è§£) BookDaoFactoryç±»ä¸­ï¼Œå°†æ–¹æ³•æ”¹ä¸ºéé™æ€æ–¹æ³• 123456public class BookDaoFactory &#123; public BookDao getBookDao()&#123; System.out.println(&quot;factory is running~~~~~&quot;); return new BookDaoImpl(); &#125;&#125; AppForInstanceBookç±»è¿è¡Œï¼š 1234567public class AppForInstanceBook &#123; public static void main(String[] args) &#123; BookDaoFactory bookDaoFactory = new BookDaoFactory(); BookDao bookDao = bookDaoFactory.getBookDao(); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is running~~~~~BookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ é€šè¿‡é…ç½®æ–‡ä»¶ä½¿ç”¨é™æ€å·¥å‚å®ä¾‹åŒ–beanï¼š Springé…ç½®æ–‡ä»¶ä¸­ï¼š 12345&lt;!-- å…ˆè¦é€ å‡ºå·¥å‚çš„bean --&gt;&lt;bean id=&quot;bookDaoFactory&quot; class=&quot;com.spring.factory.BookDaoFactory&quot;/&gt;&lt;bean id=&quot;bookDao&quot; factory-bean=&quot;bookDaoFactory&quot; factory-method=&quot;getBookDao&quot; /&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šfactory is running~~~~~BookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ é…ç½®æ–‡ä»¶ä¸­beanbookDaoFactoryåªæ˜¯ä¸ºäº†é…åˆä½¿ç”¨ï¼Œå®é™…æ²¡æœ‰æ„ä¹‰ã€‚ Springå¯¹è¿™ç§å®ä¾‹åŒ–beanæ–¹æ³•è¿›è¡Œäº†æ”¹è‰¯ï¼š 4.é€šè¿‡FactoryBeanå®ä¾‹åŒ–bean(å®ç”¨) åˆ›å»ºBookDaoFactoryBeanç±»å®ç°æ¥å£FactoryBean&lt;T&gt; 123456789101112public class BookDaoFactoryBean implements FactoryBean&lt;BookDao&gt; &#123; //ä»£æ›¿åŸå§‹å®ä¾‹å·¥å‚ä¸­åˆ›å»ºå¯¹è±¡çš„æ–¹æ³• @Override public BookDao getObject() throws Exception &#123; return new BookDaoImpl(); &#125; @Override public Class&lt;?&gt; getObjectType() &#123; return BookDao.class; &#125;&#125; Springé…ç½®æ–‡ä»¶ä¸­ï¼š 1&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.factory.BookDaoFactoryBean&quot;/&gt; AppForInstanceBookç±»è¿è¡Œï¼š 12345678public class AppForInstanceBook &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDaoImplæ„é€ å‡½æ•°BookDao~~~~~ å¹¶ä¸”BookDaoFactoryBeanç±»ä¸­å¯ä»¥é‡å†™isSinglentonæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829&lt;table&gt; &lt;th align=&quot;center&quot;&gt; &lt;td rowspan=&quot;2&quot;&gt;Key&lt;/td&gt; &lt;td colspan=&quot;2&quot;&gt;Value&lt;/td&gt; &lt;/th&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td&gt;field&lt;/td&gt; &lt;td&gt;value&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td rowspan=&quot;2&quot;&gt;REQUIRES_NEW&lt;/td&gt; &lt;td&gt;å¼€å¯T&lt;/td&gt; &lt;td&gt;æ–°å»ºT2&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td&gt;æ— &lt;/td&gt; &lt;td&gt;æ–°å»ºT2&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td rowspan=&quot;2&quot;&gt;SUPPORTS&lt;/td&gt; &lt;td&gt;å¼€å¯T&lt;/td&gt; &lt;td&gt;åŠ å…¥T&lt;/td&gt; &lt;/tr&gt; &lt;tr align=&quot;center&quot;&gt; &lt;td&gt;æ— &lt;/td&gt; &lt;td&gt;æ— &lt;/td&gt; &lt;/tr&gt;&lt;/table&gt; 8.beançš„ç”Ÿå‘½å‘¨æœŸ beanç”Ÿå‘½å‘¨æœŸï¼šbeanä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä½“è¿‡ç¨‹ beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ï¼šåœ¨beanåˆ›å»ºååˆ°é”€æ¯å‰åšä¸€äº›äº‹ åœ¨BookDaoImplç±»ä¸­ï¼Œåˆ›å»ºinitå’Œdestroyæ–¹æ³• 1234567891011121314public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125; public void init()&#123; System.out.println(&quot;init~~~&quot;); &#125; public void destroy()&#123; System.out.println(&quot;destroy~~~&quot;); &#125;&#125; åœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼š init-methodå’Œdestroy-methodå±æ€§ 12&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;/&gt; è°ƒç”¨ä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~ æ§åˆ¶å°å¹¶æ²¡æœ‰è¾“å‡ºdestroy~~~ï¼› å› ä¸ºé”€æ¯å‡½æ•°è¿˜æ²¡æœ‰æ¥å¾—åŠè°ƒç”¨ï¼Œç¨‹åºå°±è¢«æ€æ­»äº†ï¼› æ‰€ä»¥éœ€è¦è¿›è¡Œæ‰‹åŠ¨å…³é—­ï¼› æˆ‘ä»¬è°ƒç”¨ä¸»å‡½æ•°ä¸­çš„acä¸­çš„close()æ–¹æ³•ï¼Œä½†æ˜¯ApplicationContextæ¥å£ä¸­å¹¶æ²¡æœ‰æä¾›close()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ”¹ç”¨ClassPathXmlApplicationContextç±»ã€‚ 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.close(); &#125;&#125; 12345è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~destroy~~~ æˆåŠŸï¼ï¼ï¼ï¼ å®¹å™¨è¿˜æä¾›å¦å¤–ä¸€ç§æ–¹å¼å…³é—­å®¹å™¨ï¼šè®¾ç½®å…³é—­é’©å­ è°ƒç”¨acçš„registerShutdownHook()æ–¹æ³• 1234567891011public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 1234è¿è¡Œç»“æœï¼šinit~~~BookDao~~~~~destroy~~~ close()å’ŒregisterShutdownHook()çš„åŒºåˆ« å°†registerShutdownHook()æ”¾åˆ°ä¸Šé¢ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); ac.registerShutdownHook(); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234è¿è¡ŒæˆåŠŸï¼šinit~~~BookDao~~~~~destroy~~~ å°†close()æ”¾åˆ°ä¸Šé¢ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); ac.close(); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 123456è¿è¡Œç»“æœï¼šinit~~~destroy~~~æŠ¥é”™ï¼šBeanFactory not initialized or already closed - call &#x27;refresh&#x27; before accessing beans via the ApplicationContext BeanFactoryæ²¡æœ‰è¢«åˆå§‹åŒ–æˆ–è€…å·²ç»è¢«å…³é—­äº† è¿è¡Œå¤±è´¥ï¼ï¼ æˆ–è€…é€šè¿‡æ¥å£çš„æ–¹å¼å®ç°ï¼š BookServiceImplç±»å®ç°æ¥å£InitializingBeanå’ŒDisposableBeançš„æ–¹æ³• 1234567891011121314151617181920212223public class BookServiceImpl implements BookService, InitializingBean, DisposableBean &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125; public void save() &#123; bookDao.save(); &#125; @Override public void destroy() throws Exception &#123; System.out.println(&quot;service destroy~~~~&quot;); &#125; @Override public void afterPropertiesSet() throws Exception &#123; System.out.println(&quot;service init~~~~&quot;); &#125;&#125; é…ç½®æ–‡ä»¶ï¼š 123456&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt;&lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; ä¸»å‡½æ•°è¿è¡Œï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 1234567è¿è¡Œç»“æœï¼šinit~~~BookDao set~~~service init~~~~BookDao~~~~~service destroy~~~~destroy~~~ BookServiceImplç±»ä¸­destroy()æ–¹æ³•å’ŒafterPropertiesSet()æ–¹æ³•è¢«è°ƒç”¨ å¹¶ä¸”setBookDao()æ–¹æ³•ä¹‹åæ‰è°ƒç”¨çš„afterPropertiesSet()æ–¹æ³• 9.ä¾èµ–æ³¨å…¥æ–¹å¼å‘ä¸€ä¸ªç±»ä¼ é€’æ•°æ®çš„æ–¹å¼æœ‰ï¼šsetæ–¹æ³•ã€æ„é€ æ–¹æ³• 9.1 setteræ³¨å…¥ å¼•ç”¨ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„setæ–¹æ³• BookServiceImplç±»ä¸­ï¼š 1234567public class BookServiceImpl implements BookService &#123; private BookDao bookDao; //æä¾›ç›¸åº”çš„setçš„æ–¹æ³• public void setBookDao(BookDao bookDao) &#123; this.bookDao = bookDao; &#125;&#125; åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨propertyæ ‡ç­¾refå±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ 12345&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;property name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; ç®€å•ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„setæ–¹æ³• BookDaoImplç±»ä¸­ï¼š 1234567891011121314public class BookDaoImpl implements BookDao &#123; private String name; private int age; public void setName(String name) &#123; this.name = name; &#125; public void setAge(int age) &#123; this.age = age; &#125; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name+&quot;å¹´é¾„ï¼š&quot;+age); &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨propertyæ ‡ç­¾valueå±æ€§æ³¨å…¥ç®€å•ç±»å‹æ•°æ® 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;DaHuang&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;18&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); ac.registerShutdownHook(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šDaHuangå¹´é¾„ï¼š18 9.2 æ„é€ å™¨æ³¨å…¥ å¼•ç”¨ç±»å‹ åœ¨beanä¸­å®šä¹‰å¼•ç”¨ç±»å‹å±æ€§å¹¶æä¾›å¯è®¿é—®çš„æ„é€ æ–¹æ³• 12345678public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public BookServiceImpl(BookDao bookDao) &#123; System.out.println(&quot;BookServiceImplæ„é€ å™¨è¿è¡Œ~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨constructor-argæ ‡ç­¾ä¸­çš„refå±æ€§æ³¨å…¥å¼•ç”¨ç±»å‹å¯¹è±¡ 12345678&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;DaHuang&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;18&quot;/&gt; &lt;/bean&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot;&gt; &lt;constructor-arg name=&quot;bookDao&quot; ref=&quot;bookDao&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookServiceImplæ„é€ å™¨è¿è¡Œ~~~ ç®€å•ç±»å‹ BookDaoImplç±»ä¸­ï¼š 123456789public class BookDaoImpl implements BookDao &#123; private String name; private int age; public BookDaoImpl(String name, int age) &#123; this.name = name; this.age = age; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼š 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;constructor-arg name=&quot;name&quot; value=&quot;DaHei&quot;/&gt; &lt;constructor-arg name=&quot;age&quot; value=&quot;20&quot;/&gt;&lt;/bean&gt; å¦‚æœè¦æ›´æ”¹BookDaoImplç±»ä¸­çš„å½¢å‚åå­—ï¼Œè¿˜è¦æ›´æ”¹é…ç½®æ–‡ä»¶ä¸­çš„nameå±æ€§çš„åå­—ï¼› å­˜åœ¨å½¢å‚ä¸nameå±æ€§åä¸è€¦åˆçš„é—®é¢˜ã€‚ constructor-argæ ‡ç­¾è¿˜æœ‰typeå’Œindexå±æ€§ typeï¼šå½¢å‚çš„æ•°æ®ç±»å‹(å­˜åœ¨å¤šä¸ªåŒæ•°æ®ç±»å‹çš„å½¢å‚ï¼Œæ— æ³•ä½¿ç”¨) indexï¼šå½¢å‚çš„ä½ç½®é¡ºåº åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨indexå±æ€§è®¾ç½®æŒ‰å½¢å‚ä½ç½®é¡ºåºæ³¨å…¥ 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;constructor-arg index=&quot;0&quot; value=&quot;DaHei&quot;/&gt; &lt;constructor-arg index=&quot;1&quot; value=&quot;20&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šDaHeiå¹´é¾„ï¼š20 9.3 ä¾èµ–æ³¨å…¥æ–¹å¼çš„é€‰æ‹© å¼ºåˆ¶ä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥æœ‰æ¦‚ç‡ä¸æ³¨å…¥å¯¼è‡´nullå¯¹è±¡å‡ºç°ã€‚ beanå¿…é¡»è¦çš„ä¸œè¥¿ï¼Œè¦ç”¨æ„é€ å™¨æ³¨å…¥ã€‚å› ä¸ºæ„é€ å™¨å¿…é¡»è¢«æ‰§è¡Œï¼Œå¿…é¡»æ³¨å…¥ï¼Œå¦åˆ™æŠ¥é”™ è€Œsetteræ–¹æ³•å¯ä»¥æ‰§è¡Œä¹Ÿå¯ä»¥ä¸æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œsetteræ³¨å…¥ï¼Œä¼šå¯¼è‡´nullå¯¹è±¡ å¯é€‰ä¾èµ–ä½¿ç”¨setteræ³¨å…¥è¿›è¡Œï¼Œçµæ´»æ€§å¼ºã€‚ setteræ³¨å…¥å¯ä»¥æ‰§è¡Œä¹Ÿå¯ä»¥ä¸æ‰§è¡Œ Springæ¡†æ¶å€¡å¯¼ä½¿ç”¨æ„é€ å™¨ã€‚ ç¬¬ä¸‰æ–¹æ¡†æ¶å¤§å¤šé‡‡ç”¨æ„é€ å™¨æ³¨å…¥çš„å½¢å¼åˆå§‹åŒ–æ•°æ®ï¼Œæ›´åŠ ä¸¥è°¨ setteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥å¯ä»¥åŒæ—¶ä½¿ç”¨ã€‚ ä½¿ç”¨æ„é€ å™¨å®Œæˆå¼ºåˆ¶ä¾èµ–æ³¨å…¥ï¼Œä½¿ç”¨setteræ³¨å…¥å®Œæˆå¯é€‰ä¾èµ–æ³¨å…¥ è‡ªå·±å¼€å‘çš„æ¨¡å—æ¨èä½¿ç”¨setteræ³¨å…¥ 10.ä¾èµ–è‡ªåŠ¨è£…é…IOCå®¹å™¨æ ¹æ®beanéƒ½ä¾èµ–çš„èµ„æºåœ¨å®¹å™¨ä¸­è‡ªåŠ¨æŸ¥æ‰¾å¹¶æ³¨å…¥åˆ°beanä¸­çš„è¿‡ç¨‹ç§°ä¸ºè‡ªåŠ¨è£…é… è‡ªåŠ¨è£…é…çš„æ–¹å¼ï¼š æŒ‰ç±»å‹(å¸¸ç”¨) æŒ‰åç§° æŒ‰æ„é€ æ–¹æ³•(ä¸æ¨è) ä¸å¯ç”¨è‡ªåŠ¨è£…é… 10.1 æŒ‰ç±»å‹éœ€è¦æä¾›ç›¸åº”çš„setteræ–¹æ³• 123456789public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œè¦æå‰å†™å¥½bookDaoçš„beanå¦åˆ™æ— æ³•è£…é…ï¼Œ autowireå±æ€§è®¾ç½®ä¸ºbyTpye é€šè¿‡ç±»å‹è‡ªåŠ¨è£…é… 1234&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;byType&quot; /&gt; ä¸»å‡½æ•°ï¼š 123456789public class App &#123; public static void main(String[] args) &#123; ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookService bookService = (BookService) ac.getBean(&quot;bookService&quot;); bookService.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao set~~~ å¦‚æœå‡ºç°ä¸€ä¸‹è¿™ç§æƒ…å†µï¼š 12345&lt;bean id=&quot;bookDao1&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookDao2&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;byType&quot; /&gt; å‡ºç°äº†ä¸¤ä¸ªBookDaoçš„beanï¼Œå¯¼è‡´Springæ— æ³•åŒºåˆ†äº†ï¼Œè¿™æ—¶å°±éœ€è¦æŒ‰åç§°è£…é… 10.2 æŒ‰åç§°123456789public class BookServiceImpl implements BookService &#123; private BookDao bookDao; public void setBookDao(BookDao bookDao) &#123; System.out.println(&quot;BookDao set~~~&quot;); this.bookDao = bookDao; &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼Œautowireå±æ€§è®¾ç½®ä¸ºbyName é€šè¿‡åç§°è‡ªåŠ¨è£…é… æ˜¯é€šè¿‡BookServiceImplç±»çš„å˜é‡åbookDaoä¸é…ç½®æ–‡ä»¶çš„beanä¸­idç›¸åŒåç§°çš„è¿›è¡Œç»‘å®š 12345&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookDao2&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;&lt;bean id=&quot;bookService&quot; class=&quot;com.spring.service.impl.BookServiceImpl&quot; autowire=&quot;ByName&quot; /&gt; 10.3 æ€»ç»“ è‡ªåŠ¨è£…é…ç”¨äºå¼•ç”¨ç±»å‹ä¾èµ–æ³¨å…¥ï¼Œä¸èƒ½å¯¹ç®€å•ç±»å‹è¿›è¡Œæ“ä½œ ä½¿ç”¨æŒ‰ç±»å‹è£…é…byTypeï¼Œå¿…é¡»ä¿éšœå®¹å™¨ä¸­ç›¸åŒç±»å‹çš„beanå”¯ä¸€ï¼Œæ¨èä½¿ç”¨ ä½¿ç”¨æŒ‰åç§°è£…é…byNameï¼Œå¿…é¡»ä¿éšœå®¹å™¨ä¸­å…·æœ‰æŒ‡å®šåç§°çš„beanï¼Œå˜é‡åè¦ä¸é…ç½®è€¦åˆï¼Œ ä¸æ¨èä½¿ç”¨ è‡ªåŠ¨è£…é…ä¼˜å…ˆçº§ä½äºsetteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥ï¼ŒåŒæ—¶å‡ºç°æ—¶è‡ªåŠ¨è£…é…é…ç½®å¤±æ•ˆ 11.é›†åˆæ³¨å…¥123456789101112131415161718192021222324252627public class BookDaoImpl implements BookDao &#123; private int[] array; private List&lt;String&gt; list; private Set&lt;String&gt; set; private Map&lt;String, String&gt; map; private Properties properties; public void setArray(int[] array) &#123;this.array = array;&#125; public void setList(List&lt;String&gt; list) &#123;this.list = list;&#125; public void setSet(Set&lt;String&gt; set) &#123;this.set = set;&#125; public void setMap(Map&lt;String, String&gt; map) &#123;this.map = map;&#125; public void setProperties(Properties properties) &#123;this.properties = properties;&#125; public void save() &#123; System.out.println(&quot;BookDaoImpl&#123;&quot; + &quot;\\narray=&quot; + Arrays.toString(array) + &quot;, \\nlist=&quot; + list + &quot;, \\nset=&quot; + set + &quot;, \\nmap=&quot; + map + &quot;, \\nproperties=&quot; + properties + &#x27;&#125;&#x27;); &#125;&#125; é…ç½®æ–‡ä»¶ä¸­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;array&quot; &gt; &lt;array&gt; &lt;value&gt;100&lt;/value&gt; &lt;value&gt;200&lt;/value&gt; &lt;value&gt;300&lt;/value&gt; &lt;/array&gt; &lt;/property&gt; &lt;property name=&quot;list&quot; &gt; &lt;list&gt; &lt;value&gt;å”±&lt;/value&gt; &lt;value&gt;è·³&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;property name=&quot;set&quot; &gt; &lt;set&gt; &lt;value&gt;å”±&lt;/value&gt; &lt;value&gt;è·³&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;value&gt;Rap&lt;/value&gt; &lt;/set&gt; &lt;/property&gt; &lt;property name=&quot;map&quot; &gt; &lt;map&gt; &lt;entry key=&quot;county&quot; value=&quot;china&quot;/&gt; &lt;entry key=&quot;province&quot; value=&quot;tianjin&quot;/&gt; &lt;entry key=&quot;city&quot; value=&quot;baodi&quot;/&gt; &lt;/map&gt; &lt;/property&gt; &lt;property name=&quot;properties&quot;&gt; &lt;props&gt; &lt;prop key=&quot;county&quot;&gt;china&lt;/prop&gt; &lt;prop key=&quot;province&quot;&gt;tianjin&lt;/prop&gt; &lt;prop key=&quot;city&quot;&gt;baodi&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); &#125;&#125; 1234567è¿è¡Œç»“æœï¼šBookDaoImpl&#123;array=[100, 200, 300], list=[å”±, è·³, Rap], set=[å”±, è·³, Rap], map=&#123;county=china, province=tianjin, city=baodi&#125;, properties=&#123;province=tianjin, city=baodi, county=china&#125;&#125; 12.æ•°æ®æºå¯¹è±¡ç®¡ç†åœ¨pom.xmlå¯¼å…¥druidåæ ‡ 12345678910&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.2.8&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.28&lt;/version&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶ä¸­ï¼Œç®¡ç†DruidDataSouurceå¯¹è±¡ 123456&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/demo&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt;&lt;/bean&gt; è¿è¡Œä¸»å‡½æ•°ï¼š 12345678910public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); DataSource dataSource = (DataSource) ac.getBean(&quot;dataSource&quot;); System.out.println(dataSource); &#125;&#125; 123456789101112è¿è¡Œç»“æœï¼š&#123; CreateTime:&quot;2022-06-24 22:27:03&quot;, ActiveCount:0, PoolingCount:0, CreateCount:0, DestroyCount:0, CloseCount:0, ConnectCount:0, Connections:[ ]&#125; 13.åŠ è½½propertiesé…ç½®ä¿¡æ¯åœ¨rescourceèµ„æºåŒ…ä¸­åˆ›å»ºjdbc.propertiesæ–‡ä»¶ï¼š 1234567jdbc.driver=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://localhost:3306/demojdbc.username=rootjdbc.password=123456username=dahuangage=18 é…ç½®æ–‡ä»¶ä¸­: åœ¨beansæ ‡ç­¾ä¸­å¼€å¯contextå‘½åç©ºé—´ ä½¿ç”¨contextç©ºé—´åŠ è½½propertiesæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- 1.å¼€å¯contextå‘½åç©ºé—´ --&gt; &lt;!-- 2.ä½¿ç”¨contextç©ºé—´åŠ è½½propertiesæ–‡ä»¶ --&gt; &lt;context:property-placeholder location=&quot;jdbc.properties&quot; system-properties-mode=&quot;NEVER&quot;/&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt; &lt;!-- ä½¿ç”¨å ä½ç¬¦$&#123;&#125;è¯»å–propertiesä¸­çš„å±æ€§ --&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;&gt; &lt;property name=&quot;name&quot; value=&quot;$&#123;username&#125;&quot;/&gt; &lt;property name=&quot;age&quot; value=&quot;$&#123;age&#125;&quot;/&gt; &lt;/bean&gt;&lt;/beans&gt; åŠ è½½propertiesæ–‡ä»¶æ ¼å¼ï¼š ä¸åŠ è½½ç³»ç»Ÿå±æ€§ï¼š 12&lt;context:property-placeholder location=&quot;jdbc.properties&quot; system-properties-mode=&quot;NEVER&quot;/&gt; åŠ è½½å¤šä¸ªpropertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;jdbc.properties, jdbc2.properties&quot;/&gt; åŠ è½½æ‰€æœ‰propertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;*.properties&quot;/&gt; åŠ è½½propertiesæ–‡ä»¶æ ‡å‡†æ ¼å¼ï¼š 1&lt;context:property-placeholder location=&quot;classpath:*.properties&quot;/&gt; ä»ç±»è·¯å¾„æˆ–jaråŒ…ä¸­æœç´¢åŠ è½½propertiesæ–‡ä»¶ï¼š 1&lt;context:property-placeholder location=&quot;classpath*:*.properties&quot;/&gt; 14.å®¹å™¨14.1 åˆ›å»ºå®¹å™¨çš„å‡ ç§æ–¹å¼ ç±»è·¯å¾„ä¸‹çš„åŠ è½½é…ç½®æ–‡ä»¶ 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); æ–‡ä»¶ç³»ç»Ÿä¸‹åŠ è½½çš„é…ç½®æ–‡ä»¶ 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;E:\\Java_Web\\Spring\\spring_01_IOC\\src\\main\\resources\\applicationContext.xml&quot;); åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ï¼š 1ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext1.xml&quot;,&quot;applicationContext2.xml&quot;); 14.2 è·å–beançš„å‡ ç§æ–¹å¼ ä½¿ç”¨beanåç§°è·å– 1BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); ä½¿ç”¨beanåç§°è·å–å¹¶æŒ‡å®šç±»å‹ 1BookDao bookDao = ac.getBean(&quot;bookDao&quot;,BookDao.class); ä½¿ç”¨beanç±»å‹è·å– 1BookDao bookDao = ac.getBean(BookDao.class);//å¯¹åº”çš„å®¹å™¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªè¯¥ç±»å‹ï¼Œå”¯ä¸€ 14.3 å®¹å™¨ç±»å±‚æ¬¡ç»“æ„ä½¿ç”¨ctrl+Hæ‰“å¼€å®¹å™¨ç±»çš„å±‚æ¬¡ç»“æ„å›¾ï¼š BeanFactoryï¼šæ˜¯IOCå®¹å™¨çš„é¡¶å±‚æ¥å£ï¼Œåˆå§‹åŒ–BeanFactoryå¯¹è±¡æ—¶ï¼ŒåŠ è½½çš„beanå»¶è¿ŸåŠ è½½ ApplicationContextï¼šæ˜¯Springå®¹å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œåˆå§‹åŒ–æ—¶beanç«‹å³åŠ è½½ â€‹ æä¾›åŸºç¡€çš„beanæ“ä½œç›¸å…³çš„æ–¹æ³•ï¼Œé€šè¿‡å…¶ä»–æ¥å£æ‰©å±•å…¶åŠŸèƒ½ ConfigurableApplicationContextï¼šæä¾›å…³é—­å®¹å™¨åŠŸèƒ½ ClassPathXmlApplicationContextï¼šå¸¸ç”¨å®ç°ç±» 14.4 BeanFactoryåˆå§‹åŒ–ç±»è·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; Rescoure rescoure = new ClassPathRescoure(&quot;applicationContext.xml&quot;); BeanFactory bf = new XmlBeanFactory(rescoure); BookDao bookDao = bf.getBean(&quot;bookDao&quot;,BookDao.class); bookDao.save(); &#125;&#125; BeanFactoryåˆ›å»ºå®Œæ¯•åï¼Œæ‰€æœ‰beanå‡ä¸ºå»¶è¿ŸåŠ è½½ 15.æ³¨è§£å¼€å‘*15.1 ç”¨æ³¨é‡Šå®šä¹‰bean123456@component(&quot;bookDao&quot;) //ç­‰ä»·äº&lt;bean id=&quot;bookDao&quot; class=&quot;com.spring.dao.impl.BookDaoImpl&quot;/&gt;public class BookDaoImpl implements BookDao &#123; public void save() &#123; System.out.println(&quot;BookDao~~~~~&quot;); &#125;&#125; 123456@Component //æ²¡æœ‰å†™beanåï¼Œè¦é€šè¿‡ç±»å‹è·å–beanpublic class BookServiceImpl implements BookService &#123; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); &#125;&#125; ä½†æ˜¯ï¼ŒSpringæ€ä¹ˆæ„ŸçŸ¥åˆ°æ³¨é‡Šå‘¢ï¼Ÿ é…ç½®æ–‡ä»¶ä¸­ï¼Œéœ€è¦æ·»åŠ æ‰«æç»„ä»¶ï¼š 123456789101112&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- æ‰«æ@componentç»„ä»¶ --&gt; &lt;!-- base-packageä¸ºæ‰«æçš„ä½ç½® --&gt; &lt;context:component-scan base-package=&quot;com.spring&quot;/&gt;&lt;/beans&gt; ä¸»å‡½æ•°ï¼š 123456789101112public class App &#123; public static void main(String[] args) &#123; //è·å–ICOå®¹å™¨ ClassPathXmlApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;); //è·å–bean BookDao bookDao = (BookDao) ac.getBean(&quot;bookDao&quot;); bookDao.save(); //å› ä¸º@componentï¼Œå¹¶æ²¡æœ‰å†™beanåï¼Œæ‰€ä»¥è¦ç”¨ç±»å‹è·å–bean BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDao~~~~~BookService~~~~ Springæä¾›@componentæ³¨è§£çš„ä¸‰ä¸ªè¡ç”Ÿæ³¨è§£ @Repositoryï¼šç”¨äºæ•°æ®å±‚beanå®šä¹‰(Daoå±‚) â€‹ ä¹Ÿå¯ä»¥åŠ æ‹¬å·æ¥æŒ‡å®šbeanåï¼Œå¦‚ï¼š@Repository(â€œbookDao2â€) @Serviceï¼šç”¨äºä¸šåŠ¡å±‚beanå®šä¹‰(Serviceå±‚) @Controllerï¼šç”¨äºè¡¨ç°å±‚beanå®šä¹‰(Controllerå±‚) @Service,@Repositoryä¸èƒ½å†™åœ¨æ¥å£ä¸Š,éœ€è¦å†™åœ¨æ¥å£çš„å®ç°ç±»ä¸Š 1234@Repositorypublic class BookDaoImpl implements BookDao &#123; &#125; 1234@Servicepublic class BookServiceImpl implements BookService &#123;&#125; 1234@Controllerpublic class BookController &#123;&#125; 15.2 çº¯æ³¨é‡Šå¼€å‘æ–°å»ºä¸€ä¸ªSpringConfigç±»ï¼Œç”¨æ¥æ›¿ä»£é…ç½®æ–‡ä»¶ã€‚ å…¶ä½ç½®ï¼šcom.spring.config.SpringConfig.java comåŒ… springåŒ… configåŒ… SpringConfig.java @Configuration ï¼šç”¨äºè®¾å®šå½“å‰ç±»ä¸ºé…ç½®ç±»@ComponentScan(&quot;com.spring&quot;) ï¼šç”¨ç”¨äºè®¾å®šæ‰«æè·¯å¾„ï¼Œæ­¤æ³¨é‡Šåªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®ç”¨æ•°ç»„æ ¼å¼ 123456//ç”¨æ¥æ›¿ä»£ &lt;context:component-scan base-package=&quot;com.spring&quot;/&gt;@Configuration //ç”¨äºè®¾å®šå½“å‰ç±»ä¸ºé…ç½®ç±»@ComponentScan(&quot;com.spring&quot;) //ç”¨ç”¨äºè®¾å®šæ‰«æè·¯å¾„ï¼Œæ­¤æ³¨é‡Šåªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¤šä¸ªæ•°æ®ç”¨æ•°ç»„æ ¼å¼public class SpringConfig &#123; &#125; ä¸»å‡½æ•°ï¼š 1234567891011public class AppForAnnotation &#123; public static void main(String[] args) &#123; //æ”¹ç”¨æ³¨é‡Šé…ç½®åˆå§‹åŒ–å®¹å™¨ ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.save(); BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookDao~~~~~BookService~~~~ 15.3 beanç®¡ç† ä½œç”¨èŒƒå›´ @Scope(&quot;singleton&quot;)ï¼šå•ä¾‹ï¼Œé»˜è®¤å•ä¾‹ @Scope(&quot;prototype&quot;)ï¼šå¤šä¾‹ beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ @PostConstructæ³¨è§£ï¼šinit @PreDestroyæ³¨è§£ï¼šdestory 123456789101112@Repository@Scope(&quot;prototype&quot;) //å¤šä¾‹public class BookDaoImpl implements BookDao &#123; @PostConstruct public void init()&#123; System.out.println(&quot;init~~~&quot;); &#125; @PreDestroy public void destroy()&#123; System.out.println(&quot;destroy~~~&quot;); &#125;&#125; 15.4 ä¾èµ–æ³¨å…¥1.å¼•ç”¨ç±»å‹ 1234567891011@Servicepublic class BookServiceImpl implements BookService &#123; @Autowired private BookDao bookDao; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); bookDao.save(); &#125;&#125; ä¸»å‡½æ•°ï¼š 12345678public class AppForAnnotation &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookService bookService = ac.getBean(BookService.class); bookService.save(); &#125;&#125; 123è¿è¡Œç»“æœï¼šBookService~~~~ //åœ¨åˆ›å»ºå¥½BookServiceçš„bean,å¹¶æ³¨å…¥BookDaoBookDao~~~~~ //è°ƒç”¨BookDaoçš„æ–¹æ³•save(); 123@Repository(&quot;bookDao&quot;)public class BookDaoImpl implements BookDao &#123;&#125; 123@Repository(&quot;bookDao2&quot;)public class BookDaoImpl2 implements BookDao &#123;&#125; å½“æœ‰å¤šä¸ªåŒç±»å‹çš„beanï¼Œä½¿ç”¨@Qualifier(&quot;bookDao2&quot;)æ¥æŒ‡å®šbeanå å¹¶ä¸”éœ€è¦@Autowiredå’Œ@Qualifier(&quot;bookDao2&quot;)ä¸€èµ·ä½¿ç”¨ 1234567891011@Servicepublic class BookServiceImpl implements BookService &#123; @Autowired @Qualifier(&quot;bookDao2&quot;) private BookDao bookDao; public void save() &#123; System.out.println(&quot;BookService~~~~&quot;); bookDao.save(); &#125;&#125; æ³¨æ„ï¼š è‡ªåŠ¨è£…é…åŸºäºåå°„è®¾è®¡åˆ›å»ºå¯¹è±¡å¹¶æš´åŠ›åå°„å¯¹åº”å±æ€§ä¸ºç§æœ‰å±æ€§åˆå§‹åŒ–æ•°æ®ï¼Œæ— éœ€æä¾›setteræ–¹æ³• è‡ªåŠ¨è£…é…å»ºè®®ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œå¦‚æœä¸æä¾›å¯¹åº”çš„æ„é€ æ–¹æ³•ï¼Œè¯·æä¾›å”¯ä¸€çš„æ„é€ æ–¹æ³• @Qualifieræ³¨è§£æ— æ³•å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»é…åˆ@Autowiredæ³¨è§£ä½¿ç”¨ 2.ç®€å•ç±»å‹ 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Value(&quot;dahuang&quot;) private String name; public void save()&#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name); &#125;&#125; ä¸»å‡½æ•°ï¼š 1234567public class AppForAnnotation &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.save(); &#125;&#125; 12è¿è¡Œç»“æœï¼šBookDao~~~~~å§“åï¼šdahaung ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç›´æ¥èµ‹å€¼ï¼Œä¸ºä»€ä¹ˆè¦ç”¨@Valueæ³¨è§£å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥ç”¨propertiesæ–‡ä»¶ï¼Œå‘å…¶ä¼ å€¼ã€‚ 3.è¯»å–propertiesæ–‡ä»¶ é€šè¿‡åˆ›å»ºä¸€ä¸ªjdbc.propertiesæ–‡ä»¶ï¼š 1name=dahei åœ¨é…ç½®ç±»ä¸­æ–°åŠ æ³¨è§£@PropertySource()ï¼Œæ‹¬å·ä¸­æŒ‡å®šæ–‡ä»¶åï¼š å¦‚ï¼š@PropertySource(&quot;jdbc.properties&quot;)æˆ–è€…@PropertySource(&quot;classpath:jdbc.properties&quot;) ä¹Ÿå¯ä»¥æŒ‡å®šå¤šä¸ªæ–‡ä»¶ï¼š å¦‚ï¼š@PropertySource(&#123;&quot;jdbc.properties&quot;,&quot;jdbc1.properties&quot;,&quot;jdbc2.properties&quot;&#125;) 12345@Configuration@ComponentScan(&quot;com.spring&quot;)@PropertySource(&quot;jdbc.properties&quot;)public class SpringConfig &#123;&#125; åœ¨BookDaoImplä¸­å°†æ³¨è§£æ”¹ä¸ºï¼š@Value(&quot;$&#123;&#125;&quot;)ï¼Œåœ¨&#123;&#125;ä¸­å¡«å…¥propertiesæ–‡ä»¶ä¸­çš„å±æ€§ å¦‚ï¼š@Value(&quot;$&#123;name&#125;&quot;) 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Value(&quot;$&#123;name&#125;&quot;) private String name; public void save()&#123; System.out.println(&quot;BookDao~~~~~&quot;+&quot;å§“åï¼š&quot;+name); &#125;&#125; 15.5 ç¬¬ä¸‰æ–¹beanç®¡ç†1.ä½¿ç”¨ç‹¬ç«‹çš„é…ç½®ç®¡ç†ç¬¬ä¸‰æ–¹bean 12345678910111213@Configurationpublic class SpringConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.getUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; ä½†æ˜¯ä¸å»ºè®®å°†ç‹¬ç«‹é…ç½®ç›´æ¥å†™åœ¨æ ¸å¿ƒé…ç½®ç±»ä¸­ï¼š æ–¹æ³•ä¸€ï¼šå¯¼å…¥å¼(å»ºè®®ä½¿ç”¨) åœ¨configåŒ…åˆ›å»ºä¸€ä¸ªJdbcConfig.javaé…ç½®ç±»ï¼š 12345678910111213public class JdbcConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.setUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; åœ¨SpringConfig.javaæ ¸å¿ƒé…ç½®ç±»ä¸­å¯¼å…¥ï¼š ä½¿ç”¨æ³¨è§£@Import()åœ¨æ‹¬å·ä¸­æ·»åŠ è¦å¯¼å…¥çš„é…ç½®ç±»çš„ç±»å‹ å¦‚ï¼š@Import(JdbcConfig.class) æ­¤æ³¨è§£åªèƒ½æ·»åŠ ä¸€æ¬¡ï¼Œå¯¼å…¥å¤šä¸ªé…ç½®ç±»ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ ¼å¼å¯¼å…¥ å¦‚ï¼š@Import(&#123;JdbcConfig.class, XXXConfig.class, XXXConfig.calss&#125;) 12345@Configuration@Import(JdbcConfig.class)public class SpringConfig &#123; &#125; æ–¹å¼äºŒï¼šæ‰«æå¼(ä¸å»ºè®®ä½¿ç”¨) æ³¨æ„ï¼šä½¿ç”¨æ‰«æå¼éœ€è¦åœ¨ç‹¬ç«‹çš„é…ç½®ç±»åŠ å…¥æ³¨è§£@Configuration 1234567891011121314@Configurationpublic class JdbcConfig &#123; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); //ç›¸å…³é…ç½® ds.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); ds.setUrl(&quot;jdbc:mysql://localhost:3306/demo&quot;); ds.setUsername(&quot;root&quot;); ds.setPassword(&quot;123456&quot;); return ds; &#125;&#125; åœ¨SpringConfig.javaæ ¸å¿ƒé…ç½®ç±»ä¸­æ‰«æï¼š ä½¿ç”¨æ³¨è§£@ComponentScan()åœ¨æ‹¬å·ä¸­æ·»åŠ è¦æ‰«æçš„è·¯å¾„ å¦‚ï¼š@@ComponentScan(&quot;com.spring.config&quot;) æ‰«æå¤šä¸ªè·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ ¼å¼å¯¼å…¥ å¦‚ï¼š@Import(&#123;&quot;com.spring.config&quot;,&quot;com.spring.dao&quot;&#125;) 12345@Configuration@ComponentScan(&quot;com.spring.config&quot;)public class SpringConfig &#123; &#125; 2.ç¬¬ä¸‰æ–¹beanæ³¨å…¥èµ„æº ç®€å•ç±»å‹ä¾èµ–æ³¨å…¥(æˆå‘˜å˜é‡)ï¼š åˆ©ç”¨æ³¨è§£@PropertySource(&quot;jdbc.properties&quot;)å’Œ@Import(JdbcConfig.class)å¯¼å…¥æ ¸å¿ƒä¸»é…ç½®æ–‡ä»¶ä¸­ 123456@Configuration@ComponentScan(&quot;com.spring&quot;)@PropertySource(&quot;jdbc.properties&quot;)@Import(JdbcConfig.class)public class SpringConfig &#123;&#125; åˆ©ç”¨æ³¨è§£@Value(&quot;$&#123;&#125;&quot;)æ³¨å…¥æ•°æ® 12345678910111213141516171819202122public class JdbcConfig &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String userName; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; //å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); ds.setDriverClassName(driver); ds.setUrl(url); ds.setUsername(userName); ds.setPassword(password); return ds; &#125;&#125; å¼•å…¥ç±»å‹ä¾èµ–æ³¨å…¥(æ–¹æ³•å½¢å‚)ï¼š å¼•ç”¨ç±»å‹æ³¨å…¥åªéœ€è¦ä¸ºbeanå®šä¹‰çš„æ–¹æ³•è®¾ç½®å½¢å‚ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…å¯¹è±¡ 123456789//å®šä¹‰ä¸€ä¸ªæ–¹æ³•è·å¾—æƒ³è¦ç®¡ç†çš„bean @Bean // è¡¨ç¤ºå½“å‰æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªbean public DataSource dataSource(BookDao bookDao)&#123; System.out.println(&quot;å·²å¼•ç”¨ï¼š&quot;+bookDao); DruidDataSource ds = new DruidDataSource(); //å¯¹dsè¿›è¡Œç›¸å…³è®¾ç½® return ds; &#125; 15.6 æ€»ç»“XMLé…ç½®ä¸æ³¨è§£é…ç½®çš„æ¯”è¾ƒï¼š åŠŸèƒ½ XMLé…ç½® æ³¨è§£ å®šä¹‰bean beanæ ‡ç­¾ï¼š&gt;idå±æ€§&gt;classå±æ€§ @Component &gt;@Controller &gt;@Service &gt;@Repository@ComponentScan è®¾ç½®ä¾èµ–æ³¨å…¥ setteræ³¨å…¥(setæ–¹æ³•)&gt;å¼•ç”¨&#x2F;ç®€å•æ„é€ å™¨æ³¨å…¥(æ„é€ æ–¹æ³•)&gt;è‡ªåŠ¨è£…é… @Autowird&gt;@Qualifier@Value é…ç½®ç¬¬ä¸‰æ–¹bean beanæ ‡ç­¾&gt;é™æ€å·¥å‚&gt;å®ä¾‹å·¥å‚&gt;FactoryBean @Bean ä½œç”¨èŒƒå›´ scopeå±æ€§ @Scope ç”Ÿå‘½å‘¨æœŸ æ ‡å‡†æ¥å£&gt;init-method&gt;destory-method @PostConstructor@PreDestroy 16.AOP16.1 AOPç®€ä»‹ AOP(Aspect Oriented Programming)é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼ŒæŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ç»„ç»‡ç¨‹åºç»“æ„ OOP(Object Oriented Programing)é¢å‘å¯¹è±¡ç¼–ç¨‹ ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºå…¶è¿›è¡ŒåŠŸèƒ½å¢å¼º Springç†å¿µï¼šæ— å…¥ä¾µå¼&#x2F;æ— ä¾µå…¥å¼ æ‰§è¡Œsave()æ–¹æ³• è¿è¡Œç»“æœï¼š æ‰“å°å‡ºä¸€ä¸‡æ¬¡çš„book dao save â€¦ å’Œæ¶ˆè€—çš„æ—¶é—´ æ‰§è¡Œupdate()æ–¹æ³•æ²¡æœ‰å›¾ä¸­è“è‰²åŒºåŸŸçš„ä»£ç ï¼Œ ä½†æ˜¯ï¼Œè¿è¡Œç»“æœï¼š ä»ä¼šæ‰“å°æ‰“å°å‡ºä¸€ä¸‡æ¬¡çš„book dao update â€¦ å’Œæ¶ˆè€—çš„æ—¶é—´ è¿æ¥ç‚¹(JoinPoint)ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»æ„ä½ç½®ï¼Œç²’åº¦ä¸ºæ‰§è¡Œæ–¹æ³•ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè®¾ç½®å˜é‡ç­‰(ä»£è¡¨æ‰€æœ‰çš„æ–¹æ³•) åœ¨SpringAOPä¸­ï¼Œç†è§£æ–¹æ³•çš„æ‰§è¡Œ åˆ‡å…¥ç‚¹(Pointcut)ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­(ä»£è¡¨è¦è¿½åŠ åŠŸèƒ½çš„æ–¹æ³•) åœ¨SpringAOPä¸­ï¼Œä¸€ä¸ªåˆ‡å…¥ç‚¹åªæè¿°ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åŒ¹é…å¤šä¸ªæ–¹æ³• ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼šcom.spring.daoåŒ…ä¸‹çš„BookDaoæ¥å£ä¸­çš„äº”æ˜Ÿå‚æ— è¿”å›å€¼çš„save()æ–¹æ³• åŒ¹é…å¤šä¸ªæ–¹æ³•ï¼šæ‰€æœ‰saveæ–¹æ³•ï¼Œæ‰€æœ‰çš„getå¼€å¤´çš„æ–¹æ³•ï¼Œæ‰€æœ‰ä»¥Daoç»“å°¾çš„æ¥å£ä¸­çš„ä»»æ„æ–¹æ³•ï¼Œæ‰€æœ‰å¸¦æœ‰ä¸€ä¸ªå½¢å‚çš„æ–¹æ³• é€šçŸ¥(Advice)ï¼šåœ¨åˆ‡å…¥ç‚¹æ‰§è¡Œçš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½(ä»£è¡¨è¿½åŠ çš„åŠŸèƒ½) åœ¨SpringAOPä¸­ï¼ŒåŠŸèƒ½æœ€ç»ˆä»¥æ–¹æ³•çš„å½¢å¼å‘ˆç° é€šçŸ¥ç±»ï¼šå®šä¹‰é€šçŸ¥çš„ç±» åˆ‡é¢(Aspect)ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥çš„å¯¹åº”å…³ç³» 16.2 AOPå…¥é—¨ æ¡ˆä¾‹è®¾å®šï¼šæµ‹è¯•æ¥å£æ‰§è¡Œæ•ˆç‡ ç®€åŒ–è®¾å®šï¼šåœ¨æ¥å£æ‰§è¡Œå½“å‰è¾“å‡ºå½“å‰çš„ç³»ç»Ÿæ—¶é—´ å¼€å‘æ¨¡å¼ï¼šXML or æ³¨è§£(æ­¤å…¥é—¨æ¡ˆä¾‹é‡‡ç”¨æ³¨è§£çš„æ–¹å¼) æ€è·¯åˆ†æï¼š å¯¼å…¥åæ ‡(pom.xml) åˆ¶ä½œè¿æ¥ç‚¹æ–¹æ³•(åŸå§‹æ“ä½œï¼ŒDaoæ¥å£ä¸å®ç°ç±») åˆ¶ä½œå…±æ€§åŠŸèƒ½(é€šçŸ¥ç±»ä¸é€šçŸ¥) å®šä¹‰åˆ‡å…¥ç‚¹ ç»‘å®šåˆ‡å…¥ç‚¹ä¸é€šçŸ¥å…³ç³»(åˆ‡é¢) pom.xmlï¼š 1234567891011&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.3.18&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.9.9.1&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºä¸€ä¸ªMyAdivice.javaç±» å…¶ä½ç½®ï¼šcom.spring.aop.MyAdivice.java @Componentæ³¨è§£ï¼šå®šä¹‰ä¸ºSpringåŠ è½½çš„bean @Aspectæ³¨è§£ï¼šæŠŠå½“å‰ç±»æ ‡è¯†ä¸ºâ¼€ä¸ªåˆ‡â¾¯ä¾›å®¹å™¨è¯»å– @Pointcut(&quot;execution()&quot;)æ³¨è§£ï¼šå®šä¹‰åˆ‡å…¥ç‚¹ï¼Œâ½…æ³•ç­¾åå¿…é¡»æ˜¯publicåŠvoidå‹ã€‚ @Before(&quot;pt()&quot;)æ³¨è§£ï¼šæ ‡è¯†â¼€ä¸ªå‰ç½®å¢å¼ºâ½…æ³• åˆ‡å…¥ç‚¹pt()çš„å®šä¹‰ä¾æ‰˜ä¸€ä¸ªä¸å…·æœ‰å®é™…æ„ä¹‰çš„æ–¹æ³•è¿›è¡Œï¼Œå³æ— å‚æ•°ã€æ— è¿”å›å€¼ã€æ–¹æ³•æ— å®é™…é€»è¾‘ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(System.currentTimeMillis()); &#125;&#125; @EnableAspectJAutoProxyæ³¨è§£ï¼šå¼€å¯AOPä»£ç†è‡ªåŠ¨é…ç½® 123456@Configuration@ComponentScan(&quot;com.spring&quot;)@EnableAspectJAutoProxypublic class SpringConfig &#123;&#125; ä¸»å‡½æ•°ï¼š 1234567public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.update(); &#125;&#125; 123è¿è¡Œç»“æœï¼š1656341601464book dao update~~~ 16.3 AOPå·¥ä½œæµç¨‹ Springå®¹å™¨å¯åŠ¨ è¯»å–æ‰€æœ‰åˆ‡é¢é…ç½®ä¸­çš„åˆ‡å…¥ç‚¹ åˆå§‹åŒ–beanï¼Œåˆ¤å®šbeanå¯¹åº”çš„ç±»ä¸­çš„æ–¹æ³•æ˜¯å¦åŒ¹é…åˆ°ä»»æ„åˆ‡å…¥ç‚¹ åŒ¹é…å¤±è´¥ï¼Œåˆ›å»ºå¯¹è±¡ è·å–beanï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ åŒ¹é…æˆåŠŸï¼Œè°ƒç”¨æ–¹æ³•å¹¶æ‰§è¡Œï¼Œå®Œæˆæ“ä½œ è·å–çš„beanæ˜¯ä»£ç†å¯¹è±¡æ—¶ï¼Œæ ¹æ®ä»£ç†å¯¹è±¡çš„è¿è¡Œæ¨¡å¼è¿è¡ŒåŸå§‹æ–¹æ³•ä¸å¢å¼ºå†…å®¹ï¼Œå®Œæˆæ“ä½œ AOPæ ¸å¿ƒæœ¬è´¨ï¼šä»£ç†æ¨¡å¼ ç›®æ ‡å¯¹è±¡(Target)ï¼šåŸå§‹åŠŸèƒ½å»æ‰å…±æ€§åŠŸèƒ½å¯¹åº”çš„ç±»äº§ç”Ÿçš„å¯¹è±¡ï¼Œè¿™ç§å¯¹è±¡æ˜¯æ— æ³•ç›´æ¥å®Œæˆæœ€ç»ˆå·¥ä½œçš„ ä»£ç†(proxy)ï¼šç›®æ ‡å¯¹è±¡æ— æ³•ç›´æ¥å®Œæˆå·¥ä½œï¼Œéœ€è¦è¿›è¡ŒåŠŸèƒ½å›å¡«ï¼Œé€šè¿‡åŸå§‹å¯¹è±¡çš„ä»£ç†å¯¹è±¡å®ç° ä»£ç ä¾æ—§æ˜¯å…¥é—¨æ¡ˆä¾‹çš„ ä½†æ˜¯å°†ä¸»å‡½æ•°ä¿®æ”¹ï¼Œæ‰“å°bookDaoçš„ç±»å‹ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); System.out.println(bookDao); System.out.println(bookDao.getClass()); &#125;&#125; 123è¿è¡Œç»“æœï¼šcom.spring.dao.impl.BookDaoImpl@d23e042class jdk.proxy2.$Proxy20 System.out.println(bookDao)æ‰“å°å‡ºcom.spring.dao.impl.BookDaoImpl@d23e042 æ˜¯å› ä¸ºAOPå¯¹BookDaoçš„toString()æ–¹æ³•è¿›è¡Œäº†é‡å†™ class jdk.proxy2.$Proxy20ï¼šæœ€ç»ˆç”¨çš„æ˜¯ä»£ç†çš„å¯¹è±¡ 16.4 AOPåˆ‡å…¥ç‚¹è¡¨è¾¾å¼åˆ‡å…¥ç‚¹ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³• åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼šè¦è¿›è¡Œå¢å¼ºçš„æ–¹æ³•çš„æè¿°æ–¹æ³• 1.è¯­æ³•æ ¼å¼ åˆ‡å…¥ç‚¹æ ‡å‡†æ ¼å¼ï¼šåŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.æ¥å£/ç±»å.æ–¹æ³•(å‚æ•°) å¼‚å¸¸å) 12execution(public User com.spring.service.UserService.findById(int))execution(public User com.spring.service.impl.UserServiceImpl.findById(int)) åŠ¨ä½œå…³é”®å­—ï¼šæè¿°åˆ‡å…¥ç‚¹è¡Œä¸ºåŠ¨ä½œï¼Œå¦‚executionè¡¨ç¤ºæ‰§è¡Œåˆ°æŒ‡å®šåˆ‡å…¥ç‚¹ è®¿é—®ä¿®é¥°ç¬¦ï¼špublicï¼Œprivateç­‰ï¼Œå¯ä»¥çœç•¥ è¿”å›å€¼ åŒ…å æ¥å£&#x2F;ç±»åï¼šæ¥å£åæˆ–è€…ç±»åéƒ½å¯ä»¥ æ–¹æ³•å å‚æ•° å¼‚å¸¸åï¼šæ–¹æ³•å®šä¹‰ä¸­æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼Œå¯ä»¥çœç•¥ 2.é€šé…ç¬¦ å¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥ç‚¹ï¼Œå¿«é€Ÿæè¿° *ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‰ç¼€æˆ–è€…åç¼€çš„åŒ¹é…ç¬¦å‡ºç° 1execution(public * com.spring.*.UserService.find*(*)) è§£é‡Šï¼šåŒ¹é…com.springåŒ…ä¸‹çš„ä»»æ„åŒ…ä¸­å«æœ‰UserServiceç±»æˆ–æ¥å£ä¸­æ‰€æœ‰å«æœ‰findå¼€å¤´çš„å¸¦æœ‰ä»»æ„ä¸€ä¸ªå‚æ•°çš„æ–¹æ³• ..ï¼šå¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºç°ï¼Œå¸¸ç”¨äºç®€åŒ–åŒ…åä¸å‚æ•°çš„ä¹¦å†™ 1execution(public User com..UserService.findById(..)) è§£é‡Šï¼šåŒ¹é…comåŒ…ä¸­çš„ä»»æ„åŒ…ä¸­çš„UserServiceç±»æˆ–æ¥å£ä¸­çš„æ‰€æœ‰åç§°ä¸ºfindByIdçš„æ–¹æ³• +ï¼šä¸“ç”¨äºåŒ¹é…å­ç±»ç±»å‹ 1execution(* *..*Service+.*(..)) è§£é‡Šï¼šåŒ¹é…Â·ä»»æ„åŒ…ä¸‹çš„ä»¥Serviceç»“å°¾çš„ç±»æˆ–æ¥å£çš„å­ç±»ä¸­ä¸šåŠ¡å±‚çš„æ‰€æœ‰æ–¹æ³• å¸¸ç”¨å†™æ³• 1execution(* com.spring.*.*Service.save(..)) è§£é‡Šï¼šåŒ¹é…ä¸šåŠ¡å±‚æ‰€æœ‰çš„åä¸ºsaveçš„æ–¹æ³• 3.ä¹¦å†™æŠ€å·§ æ‰€æœ‰ä»£ç æŒ‰ç…§æ ‡å‡†è§„èŒƒå¼€å‘ï¼Œå¦åˆ™ä¸€ä¸‹æŠ€å·§å…¨éƒ¨å¤±æ•ˆ æè¿°åˆ‡å…¥ç‚¹é€šå¸¸æè¿°æ¥å£ï¼Œè€Œä¸æè¿°å®ç°ç±» è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦é’ˆå¯¹æ¥å£å¼€å‘å‡é‡‡ç”¨publicæè¿°(å¯çœç•¥) è¿”å›å€¼ç±»å‹å¯¹åº”å¢åˆ æ”¹ç±»ä½¿ç”¨ç²¾å‡†ç±»å‹åŠ é€ŸåŒ¹é…ï¼Œå¯¹äºæŸ¥è¯¢ç±»è¿”å›å€¼ä½¿ç”¨*é€šé…ç¬¦å¿«é€Ÿæè¿° åŒ…åä¹¦å†™å°½é‡ä¸ä½¿ç”¨..åŒ¹é…ï¼Œæ•ˆç‡è¿‡ä½ï¼Œå¸¸ç”¨*åšå•ä¸ªåŒ…æè¿°åŒ¹é…ï¼Œæˆ–ç²¾å‡†åŒ¹é… æ¥å£å&#x2F;ç±»åä¹¦å†™åç§°ä¸æ¨¡å—çš„é‡‡ç”¨*åŒ¹é… å¦‚ï¼šUserServiceä¹¦å†™æˆ*Serviceï¼Œç»‘å®šä¸šåŠ¡å±‚æ¥å£å æ–¹æ³•åä¹¦å†™ä»¥åŠ¨è¯è¿›è¡Œç²¾å‡†åŒ¹é…ï¼Œåè¯é‡‡ç”¨*åŒ¹é… å¦‚ï¼šgetByIdä¹¦å†™æˆgetBy*ï¼ŒselectAllä¹¦å†™æˆselectAll å‚æ•°è§„åˆ™è¾ƒä¸ºå¤æ‚ï¼Œæ ¹æ®ä¸šåŠ¡æ–¹æ³•çµæ´»è°ƒæ•´ é€šå¸¸ä¸ä½¿ç”¨å¼‚å¸¸ä½œä¸ºåŒ¹é…è§„åˆ™ 16.5 AOPé€šçŸ¥ç±»å‹AOPé€šçŸ¥æè¿°äº†æŠ½å–çš„å…±æ€§åŠŸèƒ½ï¼Œæ ¹æ®å…±æ€§åŠŸèƒ½æŠ½å–çš„ä½ç½®ä¸åŒï¼Œæœ€ç»ˆè¿è¡Œä»£ç æ—¶è¦å°†å…¶åŠ å…¥åˆ°åˆç†çš„ä½ç½® AOPé€šçŸ¥å…±åˆ†ä¸º5é’Ÿç±»å‹ å‰ç½®é€šçŸ¥ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;before~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbefore~~~book dao update~~~ åç½®é€šçŸ¥ â€‹ 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;after~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbook dao update~~~after~~~ ç¯ç»•é€šçŸ¥(é‡ç‚¹) 1.æ— è¿”å›å€¼ 1234567891011121314@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.update())&quot;) private void pt()&#123;&#125; @Around(&quot;pt()&quot;) public void method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨ pjp.proceed(); System.out.println(&quot;after~~~&quot;); &#125;&#125; 1234è¿è¡Œç»“æœï¼šbefore~~~book dao update~~~after~~~ 2.æœ‰è¿”å›å€¼ åœ¨BookDaoImplä¸­æ–°å†™ä¸€ä¸ªæœ‰è¿”å›å€¼çš„selectæ–¹æ³• 12345678@Repositorypublic class BookDaoImpl implements BookDao &#123; @Override public int select() &#123; System.out.println(&quot;book dao select~~~&quot;); return 100; &#125;&#125; 123456789101112131415@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(void com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); //è¡¨ç¤ºå¯¹åŸå§‹æ“ä½œçš„è°ƒç”¨ï¼Œå¹¶è·å¾—è¿”å›å€¼ Object ret = pjp.proceed(); System.out.println(&quot;after~~~&quot;); return ret; &#125;&#125; ä¸»å‡½æ•°ï¼š 12345678public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); int num = bookDao.select(); System.out.println(num); &#125;&#125; 12345è¿è¡Œç»“æœï¼šbefore~~~book dao select~~~after~~~100 å¹¶ä¸”æœ‰æ— è¿”å›å€¼éƒ½å»ºè®®è¿™æ ·çš„å†™æ³•ï¼š 1234567@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; System.out.println(&quot;before~~~&quot;); Object ret = pjp.proceed(); System.out.println(&quot;after~~~&quot;); return ret; &#125; @Aroundæ³¨æ„äº‹é¡¹ ç¯ç»•é€šçŸ¥å¿…é¡»ä¾èµ–å½¢å‚ProceedingJoinPointæ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ ,è¿›è€Œå®ç°åŸå§‹æ–¹æ³•è°ƒç”¨å‰ååŒæ—¶æ·»åŠ é€šçŸ¥ é€šçŸ¥ä¸­å¦‚æœæœªä½¿ç”¨ProceedingJoinPointå¯¹åŸå§‹æ–¹æ³•è¿›è¡Œè°ƒç”¨å°†è·³è¿‡åŸå§‹æ–¹æ³•çš„æ‰§è¡Œ å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨å¯ä»¥ä¸æ¥æ”¶è¿”å›å€¼ ,é€šçŸ¥æ–¹æ³•è®¾ç½®æˆvoidå³å¯, å¦‚æœæ¥æ”¶è¿”å›å€¼, å¿…é¡»è®¾å®šä¸ºObjectç±»å‹ åŸå§‹æ–¹æ³•çš„è¿”å›å€¼å¦‚æœ æ˜¯voidç±»å‹,é€šçŸ¥æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å¯ä»¥è®¾ç½®æˆvoid ,ä¹Ÿå¯ä»¥è®¾ç½®æˆObject ç”±äºæ— æ³•é¢„çŸ¥åŸå§‹æ–¹æ³•è¿è¡Œåæ˜¯å¦ä¼šæŠ›å‡ºå¼‚å¸¸ ,å› æ­¤ç¯ç»•é€šçŸ¥æ–¹æ³•å¿…é¡»æŠ›å‡ºThrowableå¯¹è±¡ è¿”å›åé€šçŸ¥(äº†è§£) 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @AfterReturning(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;afterReturn~~~&quot;); &#125;&#125; 1234è¿è¡Œç»“æœï¼šbook dao select~~~afterReturn~~~100 @afterå’Œ@AfterReturningçš„åŒºåˆ«ï¼š åŸå§‹æ–¹æ³•æœ‰å¼‚å¸¸æ—¶ï¼š @afterä¹Ÿä¼šæ‰“å°é€šçŸ¥çš„æ–¹æ³• @AfterReturningä¸ä¼šæ‰“å°é€šçŸ¥çš„æ–¹æ³• æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥(äº†è§£) 1234567891011@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select())&quot;) private void pt()&#123;&#125; @AfterThrowing(&quot;pt()&quot;) public void method()&#123; System.out.println(&quot;afterThrowing~~~&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼šbook dao select~~~100 @AfterThrowingæ³¨è§£ï¼šåªæœ‰åŸå§‹æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œæ‰ä¼šæ‰§è¡Œé€šçŸ¥çš„æ–¹æ³• 16.6 AOPé€šçŸ¥è·å–æ•°æ® è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•° JoinPointï¼šé€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ProceedJointPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿”å›å€¼ è¿”å›åé€šçŸ¥ ç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ç¯ç»•é€šçŸ¥ 123456789@Repositorypublic class BookDaoImpl implements BookDao &#123; @Override public int select(int id, String name) &#123; System.out.println(&quot;book dao select~~~&quot;); System.out.println(&quot;id:&quot;+id+&quot; name:&quot;+name); return 100; &#125;&#125; AOPé€šçŸ¥è·å–å‚æ•°æ•°æ® joinPointå¯¹è±¡æè¿°äº†è¿æ¥ç‚¹æ–¹æ³•çš„è¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥è·å–åˆ°åŸå§‹æ–¹æ³•çš„è°ƒç”¨å‚æ•° 1234567891011121314@Component@Aspectpublic class MyAdvice &#123; @Pointcut(&quot;execution(int com.spring.dao.BookDao.select(..))&quot;) private void pt()&#123;&#125; @Before(&quot;pt()&quot;) public void method(JoinPoint jp)&#123; Object[] args = jp.getArgs(); System.out.println(Arrays.toString(args)); &#125;&#125; ä¸»å‡½æ•°è°ƒç”¨selectæ–¹æ³•ï¼š 1234567public class App &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(SpringConfig.class); BookDao bookDao = ac.getBean(BookDao.class); bookDao.select(100, &quot;dahuang&quot;); &#125;&#125; 123è¿è¡Œç»“æœï¼š[100, dahuang]book dao select~~~ ProceedingJoinPointæ˜¯JoinPointçš„å­ç±» 12345678@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object[] args = pjp.getArgs(); System.out.println(Arrays.toString(args)); args[0] = 666; Object ret = pjp.proceed(args); return ret; &#125; 1234è¿è¡Œç»“æœï¼š[100, dahuang]book dao select~~~id:666 name:dahuang AOPé€šçŸ¥è·å–è¿”å›æ•°æ® æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡ 1234@AfterReturning(value = &quot;pt()&quot;, returning = &quot;ret&quot;)public void method(JoinPoint jp, int ret)&#123; System.out.println(&quot;afterReturn~~~&quot;+ret);&#125; ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥æ‰‹å·¥ä¹¦å†™å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ï¼Œå¾—åˆ°çš„ç»“æœå³ä¸ºåŸå§‹æ–¹æ³•çš„è¿”å›å€¼ 12345@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object ret = pjp.proceed(); return ret; &#125; AOPé€šçŸ¥è·å–å¼‚å¸¸æ•°æ®(äº†è§£) æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•ä¸­å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡ 1234@AfterThrowing(value = &quot;pt()&quot;, throwing = &quot;t&quot;)public void method(JoinPoint jp, Throwable t)&#123; System.out.println(&quot;afterThrowing~~~&quot;+t);&#125; æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥å¯ä»¥è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œçš„å¼‚å¸¸ä¿¡æ¯ï¼Œä½¿ç”¨å½¢å‚å¯ä»¥æ¥æ”¶è¿è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ 1234567891011@Around(&quot;pt()&quot;) public Object method(ProceedingJoinPoint pjp) throws Throwable &#123; Object ret = null; try&#123; ret = pjp.proceed(); &#125; catch(Throwable t)&#123; t.printStackTrace(); &#125; return ret; &#125; 16.7 AOPæ€»ç»“1.åŸºæœ¬æ¦‚å¿µï¼š æ¦‚å¿µï¼šAOP(Aspect Oriented Programming) é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸€ç§ç¼–ç¨‹èŒƒå¼ ä½œç”¨ï¼šåœ¨ä¸æƒŠåŠ¨åŸå§‹è®¾è®¡çš„åŸºç¡€ä¸Šä¸ºæ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼º æ ¸å¿ƒæ¦‚å¿µ ä»£ç†(Proxy)ï¼šSpringAOPçš„æ ¸å¿ƒæœ¬è´¨æ˜¯é‡‡ç”¨ä»£ç†æ¨¡å¼å®ç°çš„ è¿æ¥ç‚¹(JoinPoint )ï¼šåœ¨SpringAOPä¸­ ,ç†è§£ä¸ºä»»æ„æ–¹æ³•çš„æ‰§è¡Œ åˆ‡å…¥ç‚¹( Pointcut )ï¼šåŒ¹é…è¿æ¥ç‚¹çš„å¼å­,ä¹Ÿæ˜¯å…·æœ‰å…±æ€§åŠŸèƒ½çš„æ–¹æ³•æè¿° é€šçŸ¥(Advice)ï¼šè‹¥å¹²ä¸ªæ–¹æ³•çš„å…±æ€§åŠŸèƒ½,åœ¨åˆ‡å…¥ç‚¹å¤„æ‰§è¡Œ,æœ€ç»ˆä½“ç°ä¸º-ä¸€ä¸ªæ–¹æ³• åˆ‡é¢( Aspect )ï¼šæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³» ç›®æ ‡å¯¹è±¡ ( Target )ï¼šè¢«ä»£ç†çš„åŸå§‹å¯¹è±¡æˆä¸ºç›®æ ‡å¯¹è±¡ 2.åˆ‡å…¥ç‚¹ï¼š åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æ ‡å‡†æ ¼å¼ï¼š åŠ¨ä½œå…³é”®å­—(è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ åŒ…å.ç±»&#x2F;æ¥å£å.æ–¹æ³•å(å‚æ•°) å¼‚å¸¸å) execution(* com.spring.service.*Service.*(..)) åˆ‡å…¥ç‚¹è¡¨è¾¾å¼æè¿°é€šé…ç¬¦ï¼š ä½œç”¨: ç”¨äºå¿«é€Ÿæè¿°,èŒƒå›´æè¿° *ï¼šåŒ¹é…ä»»æ„ç¬¦å·(å¸¸ç”¨) ..ï¼šåŒ¹é…å¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·(å¸¸ç”¨) +ï¼šåŒ¹é…å­ç±»ç±»å‹ åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¹¦å†™æŠ€å·§ æŒ‰æ ‡å‡†è§„èŒƒå¼€å‘ æŸ¥è¯¢æ“ä½œçš„è¿”å›å€¼å»ºè®®ä½¿ç”¨*åŒ¹é… å‡å°‘ä½¿ç”¨..çš„å½¢å¼æè¿°åŒ… å¯¹æ¥å£è¿›è¡Œæè¿°,ä½¿ç”¨*è¡¨ç¤ºæ¨¡å—å,ä¾‹å¦‚UserServiceçš„åŒ¹é…æè¿°ä¸º*Service æ–¹æ³•åä¹¦å†™ä¿ç•™åŠ¨è¯,ä¾‹å¦‚get ,ä½¿ç”¨*è¡¨ç¤ºåè¯,ä¾‹å¦‚getByIdåŒ¹é…æè¿°ä¸ºgetBy* å‚æ•°æ ¹æ®å®é™…æƒ…å†µçµæ´»è°ƒæ•´ 3.é€šçŸ¥ç±»å‹ï¼š å‰ç½®é€šçŸ¥ åç½®é€šçŸ¥ ç¯ç»•é€šçŸ¥(é‡ç‚¹) ç¯ç»•é€šçŸ¥ä¾èµ–å½¢å‚ProceedingJoinPointæ‰èƒ½å®ç°å¯¹åŸå§‹æ–¹æ³•çš„è°ƒç”¨ ç¯ç»•é€šçŸ¥å¯ä»¥éš”ç¦»åŸå§‹æ–¹æ³•çš„è°ƒç”¨æ‰§è¡Œ ç¯ç»•é€šçŸ¥è¿”å›å€¼è®¾ç½®ä¸º0bjectç±»å‹ ç¯ç»•é€šçŸ¥ä¸­å¯ä»¥å¯¹åŸå§‹æ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸è¿›è¡Œå¤„ç† è¿”å›åé€šçŸ¥ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ 4.é€šçŸ¥è·å–æ•°æ®ï¼š è·å–åˆ‡å…¥ç‚¹æ–¹æ³•çš„å‚æ•° JoinPointï¼šé€‚ç”¨äºå‰ç½®ã€åç½®ã€è¿”å›åã€æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥,è®¾ç½®ä¸ºæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå½¢å‚ ProceedJointPointï¼šé€‚ç”¨äºç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿”å›å€¼ è¿”å›åé€šçŸ¥ . ç¯ç»•é€šçŸ¥ è·å–åˆ‡å…¥ç‚¹æ–¹æ³•è¿è¡Œå¼‚å¸¸ä¿¡æ¯ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ ç¯ç»•é€šçŸ¥ 17.Springäº‹åŠ¡17.1 Springäº‹åŠ¡ç®€ä»‹äº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ Springäº‹åŠ¡ä½œç”¨ï¼šåœ¨æ•°æ®å±‚æˆ–ä¸šåŠ¡å±‚ä¿éšœä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œåŒæˆåŠŸåŒå¤±è´¥ æ¡ˆä¾‹ï¼šé“¶è¡Œè½¬è´¦ éœ€æ±‚:å®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ éœ€æ±‚å¾®ç¼©: Aè´¦æˆ·å‡é’±, Bè´¦æˆ·åŠ é’± åˆ†æ: â‘ æ•°æ®å±‚æä¾›åŸºç¡€æ“ä½œ, æŒ‡å®šè´¦æˆ·å‡é’±( outMoney ) , æŒ‡å®šè´¦æˆ·åŠ é’±( inMoney ) â‘¡ä¸šåŠ¡å±‚æä¾›è½¬è´¦æ“ä½œ( transfer ) , è°ƒç”¨å‡é’±ä¸åŠ é’±çš„æ“ä½œ â‘¢æä¾›2ä¸ªè´¦å·å’Œæ“ä½œé‡‘é¢æ‰§è¡Œè½¬è´¦æ“ä½œ â‘£åŸºäºSpringæ•´åˆMyBatisç¯å¢ƒæ­å»ºä¸Šè¿°æ“ä½œ JDKç‰ˆæœ¬ï¼š8 é¡¹ç›®ç»“æ„ï¼š pom.xml 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.16&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.5.6&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.47&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;5.2.10.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; com.spring.configåŒ…ä¸‹ï¼š JdbcConfig 12345678910111213141516171819202122232425262728public class JdbcConfig &#123; @Value(&quot;$&#123;jdbc.driver&#125;&quot;) private String driver; @Value(&quot;$&#123;jdbc.url&#125;&quot;) private String url; @Value(&quot;$&#123;jdbc.username&#125;&quot;) private String userName; @Value(&quot;$&#123;jdbc.password&#125;&quot;) private String password; @Bean public DataSource dataSource()&#123; DruidDataSource ds = new DruidDataSource(); ds.setDriverClassName(driver); ds.setUrl(url); ds.setUsername(userName); ds.setPassword(password); return ds; &#125; //é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œmybatisä½¿ç”¨çš„æ˜¯jdbcäº‹åŠ¡ @Bean public PlatformTransactionManager transactionManager(DataSource dataSource)&#123; DataSourceTransactionManager transactionManager = new DataSourceTransactionManager(); transactionManager.setDataSource(dataSource); return transactionManager; &#125;&#125; MybatisConfig 1234567891011121314151617public class MybatisConfig &#123; @Bean public SqlSessionFactoryBean sqlSessionFactory(DataSource dataSource)&#123; SqlSessionFactoryBean ssfb = new SqlSessionFactoryBean(); ssfb.setTypeAliasesPackage(&quot;com.itheima.p&quot;); ssfb.setDataSource(dataSource); return ssfb; &#125; @Bean public MapperScannerConfigurer mapperScannerConfigurer()&#123; MapperScannerConfigurer msc = new MapperScannerConfigurer(); msc.setBasePackage(&quot;com.itheima.dao&quot;); return msc; &#125;&#125; æ ¸å¿ƒé…ç½®ç±»ï¼šSpringConfig 12345678@Configuration@ComponentScan(&quot;com.itheima&quot;)@PropertySource(&quot;classpath:jdbc.properties&quot;)@Import(&#123;JdbcConfig.class,MybatisConfig.class&#125;)//å¼€å¯æ³¨è§£å¼äº‹åŠ¡é©±åŠ¨@EnableTransactionManagementpublic class SpringConfig &#123;&#125; Account 123456789101112131415161718192021222324252627282930313233343536373839public class Account implements Serializable &#123; private Integer id; private String name; private Double money; public Integer getId() &#123; return id; &#125; public void setId(Integer id) &#123; this.id = id; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public Double getMoney() &#123; return money; &#125; public void setMoney(Double money) &#123; this.money = money; &#125; @Override public String toString() &#123; return &quot;Account&#123;&quot; + &quot;id=&quot; + id + &quot;, name=&#x27;&quot; + name + &#x27;\\&#x27;&#x27; + &quot;, money=&quot; + money + &#x27;&#125;&#x27;; &#125;&#125; com.spring.daoåŒ…ä¸‹ï¼š AccountDao 12345678public interface AccountDao &#123; @Update(&quot;update demo.account set money = money + #&#123;money&#125; where name = #&#123;name&#125;&quot;) void inMoney(@Param(&quot;name&quot;) String name, @Param(&quot;money&quot;) Double money); @Update(&quot;update demo.account set money = money - #&#123;money&#125; where name = #&#123;name&#125;&quot;) void outMoney(@Param(&quot;name&quot;) String name, @Param(&quot;money&quot;) Double money);&#125; AccountService 12345public interface AccountService &#123; //é…ç½®å½“å‰æ¥å£æ–¹æ³•å…·æœ‰äº‹åŠ¡ @Transactional public void transfer(String out,String in ,Double money) ;&#125; AccountServiceImpl 12345678910@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; public void transfer(String out,String in ,Double money) &#123; accountDao.outMoney(out,money); accountDao.inMoney(in,money); &#125;&#125; æµ‹è¯•ç±»ï¼šAccountServiceTest 1234567891011@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(classes = SpringConfig.class)public class AccountServiceTest &#123; @Autowired private AccountService accountService; @Test public void testTransfer() throws IOException &#123; accountService.transfer(&quot;Tom&quot;,&quot;Jerry&quot;,100D); &#125;&#125; 17.2 Springäº‹åŠ¡è§’è‰²äº‹åŠ¡è§’è‰² äº‹åŠ¡ç®¡ç†å‘˜ï¼šå‘èµ·äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸ä»£æŒ‡ä¸šåŠ¡å±‚å¼€å¯äº‹åŠ¡çš„æ–¹æ³• äº‹åŠ¡åè°ƒå‘˜ï¼šåŠ å…¥äº‹åŠ¡æ–¹ï¼Œåœ¨Springä¸­é€šå¸¸ä»£æŒ‡æ•°æ®å±‚æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡å±‚çš„æ–¹æ³• 17.3 Springäº‹åŠ¡å±æ€§ å±æ€§ ä½œç”¨ ç¤ºä¾‹ readOnly è®¾ç½®æ˜¯å¦ä¸ºåªè¯»äº‹åŠ¡ readOnly&#x3D;true åªè¯»äº‹åŠ¡ timeout è®¾ç½®äº‹åŠ¡è¶…æ—¶æ—¶é—´ timeout&#x3D;-1 æ°¸ä¸è¶…æ—¶ rollbackFor è®¾ç½®äº‹åŠ¡å›æ»šå¼‚å¸¸(class) rollbackFor&#x3D;{NullPointException.class} rollbackForClassName è®¾ç½®äº‹åŠ¡å›æ»šå¼‚å¸¸(String) åŒä¸Šå­—ç¬¦ä¸²æ ¼å¼ noRollbackFor è®¾ç½®äº‹åŠ¡ä¸å›æ»šå¼‚å¸¸(class) norollbackFor&#x3D;{NullPointException.class} noRollbackForClassName è®¾ç½®äº‹åŠ¡ä¸å›æ»šå¼‚å¸¸(String) åŒä¸Šå­—ç¬¦ä¸²æ ¼å¼ propagation è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸º â€¦.. 12345678910111213@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; @Override public void transfer(String out, String in, Double money) throws IOException &#123; accountDao.outMoney(out,money); //æ·»åŠ IOExceptionç±»å‹é”™è¯¯ if(true) throw new IOException(); accountDao.inMoney(in,money); &#125;&#125; è¿è¡Œåï¼ŒæŠ¥é”™ï¼ŒoutMoneyæ–¹æ³•æ‰§è¡Œäº†ï¼Œä½†inMoneyæ–¹æ³•æ²¡æœ‰æ‰§è¡Œ å¹¶ä¸æ˜¯æ‰€æœ‰é”™è¯¯ç±»å‹éƒ½ä¼šå›æ»š æˆ‘ä»¬å¸Œæœ›transferæ–¹æ³•ï¼Œè°ƒç”¨çš„äº‹åŠ¡åŒå¤±è´¥ åœ¨@Transactionalæ³¨è§£ä¸­çš„å±æ€§rollbackForæ·»åŠ é”™è¯¯çš„ç±»å‹ 12345public interface AccountService &#123; @Transactional(rollbackFor = &#123;IOException.class&#125;) void transfer(String out, String in, Double money) throws IOException;&#125; å†æ¬¡è¿è¡Œåï¼ŒæŠ¥é”™ï¼ŒoutMoneyå’ŒinMoneyæ–¹æ³•éƒ½æ²¡æœ‰æ‰§è¡Œ æ¡ˆä¾‹ï¼šè½¬è´¦ä¸šåŠ¡è¿½åŠ æ—¥å¿— éœ€æ±‚:å®ç°ä»»æ„ä¸¤ä¸ªè´¦æˆ·é—´è½¬è´¦æ“ä½œ,å¹¶å¯¹æ¯æ¬¡è½¬è´¦æ“ä½œåœ¨æ•°æ®åº“è¿›è¡Œç•™ç—• éœ€æ±‚å¾®ç¼©: Aè´¦æˆ·å‡é’±, Bè´¦æˆ·åŠ é’±,æ•°æ®åº“è®°å½•æ—¥å¿— åˆ†æ: â‘ :åŸºäºè½¬è´¦æ“ä½œæ¡ˆä¾‹æ·»åŠ æ—¥å¿—æ¨¡å—,å®ç°æ•°æ®åº“ä¸­è®°å½•æ—¥å¿— â‘¡:ä¸šåŠ¡å±‚è½¬è´¦æ“ä½œ( transfer ) ,è°ƒç”¨å‡é’±ã€åŠ é’±ä¸è®°å½•æ—¥å¿—åŠŸèƒ½ å®ç°æ•ˆæœé¢„æœŸï¼š â€‹ æ— è®ºè½¬è´¦æ“ä½œæ˜¯å¦æˆåŠŸ,å‡è¿›è¡Œè½¬è´¦æ“ä½œçš„æ—¥å¿—ç•™ç—• 123456789101112131415161718192021@Servicepublic class AccountServiceImpl implements AccountService &#123; @Autowired private AccountDao accountDao; @Autowired private LogService logService; @Override public void transfer(String out, String in, Double money) throws IOException &#123; try&#123; accountDao.outMoney(out,money); int i = 1/0; accountDao.inMoney(in,money); &#125; finally&#123; logService.log(out,in,money); &#125; &#125;&#125; è¿è¡Œåï¼ŒoutMoneyæ–¹æ³•å’ŒinMoneyæ–¹æ³•è¿›è¡Œå›æ»šï¼ŒåŒæ—¶logæ–¹æ³•ä¹Ÿè¿›è¡Œäº†å›æ»šï¼Œæœªå°†æ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ å­˜åœ¨é—®é¢˜ï¼š æ—¥å¿—çš„è®°å½•ä¸è½¬è´¦æ“ä½œéš¶å±åŒä¸€ä¸ªäº‹åŠ¡ï¼ŒåŒæˆåŠŸåŒå¤±è´¥ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šäº‹åŠ¡åè°ƒå‘˜å¯¹äº‹ç‰©ç®¡ç†å‘˜æ‰€æºå¸¦äº‹åŠ¡çš„å¤„ç†æ€åº¦ åœ¨ä¸šåŠ¡å±‚æ¥å£æ·»åŠ Springäº‹åŠ¡ï¼Œ @Transactionalæ³¨è§£ä¸­çš„propagationå±æ€§è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºREQIRES_NEW(éœ€è¦æ–°äº‹åŠ¡) 123456@Servicepublic interface LogService &#123; //è®¾ç½®ä¸ºæ–°äº‹åŠ¡ @Transactional(propagation=Propagation.REQIRES_NEW) public void log(String out, String in, Double money);&#125; è¿è¡Œåï¼ŒoutMoneyæ–¹æ³•å’ŒinMoneyæ–¹æ³•è¿›è¡Œå›æ»šï¼Œäº‹åŠ¡æˆåŠŸã€‚ logæ–¹æ³•æ‰§è¡Œï¼Œå°†æ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ ä¼ æ’­å±æ€§ äº‹åŠ¡ç®¡ç†å‘˜ äº‹åŠ¡åè°ƒå‘˜ REQUIRED(é»˜è®¤) å¼€å¯T åŠ å…¥T æ—  æ–°å»ºT2 REQUIRES_NEW å¼€å¯T æ–°å»ºT2 æ—  æ–°å»ºT2 SUPPORTS å¼€å¯T åŠ å…¥T æ—  æ—  NOT_SUPPORTED å¼€å¯T æ—  æ—  æ—  MANDATORY å¼€å¯T åŠ å…¥T æ—  ERROR NEVER å¼€å¯T ERROR æ—  æ—  NESTED è®¾ç½®savePointï¼Œä¸€æ—¦äº‹åŠ¡å›æ»šï¼Œäº‹åŠ¡å°†å›æ»šåˆ°savePointå¤„ï¼Œäº¤ç”±å®¢æˆ·ç«¯æäº¤/å›æ»š â€‹ 18.ç»“è¯­ä½ ç«Ÿç„¶çœ‹å®Œäº†(ä¸æ•¢ç›¸ä¿¡ï¼ï¼)ï¼ŒçœŸçš„äººä¼šçœ‹å—ï¼çœŸçš„å—ï¼ã‚â—Ğ”â—ãƒ¾ æœ¬äººä¹Ÿæ˜¯åˆå­¦Springï¼Œç¬”è®°ä¸­å¦‚æœæœ‰ä»€ä¹ˆé—æ¼æˆ–é”™è¯¯çš„åœ°æ–¹æ¬¢è¿å¤§ä½¬æŒ‡æ­£ï¼ˆâ‰§âˆ€â‰¦ï¼‰ æœ¬äººQQï¼š2691936018 å¤‡æ³¨ï¼šSpring å¦å¤–å…³äºSpringæ¡†æ¶ï¼Œå¦‚æœæœ‰æ–°çš„å†…å®¹éœ€è¦è¡¥å……ï¼Œæœ¬äººä¹Ÿä¼šè¿›è¡Œæ›´æ–°çš„ æœ¬ç¬”è®°çš„å­¦ä¹ è§†é¢‘ï¼šé»‘é©¬2022æœ€æ–°SSMæ¡†æ¶ æˆ‘ä»¬SpringMVCè§ï¼ï¼(è¿˜æ˜¯ä¸å¤ªç›¸ä¿¡èƒ½æœ‰äººçœ‹â•®(â•¯â–½â•°)â•­)","categories":[{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]},{"title":"(æ¯æ—¥LeetCode)å‰‘æŒ‡ Offer II 091. ç²‰åˆ·æˆ¿å­","slug":"æ¯æ—¥LeetCode/2022-6/å‰‘æŒ‡ Offer II 091 ç²‰åˆ·æˆ¿å­","date":"2022-06-25T02:00:00.000Z","updated":"2022-07-08T00:34:56.580Z","comments":true,"path":"2022/06/25/æ¯æ—¥LeetCode/2022-6/å‰‘æŒ‡ Offer II 091 ç²‰åˆ·æˆ¿å­/","link":"","permalink":"http://example.com/2022/06/25/%E6%AF%8F%E6%97%A5LeetCode/2022-6/%E5%89%91%E6%8C%87%20Offer%20II%20091%20%E7%B2%89%E5%88%B7%E6%88%BF%E5%AD%90/","excerpt":"","text":"é¢˜ç›®ï¼šå‡å¦‚æœ‰ä¸€æ’æˆ¿å­ï¼Œå…± n ä¸ªï¼Œæ¯ä¸ªæˆ¿å­å¯ä»¥è¢«ç²‰åˆ·æˆçº¢è‰²ã€è“è‰²æˆ–è€…ç»¿è‰²è¿™ä¸‰ç§é¢œè‰²ä¸­çš„ä¸€ç§ï¼Œä½ éœ€è¦ç²‰åˆ·æ‰€æœ‰çš„æˆ¿å­å¹¶ä¸”ä½¿å…¶ç›¸é‚»çš„ä¸¤ä¸ªæˆ¿å­é¢œè‰²ä¸èƒ½ç›¸åŒã€‚ å½“ç„¶ï¼Œå› ä¸ºå¸‚åœºä¸Šä¸åŒé¢œè‰²æ²¹æ¼†çš„ä»·æ ¼ä¸åŒï¼Œæ‰€ä»¥æˆ¿å­ç²‰åˆ·æˆä¸åŒé¢œè‰²çš„èŠ±è´¹æˆæœ¬ä¹Ÿæ˜¯ä¸åŒçš„ã€‚æ¯ä¸ªæˆ¿å­ç²‰åˆ·æˆä¸åŒé¢œè‰²çš„èŠ±è´¹æ˜¯ä»¥ä¸€ä¸ª n x 3 çš„æ­£æ•´æ•°çŸ©é˜µ costsæ¥è¡¨ç¤ºçš„ã€‚ ä¾‹å¦‚ï¼Œcosts[0][0] è¡¨ç¤ºç¬¬ 0 å·æˆ¿å­ç²‰åˆ·æˆçº¢è‰²çš„æˆæœ¬èŠ±è´¹ï¼›costs[1][2] è¡¨ç¤ºç¬¬ 1 å·æˆ¿å­ç²‰åˆ·æˆç»¿è‰²çš„èŠ±è´¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¯·è®¡ç®—å‡ºç²‰åˆ·å®Œæ‰€æœ‰æˆ¿å­æœ€å°‘çš„èŠ±è´¹æˆæœ¬ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: costs &#x3D; [[17,2,17],[16,16,5],[14,3,19]]è¾“å‡º: 10è§£é‡Š: å°† 0 å·æˆ¿å­ç²‰åˆ·æˆè“è‰²ï¼Œ1 å·æˆ¿å­ç²‰åˆ·æˆç»¿è‰²ï¼Œ2 å·æˆ¿å­ç²‰åˆ·æˆè“è‰²ã€‚ æœ€å°‘èŠ±è´¹: 2 + 5 + 3 &#x3D; 10ã€‚ 1.é€’å½’ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031class Solution &#123;public: int def(vector&lt;vector&lt;int&gt;&gt;&amp; costs, int pos, int n, vector&lt;vector&lt;int&gt;&gt; flag) &#123; //åˆ°è¾¾æœ€åï¼Œæ²¡æœ‰æˆ¿å­äº†ï¼Œé€€å‡º if (pos == n) return 0; int ans = INT_MAX; //ä¾æ¬¡é€‰æ‹©ä¸‰ç§é¢œè‰² for (int i = 0; i &lt; 3; i++) &#123; int temp = INT_MAX; vector&lt;vector&lt;int&gt;&gt; temp_flag(flag); //ç²‰åˆ·ç¬¬ä¸€ä¸ªæˆ¿å­ï¼Œæ— éœ€çœ‹å‰é¢æˆ¿å­çš„é¢œè‰²ï¼Œå› ä¸ºå‰é¢æ²¡æœ‰æˆ¿å­ã€‚ if (pos == 0) &#123; temp_flag[pos][i] = -1; temp = def(costs, pos + 1, n, temp_flag) + costs[pos][i]; &#125; //ç²‰åˆ·å¢™ï¼Œè¦çœ‹å‰é¢ç”¨äº†ä»€ä¹ˆé¢œè‰² else if (flag[pos - 1][i] != -1) &#123; //å°†è¿™ä¸ªæˆ¿å­çš„é¢œè‰²æ ‡è®° temp_flag[pos][i] = -1; temp = def(costs, pos + 1, n, temp_flag) + costs[pos][i]; &#125; //é€‰æ‹©èŠ±è´¹æœ€å°‘çš„é‡‘é¢ ans = min(ans, temp); &#125; return ans; &#125; int minCost(vector&lt;vector&lt;int&gt;&gt;&amp; costs) &#123; return def(costs, 0, costs.size(), costs); &#125;&#125;; é‡‡ç”¨é€’å½’çš„æ–¹æ³•ï¼Œæäº¤åï¼Œç»“æœæ‰§è¡Œè¶…æ—¶ã€‚ 2.åŠ¨æ€è§„åˆ’$$Red[pos][0]&#x3D;\\begin{cases}cost[0][0] &amp; pos &#x3D; 0; \\min(Green[pos+1][1],Blue[pos+1][2]) + costs[pos][0] &amp; pos&gt;0\\end{cases} \\$$ $$Green[pos][1]&#x3D;\\begin{cases}cost[0][1] &amp; pos &#x3D; 0; \\min(Red[pos+1][0],Blue[pos+1][2]) + costs[pos][1] &amp; pos&gt;0\\end{cases} \\$$ $$Blue[pos][2]&#x3D;\\begin{cases}cost[0][2] &amp; pos &#x3D; 0; \\min(Red[pos+1][0],Green[pos+1][1]) + costs[pos][2] &amp; pos&gt;0\\end{cases}$$ ç”»å‡ºåŠ¨æ€è§„åˆ’å›¾ï¼Œä»¥ç¤ºä¾‹ä¸ºä¾‹ï¼š costs = [[17,2,17],[16,16,5],[14,3,19]] é¢œè‰²\\pos 0 1 2 Red(0) 17 18 21 Green(1) 2 33 10 Blue(2) 17 7 37 $$mincost &#x3D; min(dp[2][0],dp[2][1],dp[2][2])$$ ä»£ç (cpp)ï¼š123456789101112131415161718192021class Solution &#123;public: int minCost(vector&lt;vector&lt;int&gt;&gt;&amp; costs) &#123; int n = costs.size(); vector&lt;int&gt; red(n, 0); vector&lt;int&gt; blue(n, 0); vector&lt;int&gt; green(n, 0); // åˆå§‹åŒ– red[0] = costs[0][0]; blue[0] = costs[0][1]; green[0] = costs[0][2]; for (int i = 1; i &lt; n; ++i) &#123; red[i] = min(blue[i - 1], green[i - 1]) + costs[i][0]; blue[i] = min(red[i - 1], green[i - 1]) + costs[i][1]; green[i] = min(red[i - 1], blue[i - 1]) + costs[i][2]; &#125; return min(red[n - 1], min(blue[n - 1], green[n - 1])); &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯æˆ¿å­ä¸ªæ•°ã€‚éœ€è¦éå†å…¨éƒ¨æˆ¿å­ä¸€æ¬¡ï¼Œç”±äºé¢œè‰²æ•°é‡å›ºå®šæ˜¯ä¸‰ç§ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªæˆ¿å­è®¡ç®—ç²‰åˆ·æˆ¿å­çš„æœ€å°èŠ±è´¹æˆæœ¬çš„æ—¶é—´æ˜¯ O(1)ï¼Œæ€»æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚ä½¿ç”¨ç©ºé—´ä¼˜åŒ–çš„æ–¹æ³•ï¼Œåªéœ€è¦ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º 3 çš„æ•°ç»„ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯ O(1)ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)515. åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼(ä¸­ç­‰)","slug":"æ¯æ—¥LeetCode/2022-6/515 åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼","date":"2022-06-24T01:04:00.000Z","updated":"2022-07-08T00:35:14.972Z","comments":true,"path":"2022/06/24/æ¯æ—¥LeetCode/2022-6/515 åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼/","link":"","permalink":"http://example.com/2022/06/24/%E6%AF%8F%E6%97%A5LeetCode/2022-6/515%20%E5%9C%A8%E6%AF%8F%E4%B8%AA%E6%A0%91%E8%A1%8C%E4%B8%AD%E6%89%BE%E6%9C%80%E5%A4%A7%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ root ï¼Œè¯·æ‰¾å‡ºè¯¥äºŒå‰æ ‘ä¸­æ¯ä¸€å±‚çš„æœ€å¤§å€¼ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥: root &#x3D; [1,3,2,5,3,null,9]è¾“å‡º: [1,3,9] æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢æˆ‘ä»¬é‡‡ç”¨æ ‘çš„å…ˆåºéå†ï¼Œæ¥è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå¹¶ç”¨posæ¥è®°å½•å½“å‰æ ‘çš„é«˜åº¦ï¼Œå°±å¯ä»¥é€šè¿‡posé«˜åº¦æ¥åˆ¤æ–­æ˜¯å¦åœ¨åŒä¸€å±‚ï¼Œå¹¶ä¸”æ˜¯å¦æ›´æ–°æ­¤é«˜åº¦çš„æœ€å¤§å€¼ã€‚ ä»£ç (cpp)ï¼š123456789101112131415161718192021222324252627class Solution &#123;public: void dfs(TreeNode* root, vector&lt;int&gt;&amp; result, int pos)&#123; //å¦‚æœè¯¥ç»“ç‚¹ä¸ºç©ºï¼Œåˆ™é€€å‡º if(root == nullptr) return; if(result.size() == pos)&#123; //æ•°ç»„çš„å¤§å°å°äºé«˜åº¦ï¼Œå¤§å°éœ€è¦åŠ 1 result.push_back(root-&gt;val); &#125; else&#123; //åˆ¤æ–­è¯¥å±‚çš„æŸä¸ªç»“ç‚¹ï¼Œä¸ä¹‹å‰è®°å½•çš„æ¯”è¾ƒå¤§å° result[pos] = max(result[pos], root-&gt;val); &#125; //éå†å·¦å­æ ‘ï¼Œé«˜åº¦+1 dfs(root-&gt;left, result, pos+1); //éå†å³å­æ ‘ï¼Œé«˜åº¦+1 dfs(root-&gt;right, result, pos+1); &#125; vector&lt;int&gt; largestValues(TreeNode* root) &#123; vector&lt;int&gt; result; dfs(root, result, 0); return result; &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n ä¸ºäºŒå‰æ ‘èŠ‚ç‚¹ä¸ªæ•°ã€‚äºŒå‰æ ‘çš„éå†ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¼šè¢«è®¿é—®ä¸€æ¬¡ä¸”åªä¼šè¢«è®¿é—®ä¸€æ¬¡ã€‚ ç©ºé—´å¤æ‚åº¦ï¼šO(pos)ã€‚å…¶ä¸­ pos è¡¨ç¤ºäºŒå‰æ ‘çš„é«˜åº¦ã€‚é€’å½’å‡½æ•°éœ€è¦æ ˆç©ºé—´ï¼Œè€Œæ ˆç©ºé—´å–å†³äºé€’å½’çš„æ·±åº¦ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ç­‰ä»·äºäºŒå‰æ ‘çš„é«˜åº¦ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)30. ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²","slug":"æ¯æ—¥LeetCode/2022-6/30 ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²","date":"2022-06-23T03:53:00.000Z","updated":"2022-07-08T00:35:01.595Z","comments":true,"path":"2022/06/23/æ¯æ—¥LeetCode/2022-6/30 ä¸²è”æ‰€æœ‰å•è¯çš„å­ä¸²/","link":"","permalink":"http://example.com/2022/06/23/%E6%AF%8F%E6%97%A5LeetCode/2022-6/30%20%E4%B8%B2%E8%81%94%E6%89%80%E6%9C%89%E5%8D%95%E8%AF%8D%E7%9A%84%E5%AD%90%E4%B8%B2/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²så’Œä¸€äº›é•¿åº¦ç›¸åŒçš„å•è¯wordsã€‚æ‰¾å‡ºsä¸­æ°å¥½å¯ä»¥ç”±wordsä¸­æ‰€æœ‰å•è¯ä¸²è”å½¢æˆçš„å­ä¸²çš„èµ·å§‹ä½ç½®ã€‚ æ³¨æ„å­ä¸²è¦ä¸wordsä¸­çš„å•è¯å®Œå…¨åŒ¹é…ï¼Œä¸­é—´ä¸èƒ½æœ‰å…¶ä»–å­—ç¬¦ï¼Œä½†ä¸éœ€è¦è€ƒè™‘wordsä¸­å•è¯ä¸²è”çš„é¡ºåºã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šs &#x3D; â€œbarfoofoobarthefoobarmanâ€, words &#x3D; [â€œbarâ€,â€fooâ€,â€theâ€]è¾“å‡ºï¼š[6,9,12] è¾“å‡ºè¿”å›å­—ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦åœ¨sä¸­çš„ä½ç½® ç¬¬ä¸€ä¸ªå­—ä¸²ï¼šbarfoofoobarthefoobarman 6 ç¬¬äºŒä¸ªå­—ä¸²ï¼šbarfoofoobarthefoobarman 9 ç¬¬ä¸‰ä¸ªå­—ç¬¦ï¼šbarfoofoobarthefoobarman 12 æ€è·¯ï¼šæ»‘åŠ¨çª—å£ word_lenä¸ºæ¯ä¸ªå•è¯çš„é•¿åº¦ï¼Œå› ä¸ºæ¯ä¸ªå•è¯çš„é•¿åº¦éƒ½ç›¸åŒï¼› word_numä¸ºwordsæ•°ç»„ä¸­å•è¯çš„ä¸ªæ•°ï¼› total_lenä¸ºwordsæ•°ç»„ä¸­æ‰€æœ‰çš„å•è¯çš„æ€»é•¿åº¦ï¼› mapæ¥è®°å½•wordsæ•°ç»„ä¸­æ¯ä¸ªå•è¯çš„ä¸ªæ•°ï¼› t_mapéå†sæ—¶ç”¨æ¥è®°å½•ï¼› å·¦æŒ‡é’ˆleftå’Œå³æŒ‡é’ˆrightç”¨æ¥å½“ä½œå·¦å³è¾¹ç•Œï¼› countç”¨æ¥ç»Ÿè®¡å·²ç»åŒ¹é…å•è¯çš„ä¸ªæ•°ï¼Œå¦‚æœcount == word_numï¼Œå°±è¯æ˜åŒ¹é…æˆåŠŸï¼› éå†sæ—¶æ— éœ€ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„éå†ï¼Œå¯ä»¥ä¸€ä¸ªä¸€ä¸ªå•è¯çš„éå†ï¼Œright += word_lenï¼› å¦‚æœæˆªå–çš„å•è¯mapä¸­ä¸å­˜åœ¨ï¼Œåˆ™ä¹‹å‰è®°å½•çš„å…¨éƒ¨æ— æ•ˆï¼Œæ¸…ç©ºt_mapå’Œcountï¼› å¦‚æœæŸä¸ªå•è¯åœ¨t_mapä¸­çš„ä¸ªæ•°å¤§äºmapä¸­çš„ä¸ªæ•°ï¼Œå°±éœ€è¦åˆ é™¤åŒ¹é…çš„å¤šä½™çš„å•è¯ï¼Œå°±éœ€è¦åˆ é™¤çª—å£ä¸­ç¬¬ä¸€ä¸ªå•è¯ï¼Œç›´åˆ°æŸä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°å°äºmapä¸­çš„ä¸ªæ•° ä»£ç (cpp)ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364class Solution &#123;public: vector&lt;int&gt; findSubstring(string s, vector&lt;string&gt;&amp; words) &#123; //ç”¨æ¥å­˜æ”¾ç»“æœ vector&lt;int&gt; result; //åˆ¤æ–­så’Œwordsæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœå…¶ä¸­æœ‰ä¸€ä¸ªä¸ºç©ºï¼Œåˆ™è¿”å›ç©ºæ•°ç»„ if(s.empty()||words.empty())&#123; return result; &#125; int word_len = words[0].size(); //ä¸€ä¸ªå•è¯çš„é•¿åº¦ï¼ˆæ¯ä¸ªå•è¯é•¿åº¦éƒ½ç›¸åŒï¼‰ int word_num = words.size(); // å•è¯çš„æ€»ä¸ªæ•° int total_len = word_len*word_num; // å…¨éƒ¨å•è¯çš„é•¿åº¦ //å»ºç«‹å•è¯-&gt;å•è¯ä¸ªæ•°çš„æ˜ å°„ unordered_map&lt;string, int&gt; map; //ç»Ÿè®¡æ¯ä¸ªå•è¯çš„ä¸ªæ•° for(auto &amp;word : words)&#123; //map[key]:è¿”å›keyå€¼æ‰€å¯¹åº”çš„valueå€¼ï¼Œå¦‚æœä¸å­˜åœ¨keyå€¼ï¼Œåˆ™ä¼šä½¿ç”¨è¯¥keyå€¼å‘å½“å‰å®¹å™¨ä¸­æ’å…¥ä¸€ä¸ªæ–°valueå€¼ä¸º 0 map[word]++; //ç­‰ä»·äº map[word] += 1 &#125; for(int i = 0; i&lt; word_len; i++)&#123; //leftå’Œrightç”¨æ¥è¡¨ç¤ºçª—å£çš„å·¦å³è¾¹ç•Œ int left = i; int right = i; //countç”¨æ¥ç»Ÿè®¡å·²ç»åŒ¹é…çš„å•è¯ä¸ªæ•° int count = 0; unordered_map&lt;string, int&gt; t_map; //å¼€å§‹æ»‘åŠ¨çª—å£ //rightå³è¾¹ç•Œä¾æ¬¡ç´¯åŠ å•è¯çš„é•¿åº¦ï¼Œç›´åˆ°è¶…è¿‡sçš„é•¿åº¦åœæ­¢å¾ªç¯ while(right + word_len &lt;= s.size())&#123; //substr(pos, n):ä»ç¬¬posçš„ä½ç½®å¼€å§‹æˆªå–nä¸ªå­—ç¬¦è·å–å•è¯ string word = s.substr(right, word_len); right += word_len; //rightè·³åˆ°ä¸‹ä¸€ä¸ªå•è¯ //count(key):åœ¨å®¹å™¨ä¸­æŸ¥æ‰¾ä»¥keyé”®çš„é”®å€¼å¯¹çš„ä¸ªæ•°ã€‚å¦‚æœä¸º0ï¼Œè¯´æ˜æ­¤å•è¯wordåœ¨wordsæ•°ç»„ä¸­ä¸å­˜åœ¨ã€‚ if(map.count(word) == 0)&#123; count = 0; //æ¸…ç©ºä¹‹å‰ç»Ÿè®¡çš„ä¸ªæ•° left = right; //å°†å·¦æŒ‡é’ˆleftç§»åŠ¨åˆ°å³æŒ‡é’ˆrightä½ç½®ä¸Šé‡æ–°å¼€å§‹ t_map.clear(); //ä¹‹å‰åŒ¹é…çš„å•è¯æ²¡ç”¨äº†ï¼Œæ¸…ç©ºt_mapä¸­çš„å…ƒç´  &#125; //å¦‚æœä¸ä¸º0ï¼Œè¯´æ˜æ­¤å•è¯wordåœ¨wordsæ•°ç»„ä¸­å­˜åœ¨ã€‚ else&#123; count++; //ç»Ÿè®¡ä¸ªæ•°åŠ 1 t_map[word]++;// wordæ‰€å¯¹åº”çš„ä¸ªæ•°åŠ 1 //t_mapä¸­çš„wordå¯¹åº”çš„ä¸ªæ•°å¤§äºmapçš„wordå¯¹åº”çš„ä¸ªæ•°ï¼Œè¯´æ˜åŒ¹é…åˆ°å¤šä½™çš„å•è¯äº† while(t_map[word]&gt; map[word])&#123; //è·å–çª—å£çš„ç¬¬ä¸€ä¸ªå•è¯ string t_word = s.substr(left, word_len); //å°†t_wordè¿™ä¸ªå•è¯å¯¹åº”çš„ä¸ªæ•°å‡1 //å¹¶éæ˜¯é‚£ä¸ªå¤§äºmapä¸­ä¸ªæ•°çš„å•è¯ t_map[t_word]--; count--; //ç»Ÿè®¡ä¸ªæ•°å‡1 left += word_len;//å°†å·¦æŒ‡é’ˆè·³åˆ°ä¸‹ä¸€ä¸ª &#125; //å¦‚æœcountç­‰äºå•è¯çš„ä¸ªæ•°è¯´æ˜åŒ¹é…æˆåŠŸï¼Œå°†å·¦æŒ‡é’ˆä½ç½®è®°å½• if(count == word_num)&#123; result.push_back(left); &#125; &#125; &#125; &#125; return result; &#125;&#125;; å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼šO(lsÃ—n)ï¼Œå…¶ä¸­ ls æ˜¯è¾“å…¥ s çš„é•¿åº¦ï¼Œn æ˜¯ words ä¸­æ¯ä¸ªå•è¯çš„é•¿åº¦ã€‚éœ€è¦åš n æ¬¡æ»‘åŠ¨çª—å£ï¼Œæ¯æ¬¡éœ€è¦éå†ä¸€æ¬¡ sã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"(æ¯æ—¥LeetCode)513. æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼","slug":"æ¯æ—¥LeetCode/2022-6/513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼","date":"2022-06-22T03:11:00.000Z","updated":"2022-07-08T00:35:09.778Z","comments":true,"path":"2022/06/22/æ¯æ—¥LeetCode/2022-6/513 æ‰¾æ ‘å·¦ä¸‹è§’çš„å€¼/","link":"","permalink":"http://example.com/2022/06/22/%E6%AF%8F%E6%97%A5LeetCode/2022-6/513%20%E6%89%BE%E6%A0%91%E5%B7%A6%E4%B8%8B%E8%A7%92%E7%9A%84%E5%80%BC/","excerpt":"","text":"é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„ æ ¹èŠ‚ç‚¹ rootï¼Œè¯·æ‰¾å‡ºè¯¥äºŒå‰æ ‘çš„ æœ€åº•å±‚ æœ€å·¦è¾¹ èŠ‚ç‚¹çš„å€¼ã€‚ å‡è®¾äºŒå‰æ ‘ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚ ç¤ºä¾‹: è¾“å…¥: [1,2,3,4,null,5,6,null,null,7]è¾“å‡º: 7 æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)æˆ‘é‡‡ç”¨äº†ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œå†éå†å³èŠ‚ç‚¹ï¼Œå› ä¸ºåªæœ‰ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œæ‰ä¼šä¼˜å…ˆè®°å½•å½“å‰æ·±åº¦å·¦èŠ‚ç‚¹çš„å€¼ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¿…è¦è®°å½•å½“å‰æ·±åº¦å³è¾¹çš„å€¼äº†ã€‚ ä½¿ç”¨depthè®°å½•å½“å‰æ ‘çš„æ·±åº¦ï¼Œcurrent_valä¸ºè®°å½•çš„æ·±åº¦current_depthçš„æœ€å·¦è¾¹çš„å€¼ã€‚ è¿›è¡Œåˆ¤æ–­å¦‚æœdepthçš„æ·±åº¦å¤§äºcurrent_depthçš„æ·±åº¦ï¼Œå°†current_valçš„å€¼è®¾ç½®ä¸ºå½“å‰ç»“ç‚¹çš„å€¼ï¼Œå¹¶å°†current_depthçš„å€¼è®¾ç½®å½“å‰ç»“ç‚¹æ·±åº¦depth ä»£ç (cpp)ï¼š1234567891011121314151617181920212223242526272829class Solution &#123;public: void dfs(TreeNode* root, int depth, int&amp; current_depth, int&amp; current_val) &#123; if (root == nullptr) //å¦‚æœå½“å‰ç»“ç‚¹ä¸ºç©ºï¼Œåˆ™é€€å‡º &#123; return; &#125; //ä¼˜å…ˆéå†å·¦èŠ‚ç‚¹ï¼Œæ·±åº¦åŠ 1 dfs(root-&gt;left, depth+1, current_depth, current_val); //å…¶æ¬¡éå†å³èŠ‚ç‚¹ï¼Œæ·±åº¦åŠ 1 dfs(root-&gt;right, depth+1, current_depth, current_val); //å¦‚æœå½“å‰æ·±åº¦å¤§äºè®°å½•çš„æ·±åº¦ if (depth &gt; current_depth) &#123; current_depth = depth; //å°†å½“å‰æ·±åº¦è®°å½•åˆ°current_depth current_val = root-&gt;val; //å°†å½“å‰ç»“ç‚¹å€¼è®°å½•åˆ°current_val &#125; &#125; int findBottomLeftValue(TreeNode* root) &#123; int current_depth = 0; //åˆå§‹åŒ–current_depth int current_val = 0; //åˆå§‹åŒ–current_val //å› ä¸ºæœ‰æ ¹ç»“ç‚¹å­˜åœ¨ï¼Œå°†depthè®¾ç½®ä¸º1ï¼Œè€Œé0 dfs(root, 1, current_depth, current_val); return current_val; &#125;&#125;; å¤æ‚åº¦åˆ†æ â€‹ æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­ n æ˜¯äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ç›®ã€‚éœ€è¦éå† n ä¸ªèŠ‚ç‚¹ã€‚ â€‹ ç©ºé—´å¤æ‚åº¦ï¼šO(n)ã€‚é€’å½’æ ˆéœ€è¦å ç”¨ O(n) çš„ç©ºé—´ã€‚","categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]}],"categories":[{"name":"æ¯æ—¥LeetCode","slug":"æ¯æ—¥LeetCode","permalink":"http://example.com/categories/%E6%AF%8F%E6%97%A5LeetCode/"},{"name":"C++","slug":"C","permalink":"http://example.com/categories/C/"},{"name":"Java","slug":"Java","permalink":"http://example.com/categories/Java/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://example.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"LeetCode","slug":"LeetCode","permalink":"http://example.com/tags/LeetCode/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"C++","slug":"C","permalink":"http://example.com/tags/C/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"http://example.com/tags/%E5%AE%B9%E5%99%A8/"},{"name":"STL","slug":"STL","permalink":"http://example.com/tags/STL/"},{"name":"Java","slug":"Java","permalink":"http://example.com/tags/Java/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"http://example.com/tags/%E6%A1%86%E6%9E%B6/"}]}